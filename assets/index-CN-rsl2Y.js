var V$=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Gwe=V$((uve,Mp)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();/**
* @vue/shared v3.5.6
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function dR(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Nt={},gc=[],Hs=()=>{},W$=()=>!1,Ow=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),fR=t=>t.startsWith("onUpdate:"),Dn=Object.assign,gR=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},B$=Object.prototype.hasOwnProperty,wt=(t,e)=>B$.call(t,e),Ue=Array.isArray,cd=t=>Pw(t)==="[object Map]",j$=t=>Pw(t)==="[object Set]",Je=t=>typeof t=="function",Pn=t=>typeof t=="string",Dc=t=>typeof t=="symbol",ln=t=>t!==null&&typeof t=="object",Sx=t=>(ln(t)||Je(t))&&Je(t.then)&&Je(t.catch),U$=Object.prototype.toString,Pw=t=>U$.call(t),Y$=t=>Pw(t).slice(8,-1),z$=t=>Pw(t)==="[object Object]",mR=t=>Pn(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,hd=dR(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Iw=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},G$=/-(\w)/g,Yl=Iw(t=>t.replace(G$,(e,n)=>n?n.toUpperCase():"")),K$=/\B([A-Z])/g,nu=Iw(t=>t.replace(K$,"-$1").toLowerCase()),Rx=Iw(t=>t.charAt(0).toUpperCase()+t.slice(1)),qv=Iw(t=>t?`on${Rx(t)}`:""),xa=(t,e)=>!Object.is(t,e),Zv=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},Ex=(t,e,n,i=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:i,value:n})},X$=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let UM;const Tx=()=>UM||(UM=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function pR(t){if(Ue(t)){const e={};for(let n=0;n<t.length;n++){const i=t[n],r=Pn(i)?Q$(i):pR(i);if(r)for(const s in r)e[s]=r[s]}return e}else if(Pn(t)||ln(t))return t}const q$=/;(?![^(]*\))/g,Z$=/:([^]+)/,J$=/\/\*[^]*?\*\//g;function Q$(t){const e={};return t.replace(J$,"").split(q$).forEach(n=>{if(n){const i=n.split(Z$);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function wR(t){let e="";if(Pn(t))e=t;else if(Ue(t))for(let n=0;n<t.length;n++){const i=wR(t[n]);i&&(e+=i+" ")}else if(ln(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const eF="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",tF=dR(eF);function Mx(t){return!!t||t===""}/**
* @vue/reactivity v3.5.6
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let si;class _x{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=si,!e&&si&&(this.index=(si.scopes||(si.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=si;try{return si=this,e()}finally{si=n}}}on(){si=this}off(){si=this.parent}stop(e){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function nF(t){return new _x(t)}function iF(){return si}function rF(t,e=!1){si&&si.cleanups.push(t)}let Ot;const Jv=new WeakSet;class Ox{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,si&&si.active&&si.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Jv.has(this)&&(Jv.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ix(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,YM(this),xx(this);const e=Ot,n=Lr;Ot=this,Lr=!0;try{return this.fn()}finally{Ax(this),Ot=e,Lr=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)yR(e);this.deps=this.depsTail=void 0,YM(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Jv.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){$b(this)&&this.run()}get dirty(){return $b(this)}}let Px=0,dd;function Ix(t){t.flags|=8,t.next=dd,dd=t}function vR(){Px++}function CR(){if(--Px>0)return;let t;for(;dd;){let e=dd;for(dd=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(i){t||(t=i)}e=n}}if(t)throw t}function xx(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Ax(t){let e,n=t.depsTail,i=n;for(;i;){const r=i.prevDep;i.version===-1?(i===n&&(n=r),yR(i),sF(i)):e=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}t.deps=e,t.depsTail=n}function $b(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Hx(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function Hx(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===jd))return;t.globalVersion=jd;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!$b(t)){t.flags&=-3;return}const n=Ot,i=Lr;Ot=t,Lr=!0;try{xx(t);const r=t.fn(t._value);(e.version===0||xa(r,t._value))&&(t._value=r,e.version++)}catch(r){throw e.version++,r}finally{Ot=n,Lr=i,Ax(t),t.flags&=-3}}function yR(t){const{dep:e,prevSub:n,nextSub:i}=t;if(n&&(n.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=n,t.nextSub=void 0),e.subs===t&&(e.subs=n),!e.subs&&e.computed){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)yR(r)}}function sF(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let Lr=!0;const Nx=[];function ka(){Nx.push(Lr),Lr=!1}function $a(){const t=Nx.pop();Lr=t===void 0?!0:t}function YM(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Ot;Ot=void 0;try{e()}finally{Ot=n}}}let jd=0;class oF{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class bR{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0}track(e){if(!Ot||!Lr||Ot===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Ot)n=this.activeLink=new oF(Ot,this),Ot.deps?(n.prevDep=Ot.depsTail,Ot.depsTail.nextDep=n,Ot.depsTail=n):Ot.deps=Ot.depsTail=n,Ot.flags&4&&Dx(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=Ot.depsTail,n.nextDep=void 0,Ot.depsTail.nextDep=n,Ot.depsTail=n,Ot.deps===n&&(Ot.deps=i)}return n}trigger(e){this.version++,jd++,this.notify(e)}notify(e){vR();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{CR()}}}function Dx(t){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let i=e.deps;i;i=i.nextDep)Dx(i)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}const _p=new WeakMap,jl=Symbol(""),Fb=Symbol(""),Ud=Symbol("");function qn(t,e,n){if(Lr&&Ot){let i=_p.get(t);i||_p.set(t,i=new Map);let r=i.get(n);r||i.set(n,r=new bR),r.track()}}function Mo(t,e,n,i,r,s){const o=_p.get(t);if(!o){jd++;return}const a=l=>{l&&l.trigger()};if(vR(),e==="clear")o.forEach(a);else{const l=Ue(t),u=l&&mR(n);if(l&&n==="length"){const c=Number(i);o.forEach((h,d)=>{(d==="length"||d===Ud||!Dc(d)&&d>=c)&&a(h)})}else switch(n!==void 0&&a(o.get(n)),u&&a(o.get(Ud)),e){case"add":l?u&&a(o.get("length")):(a(o.get(jl)),cd(t)&&a(o.get(Fb)));break;case"delete":l||(a(o.get(jl)),cd(t)&&a(o.get(Fb)));break;case"set":cd(t)&&a(o.get(jl));break}}CR()}function aF(t,e){var n;return(n=_p.get(t))==null?void 0:n.get(e)}function mu(t){const e=ct(t);return e===t?e:(qn(e,"iterate",Ud),kr(t)?e:e.map(ui))}function SR(t){return qn(t=ct(t),"iterate",Ud),t}const lF={__proto__:null,[Symbol.iterator](){return Qv(this,Symbol.iterator,ui)},concat(...t){return mu(this).concat(...t.map(e=>Ue(e)?mu(e):e))},entries(){return Qv(this,"entries",t=>(t[1]=ui(t[1]),t))},every(t,e){return Ys(this,"every",t,e,void 0,arguments)},filter(t,e){return Ys(this,"filter",t,e,n=>n.map(ui),arguments)},find(t,e){return Ys(this,"find",t,e,ui,arguments)},findIndex(t,e){return Ys(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Ys(this,"findLast",t,e,ui,arguments)},findLastIndex(t,e){return Ys(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Ys(this,"forEach",t,e,void 0,arguments)},includes(...t){return eC(this,"includes",t)},indexOf(...t){return eC(this,"indexOf",t)},join(t){return mu(this).join(t)},lastIndexOf(...t){return eC(this,"lastIndexOf",t)},map(t,e){return Ys(this,"map",t,e,void 0,arguments)},pop(){return Zc(this,"pop")},push(...t){return Zc(this,"push",t)},reduce(t,...e){return zM(this,"reduce",t,e)},reduceRight(t,...e){return zM(this,"reduceRight",t,e)},shift(){return Zc(this,"shift")},some(t,e){return Ys(this,"some",t,e,void 0,arguments)},splice(...t){return Zc(this,"splice",t)},toReversed(){return mu(this).toReversed()},toSorted(t){return mu(this).toSorted(t)},toSpliced(...t){return mu(this).toSpliced(...t)},unshift(...t){return Zc(this,"unshift",t)},values(){return Qv(this,"values",ui)}};function Qv(t,e,n){const i=SR(t),r=i[e]();return i!==t&&!kr(t)&&(r._next=r.next,r.next=()=>{const s=r._next();return s.value&&(s.value=n(s.value)),s}),r}const uF=Array.prototype;function Ys(t,e,n,i,r,s){const o=SR(t),a=o!==t&&!kr(t),l=o[e];if(l!==uF[e]){const h=l.apply(t,s);return a?ui(h):h}let u=n;o!==t&&(a?u=function(h,d){return n.call(this,ui(h),d,t)}:n.length>2&&(u=function(h,d){return n.call(this,h,d,t)}));const c=l.call(o,u,i);return a&&r?r(c):c}function zM(t,e,n,i){const r=SR(t);let s=n;return r!==t&&(kr(t)?n.length>3&&(s=function(o,a,l){return n.call(this,o,a,l,t)}):s=function(o,a,l){return n.call(this,o,ui(a),l,t)}),r[e](s,...i)}function eC(t,e,n){const i=ct(t);qn(i,"iterate",Ud);const r=i[e](...n);return(r===-1||r===!1)&&MR(n[0])?(n[0]=ct(n[0]),i[e](...n)):r}function Zc(t,e,n=[]){ka(),vR();const i=ct(t)[e].apply(t,n);return CR(),$a(),i}const cF=dR("__proto__,__v_isRef,__isVue"),Lx=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Dc));function hF(t){Dc(t)||(t=String(t));const e=ct(this);return qn(e,"has",t),e.hasOwnProperty(t)}class kx{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,i){const r=this._isReadonly,s=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return s;if(n==="__v_raw")return i===(r?s?EF:Wx:s?Vx:Fx).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=Ue(e);if(!r){let l;if(o&&(l=lF[n]))return l;if(n==="hasOwnProperty")return hF}const a=Reflect.get(e,n,Nn(e)?e:i);return(Dc(n)?Lx.has(n):cF(n))||(r||qn(e,"get",n),s)?a:Nn(a)?o&&mR(n)?a:a.value:ln(a)?r?Bx(a):Lc(a):a}}class $x extends kx{constructor(e=!1){super(!1,e)}set(e,n,i,r){let s=e[n];if(!this._isShallow){const l=zl(s);if(!kr(i)&&!zl(i)&&(s=ct(s),i=ct(i)),!Ue(e)&&Nn(s)&&!Nn(i))return l?!1:(s.value=i,!0)}const o=Ue(e)&&mR(n)?Number(n)<e.length:wt(e,n),a=Reflect.set(e,n,i,Nn(e)?e:r);return e===ct(r)&&(o?xa(i,s)&&Mo(e,"set",n,i):Mo(e,"add",n,i)),a}deleteProperty(e,n){const i=wt(e,n);e[n];const r=Reflect.deleteProperty(e,n);return r&&i&&Mo(e,"delete",n,void 0),r}has(e,n){const i=Reflect.has(e,n);return(!Dc(n)||!Lx.has(n))&&qn(e,"has",n),i}ownKeys(e){return qn(e,"iterate",Ue(e)?"length":jl),Reflect.ownKeys(e)}}class dF extends kx{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const fF=new $x,gF=new dF,mF=new $x(!0),RR=t=>t,xw=t=>Reflect.getPrototypeOf(t);function tg(t,e,n=!1,i=!1){t=t.__v_raw;const r=ct(t),s=ct(e);n||(xa(e,s)&&qn(r,"get",e),qn(r,"get",s));const{has:o}=xw(r),a=i?RR:n?_R:ui;if(o.call(r,e))return a(t.get(e));if(o.call(r,s))return a(t.get(s));t!==r&&t.get(e)}function ng(t,e=!1){const n=this.__v_raw,i=ct(n),r=ct(t);return e||(xa(t,r)&&qn(i,"has",t),qn(i,"has",r)),t===r?n.has(t):n.has(t)||n.has(r)}function ig(t,e=!1){return t=t.__v_raw,!e&&qn(ct(t),"iterate",jl),Reflect.get(t,"size",t)}function GM(t,e=!1){!e&&!kr(t)&&!zl(t)&&(t=ct(t));const n=ct(this);return xw(n).has.call(n,t)||(n.add(t),Mo(n,"add",t,t)),this}function KM(t,e,n=!1){!n&&!kr(e)&&!zl(e)&&(e=ct(e));const i=ct(this),{has:r,get:s}=xw(i);let o=r.call(i,t);o||(t=ct(t),o=r.call(i,t));const a=s.call(i,t);return i.set(t,e),o?xa(e,a)&&Mo(i,"set",t,e):Mo(i,"add",t,e),this}function XM(t){const e=ct(this),{has:n,get:i}=xw(e);let r=n.call(e,t);r||(t=ct(t),r=n.call(e,t)),i&&i.call(e,t);const s=e.delete(t);return r&&Mo(e,"delete",t,void 0),s}function qM(){const t=ct(this),e=t.size!==0,n=t.clear();return e&&Mo(t,"clear",void 0,void 0),n}function rg(t,e){return function(i,r){const s=this,o=s.__v_raw,a=ct(o),l=e?RR:t?_R:ui;return!t&&qn(a,"iterate",jl),o.forEach((u,c)=>i.call(r,l(u),l(c),s))}}function sg(t,e,n){return function(...i){const r=this.__v_raw,s=ct(r),o=cd(s),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,u=r[t](...i),c=n?RR:e?_R:ui;return!e&&qn(s,"iterate",l?Fb:jl),{next(){const{value:h,done:d}=u.next();return d?{value:h,done:d}:{value:a?[c(h[0]),c(h[1])]:c(h),done:d}},[Symbol.iterator](){return this}}}}function Uo(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function pF(){const t={get(s){return tg(this,s)},get size(){return ig(this)},has:ng,add:GM,set:KM,delete:XM,clear:qM,forEach:rg(!1,!1)},e={get(s){return tg(this,s,!1,!0)},get size(){return ig(this)},has:ng,add(s){return GM.call(this,s,!0)},set(s,o){return KM.call(this,s,o,!0)},delete:XM,clear:qM,forEach:rg(!1,!0)},n={get(s){return tg(this,s,!0)},get size(){return ig(this,!0)},has(s){return ng.call(this,s,!0)},add:Uo("add"),set:Uo("set"),delete:Uo("delete"),clear:Uo("clear"),forEach:rg(!0,!1)},i={get(s){return tg(this,s,!0,!0)},get size(){return ig(this,!0)},has(s){return ng.call(this,s,!0)},add:Uo("add"),set:Uo("set"),delete:Uo("delete"),clear:Uo("clear"),forEach:rg(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=sg(s,!1,!1),n[s]=sg(s,!0,!1),e[s]=sg(s,!1,!0),i[s]=sg(s,!0,!0)}),[t,n,e,i]}const[wF,vF,CF,yF]=pF();function ER(t,e){const n=e?t?yF:CF:t?vF:wF;return(i,r,s)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?i:Reflect.get(wt(n,r)&&r in i?n:i,r,s)}const bF={get:ER(!1,!1)},SF={get:ER(!1,!0)},RF={get:ER(!0,!1)},Fx=new WeakMap,Vx=new WeakMap,Wx=new WeakMap,EF=new WeakMap;function TF(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function MF(t){return t.__v_skip||!Object.isExtensible(t)?0:TF(Y$(t))}function Lc(t){return zl(t)?t:TR(t,!1,fF,bF,Fx)}function _F(t){return TR(t,!1,mF,SF,Vx)}function Bx(t){return TR(t,!0,gF,RF,Wx)}function TR(t,e,n,i,r){if(!ln(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=r.get(t);if(s)return s;const o=MF(t);if(o===0)return t;const a=new Proxy(t,o===2?i:n);return r.set(t,a),a}function fd(t){return zl(t)?fd(t.__v_raw):!!(t&&t.__v_isReactive)}function zl(t){return!!(t&&t.__v_isReadonly)}function kr(t){return!!(t&&t.__v_isShallow)}function MR(t){return t?!!t.__v_raw:!1}function ct(t){const e=t&&t.__v_raw;return e?ct(e):t}function OF(t){return!wt(t,"__v_skip")&&Object.isExtensible(t)&&Ex(t,"__v_skip",!0),t}const ui=t=>ln(t)?Lc(t):t,_R=t=>ln(t)?Bx(t):t;function Nn(t){return t?t.__v_isRef===!0:!1}function _c(t){return jx(t,!1)}function mc(t){return jx(t,!0)}function jx(t,e){return Nn(t)?t:new PF(t,e)}class PF{constructor(e,n){this.dep=new bR,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:ct(e),this._value=n?e:ui(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,i=this.__v_isShallow||kr(e)||zl(e);e=i?e:ct(e),xa(e,n)&&(this._rawValue=e,this._value=i?e:ui(e),this.dep.trigger())}}function IF(t){return Nn(t)?t.value:t}const xF={get:(t,e,n)=>e==="__v_raw"?t:IF(Reflect.get(t,e,n)),set:(t,e,n,i)=>{const r=t[e];return Nn(r)&&!Nn(n)?(r.value=n,!0):Reflect.set(t,e,n,i)}};function Ux(t){return fd(t)?t:new Proxy(t,xF)}function AF(t){const e=Ue(t)?new Array(t.length):{};for(const n in t)e[n]=NF(t,n);return e}class HF{constructor(e,n,i){this._object=e,this._key=n,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return aF(ct(this._object),this._key)}}function NF(t,e,n){const i=t[e];return Nn(i)?i:new HF(t,e,n)}class DF{constructor(e,n,i){this.fn=e,this.setter=n,this._value=void 0,this.dep=new bR(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=jd-1,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Ot!==this)return Ix(this),!0}get value(){const e=this.dep.track();return Hx(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function LF(t,e,n=!1){let i,r;return Je(t)?i=t:(i=t.get,r=t.set),new DF(i,r,n)}const og={},Op=new WeakMap;let Il;function kF(t,e=!1,n=Il){if(n){let i=Op.get(n);i||Op.set(n,i=[]),i.push(t)}}function $F(t,e,n=Nt){const{immediate:i,deep:r,once:s,scheduler:o,augmentJob:a,call:l}=n,u=P=>r?P:kr(P)||r===!1||r===0?fa(P,1):fa(P);let c,h,d,f,m=!1,p=!1;if(Nn(t)?(h=()=>t.value,m=kr(t)):fd(t)?(h=()=>u(t),m=!0):Ue(t)?(p=!0,m=t.some(P=>fd(P)||kr(P)),h=()=>t.map(P=>{if(Nn(P))return P.value;if(fd(P))return u(P);if(Je(P))return l?l(P,2):P()})):Je(t)?e?h=l?()=>l(t,2):t:h=()=>{if(d){ka();try{d()}finally{$a()}}const P=Il;Il=c;try{return l?l(t,3,[f]):t(f)}finally{Il=P}}:h=Hs,e&&r){const P=h,H=r===!0?1/0:r;h=()=>fa(P(),H)}const y=iF(),E=()=>{c.stop(),y&&gR(y.effects,c)};if(s&&e){const P=e;e=(...H)=>{P(...H),E()}}let T=p?new Array(t.length).fill(og):og;const M=P=>{if(!(!(c.flags&1)||!c.dirty&&!P))if(e){const H=c.run();if(r||m||(p?H.some((U,Y)=>xa(U,T[Y])):xa(H,T))){d&&d();const U=Il;Il=c;try{const Y=[H,T===og?void 0:p&&T[0]===og?[]:T,f];l?l(e,3,Y):e(...Y),T=H}finally{Il=U}}}else c.run()};return a&&a(M),c=new Ox(h),c.scheduler=o?()=>o(M,!1):M,f=P=>kF(P,!1,c),d=c.onStop=()=>{const P=Op.get(c);if(P){if(l)l(P,4);else for(const H of P)H();Op.delete(c)}},e?i?M(!0):T=c.run():o?o(M.bind(null,!0),!0):c.run(),E.pause=c.pause.bind(c),E.resume=c.resume.bind(c),E.stop=E,E}function fa(t,e=1/0,n){if(e<=0||!ln(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,Nn(t))fa(t.value,e,n);else if(Ue(t))for(let i=0;i<t.length;i++)fa(t[i],e,n);else if(j$(t)||cd(t))t.forEach(i=>{fa(i,e,n)});else if(z$(t)){for(const i in t)fa(t[i],e,n);for(const i of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,i)&&fa(t[i],e,n)}return t}/**
* @vue/runtime-core v3.5.6
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Cf(t,e,n,i){try{return i?t(...i):t()}catch(r){Aw(r,e,n)}}function Ds(t,e,n,i){if(Je(t)){const r=Cf(t,e,n,i);return r&&Sx(r)&&r.catch(s=>{Aw(s,e,n)}),r}if(Ue(t)){const r=[];for(let s=0;s<t.length;s++)r.push(Ds(t[s],e,n,i));return r}}function Aw(t,e,n,i=!0){const r=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Nt;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const c=a.ec;if(c){for(let h=0;h<c.length;h++)if(c[h](t,l,u)===!1)return}a=a.parent}if(s){ka(),Cf(s,null,10,[t,l,u]),$a();return}}FF(t,n,r,i,o)}function FF(t,e,n,i=!0,r=!1){if(r)throw t;console.error(t)}let Yd=!1,Vb=!1;const ci=[];let ws=0;const pc=[];let oa=null,nc=0;const Yx=Promise.resolve();let OR=null;function zx(t){const e=OR||Yx;return t?e.then(this?t.bind(this):t):e}function VF(t){let e=Yd?ws+1:0,n=ci.length;for(;e<n;){const i=e+n>>>1,r=ci[i],s=zd(r);s<t||s===t&&r.flags&2?e=i+1:n=i}return e}function PR(t){if(!(t.flags&1)){const e=zd(t),n=ci[ci.length-1];!n||!(t.flags&2)&&e>=zd(n)?ci.push(t):ci.splice(VF(e),0,t),t.flags|=1,Gx()}}function Gx(){!Yd&&!Vb&&(Vb=!0,OR=Yx.then(Xx))}function WF(t){Ue(t)?pc.push(...t):oa&&t.id===-1?oa.splice(nc+1,0,t):t.flags&1||(pc.push(t),t.flags|=1),Gx()}function ZM(t,e,n=Yd?ws+1:0){for(;n<ci.length;n++){const i=ci[n];if(i&&i.flags&2){if(t&&i.id!==t.uid)continue;ci.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&=-2}}}function Kx(t){if(pc.length){const e=[...new Set(pc)].sort((n,i)=>zd(n)-zd(i));if(pc.length=0,oa){oa.push(...e);return}for(oa=e,nc=0;nc<oa.length;nc++){const n=oa[nc];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}oa=null,nc=0}}const zd=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Xx(t){Vb=!1,Yd=!0;try{for(ws=0;ws<ci.length;ws++){const e=ci[ws];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Cf(e,e.i,e.i?15:14),e.flags&=-2)}}finally{for(;ws<ci.length;ws++){const e=ci[ws];e&&(e.flags&=-2)}ws=0,ci.length=0,Kx(),Yd=!1,OR=null,(ci.length||pc.length)&&Xx()}}let Nr=null,qx=null;function Pp(t){const e=Nr;return Nr=t,qx=t&&t.type.__scopeId||null,e}function BF(t,e=Nr,n){if(!e||t._n)return t;const i=(...r)=>{i._d&&s_(-1);const s=Pp(e);let o;try{o=t(...r)}finally{Pp(s),i._d&&s_(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function Ua(t,e,n,i){const r=t.dirs,s=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(ka(),Ds(l,n,8,[t.el,a,t,e]),$a())}}const jF=Symbol("_vte"),UF=t=>t.__isTeleport;function IR(t,e){t.shapeFlag&6&&t.component?(t.transition=e,IR(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function YF(t,e){return Je(t)?Dn({name:t.name},e,{setup:t}):t}function Zx(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function Wb(t,e,n,i,r=!1){if(Ue(t)){t.forEach((m,p)=>Wb(m,e&&(Ue(e)?e[p]:e),n,i,r));return}if(gd(i)&&!r)return;const s=i.shapeFlag&4?LR(i.component):i.el,o=r?null:s,{i:a,r:l}=t,u=e&&e.r,c=a.refs===Nt?a.refs={}:a.refs,h=a.setupState,d=ct(h),f=h===Nt?()=>!1:m=>wt(d,m);if(u!=null&&u!==l&&(Pn(u)?(c[u]=null,f(u)&&(h[u]=null)):Nn(u)&&(u.value=null)),Je(l))Cf(l,a,12,[o,c]);else{const m=Pn(l),p=Nn(l);if(m||p){const y=()=>{if(t.f){const E=m?f(l)?h[l]:c[l]:l.value;r?Ue(E)&&gR(E,s):Ue(E)?E.includes(s)||E.push(s):m?(c[l]=[s],f(l)&&(h[l]=c[l])):(l.value=[s],t.k&&(c[t.k]=l.value))}else m?(c[l]=o,f(l)&&(h[l]=o)):p&&(l.value=o,t.k&&(c[t.k]=o))};o?(y.id=-1,Ii(y,n)):y()}}}const gd=t=>!!t.type.__asyncLoader,Jx=t=>t.type.__isKeepAlive;function zF(t,e){Qx(t,"a",e)}function GF(t,e){Qx(t,"da",e)}function Qx(t,e,n=Kn){const i=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(Hw(e,i,n),n){let r=n.parent;for(;r&&r.parent;)Jx(r.parent.vnode)&&KF(i,e,n,r),r=r.parent}}function KF(t,e,n,i){const r=Hw(e,t,i,!0);eA(()=>{gR(i[e],r)},n)}function Hw(t,e,n=Kn,i=!1){if(n){const r=n[t]||(n[t]=[]),s=e.__weh||(e.__weh=(...o)=>{ka();const a=yf(n),l=Ds(e,n,t,o);return a(),$a(),l});return i?r.unshift(s):r.push(s),s}}const Lo=t=>(e,n=Kn)=>{(!Lw||t==="sp")&&Hw(t,(...i)=>e(...i),n)},XF=Lo("bm"),qF=Lo("m"),ZF=Lo("bu"),JF=Lo("u"),QF=Lo("bum"),eA=Lo("um"),eV=Lo("sp"),tV=Lo("rtg"),nV=Lo("rtc");function iV(t,e=Kn){Hw("ec",t,e)}const rV=Symbol.for("v-ndc"),Bb=t=>t?bA(t)?LR(t):Bb(t.parent):null,md=Dn(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Bb(t.parent),$root:t=>Bb(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>xR(t),$forceUpdate:t=>t.f||(t.f=()=>{PR(t.update)}),$nextTick:t=>t.n||(t.n=zx.bind(t.proxy)),$watch:t=>TV.bind(t)}),tC=(t,e)=>t!==Nt&&!t.__isScriptSetup&&wt(t,e),sV={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:l}=t;let u;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return i[e];case 2:return r[e];case 4:return n[e];case 3:return s[e]}else{if(tC(i,e))return o[e]=1,i[e];if(r!==Nt&&wt(r,e))return o[e]=2,r[e];if((u=t.propsOptions[0])&&wt(u,e))return o[e]=3,s[e];if(n!==Nt&&wt(n,e))return o[e]=4,n[e];jb&&(o[e]=0)}}const c=md[e];let h,d;if(c)return e==="$attrs"&&qn(t.attrs,"get",""),c(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==Nt&&wt(n,e))return o[e]=4,n[e];if(d=l.config.globalProperties,wt(d,e))return d[e]},set({_:t},e,n){const{data:i,setupState:r,ctx:s}=t;return tC(r,e)?(r[e]=n,!0):i!==Nt&&wt(i,e)?(i[e]=n,!0):wt(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:i,appContext:r,propsOptions:s}},o){let a;return!!n[o]||t!==Nt&&wt(t,o)||tC(e,o)||(a=s[0])&&wt(a,o)||wt(i,o)||wt(md,o)||wt(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:wt(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function JM(t){return Ue(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let jb=!0;function oV(t){const e=xR(t),n=t.proxy,i=t.ctx;jb=!1,e.beforeCreate&&QM(e.beforeCreate,t,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:u,created:c,beforeMount:h,mounted:d,beforeUpdate:f,updated:m,activated:p,deactivated:y,beforeDestroy:E,beforeUnmount:T,destroyed:M,unmounted:P,render:H,renderTracked:U,renderTriggered:Y,errorCaptured:Q,serverPrefetch:q,expose:Z,inheritAttrs:te,components:ue,directives:ce,filters:Ee}=e;if(u&&aV(u,i,null),o)for(const be in o){const le=o[be];Je(le)&&(i[be]=le.bind(n))}if(r){const be=r.call(n,n);ln(be)&&(t.data=Lc(be))}if(jb=!0,s)for(const be in s){const le=s[be],ve=Je(le)?le.bind(n,n):Je(le.get)?le.get.bind(n,n):Hs,st=!Je(le)&&Je(le.set)?le.set.bind(n):Hs,g=Fi({get:ve,set:st});Object.defineProperty(i,be,{enumerable:!0,configurable:!0,get:()=>g.value,set:w=>g.value=w})}if(a)for(const be in a)tA(a[be],i,n,be);if(l){const be=Je(l)?l.call(n):l;Reflect.ownKeys(be).forEach(le=>{iA(le,be[le])})}c&&QM(c,t,"c");function Le(be,le){Ue(le)?le.forEach(ve=>be(ve.bind(n))):le&&be(le.bind(n))}if(Le(XF,h),Le(qF,d),Le(ZF,f),Le(JF,m),Le(zF,p),Le(GF,y),Le(iV,Q),Le(nV,U),Le(tV,Y),Le(QF,T),Le(eA,P),Le(eV,q),Ue(Z))if(Z.length){const be=t.exposed||(t.exposed={});Z.forEach(le=>{Object.defineProperty(be,le,{get:()=>n[le],set:ve=>n[le]=ve})})}else t.exposed||(t.exposed={});H&&t.render===Hs&&(t.render=H),te!=null&&(t.inheritAttrs=te),ue&&(t.components=ue),ce&&(t.directives=ce),q&&Zx(t)}function aV(t,e,n=Hs){Ue(t)&&(t=Ub(t));for(const i in t){const r=t[i];let s;ln(r)?"default"in r?s=pd(r.from||i,r.default,!0):s=pd(r.from||i):s=pd(r),Nn(s)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[i]=s}}function QM(t,e,n){Ds(Ue(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,n)}function tA(t,e,n,i){let r=i.includes(".")?mA(n,i):()=>n[i];if(Pn(t)){const s=e[t];Je(s)&&_o(r,s)}else if(Je(t))_o(r,t.bind(n));else if(ln(t))if(Ue(t))t.forEach(s=>tA(s,e,n,i));else{const s=Je(t.handler)?t.handler.bind(n):e[t.handler];Je(s)&&_o(r,s,t)}}function xR(t){const e=t.type,{mixins:n,extends:i}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=t.appContext,a=s.get(e);let l;return a?l=a:!r.length&&!n&&!i?l=e:(l={},r.length&&r.forEach(u=>Ip(l,u,o,!0)),Ip(l,e,o)),ln(e)&&s.set(e,l),l}function Ip(t,e,n,i=!1){const{mixins:r,extends:s}=e;s&&Ip(t,s,n,!0),r&&r.forEach(o=>Ip(t,o,n,!0));for(const o in e)if(!(i&&o==="expose")){const a=lV[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const lV={data:e_,props:t_,emits:t_,methods:id,computed:id,beforeCreate:ni,created:ni,beforeMount:ni,mounted:ni,beforeUpdate:ni,updated:ni,beforeDestroy:ni,beforeUnmount:ni,destroyed:ni,unmounted:ni,activated:ni,deactivated:ni,errorCaptured:ni,serverPrefetch:ni,components:id,directives:id,watch:cV,provide:e_,inject:uV};function e_(t,e){return e?t?function(){return Dn(Je(t)?t.call(this,this):t,Je(e)?e.call(this,this):e)}:e:t}function uV(t,e){return id(Ub(t),Ub(e))}function Ub(t){if(Ue(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function ni(t,e){return t?[...new Set([].concat(t,e))]:e}function id(t,e){return t?Dn(Object.create(null),t,e):e}function t_(t,e){return t?Ue(t)&&Ue(e)?[...new Set([...t,...e])]:Dn(Object.create(null),JM(t),JM(e??{})):e}function cV(t,e){if(!t)return e;if(!e)return t;const n=Dn(Object.create(null),t);for(const i in e)n[i]=ni(t[i],e[i]);return n}function nA(){return{app:null,config:{isNativeTag:W$,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let hV=0;function dV(t,e){return function(i,r=null){Je(i)||(i=Dn({},i)),r!=null&&!ln(r)&&(r=null);const s=nA(),o=new WeakSet,a=[];let l=!1;const u=s.app={_uid:hV++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:qV,get config(){return s.config},set config(c){},use(c,...h){return o.has(c)||(c&&Je(c.install)?(o.add(c),c.install(u,...h)):Je(c)&&(o.add(c),c(u,...h))),u},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),u},component(c,h){return h?(s.components[c]=h,u):s.components[c]},directive(c,h){return h?(s.directives[c]=h,u):s.directives[c]},mount(c,h,d){if(!l){const f=u._ceVNode||fn(i,r);return f.appContext=s,d===!0?d="svg":d===!1&&(d=void 0),h&&e?e(f,c):t(f,c,d),l=!0,u._container=c,c.__vue_app__=u,LR(f.component)}},onUnmount(c){a.push(c)},unmount(){l&&(Ds(a,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(c,h){return s.provides[c]=h,u},runWithContext(c){const h=wc;wc=u;try{return c()}finally{wc=h}}};return u}}let wc=null;function iA(t,e){if(Kn){let n=Kn.provides;const i=Kn.parent&&Kn.parent.provides;i===n&&(n=Kn.provides=Object.create(i)),n[t]=e}}function pd(t,e,n=!1){const i=Kn||Nr;if(i||wc){const r=wc?wc._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&t in r)return r[t];if(arguments.length>1)return n&&Je(e)?e.call(i&&i.proxy):e}}const rA={},sA=()=>Object.create(rA),oA=t=>Object.getPrototypeOf(t)===rA;function fV(t,e,n,i=!1){const r={},s=sA();t.propsDefaults=Object.create(null),aA(t,e,r,s);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=i?r:_F(r):t.type.props?t.props=r:t.props=s,t.attrs=s}function gV(t,e,n,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=t,a=ct(r),[l]=t.propsOptions;let u=!1;if((i||o>0)&&!(o&16)){if(o&8){const c=t.vnode.dynamicProps;for(let h=0;h<c.length;h++){let d=c[h];if(Nw(t.emitsOptions,d))continue;const f=e[d];if(l)if(wt(s,d))f!==s[d]&&(s[d]=f,u=!0);else{const m=Yl(d);r[m]=Yb(l,a,m,f,t,!1)}else f!==s[d]&&(s[d]=f,u=!0)}}}else{aA(t,e,r,s)&&(u=!0);let c;for(const h in a)(!e||!wt(e,h)&&((c=nu(h))===h||!wt(e,c)))&&(l?n&&(n[h]!==void 0||n[c]!==void 0)&&(r[h]=Yb(l,a,h,void 0,t,!0)):delete r[h]);if(s!==a)for(const h in s)(!e||!wt(e,h))&&(delete s[h],u=!0)}u&&Mo(t.attrs,"set","")}function aA(t,e,n,i){const[r,s]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(hd(l))continue;const u=e[l];let c;r&&wt(r,c=Yl(l))?!s||!s.includes(c)?n[c]=u:(a||(a={}))[c]=u:Nw(t.emitsOptions,l)||(!(l in i)||u!==i[l])&&(i[l]=u,o=!0)}if(s){const l=ct(n),u=a||Nt;for(let c=0;c<s.length;c++){const h=s[c];n[h]=Yb(r,l,h,u[h],t,!wt(u,h))}}return o}function Yb(t,e,n,i,r,s){const o=t[n];if(o!=null){const a=wt(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Je(l)){const{propsDefaults:u}=r;if(n in u)i=u[n];else{const c=yf(r);i=u[n]=l.call(null,e),c()}}else i=l;r.ce&&r.ce._setProp(n,i)}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===nu(n))&&(i=!0))}return i}const mV=new WeakMap;function lA(t,e,n=!1){const i=n?mV:e.propsCache,r=i.get(t);if(r)return r;const s=t.props,o={},a=[];let l=!1;if(!Je(t)){const c=h=>{l=!0;const[d,f]=lA(h,e,!0);Dn(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}if(!s&&!l)return ln(t)&&i.set(t,gc),gc;if(Ue(s))for(let c=0;c<s.length;c++){const h=Yl(s[c]);n_(h)&&(o[h]=Nt)}else if(s)for(const c in s){const h=Yl(c);if(n_(h)){const d=s[c],f=o[h]=Ue(d)||Je(d)?{type:d}:Dn({},d),m=f.type;let p=!1,y=!0;if(Ue(m))for(let E=0;E<m.length;++E){const T=m[E],M=Je(T)&&T.name;if(M==="Boolean"){p=!0;break}else M==="String"&&(y=!1)}else p=Je(m)&&m.name==="Boolean";f[0]=p,f[1]=y,(p||wt(f,"default"))&&a.push(h)}}const u=[o,a];return ln(t)&&i.set(t,u),u}function n_(t){return t[0]!=="$"&&!hd(t)}const uA=t=>t[0]==="_"||t==="$stable",AR=t=>Ue(t)?t.map(Ts):[Ts(t)],pV=(t,e,n)=>{if(e._n)return e;const i=BF((...r)=>AR(e(...r)),n);return i._c=!1,i},cA=(t,e,n)=>{const i=t._ctx;for(const r in t){if(uA(r))continue;const s=t[r];if(Je(s))e[r]=pV(r,s,i);else if(s!=null){const o=AR(s);e[r]=()=>o}}},hA=(t,e)=>{const n=AR(e);t.slots.default=()=>n},dA=(t,e,n)=>{for(const i in e)(n||i!=="_")&&(t[i]=e[i])},wV=(t,e,n)=>{const i=t.slots=sA();if(t.vnode.shapeFlag&32){const r=e._;r?(dA(i,e,n),n&&Ex(i,"_",r,!0)):cA(e,i)}else e&&hA(t,e)},vV=(t,e,n)=>{const{vnode:i,slots:r}=t;let s=!0,o=Nt;if(i.shapeFlag&32){const a=e._;a?n&&a===1?s=!1:dA(r,e,n):(s=!e.$stable,cA(e,r)),o=e}else e&&(hA(t,e),o={default:1});if(s)for(const a in r)!uA(a)&&o[a]==null&&delete r[a]},Ii=AV;function CV(t){return yV(t)}function yV(t,e){const n=Tx();n.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:u,setElementText:c,parentNode:h,nextSibling:d,setScopeId:f=Hs,insertStaticContent:m}=t,p=(O,S,W,K=null,G=null,z=null,J=void 0,v=null,C=!!S.dynamicChildren)=>{if(O===S)return;O&&!Jc(O,S)&&(K=X(O),w(O,G,z,!0),O=null),S.patchFlag===-2&&(C=!1,S.dynamicChildren=null);const{type:R,ref:N,shapeFlag:_}=S;switch(R){case Dw:y(O,S,W,K);break;case Gd:E(O,S,W,K);break;case rC:O==null&&T(S,W,K,J);break;case po:ue(O,S,W,K,G,z,J,v,C);break;default:_&1?H(O,S,W,K,G,z,J,v,C):_&6?ce(O,S,W,K,G,z,J,v,C):(_&64||_&128)&&R.process(O,S,W,K,G,z,J,v,C,me)}N!=null&&G&&Wb(N,O&&O.ref,z,S||O,!S)},y=(O,S,W,K)=>{if(O==null)i(S.el=a(S.children),W,K);else{const G=S.el=O.el;S.children!==O.children&&u(G,S.children)}},E=(O,S,W,K)=>{O==null?i(S.el=l(S.children||""),W,K):S.el=O.el},T=(O,S,W,K)=>{[O.el,O.anchor]=m(O.children,S,W,K,O.el,O.anchor)},M=({el:O,anchor:S},W,K)=>{let G;for(;O&&O!==S;)G=d(O),i(O,W,K),O=G;i(S,W,K)},P=({el:O,anchor:S})=>{let W;for(;O&&O!==S;)W=d(O),r(O),O=W;r(S)},H=(O,S,W,K,G,z,J,v,C)=>{S.type==="svg"?J="svg":S.type==="math"&&(J="mathml"),O==null?U(S,W,K,G,z,J,v,C):q(O,S,G,z,J,v,C)},U=(O,S,W,K,G,z,J,v)=>{let C,R;const{props:N,shapeFlag:_,transition:D,dirs:I}=O;if(C=O.el=o(O.type,z,N&&N.is,N),_&8?c(C,O.children):_&16&&Q(O.children,C,null,K,G,nC(O,z),J,v),I&&Ua(O,null,K,"created"),Y(C,O,O.scopeId,J,K),N){for(const F in N)F!=="value"&&!hd(F)&&s(C,F,null,N[F],z,K);"value"in N&&s(C,"value",null,N.value,z),(R=N.onVnodeBeforeMount)&&Xr(R,K,O)}I&&Ua(O,null,K,"beforeMount");const x=bV(G,D);x&&D.beforeEnter(C),i(C,S,W),((R=N&&N.onVnodeMounted)||x||I)&&Ii(()=>{R&&Xr(R,K,O),x&&D.enter(C),I&&Ua(O,null,K,"mounted")},G)},Y=(O,S,W,K,G)=>{if(W&&f(O,W),K)for(let z=0;z<K.length;z++)f(O,K[z]);if(G){let z=G.subTree;if(S===z||wA(z.type)&&(z.ssContent===S||z.ssFallback===S)){const J=G.vnode;Y(O,J,J.scopeId,J.slotScopeIds,G.parent)}}},Q=(O,S,W,K,G,z,J,v,C=0)=>{for(let R=C;R<O.length;R++){const N=O[R]=v?aa(O[R]):Ts(O[R]);p(null,N,S,W,K,G,z,J,v)}},q=(O,S,W,K,G,z,J)=>{const v=S.el=O.el;let{patchFlag:C,dynamicChildren:R,dirs:N}=S;C|=O.patchFlag&16;const _=O.props||Nt,D=S.props||Nt;let I;if(W&&Ya(W,!1),(I=D.onVnodeBeforeUpdate)&&Xr(I,W,S,O),N&&Ua(S,O,W,"beforeUpdate"),W&&Ya(W,!0),(_.innerHTML&&D.innerHTML==null||_.textContent&&D.textContent==null)&&c(v,""),R?Z(O.dynamicChildren,R,v,W,K,nC(S,G),z):J||le(O,S,v,null,W,K,nC(S,G),z,!1),C>0){if(C&16)te(v,_,D,W,G);else if(C&2&&_.class!==D.class&&s(v,"class",null,D.class,G),C&4&&s(v,"style",_.style,D.style,G),C&8){const x=S.dynamicProps;for(let F=0;F<x.length;F++){const $=x[F],j=_[$],re=D[$];(re!==j||$==="value")&&s(v,$,j,re,G,W)}}C&1&&O.children!==S.children&&c(v,S.children)}else!J&&R==null&&te(v,_,D,W,G);((I=D.onVnodeUpdated)||N)&&Ii(()=>{I&&Xr(I,W,S,O),N&&Ua(S,O,W,"updated")},K)},Z=(O,S,W,K,G,z,J)=>{for(let v=0;v<S.length;v++){const C=O[v],R=S[v],N=C.el&&(C.type===po||!Jc(C,R)||C.shapeFlag&70)?h(C.el):W;p(C,R,N,null,K,G,z,J,!0)}},te=(O,S,W,K,G)=>{if(S!==W){if(S!==Nt)for(const z in S)!hd(z)&&!(z in W)&&s(O,z,S[z],null,G,K);for(const z in W){if(hd(z))continue;const J=W[z],v=S[z];J!==v&&z!=="value"&&s(O,z,v,J,G,K)}"value"in W&&s(O,"value",S.value,W.value,G)}},ue=(O,S,W,K,G,z,J,v,C)=>{const R=S.el=O?O.el:a(""),N=S.anchor=O?O.anchor:a("");let{patchFlag:_,dynamicChildren:D,slotScopeIds:I}=S;I&&(v=v?v.concat(I):I),O==null?(i(R,W,K),i(N,W,K),Q(S.children||[],W,N,G,z,J,v,C)):_>0&&_&64&&D&&O.dynamicChildren?(Z(O.dynamicChildren,D,W,G,z,J,v),(S.key!=null||G&&S===G.subTree)&&fA(O,S,!0)):le(O,S,W,N,G,z,J,v,C)},ce=(O,S,W,K,G,z,J,v,C)=>{S.slotScopeIds=v,O==null?S.shapeFlag&512?G.ctx.activate(S,W,K,J,C):Ee(S,W,K,G,z,J,C):He(O,S,C)},Ee=(O,S,W,K,G,z,J)=>{const v=O.component=BV(O,K,G);if(Jx(O)&&(v.ctx.renderer=me),UV(v,!1,J),v.asyncDep){if(G&&G.registerDep(v,Le,J),!O.el){const C=v.subTree=fn(Gd);E(null,C,S,W)}}else Le(v,O,S,W,G,z,J)},He=(O,S,W)=>{const K=S.component=O.component;if(IV(O,S,W))if(K.asyncDep&&!K.asyncResolved){be(K,S,W);return}else K.next=S,K.update();else S.el=O.el,K.vnode=S},Le=(O,S,W,K,G,z,J)=>{const v=()=>{if(O.isMounted){let{next:_,bu:D,u:I,parent:x,vnode:F}=O;{const Ce=gA(O);if(Ce){_&&(_.el=F.el,be(O,_,J)),Ce.asyncDep.then(()=>{O.isUnmounted||v()});return}}let $=_,j;Ya(O,!1),_?(_.el=F.el,be(O,_,J)):_=F,D&&Zv(D),(j=_.props&&_.props.onVnodeBeforeUpdate)&&Xr(j,x,_,F),Ya(O,!0);const re=iC(O),he=O.subTree;O.subTree=re,p(he,re,h(he.el),X(he),O,G,z),_.el=re.el,$===null&&xV(O,re.el),I&&Ii(I,G),(j=_.props&&_.props.onVnodeUpdated)&&Ii(()=>Xr(j,x,_,F),G)}else{let _;const{el:D,props:I}=S,{bm:x,m:F,parent:$,root:j,type:re}=O,he=gd(S);if(Ya(O,!1),x&&Zv(x),!he&&(_=I&&I.onVnodeBeforeMount)&&Xr(_,$,S),Ya(O,!0),D&&ke){const Ce=()=>{O.subTree=iC(O),ke(D,O.subTree,O,G,null)};he&&re.__asyncHydrate?re.__asyncHydrate(D,O,Ce):Ce()}else{j.ce&&j.ce._injectChildStyle(re);const Ce=O.subTree=iC(O);p(null,Ce,W,K,O,G,z),S.el=Ce.el}if(F&&Ii(F,G),!he&&(_=I&&I.onVnodeMounted)){const Ce=S;Ii(()=>Xr(_,$,Ce),G)}(S.shapeFlag&256||$&&gd($.vnode)&&$.vnode.shapeFlag&256)&&O.a&&Ii(O.a,G),O.isMounted=!0,S=W=K=null}};O.scope.on();const C=O.effect=new Ox(v);O.scope.off();const R=O.update=C.run.bind(C),N=O.job=C.runIfDirty.bind(C);N.i=O,N.id=O.uid,C.scheduler=()=>PR(N),Ya(O,!0),R()},be=(O,S,W)=>{S.component=O;const K=O.vnode.props;O.vnode=S,O.next=null,gV(O,S.props,K,W),vV(O,S.children,W),ka(),ZM(O),$a()},le=(O,S,W,K,G,z,J,v,C=!1)=>{const R=O&&O.children,N=O?O.shapeFlag:0,_=S.children,{patchFlag:D,shapeFlag:I}=S;if(D>0){if(D&128){st(R,_,W,K,G,z,J,v,C);return}else if(D&256){ve(R,_,W,K,G,z,J,v,C);return}}I&8?(N&16&&B(R,G,z),_!==R&&c(W,_)):N&16?I&16?st(R,_,W,K,G,z,J,v,C):B(R,G,z,!0):(N&8&&c(W,""),I&16&&Q(_,W,K,G,z,J,v,C))},ve=(O,S,W,K,G,z,J,v,C)=>{O=O||gc,S=S||gc;const R=O.length,N=S.length,_=Math.min(R,N);let D;for(D=0;D<_;D++){const I=S[D]=C?aa(S[D]):Ts(S[D]);p(O[D],I,W,null,G,z,J,v,C)}R>N?B(O,G,z,!0,!1,_):Q(S,W,K,G,z,J,v,C,_)},st=(O,S,W,K,G,z,J,v,C)=>{let R=0;const N=S.length;let _=O.length-1,D=N-1;for(;R<=_&&R<=D;){const I=O[R],x=S[R]=C?aa(S[R]):Ts(S[R]);if(Jc(I,x))p(I,x,W,null,G,z,J,v,C);else break;R++}for(;R<=_&&R<=D;){const I=O[_],x=S[D]=C?aa(S[D]):Ts(S[D]);if(Jc(I,x))p(I,x,W,null,G,z,J,v,C);else break;_--,D--}if(R>_){if(R<=D){const I=D+1,x=I<N?S[I].el:K;for(;R<=D;)p(null,S[R]=C?aa(S[R]):Ts(S[R]),W,x,G,z,J,v,C),R++}}else if(R>D)for(;R<=_;)w(O[R],G,z,!0),R++;else{const I=R,x=R,F=new Map;for(R=x;R<=D;R++){const Ne=S[R]=C?aa(S[R]):Ts(S[R]);Ne.key!=null&&F.set(Ne.key,R)}let $,j=0;const re=D-x+1;let he=!1,Ce=0;const $e=new Array(re);for(R=0;R<re;R++)$e[R]=0;for(R=I;R<=_;R++){const Ne=O[R];if(j>=re){w(Ne,G,z,!0);continue}let Oe;if(Ne.key!=null)Oe=F.get(Ne.key);else for($=x;$<=D;$++)if($e[$-x]===0&&Jc(Ne,S[$])){Oe=$;break}Oe===void 0?w(Ne,G,z,!0):($e[Oe-x]=R+1,Oe>=Ce?Ce=Oe:he=!0,p(Ne,S[Oe],W,null,G,z,J,v,C),j++)}const Qe=he?SV($e):gc;for($=Qe.length-1,R=re-1;R>=0;R--){const Ne=x+R,Oe=S[Ne],nt=Ne+1<N?S[Ne+1].el:K;$e[R]===0?p(null,Oe,W,nt,G,z,J,v,C):he&&($<0||R!==Qe[$]?g(Oe,W,nt,2):$--)}}},g=(O,S,W,K,G=null)=>{const{el:z,type:J,transition:v,children:C,shapeFlag:R}=O;if(R&6){g(O.component.subTree,S,W,K);return}if(R&128){O.suspense.move(S,W,K);return}if(R&64){J.move(O,S,W,me);return}if(J===po){i(z,S,W);for(let _=0;_<C.length;_++)g(C[_],S,W,K);i(O.anchor,S,W);return}if(J===rC){M(O,S,W);return}if(K!==2&&R&1&&v)if(K===0)v.beforeEnter(z),i(z,S,W),Ii(()=>v.enter(z),G);else{const{leave:_,delayLeave:D,afterLeave:I}=v,x=()=>i(z,S,W),F=()=>{_(z,()=>{x(),I&&I()})};D?D(z,x,F):F()}else i(z,S,W)},w=(O,S,W,K=!1,G=!1)=>{const{type:z,props:J,ref:v,children:C,dynamicChildren:R,shapeFlag:N,patchFlag:_,dirs:D,cacheIndex:I}=O;if(_===-2&&(G=!1),v!=null&&Wb(v,null,W,O,!0),I!=null&&(S.renderCache[I]=void 0),N&256){S.ctx.deactivate(O);return}const x=N&1&&D,F=!gd(O);let $;if(F&&($=J&&J.onVnodeBeforeUnmount)&&Xr($,S,O),N&6)k(O.component,W,K);else{if(N&128){O.suspense.unmount(W,K);return}x&&Ua(O,null,S,"beforeUnmount"),N&64?O.type.remove(O,S,W,me,K):R&&!R.hasOnce&&(z!==po||_>0&&_&64)?B(R,S,W,!1,!0):(z===po&&_&384||!G&&N&16)&&B(C,S,W),K&&b(O)}(F&&($=J&&J.onVnodeUnmounted)||x)&&Ii(()=>{$&&Xr($,S,O),x&&Ua(O,null,S,"unmounted")},W)},b=O=>{const{type:S,el:W,anchor:K,transition:G}=O;if(S===po){L(W,K);return}if(S===rC){P(O);return}const z=()=>{r(W),G&&!G.persisted&&G.afterLeave&&G.afterLeave()};if(O.shapeFlag&1&&G&&!G.persisted){const{leave:J,delayLeave:v}=G,C=()=>J(W,z);v?v(O.el,z,C):C()}else z()},L=(O,S)=>{let W;for(;O!==S;)W=d(O),r(O),O=W;r(S)},k=(O,S,W)=>{const{bum:K,scope:G,job:z,subTree:J,um:v,m:C,a:R}=O;i_(C),i_(R),K&&Zv(K),G.stop(),z&&(z.flags|=8,w(J,O,S,W)),v&&Ii(v,S),Ii(()=>{O.isUnmounted=!0},S),S&&S.pendingBranch&&!S.isUnmounted&&O.asyncDep&&!O.asyncResolved&&O.suspenseId===S.pendingId&&(S.deps--,S.deps===0&&S.resolve())},B=(O,S,W,K=!1,G=!1,z=0)=>{for(let J=z;J<O.length;J++)w(O[J],S,W,K,G)},X=O=>{if(O.shapeFlag&6)return X(O.component.subTree);if(O.shapeFlag&128)return O.suspense.next();const S=d(O.anchor||O.el),W=S&&S[jF];return W?d(W):S};let ee=!1;const ge=(O,S,W)=>{O==null?S._vnode&&w(S._vnode,null,null,!0):p(S._vnode||null,O,S,null,null,null,W),S._vnode=O,ee||(ee=!0,ZM(),Kx(),ee=!1)},me={p,um:w,m:g,r:b,mt:Ee,mc:Q,pc:le,pbc:Z,n:X,o:t};let se,ke;return{render:ge,hydrate:se,createApp:dV(ge,se)}}function nC({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Ya({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function bV(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function fA(t,e,n=!1){const i=t.children,r=e.children;if(Ue(i)&&Ue(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=aa(r[s]),a.el=o.el),!n&&a.patchFlag!==-2&&fA(o,a)),a.type===Dw&&(a.el=o.el)}}function SV(t){const e=t.slice(),n=[0];let i,r,s,o,a;const l=t.length;for(i=0;i<l;i++){const u=t[i];if(u!==0){if(r=n[n.length-1],t[r]<u){e[i]=r,n.push(i);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,t[n[a]]<u?s=a+1:o=a;u<t[n[s]]&&(s>0&&(e[i]=n[s-1]),n[s]=i)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=e[o];return n}function gA(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:gA(e)}function i_(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const RV=Symbol.for("v-scx"),EV=()=>pd(RV);function HR(t,e){return NR(t,null,e)}function _o(t,e,n){return NR(t,e,n)}function NR(t,e,n=Nt){const{immediate:i,deep:r,flush:s,once:o}=n,a=Dn({},n);let l;if(Lw)if(s==="sync"){const d=EV();l=d.__watcherHandles||(d.__watcherHandles=[])}else if(!e||i)a.once=!0;else{const d=()=>{};return d.stop=Hs,d.resume=Hs,d.pause=Hs,d}const u=Kn;a.call=(d,f,m)=>Ds(d,u,f,m);let c=!1;s==="post"?a.scheduler=d=>{Ii(d,u&&u.suspense)}:s!=="sync"&&(c=!0,a.scheduler=(d,f)=>{f?d():PR(d)}),a.augmentJob=d=>{e&&(d.flags|=4),c&&(d.flags|=2,u&&(d.id=u.uid,d.i=u))};const h=$F(t,e,a);return l&&l.push(h),h}function TV(t,e,n){const i=this.proxy,r=Pn(t)?t.includes(".")?mA(i,t):()=>i[t]:t.bind(i,i);let s;Je(e)?s=e:(s=e.handler,n=e);const o=yf(this),a=NR(r,s.bind(i),n);return o(),a}function mA(t,e){const n=e.split(".");return()=>{let i=t;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}const MV=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Yl(e)}Modifiers`]||t[`${nu(e)}Modifiers`];function _V(t,e,...n){if(t.isUnmounted)return;const i=t.vnode.props||Nt;let r=n;const s=e.startsWith("update:"),o=s&&MV(i,e.slice(7));o&&(o.trim&&(r=n.map(c=>Pn(c)?c.trim():c)),o.number&&(r=n.map(X$)));let a,l=i[a=qv(e)]||i[a=qv(Yl(e))];!l&&s&&(l=i[a=qv(nu(e))]),l&&Ds(l,t,6,r);const u=i[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Ds(u,t,6,r)}}function pA(t,e,n=!1){const i=e.emitsCache,r=i.get(t);if(r!==void 0)return r;const s=t.emits;let o={},a=!1;if(!Je(t)){const l=u=>{const c=pA(u,e,!0);c&&(a=!0,Dn(o,c))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!s&&!a?(ln(t)&&i.set(t,null),null):(Ue(s)?s.forEach(l=>o[l]=null):Dn(o,s),ln(t)&&i.set(t,o),o)}function Nw(t,e){return!t||!Ow(e)?!1:(e=e.slice(2).replace(/Once$/,""),wt(t,e[0].toLowerCase()+e.slice(1))||wt(t,nu(e))||wt(t,e))}function iC(t){const{type:e,vnode:n,proxy:i,withProxy:r,propsOptions:[s],slots:o,attrs:a,emit:l,render:u,renderCache:c,props:h,data:d,setupState:f,ctx:m,inheritAttrs:p}=t,y=Pp(t);let E,T;try{if(n.shapeFlag&4){const P=r||i,H=P;E=Ts(u.call(H,P,c,h,f,d,m)),T=a}else{const P=e;E=Ts(P.length>1?P(h,{attrs:a,slots:o,emit:l}):P(h,null)),T=e.props?a:OV(a)}}catch(P){wd.length=0,Aw(P,t,1),E=fn(Gd)}let M=E;if(T&&p!==!1){const P=Object.keys(T),{shapeFlag:H}=M;P.length&&H&7&&(s&&P.some(fR)&&(T=PV(T,s)),M=Oc(M,T,!1,!0))}return n.dirs&&(M=Oc(M,null,!1,!0),M.dirs=M.dirs?M.dirs.concat(n.dirs):n.dirs),n.transition&&IR(M,n.transition),E=M,Pp(y),E}const OV=t=>{let e;for(const n in t)(n==="class"||n==="style"||Ow(n))&&((e||(e={}))[n]=t[n]);return e},PV=(t,e)=>{const n={};for(const i in t)(!fR(i)||!(i.slice(9)in e))&&(n[i]=t[i]);return n};function IV(t,e,n){const{props:i,children:r,component:s}=t,{props:o,children:a,patchFlag:l}=e,u=s.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?r_(i,o,u):!!o;if(l&8){const c=e.dynamicProps;for(let h=0;h<c.length;h++){const d=c[h];if(o[d]!==i[d]&&!Nw(u,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?r_(i,o,u):!0:!!o;return!1}function r_(t,e,n){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(e[s]!==t[s]&&!Nw(n,s))return!0}return!1}function xV({vnode:t,parent:e},n){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===t&&(i.el=t.el),i===t)(t=e.vnode).el=n,e=e.parent;else break}}const wA=t=>t.__isSuspense;function AV(t,e){e&&e.pendingBranch?Ue(t)?e.effects.push(...t):e.effects.push(t):WF(t)}const po=Symbol.for("v-fgt"),Dw=Symbol.for("v-txt"),Gd=Symbol.for("v-cmt"),rC=Symbol.for("v-stc"),wd=[];let Vi=null;function HV(t=!1){wd.push(Vi=t?null:[])}function NV(){wd.pop(),Vi=wd[wd.length-1]||null}let Kd=1;function s_(t){Kd+=t,t<0&&Vi&&(Vi.hasOnce=!0)}function DV(t){return t.dynamicChildren=Kd>0?Vi||gc:null,NV(),Kd>0&&Vi&&Vi.push(t),t}function LV(t,e,n,i,r,s){return DV(CA(t,e,n,i,r,s,!0))}function zb(t){return t?t.__v_isVNode===!0:!1}function Jc(t,e){return t.type===e.type&&t.key===e.key}const vA=({key:t})=>t??null,qm=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Pn(t)||Nn(t)||Je(t)?{i:Nr,r:t,k:e,f:!!n}:t:null);function CA(t,e=null,n=null,i=0,r=null,s=t===po?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&vA(e),ref:e&&qm(e),scopeId:qx,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Nr};return a?(DR(l,n),s&128&&t.normalize(l)):n&&(l.shapeFlag|=Pn(n)?8:16),Kd>0&&!o&&Vi&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Vi.push(l),l}const fn=kV;function kV(t,e=null,n=null,i=0,r=null,s=!1){if((!t||t===rV)&&(t=Gd),zb(t)){const a=Oc(t,e,!0);return n&&DR(a,n),Kd>0&&!s&&Vi&&(a.shapeFlag&6?Vi[Vi.indexOf(t)]=a:Vi.push(a)),a.patchFlag=-2,a}if(KV(t)&&(t=t.__vccOpts),e){e=$V(e);let{class:a,style:l}=e;a&&!Pn(a)&&(e.class=wR(a)),ln(l)&&(MR(l)&&!Ue(l)&&(l=Dn({},l)),e.style=pR(l))}const o=Pn(t)?1:wA(t)?128:UF(t)?64:ln(t)?4:Je(t)?2:0;return CA(t,e,n,i,r,o,s,!0)}function $V(t){return t?MR(t)||oA(t)?Dn({},t):t:null}function Oc(t,e,n=!1,i=!1){const{props:r,ref:s,patchFlag:o,children:a,transition:l}=t,u=e?yA(r||{},e):r,c={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&vA(u),ref:e&&e.ref?n&&s?Ue(s)?s.concat(qm(e)):[s,qm(e)]:qm(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==po?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Oc(t.ssContent),ssFallback:t.ssFallback&&Oc(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&i&&IR(c,l.clone(c)),c}function FV(t=" ",e=0){return fn(Dw,null,t,e)}function Ts(t){return t==null||typeof t=="boolean"?fn(Gd):Ue(t)?fn(po,null,t.slice()):typeof t=="object"?aa(t):fn(Dw,null,String(t))}function aa(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Oc(t)}function DR(t,e){let n=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(Ue(e))n=16;else if(typeof e=="object")if(i&65){const r=e.default;r&&(r._c&&(r._d=!1),DR(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!oA(e)?e._ctx=Nr:r===3&&Nr&&(Nr.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Je(e)?(e={default:e,_ctx:Nr},n=32):(e=String(e),i&64?(n=16,e=[FV(e)]):n=8);t.children=e,t.shapeFlag|=n}function yA(...t){const e={};for(let n=0;n<t.length;n++){const i=t[n];for(const r in i)if(r==="class")e.class!==i.class&&(e.class=wR([e.class,i.class]));else if(r==="style")e.style=pR([e.style,i.style]);else if(Ow(r)){const s=e[r],o=i[r];o&&s!==o&&!(Ue(s)&&s.includes(o))&&(e[r]=s?[].concat(s,o):o)}else r!==""&&(e[r]=i[r])}return e}function Xr(t,e,n,i=null){Ds(t,e,7,[n,i])}const VV=nA();let WV=0;function BV(t,e,n){const i=t.type,r=(e?e.appContext:t.appContext)||VV,s={uid:WV++,vnode:t,type:i,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new _x(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:lA(i,r),emitsOptions:pA(i,r),emit:null,emitted:null,propsDefaults:Nt,inheritAttrs:i.inheritAttrs,ctx:Nt,data:Nt,props:Nt,attrs:Nt,slots:Nt,refs:Nt,setupState:Nt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=_V.bind(null,s),t.ce&&t.ce(s),s}let Kn=null;const jV=()=>Kn||Nr;let xp,Gb;{const t=Tx(),e=(n,i)=>{let r;return(r=t[n])||(r=t[n]=[]),r.push(i),s=>{r.length>1?r.forEach(o=>o(s)):r[0](s)}};xp=e("__VUE_INSTANCE_SETTERS__",n=>Kn=n),Gb=e("__VUE_SSR_SETTERS__",n=>Lw=n)}const yf=t=>{const e=Kn;return xp(t),t.scope.on(),()=>{t.scope.off(),xp(e)}},o_=()=>{Kn&&Kn.scope.off(),xp(null)};function bA(t){return t.vnode.shapeFlag&4}let Lw=!1;function UV(t,e=!1,n=!1){e&&Gb(e);const{props:i,children:r}=t.vnode,s=bA(t);fV(t,i,s,e),wV(t,r,n);const o=s?YV(t,e):void 0;return e&&Gb(!1),o}function YV(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,sV);const{setup:i}=n;if(i){const r=t.setupContext=i.length>1?GV(t):null,s=yf(t);ka();const o=Cf(i,t,0,[t.props,r]);if($a(),s(),Sx(o)){if(gd(t)||Zx(t),o.then(o_,o_),e)return o.then(a=>{a_(t,a,e)}).catch(a=>{Aw(a,t,0)});t.asyncDep=o}else a_(t,o,e)}else SA(t,e)}function a_(t,e,n){Je(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:ln(e)&&(t.setupState=Ux(e)),SA(t,n)}let l_;function SA(t,e,n){const i=t.type;if(!t.render){if(!e&&l_&&!i.render){const r=i.template||xR(t).template;if(r){const{isCustomElement:s,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:l}=i,u=Dn(Dn({isCustomElement:s,delimiters:a},o),l);i.render=l_(r,u)}}t.render=i.render||Hs}{const r=yf(t);ka();try{oV(t)}finally{$a(),r()}}}const zV={get(t,e){return qn(t,"get",""),t[e]}};function GV(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,zV),slots:t.slots,emit:t.emit,expose:e}}function LR(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Ux(OF(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in md)return md[n](t)},has(e,n){return n in e||n in md}})):t.proxy}function KV(t){return Je(t)&&"__vccOpts"in t}const Fi=(t,e)=>LF(t,e,Lw);function XV(t,e,n){const i=arguments.length;return i===2?ln(e)&&!Ue(e)?zb(e)?fn(t,null,[e]):fn(t,e):fn(t,null,e):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&zb(n)&&(n=[n]),fn(t,e,n))}const qV="3.5.6";/**
* @vue/runtime-dom v3.5.6
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Kb;const u_=typeof window<"u"&&window.trustedTypes;if(u_)try{Kb=u_.createPolicy("vue",{createHTML:t=>t})}catch{}const RA=Kb?t=>Kb.createHTML(t):t=>t,ZV="http://www.w3.org/2000/svg",JV="http://www.w3.org/1998/Math/MathML",uo=typeof document<"u"?document:null,c_=uo&&uo.createElement("template"),QV={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,i)=>{const r=e==="svg"?uo.createElementNS(ZV,t):e==="mathml"?uo.createElementNS(JV,t):n?uo.createElement(t,{is:n}):uo.createElement(t);return t==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:t=>uo.createTextNode(t),createComment:t=>uo.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>uo.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,i,r,s){const o=n?n.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===s||!(r=r.nextSibling)););else{c_.innerHTML=RA(i==="svg"?`<svg>${t}</svg>`:i==="mathml"?`<math>${t}</math>`:t);const a=c_.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},eW=Symbol("_vtc");function tW(t,e,n){const i=t[eW];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const h_=Symbol("_vod"),nW=Symbol("_vsh"),iW=Symbol(""),rW=/(^|;)\s*display\s*:/;function sW(t,e,n){const i=t.style,r=Pn(n);let s=!1;if(n&&!r){if(e)if(Pn(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&Zm(i,a,"")}else for(const o in e)n[o]==null&&Zm(i,o,"");for(const o in n)o==="display"&&(s=!0),Zm(i,o,n[o])}else if(r){if(e!==n){const o=i[iW];o&&(n+=";"+o),i.cssText=n,s=rW.test(n)}}else e&&t.removeAttribute("style");h_ in t&&(t[h_]=s?i.display:"",t[nW]&&(i.display="none"))}const d_=/\s*!important$/;function Zm(t,e,n){if(Ue(n))n.forEach(i=>Zm(t,e,i));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=oW(t,e);d_.test(n)?t.setProperty(nu(i),n.replace(d_,""),"important"):t[i]=n}}const f_=["Webkit","Moz","ms"],sC={};function oW(t,e){const n=sC[e];if(n)return n;let i=Yl(e);if(i!=="filter"&&i in t)return sC[e]=i;i=Rx(i);for(let r=0;r<f_.length;r++){const s=f_[r]+i;if(s in t)return sC[e]=s}return e}const g_="http://www.w3.org/1999/xlink";function m_(t,e,n,i,r,s=tF(e)){i&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(g_,e.slice(6,e.length)):t.setAttributeNS(g_,e,n):n==null||s&&!Mx(n)?t.removeAttribute(e):t.setAttribute(e,s?"":Dc(n)?String(n):n)}function aW(t,e,n,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?RA(n):n);return}const r=t.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const o=r==="OPTION"?t.getAttribute("value")||"":t.value,a=n==null?t.type==="checkbox"?"on":"":String(n);(o!==a||!("_value"in t))&&(t.value=a),n==null&&t.removeAttribute(e),t._value=n;return}let s=!1;if(n===""||n==null){const o=typeof t[e];o==="boolean"?n=Mx(n):n==null&&o==="string"?(n="",s=!0):o==="number"&&(n=0,s=!0)}try{t[e]=n}catch{}s&&t.removeAttribute(e)}function lW(t,e,n,i){t.addEventListener(e,n,i)}function uW(t,e,n,i){t.removeEventListener(e,n,i)}const p_=Symbol("_vei");function cW(t,e,n,i,r=null){const s=t[p_]||(t[p_]={}),o=s[e];if(i&&o)o.value=i;else{const[a,l]=hW(e);if(i){const u=s[e]=gW(i,r);lW(t,a,u,l)}else o&&(uW(t,a,o,l),s[e]=void 0)}}const w_=/(?:Once|Passive|Capture)$/;function hW(t){let e;if(w_.test(t)){e={};let i;for(;i=t.match(w_);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):nu(t.slice(2)),e]}let oC=0;const dW=Promise.resolve(),fW=()=>oC||(dW.then(()=>oC=0),oC=Date.now());function gW(t,e){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;Ds(mW(i,n.value),e,5,[i])};return n.value=t,n.attached=fW(),n}function mW(t,e){if(Ue(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(i=>r=>!r._stopped&&i&&i(r))}else return e}const v_=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,pW=(t,e,n,i,r,s)=>{const o=r==="svg";e==="class"?tW(t,i,o):e==="style"?sW(t,n,i):Ow(e)?fR(e)||cW(t,e,n,i,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):wW(t,e,i,o))?(aW(t,e,i),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&m_(t,e,i,o,s,e!=="value")):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),m_(t,e,i,o))};function wW(t,e,n,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in t&&v_(e)&&Je(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return v_(e)&&Pn(n)?!1:!!(e in t||t._isVueCE&&(/[A-Z]/.test(e)||!Pn(n)))}const vW=Dn({patchProp:pW},QV);let C_;function CW(){return C_||(C_=CV(vW))}const yW=(...t)=>{const e=CW().createApp(...t),{mount:n}=e;return e.mount=i=>{const r=SW(i);if(!r)return;const s=e._component;!Je(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=n(r,!1,bW(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function bW(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function SW(t){return Pn(t)?document.querySelector(t):t}function RW(t,e){let n;function i(){n=nF(),n.run(()=>e.length?e(()=>{n==null||n.stop(),i()}):e())}_o(t,r=>{r&&!n?i():r||(n==null||n.stop(),n=void 0)},{immediate:!0}),rF(()=>{n==null||n.stop()})}const Is=typeof window<"u",EW=Is&&("ontouchstart"in window||window.navigator.maxTouchPoints>0);function TW(t,e,n){const i=e.length-1;if(i<0)return t===void 0?n:t;for(let r=0;r<i;r++){if(t==null)return n;t=t[e[r]]}return t==null||t[e[i]]===void 0?n:t[e[i]]}function y_(t,e,n){return t==null||!e||typeof e!="string"?n:t[e]!==void 0?t[e]:(e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,""),TW(t,e.split("."),n))}function EA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:t},(n,i)=>e+i)}function b_(t){let e;return t!==null&&typeof t=="object"&&((e=Object.getPrototypeOf(t))===Object.prototype||e===null)}function aC(t,e){return e.every(n=>t.hasOwnProperty(n))}function MW(t,e){const n={},i=new Set(Object.keys(t));for(const r of e)i.has(r)&&(n[r]=t[r]);return n}function _W(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(e,Math.min(n,t))}function S_(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return t+n.repeat(Math.max(0,e-t.length))}function R_(t,e){return(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0").repeat(Math.max(0,e-t.length))+t}function OW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const n=[];let i=0;for(;i<t.length;)n.push(t.substr(i,e)),i+=e;return n}function Io(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const i={};for(const r in t)i[r]=t[r];for(const r in e){const s=t[r],o=e[r];if(b_(s)&&b_(o)){i[r]=Io(s,o,n);continue}if(n&&Array.isArray(s)&&Array.isArray(o)){i[r]=n(s,o);continue}i[r]=o}return i}function vc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(vc.cache.has(t))return vc.cache.get(t);const e=t.replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase();return vc.cache.set(t,e),e}vc.cache=new Map;const pu=2.4,E_=.2126729,T_=.7151522,M_=.072175,PW=.55,IW=.58,xW=.57,AW=.62,ag=.03,__=1.45,HW=5e-4,NW=1.25,DW=1.25,O_=.078,P_=12.82051282051282,lg=.06,I_=.001;function x_(t,e){const n=(t.r/255)**pu,i=(t.g/255)**pu,r=(t.b/255)**pu,s=(e.r/255)**pu,o=(e.g/255)**pu,a=(e.b/255)**pu;let l=n*E_+i*T_+r*M_,u=s*E_+o*T_+a*M_;if(l<=ag&&(l+=(ag-l)**__),u<=ag&&(u+=(ag-u)**__),Math.abs(u-l)<HW)return 0;let c;if(u>l){const h=(u**PW-l**IW)*NW;c=h<I_?0:h<O_?h-h*P_*lg:h-lg}else{const h=(u**AW-l**xW)*DW;c=h>-I_?0:h>-O_?h-h*P_*lg:h+lg}return c*100}const Ap=.20689655172413793,LW=t=>t>Ap**3?Math.cbrt(t):t/(3*Ap**2)+4/29,kW=t=>t>Ap?t**3:3*Ap**2*(t-4/29);function TA(t){const e=LW,n=e(t[1]);return[116*n-16,500*(e(t[0]/.95047)-n),200*(n-e(t[2]/1.08883))]}function MA(t){const e=kW,n=(t[0]+16)/116;return[e(n+t[1]/500)*.95047,e(n),e(n-t[2]/200)*1.08883]}const $W=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],FW=t=>t<=.0031308?t*12.92:1.055*t**(1/2.4)-.055,VW=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],WW=t=>t<=.04045?t/12.92:((t+.055)/1.055)**2.4;function _A(t){const e=Array(3),n=FW,i=$W;for(let r=0;r<3;++r)e[r]=Math.round(_W(n(i[r][0]*t[0]+i[r][1]*t[1]+i[r][2]*t[2]))*255);return{r:e[0],g:e[1],b:e[2]}}function kR(t){let{r:e,g:n,b:i}=t;const r=[0,0,0],s=WW,o=VW;e=s(e/255),n=s(n/255),i=s(i/255);for(let a=0;a<3;++a)r[a]=o[a][0]*e+o[a][1]*n+o[a][2]*i;return r}const A_=/^(?<fn>(?:rgb|hsl)a?)\((?<values>.+)\)/,BW={rgb:(t,e,n,i)=>({r:t,g:e,b:n,a:i}),rgba:(t,e,n,i)=>({r:t,g:e,b:n,a:i}),hsl:(t,e,n,i)=>H_({h:t,s:e,l:n,a:i}),hsla:(t,e,n,i)=>H_({h:t,s:e,l:n,a:i}),hsv:(t,e,n,i)=>Xd({h:t,s:e,v:n,a:i}),hsva:(t,e,n,i)=>Xd({h:t,s:e,v:n,a:i})};function vo(t){if(typeof t=="number")return{r:(t&16711680)>>16,g:(t&65280)>>8,b:t&255};if(typeof t=="string"&&A_.test(t)){const{groups:e}=t.match(A_),{fn:n,values:i}=e,r=i.split(/,\s*/).map(s=>s.endsWith("%")&&["hsl","hsla","hsv","hsva"].includes(n)?parseFloat(s)/100:parseFloat(s));return BW[n](...r)}else if(typeof t=="string"){let e=t.startsWith("#")?t.slice(1):t;return[3,4].includes(e.length)?e=e.split("").map(n=>n+n).join(""):[6,8].includes(e.length),UW(e)}else if(typeof t=="object"){if(aC(t,["r","g","b"]))return t;if(aC(t,["h","s","l"]))return Xd(OA(t));if(aC(t,["h","s","v"]))return Xd(t)}throw new TypeError(`Invalid color: ${t==null?t:String(t)||t.constructor.name}
Expected #hex, #hexa, rgb(), rgba(), hsl(), hsla(), object or number`)}function Xd(t){const{h:e,s:n,v:i,a:r}=t,s=a=>{const l=(a+e/60)%6;return i-i*n*Math.max(Math.min(l,4-l,1),0)},o=[s(5),s(3),s(1)].map(a=>Math.round(a*255));return{r:o[0],g:o[1],b:o[2],a:r}}function H_(t){return Xd(OA(t))}function OA(t){const{h:e,s:n,l:i,a:r}=t,s=i+n*Math.min(i,1-i),o=s===0?0:2-2*i/s;return{h:e,s:o,v:s,a:r}}function ug(t){const e=Math.round(t).toString(16);return("00".substr(0,2-e.length)+e).toUpperCase()}function jW(t){let{r:e,g:n,b:i,a:r}=t;return`#${[ug(e),ug(n),ug(i),r!==void 0?ug(Math.round(r*255)):""].join("")}`}function UW(t){t=YW(t);let[e,n,i,r]=OW(t,2).map(s=>parseInt(s,16));return r=r===void 0?r:r/255,{r:e,g:n,b:i,a:r}}function YW(t){return t.startsWith("#")&&(t=t.slice(1)),t=t.replace(/([^0-9a-f])/gi,"F"),(t.length===3||t.length===4)&&(t=t.split("").map(e=>e+e).join("")),t.length!==6&&(t=S_(S_(t,6),8,"F")),t}function zW(t,e){const n=TA(kR(t));return n[0]=n[0]+e*10,_A(MA(n))}function GW(t,e){const n=TA(kR(t));return n[0]=n[0]-e*10,_A(MA(n))}function KW(t){const e=vo(t);return kR(e)[1]}function XW(t){const e=Math.abs(x_(vo(0),vo(t)));return Math.abs(x_(vo(16777215),vo(t)))>Math.min(e,50)?"#fff":"#000"}function PA(t,e){return n=>Object.keys(t).reduce((i,r)=>{const o=typeof t[r]=="object"&&t[r]!=null&&!Array.isArray(t[r])?t[r]:{type:t[r]};return n&&r in n?i[r]={...o,default:n[r]}:i[r]=o,e&&!i[r].source&&(i[r].source=e),i},{})}function kw(t,e){const n=jV();if(!n)throw new Error(`[Vuetify] ${t} must be called from inside a setup function`);return n}let IA=0,Jm=new WeakMap;function xA(){const t=kw("getUid");if(Jm.has(t))return Jm.get(t);{const e=IA++;return Jm.set(t,e),e}}xA.reset=()=>{IA=0,Jm=new WeakMap};function qW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:kw("injectSelf");const{provides:n}=e;if(n&&t in n)return n[t]}const qd=Symbol.for("vuetify:defaults");function ZW(t){return _c(t)}function AA(){const t=pd(qd);if(!t)throw new Error("[Vuetify] Could not find defaults instance");return t}function JW(t,e){var n,i;return typeof((n=t.props)==null?void 0:n[e])<"u"||typeof((i=t.props)==null?void 0:i[vc(e)])<"u"}function QW(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:AA();const i=kw("useDefaults");if(e=e??i.type.name??i.type.__name,!e)throw new Error("[Vuetify] Could not determine component name");const r=Fi(()=>{var l;return(l=n.value)==null?void 0:l[t._as??e]}),s=new Proxy(t,{get(l,u){var h,d,f,m,p,y,E;const c=Reflect.get(l,u);return u==="class"||u==="style"?[(h=r.value)==null?void 0:h[u],c].filter(T=>T!=null):typeof u=="string"&&!JW(i.vnode,u)?((d=r.value)==null?void 0:d[u])!==void 0?(f=r.value)==null?void 0:f[u]:((p=(m=n.value)==null?void 0:m.global)==null?void 0:p[u])!==void 0?(E=(y=n.value)==null?void 0:y.global)==null?void 0:E[u]:c:c}}),o=mc();HR(()=>{if(r.value){const l=Object.entries(r.value).filter(u=>{let[c]=u;return c.startsWith(c[0].toUpperCase())});o.value=l.length?Object.fromEntries(l):void 0}else o.value=void 0});function a(){const l=qW(qd,i);iA(qd,Fi(()=>o.value?Io((l==null?void 0:l.value)??{},o.value):l==null?void 0:l.value))}return{props:s,provideSubDefaults:a}}function bf(t){if(t._setup=t._setup??t.setup,!t.name)return t;if(t._setup){t.props=PA(t.props??{},t.name)();const e=Object.keys(t.props).filter(n=>n!=="class"&&n!=="style");t.filterProps=function(i){return MW(i,e)},t.props._as=String,t.setup=function(i,r){const s=AA();if(!s.value)return t._setup(i,r);const{props:o,provideSubDefaults:a}=QW(i,i._as??t.name,s),l=t._setup(o,r);return a(),l}}return t}function eB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return e=>(t?bf:YF)(e)}function tB(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:h=>h,r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:h=>h;const s=kw("useProxiedModel"),o=_c(t[e]!==void 0?t[e]:n),a=vc(e),u=Fi(a!==e?()=>{var h,d,f,m;return t[e],!!(((h=s.vnode.props)!=null&&h.hasOwnProperty(e)||(d=s.vnode.props)!=null&&d.hasOwnProperty(a))&&((f=s.vnode.props)!=null&&f.hasOwnProperty(`onUpdate:${e}`)||(m=s.vnode.props)!=null&&m.hasOwnProperty(`onUpdate:${a}`)))}:()=>{var h,d;return t[e],!!((h=s.vnode.props)!=null&&h.hasOwnProperty(e)&&((d=s.vnode.props)!=null&&d.hasOwnProperty(`onUpdate:${e}`)))});RW(()=>!u.value,()=>{_o(()=>t[e],h=>{o.value=h})});const c=Fi({get(){const h=t[e];return i(u.value?h:o.value)},set(h){const d=r(h),f=ct(u.value?t[e]:o.value);f===d||i(f)===h||(o.value=d,s==null||s.emit(`update:${e}`,d))}});return Object.defineProperty(c,"externalValue",{get:()=>u.value?t[e]:o.value}),c}const nB={badge:"Badge",open:"Open",close:"Close",dismiss:"Dismiss",confirmEdit:{ok:"OK",cancel:"Cancel"},dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},dateRangeInput:{divider:"to"},datePicker:{itemsSelected:"{0} selected",range:{title:"Select dates",header:"Enter dates"},title:"Select date",header:"Enter date",input:{placeholder:"Enter date"}},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more",today:"Today"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action",otp:"Please enter OTP character {0}"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM",title:"Select Time"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Go to page {0}",currentPage:"Page {0}, Current page",first:"First page",last:"Last page"}},stepper:{next:"Next",prev:"Previous"},rating:{ariaLabel:{item:"Rating {0} of {1}"}},loading:"Loading...",infiniteScroll:{loadMore:"Load more",empty:"No more"}},N_="$vuetify.",D_=(t,e)=>t.replace(/\{(\d+)\}/g,(n,i)=>String(e[+i])),HA=(t,e,n)=>function(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];if(!i.startsWith(N_))return D_(i,s);const a=i.replace(N_,""),l=t.value&&n.value[t.value],u=e.value&&n.value[e.value];let c=y_(l,a,null);return c||(`${i}${t.value}`,c=y_(u,a,null)),c||(c=i),typeof c!="string"&&(c=i),D_(c,s)};function NA(t,e){return(n,i)=>new Intl.NumberFormat([t.value,e.value],i).format(n)}function lC(t,e,n){const i=tB(t,e,t[e]??n.value);return i.value=t[e]??n.value,_o(n,r=>{t[e]==null&&(i.value=n.value)}),i}function DA(t){return e=>{const n=lC(e,"locale",t.current),i=lC(e,"fallback",t.fallback),r=lC(e,"messages",t.messages);return{name:"vuetify",current:n,fallback:i,messages:r,t:HA(n,i,r),n:NA(n,i),provide:DA({current:n,fallback:i,messages:r})}}}function iB(t){const e=mc((t==null?void 0:t.locale)??"en"),n=mc((t==null?void 0:t.fallback)??"en"),i=_c({en:nB,...t==null?void 0:t.messages});return{name:"vuetify",current:e,fallback:n,messages:i,t:HA(e,n,i),n:NA(e,n),provide:DA({current:e,fallback:n,messages:i})}}const L_=Symbol.for("vuetify:locale");function rB(t){return t.name!=null}function sB(t){const e=t!=null&&t.adapter&&rB(t==null?void 0:t.adapter)?t==null?void 0:t.adapter:iB(t),n=aB(e,t);return{...e,...n}}function oB(){return{af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!0,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,km:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1}}function aB(t,e){const n=_c((e==null?void 0:e.rtl)??oB()),i=Fi(()=>n.value[t.current.value]??!1);return{isRtl:i,rtl:n,rtlClasses:Fi(()=>`v-locale--is-${i.value?"rtl":"ltr"}`)}}const $w={"001":1,AD:1,AE:6,AF:6,AG:0,AI:1,AL:1,AM:1,AN:1,AR:1,AS:0,AT:1,AU:1,AX:1,AZ:1,BA:1,BD:0,BE:1,BG:1,BH:6,BM:1,BN:1,BR:0,BS:0,BT:0,BW:0,BY:1,BZ:0,CA:0,CH:1,CL:1,CM:1,CN:1,CO:0,CR:1,CY:1,CZ:1,DE:1,DJ:6,DK:1,DM:0,DO:0,DZ:6,EC:1,EE:1,EG:6,ES:1,ET:0,FI:1,FJ:1,FO:1,FR:1,GB:1,"GB-alt-variant":0,GE:1,GF:1,GP:1,GR:1,GT:0,GU:0,HK:0,HN:0,HR:1,HU:1,ID:0,IE:1,IL:0,IN:0,IQ:6,IR:6,IS:1,IT:1,JM:0,JO:6,JP:0,KE:0,KG:1,KH:0,KR:0,KW:6,KZ:1,LA:0,LB:1,LI:1,LK:1,LT:1,LU:1,LV:1,LY:6,MC:1,MD:1,ME:1,MH:0,MK:1,MM:0,MN:1,MO:0,MQ:1,MT:0,MV:5,MX:0,MY:1,MZ:0,NI:0,NL:1,NO:1,NP:0,NZ:1,OM:6,PA:0,PE:0,PH:0,PK:0,PL:1,PR:0,PT:0,PY:0,QA:6,RE:1,RO:1,RS:1,RU:1,SA:0,SD:6,SE:1,SG:0,SI:1,SK:1,SM:1,SV:0,SY:6,TH:0,TJ:1,TM:1,TR:1,TT:0,TW:0,UA:1,UM:0,US:0,UY:1,UZ:1,VA:1,VE:0,VI:0,VN:1,WS:0,XK:1,YE:0,ZA:0,ZW:0};function lB(t,e,n){const i=[];let r=[];const s=LA(t),o=kA(t),a=n??$w[e.slice(-2).toUpperCase()]??0,l=(s.getDay()-a+7)%7,u=(o.getDay()-a+7)%7;for(let c=0;c<l;c++){const h=new Date(s);h.setDate(h.getDate()-(l-c)),r.push(h)}for(let c=1;c<=o.getDate();c++){const h=new Date(t.getFullYear(),t.getMonth(),c);r.push(h),r.length===7&&(i.push(r),r=[])}for(let c=1;c<7-u;c++){const h=new Date(o);h.setDate(h.getDate()+c),r.push(h)}return r.length>0&&i.push(r),i}function uB(t,e,n){const i=n??$w[e.slice(-2).toUpperCase()]??0,r=new Date(t);for(;r.getDay()!==i;)r.setDate(r.getDate()-1);return r}function cB(t,e){const n=new Date(t),i=(($w[e.slice(-2).toUpperCase()]??0)+6)%7;for(;n.getDay()!==i;)n.setDate(n.getDate()+1);return n}function LA(t){return new Date(t.getFullYear(),t.getMonth(),1)}function kA(t){return new Date(t.getFullYear(),t.getMonth()+1,0)}function hB(t){const e=t.split("-").map(Number);return new Date(e[0],e[1]-1,e[2])}const dB=/^([12]\d{3}-([1-9]|0[1-9]|1[0-2])-([1-9]|0[1-9]|[12]\d|3[01]))$/;function $A(t){if(t==null)return new Date;if(t instanceof Date)return t;if(typeof t=="string"){let e;if(dB.test(t))return hB(t);if(e=Date.parse(t),!isNaN(e))return new Date(e)}return null}const k_=new Date(2e3,0,2);function fB(t,e){const n=e??$w[t.slice(-2).toUpperCase()]??0;return EA(7).map(i=>{const r=new Date(k_);return r.setDate(k_.getDate()+n+i),new Intl.DateTimeFormat(t,{weekday:"narrow"}).format(r)})}function gB(t,e,n,i){const r=$A(t)??new Date,s=i==null?void 0:i[e];if(typeof s=="function")return s(r,e,n);let o={};switch(e){case"fullDate":o={year:"numeric",month:"long",day:"numeric"};break;case"fullDateWithWeekday":o={weekday:"long",year:"numeric",month:"long",day:"numeric"};break;case"normalDate":const a=r.getDate(),l=new Intl.DateTimeFormat(n,{month:"long"}).format(r);return`${a} ${l}`;case"normalDateWithWeekday":o={weekday:"short",day:"numeric",month:"short"};break;case"shortDate":o={month:"short",day:"numeric"};break;case"year":o={year:"numeric"};break;case"month":o={month:"long"};break;case"monthShort":o={month:"short"};break;case"monthAndYear":o={month:"long",year:"numeric"};break;case"monthAndDate":o={month:"long",day:"numeric"};break;case"weekday":o={weekday:"long"};break;case"weekdayShort":o={weekday:"short"};break;case"dayOfMonth":return new Intl.NumberFormat(n).format(r.getDate());case"hours12h":o={hour:"numeric",hour12:!0};break;case"hours24h":o={hour:"numeric",hour12:!1};break;case"minutes":o={minute:"numeric"};break;case"seconds":o={second:"numeric"};break;case"fullTime":o={hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"fullTime12h":o={hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"fullTime24h":o={hour:"numeric",minute:"numeric",second:"numeric",hour12:!1};break;case"fullDateTime":o={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"fullDateTime12h":o={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"fullDateTime24h":o={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1};break;case"keyboardDate":o={year:"numeric",month:"2-digit",day:"2-digit"};break;case"keyboardDateTime":o={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1};break;case"keyboardDateTime12h":o={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};break;case"keyboardDateTime24h":o={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1};break;default:o=s??{timeZone:"UTC",timeZoneName:"short"}}return new Intl.DateTimeFormat(n,o).format(r)}function mB(t,e){const n=t.toJsDate(e),i=n.getFullYear(),r=R_(String(n.getMonth()+1),2,"0"),s=R_(String(n.getDate()),2,"0");return`${i}-${r}-${s}`}function pB(t){const[e,n,i]=t.split("-").map(Number);return new Date(e,n-1,i)}function wB(t,e){const n=new Date(t);return n.setMinutes(n.getMinutes()+e),n}function vB(t,e){const n=new Date(t);return n.setHours(n.getHours()+e),n}function CB(t,e){const n=new Date(t);return n.setDate(n.getDate()+e),n}function yB(t,e){const n=new Date(t);return n.setDate(n.getDate()+e*7),n}function bB(t,e){const n=new Date(t);return n.setDate(1),n.setMonth(n.getMonth()+e),n}function SB(t){return t.getFullYear()}function RB(t){return t.getMonth()}function EB(t){return t.getDate()}function TB(t){return new Date(t.getFullYear(),t.getMonth()+1,1)}function MB(t){return new Date(t.getFullYear(),t.getMonth()-1,1)}function _B(t){return t.getHours()}function OB(t){return t.getMinutes()}function PB(t){return new Date(t.getFullYear(),0,1)}function IB(t){return new Date(t.getFullYear(),11,31)}function xB(t,e){return Hp(t,e[0])&&NB(t,e[1])}function AB(t){const e=new Date(t);return e instanceof Date&&!isNaN(e.getTime())}function Hp(t,e){return t.getTime()>e.getTime()}function HB(t,e){return Hp(Xb(t),Xb(e))}function NB(t,e){return t.getTime()<e.getTime()}function $_(t,e){return t.getTime()===e.getTime()}function DB(t,e){return t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}function LB(t,e){return t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}function kB(t,e){return t.getFullYear()===e.getFullYear()}function $B(t,e,n){const i=new Date(t),r=new Date(e);switch(n){case"years":return i.getFullYear()-r.getFullYear();case"quarters":return Math.floor((i.getMonth()-r.getMonth()+(i.getFullYear()-r.getFullYear())*12)/4);case"months":return i.getMonth()-r.getMonth()+(i.getFullYear()-r.getFullYear())*12;case"weeks":return Math.floor((i.getTime()-r.getTime())/(1e3*60*60*24*7));case"days":return Math.floor((i.getTime()-r.getTime())/(1e3*60*60*24));case"hours":return Math.floor((i.getTime()-r.getTime())/(1e3*60*60));case"minutes":return Math.floor((i.getTime()-r.getTime())/(1e3*60));case"seconds":return Math.floor((i.getTime()-r.getTime())/1e3);default:return i.getTime()-r.getTime()}}function FB(t,e){const n=new Date(t);return n.setHours(e),n}function VB(t,e){const n=new Date(t);return n.setMinutes(e),n}function WB(t,e){const n=new Date(t);return n.setMonth(e),n}function BB(t,e){const n=new Date(t);return n.setDate(e),n}function jB(t,e){const n=new Date(t);return n.setFullYear(e),n}function Xb(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0)}function UB(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999)}class YB{constructor(e){this.locale=e.locale,this.formats=e.formats}date(e){return $A(e)}toJsDate(e){return e}toISO(e){return mB(this,e)}parseISO(e){return pB(e)}addMinutes(e,n){return wB(e,n)}addHours(e,n){return vB(e,n)}addDays(e,n){return CB(e,n)}addWeeks(e,n){return yB(e,n)}addMonths(e,n){return bB(e,n)}getWeekArray(e,n){return lB(e,this.locale,n?Number(n):void 0)}startOfWeek(e,n){return uB(e,this.locale,n?Number(n):void 0)}endOfWeek(e){return cB(e,this.locale)}startOfMonth(e){return LA(e)}endOfMonth(e){return kA(e)}format(e,n){return gB(e,n,this.locale,this.formats)}isEqual(e,n){return $_(e,n)}isValid(e){return AB(e)}isWithinRange(e,n){return xB(e,n)}isAfter(e,n){return Hp(e,n)}isAfterDay(e,n){return HB(e,n)}isBefore(e,n){return!Hp(e,n)&&!$_(e,n)}isSameDay(e,n){return DB(e,n)}isSameMonth(e,n){return LB(e,n)}isSameYear(e,n){return kB(e,n)}setMinutes(e,n){return VB(e,n)}setHours(e,n){return FB(e,n)}setMonth(e,n){return WB(e,n)}setDate(e,n){return BB(e,n)}setYear(e,n){return jB(e,n)}getDiff(e,n,i){return $B(e,n,i)}getWeekdays(e){return fB(this.locale,e?Number(e):void 0)}getYear(e){return SB(e)}getMonth(e){return RB(e)}getDate(e){return EB(e)}getNextMonth(e){return TB(e)}getPreviousMonth(e){return MB(e)}getHours(e){return _B(e)}getMinutes(e){return OB(e)}startOfDay(e){return Xb(e)}endOfDay(e){return UB(e)}startOfYear(e){return PB(e)}endOfYear(e){return IB(e)}}const zB=Symbol.for("vuetify:date-options"),F_=Symbol.for("vuetify:date-adapter");function GB(t,e){const n=Io({adapter:YB,locale:{af:"af-ZA",bg:"bg-BG",ca:"ca-ES",ckb:"",cs:"cs-CZ",de:"de-DE",el:"el-GR",en:"en-US",et:"et-EE",fa:"fa-IR",fi:"fi-FI",hr:"hr-HR",hu:"hu-HU",he:"he-IL",id:"id-ID",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lv:"lv-LV",lt:"lt-LT",nl:"nl-NL",no:"no-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",srCyrl:"sr-SP",srLatn:"sr-SP",sv:"sv-SE",th:"th-TH",tr:"tr-TR",az:"az-AZ",uk:"uk-UA",vi:"vi-VN",zhHans:"zh-CN",zhHant:"zh-TW"}},t);return{options:n,instance:KB(n,e)}}function KB(t,e){const n=Lc(typeof t.adapter=="function"?new t.adapter({locale:t.locale[e.current.value]??e.current.value,formats:t.formats}):t.adapter);return _o(e.current,i=>{n.locale=t.locale[i]??i??n.locale}),n}const V_=Symbol.for("vuetify:display"),W_={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},XB=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:W_;return Io(W_,t)};function B_(t){return Is&&!t?window.innerWidth:typeof t=="object"&&t.clientWidth||0}function j_(t){return Is&&!t?window.innerHeight:typeof t=="object"&&t.clientHeight||0}function U_(t){const e=Is&&!t?window.navigator.userAgent:"ssr";function n(m){return!!e.match(m)}const i=n(/android/i),r=n(/iphone|ipad|ipod/i),s=n(/cordova/i),o=n(/electron/i),a=n(/chrome/i),l=n(/edge/i),u=n(/firefox/i),c=n(/opera/i),h=n(/win/i),d=n(/mac/i),f=n(/linux/i);return{android:i,ios:r,cordova:s,electron:o,chrome:a,edge:l,firefox:u,opera:c,win:h,mac:d,linux:f,touch:EW,ssr:e==="ssr"}}function qB(t,e){const{thresholds:n,mobileBreakpoint:i}=XB(t),r=mc(j_(e)),s=mc(U_(e)),o=Lc({}),a=mc(B_(e));function l(){r.value=j_(),a.value=B_()}function u(){l(),s.value=U_()}return HR(()=>{const c=a.value<n.sm,h=a.value<n.md&&!c,d=a.value<n.lg&&!(h||c),f=a.value<n.xl&&!(d||h||c),m=a.value<n.xxl&&!(f||d||h||c),p=a.value>=n.xxl,y=c?"xs":h?"sm":d?"md":f?"lg":m?"xl":"xxl",E=typeof i=="number"?i:n[i],T=a.value<E;o.xs=c,o.sm=h,o.md=d,o.lg=f,o.xl=m,o.xxl=p,o.smAndUp=!c,o.mdAndUp=!(c||h),o.lgAndUp=!(c||h||d),o.xlAndUp=!(c||h||d||f),o.smAndDown=!(d||f||m||p),o.mdAndDown=!(f||m||p),o.lgAndDown=!(m||p),o.xlAndDown=!p,o.name=y,o.height=r.value,o.width=a.value,o.mobile=T,o.mobileBreakpoint=i,o.platform=s.value,o.thresholds=n}),Is&&window.addEventListener("resize",l,{passive:!0}),{...AF(o),update:u,ssr:!!e}}const ZB=Symbol.for("vuetify:goto");function JB(){return{container:void 0,duration:300,layout:!1,offset:0,easing:"easeInOutCubic",patterns:{linear:t=>t,easeInQuad:t=>t**2,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t**2:-1+(4-2*t)*t,easeInCubic:t=>t**3,easeOutCubic:t=>--t**3+1,easeInOutCubic:t=>t<.5?4*t**3:(t-1)*(2*t-2)*(2*t-2)+1,easeInQuart:t=>t**4,easeOutQuart:t=>1- --t**4,easeInOutQuart:t=>t<.5?8*t**4:1-8*--t**4,easeInQuint:t=>t**5,easeOutQuint:t=>1+--t**5,easeInOutQuint:t=>t<.5?16*t**5:1+16*--t**5}}}function QB(t,e){return{rtl:e.isRtl,options:Io(JB(),t)}}const ej={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sortAsc:"mdi-arrow-up",sortDesc:"mdi-arrow-down",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus",calendar:"mdi-calendar",treeviewCollapse:"mdi-menu-down",treeviewExpand:"mdi-menu-right",eyeDropper:"mdi-eyedropper"},tj={component:t=>XV(FA,{...t,class:"mdi"})},nj=[String,Function,Object,Array],Y_=Symbol.for("vuetify:icons"),Fw=PA({icon:{type:nj},tag:{type:String,required:!0}},"icon");eB()({name:"VComponentIcon",props:Fw(),setup(t,e){let{slots:n}=e;return()=>{const i=t.icon;return fn(t.tag,null,{default:()=>{var r;return[t.icon?fn(i,null,null):(r=n.default)==null?void 0:r.call(n)]}})}}});const ij=bf({name:"VSvgIcon",inheritAttrs:!1,props:Fw(),setup(t,e){let{attrs:n}=e;return()=>fn(t.tag,yA(n,{style:null}),{default:()=>[fn("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[Array.isArray(t.icon)?t.icon.map(i=>Array.isArray(i)?fn("path",{d:i[0],"fill-opacity":i[1]},null):fn("path",{d:i},null)):fn("path",{d:t.icon},null)])]})}});bf({name:"VLigatureIcon",props:Fw(),setup(t){return()=>fn(t.tag,null,{default:()=>[t.icon]})}});const FA=bf({name:"VClassIcon",props:Fw(),setup(t){return()=>fn(t.tag,{class:t.icon},null)}});function rj(){return{svg:{component:ij},class:{component:FA}}}function sj(t){const e=rj(),n=(t==null?void 0:t.defaultSet)??"mdi";return n==="mdi"&&!e.mdi&&(e.mdi=tj),Io({defaultSet:n,sets:e,aliases:{...ej,vuetify:["M8.2241 14.2009L12 21L22 3H14.4459L8.2241 14.2009Z",["M7.26303 12.4733L7.00113 12L2 3H12.5261C12.5261 3 12.5261 3 12.5261 3L7.26303 12.4733Z",.6]],"vuetify-outline":"svg:M7.26 12.47 12.53 3H2L7.26 12.47ZM14.45 3 8.22 14.2 12 21 22 3H14.45ZM18.6 5 12 16.88 10.51 14.2 15.62 5ZM7.26 8.35 5.4 5H9.13L7.26 8.35Z","vuetify-play":["m6.376 13.184-4.11-7.192C1.505 4.66 2.467 3 4.003 3h8.532l-.953 1.576-.006.01-.396.677c-.429.732-.214 1.507.194 2.015.404.503 1.092.878 1.869.806a3.72 3.72 0 0 1 1.005.022c.276.053.434.143.523.237.138.146.38.635-.25 2.09-.893 1.63-1.553 1.722-1.847 1.677-.213-.033-.468-.158-.756-.406a4.95 4.95 0 0 1-.8-.927c-.39-.564-1.04-.84-1.66-.846-.625-.006-1.316.27-1.693.921l-.478.826-.911 1.506Z",["M9.093 11.552c.046-.079.144-.15.32-.148a.53.53 0 0 1 .43.207c.285.414.636.847 1.046 1.2.405.35.914.662 1.516.754 1.334.205 2.502-.698 3.48-2.495l.014-.028.013-.03c.687-1.574.774-2.852-.005-3.675-.37-.391-.861-.586-1.333-.676a5.243 5.243 0 0 0-1.447-.044c-.173.016-.393-.073-.54-.257-.145-.18-.127-.316-.082-.392l.393-.672L14.287 3h5.71c1.536 0 2.499 1.659 1.737 2.992l-7.997 13.996c-.768 1.344-2.706 1.344-3.473 0l-3.037-5.314 1.377-2.278.004-.006.004-.007.481-.831Z",.6]]}},t)}const z_=Symbol.for("vuetify:theme");function G_(){return{defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-bright":"#FFFFFF","surface-light":"#EEEEEE","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#1867C0","primary-darken-1":"#1F5592",secondary:"#48A9A6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-bright":"#ccbfd6","surface-light":"#424242","surface-variant":"#a3a3a3","on-surface-variant":"#424242",primary:"#2196F3","primary-darken-1":"#277CC1",secondary:"#54B6B2","secondary-darken-1":"#48A9A6",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":1,"medium-emphasis-opacity":.7,"disabled-opacity":.5,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}}}function oj(){var i,r;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:G_();const e=G_();if(!t)return{...e,isDisabled:!0};const n={};for(const[s,o]of Object.entries(t.themes??{})){const a=o.dark||s==="dark"?(i=e.themes)==null?void 0:i.dark:(r=e.themes)==null?void 0:r.light;n[s]=Io(a,o)}return Io(e,{...t,themes:n})}function aj(t){const e=oj(t),n=_c(e.defaultTheme),i=_c(e.themes),r=Fi(()=>{const c={};for(const[h,d]of Object.entries(i.value)){const f=c[h]={...d,colors:{...d.colors}};if(e.variations)for(const m of e.variations.colors){const p=f.colors[m];if(p)for(const y of["lighten","darken"]){const E=y==="lighten"?zW:GW;for(const T of EA(e.variations[y],1))f.colors[`${m}-${y}-${T}`]=jW(E(vo(p),T))}}for(const m of Object.keys(f.colors)){if(/^on-[a-z]/.test(m)||f.colors[`on-${m}`])continue;const p=`on-${m}`,y=vo(f.colors[m]);f.colors[p]=XW(y)}}return c}),s=Fi(()=>r.value[n.value]),o=Fi(()=>{var m;const c=[];(m=s.value)!=null&&m.dark&&za(c,":root",["color-scheme: dark"]),za(c,":root",K_(s.value));for(const[p,y]of Object.entries(r.value))za(c,`.v-theme--${p}`,[`color-scheme: ${y.dark?"dark":"normal"}`,...K_(y)]);const h=[],d=[],f=new Set(Object.values(r.value).flatMap(p=>Object.keys(p.colors)));for(const p of f)/^on-[a-z]/.test(p)?za(d,`.${p}`,[`color: rgb(var(--v-theme-${p})) !important`]):(za(h,`.bg-${p}`,[`--v-theme-overlay-multiplier: var(--v-theme-${p}-overlay-multiplier)`,`background-color: rgb(var(--v-theme-${p})) !important`,`color: rgb(var(--v-theme-on-${p})) !important`]),za(d,`.text-${p}`,[`color: rgb(var(--v-theme-${p})) !important`]),za(d,`.border-${p}`,[`--v-border-color: var(--v-theme-${p})`]));return c.push(...h,...d),c.map((p,y)=>y===0?p:`    ${p}`).join("")});function a(){return{style:[{children:o.value,id:"vuetify-theme-stylesheet",nonce:e.cspNonce||!1}]}}function l(c){if(e.isDisabled)return;const h=c._context.provides.usehead;if(h)if(h.push){const f=h.push(a);Is&&_o(o,()=>{f.patch(a)})}else Is?(h.addHeadObjs(Fi(a)),HR(()=>h.updateDOM())):h.addHeadObjs(a());else{let m=function(){if(typeof document<"u"&&!f){const p=document.createElement("style");p.type="text/css",p.id="vuetify-theme-stylesheet",e.cspNonce&&p.setAttribute("nonce",e.cspNonce),f=p,document.head.appendChild(f)}f&&(f.innerHTML=o.value)};var d=m;let f=Is?document.getElementById("vuetify-theme-stylesheet"):null;Is?_o(o,m,{immediate:!0}):m()}}const u=Fi(()=>e.isDisabled?void 0:`v-theme--${n.value}`);return{install:l,isDisabled:e.isDisabled,name:n,themes:i,current:s,computedThemes:r,themeClasses:u,styles:o,global:{name:n,current:s}}}function za(t,e,n){t.push(`${e} {
`,...n.map(i=>`  ${i};
`),`}
`)}function K_(t){const e=t.dark?2:1,n=t.dark?1:2,i=[];for(const[r,s]of Object.entries(t.colors)){const o=vo(s);i.push(`--v-theme-${r}: ${o.r},${o.g},${o.b}`),r.startsWith("on-")||i.push(`--v-theme-${r}-overlay-multiplier: ${KW(s)>.18?e:n}`)}for(const[r,s]of Object.entries(t.variables)){const o=typeof s=="string"&&s.startsWith("#")?vo(s):void 0,a=o?`${o.r}, ${o.g}, ${o.b}`:void 0;i.push(`--v-${r}: ${a??s}`)}return i}function VA(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:e,...n}=t,i=Io(e,n),{aliases:r={},components:s={},directives:o={}}=i,a=ZW(i.defaults),l=qB(i.display,i.ssr),u=aj(i.theme),c=sj(i.icons),h=sB(i.locale),d=GB(i.date,h),f=QB(i.goTo,h);return{install:p=>{for(const y in o)p.directive(y,o[y]);for(const y in s)p.component(y,s[y]);for(const y in r)p.component(y,bf({...r[y],name:y,aliasName:r[y].name}));if(u.install(p),p.provide(qd,a),p.provide(V_,l),p.provide(z_,u),p.provide(Y_,c),p.provide(L_,h),p.provide(zB,d.options),p.provide(F_,d.instance),p.provide(ZB,f),Is&&i.ssr)if(p.$nuxt)p.$nuxt.hook("app:suspense:resolve",()=>{l.update()});else{const{mount:y}=p;p.mount=function(){const E=y(...arguments);return zx(()=>l.update()),p.mount=y,E}}xA.reset(),p.mixin({computed:{$vuetify(){return Lc({defaults:wu.call(this,qd),display:wu.call(this,V_),theme:wu.call(this,z_),icons:wu.call(this,Y_),locale:wu.call(this,L_),date:wu.call(this,F_)})}}})},defaults:a,display:l,theme:u,icons:c,locale:h,date:d,goTo:f}}const lj="3.7.2";VA.version=lj;function wu(t){var i,r;const e=this.$,n=((i=e.parent)==null?void 0:i.provides)??((r=e.vnode.appContext)==null?void 0:r.provides);if(n&&t in n)return n[t]}const uj=VA({theme:{defaultTheme:"dark"}});function cj(t){t.use(uj)}var cg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hj(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Qc=function(t){return t&&t.Math===Math&&t},Ln=Qc(typeof globalThis=="object"&&globalThis)||Qc(typeof window=="object"&&window)||Qc(typeof self=="object"&&self)||Qc(typeof cg=="object"&&cg)||Qc(typeof cg=="object"&&cg)||function(){return this}()||Function("return this")(),$R={},Mi=function(t){try{return!!t()}catch{return!0}},dj=Mi,Ur=!dj(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),fj=Mi,Vw=!fj(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),gj=Vw,hg=Function.prototype.call,Yr=gj?hg.bind(hg):function(){return hg.apply(hg,arguments)},WA={},BA={}.propertyIsEnumerable,jA=Object.getOwnPropertyDescriptor,mj=jA&&!BA.call({1:2},1);WA.f=mj?function(e){var n=jA(this,e);return!!n&&n.enumerable}:BA;var Ww=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},UA=Vw,YA=Function.prototype,qb=YA.call,pj=UA&&YA.bind.bind(qb,qb),gn=UA?pj:function(t){return function(){return qb.apply(t,arguments)}},zA=gn,wj=zA({}.toString),vj=zA("".slice),iu=function(t){return vj(wj(t),8,-1)},Cj=gn,yj=Mi,bj=iu,uC=Object,Sj=Cj("".split),Rj=yj(function(){return!uC("z").propertyIsEnumerable(0)})?function(t){return bj(t)==="String"?Sj(t,""):uC(t)}:uC,Bw=function(t){return t==null},Ej=Bw,Tj=TypeError,Sf=function(t){if(Ej(t))throw new Tj("Can't call method on "+t);return t},Mj=Rj,_j=Sf,jw=function(t){return Mj(_j(t))},cC=typeof document=="object"&&document.all,kn=typeof cC>"u"&&cC!==void 0?function(t){return typeof t=="function"||t===cC}:function(t){return typeof t=="function"},Oj=kn,ks=function(t){return typeof t=="object"?t!==null:Oj(t)},hC=Ln,Pj=kn,Ij=function(t){return Pj(t)?t:void 0},kc=function(t,e){return arguments.length<2?Ij(hC[t]):hC[t]&&hC[t][e]},xj=gn,Uw=xj({}.isPrototypeOf),Aj=Ln,X_=Aj.navigator,q_=X_&&X_.userAgent,Yw=q_?String(q_):"",GA=Ln,dC=Yw,Z_=GA.process,J_=GA.Deno,Q_=Z_&&Z_.versions||J_&&J_.version,e1=Q_&&Q_.v8,Hr,Np;e1&&(Hr=e1.split("."),Np=Hr[0]>0&&Hr[0]<4?1:+(Hr[0]+Hr[1]));!Np&&dC&&(Hr=dC.match(/Edge\/(\d+)/),(!Hr||Hr[1]>=74)&&(Hr=dC.match(/Chrome\/(\d+)/),Hr&&(Np=+Hr[1])));var Hj=Np,t1=Hj,Nj=Mi,Dj=Ln,Lj=Dj.String,FR=!!Object.getOwnPropertySymbols&&!Nj(function(){var t=Symbol("symbol detection");return!Lj(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&t1&&t1<41}),kj=FR,KA=kj&&!Symbol.sham&&typeof Symbol.iterator=="symbol",$j=kc,Fj=kn,Vj=Uw,Wj=KA,Bj=Object,VR=Wj?function(t){return typeof t=="symbol"}:function(t){var e=$j("Symbol");return Fj(e)&&Vj(e.prototype,Bj(t))},jj=String,zw=function(t){try{return jj(t)}catch{return"Object"}},Uj=kn,Yj=zw,zj=TypeError,Rf=function(t){if(Uj(t))return t;throw new zj(Yj(t)+" is not a function")},Gj=Rf,Kj=Bw,Gw=function(t,e){var n=t[e];return Kj(n)?void 0:Gj(n)},fC=Yr,gC=kn,mC=ks,Xj=TypeError,qj=function(t,e){var n,i;if(e==="string"&&gC(n=t.toString)&&!mC(i=fC(n,t))||gC(n=t.valueOf)&&!mC(i=fC(n,t))||e!=="string"&&gC(n=t.toString)&&!mC(i=fC(n,t)))return i;throw new Xj("Can't convert object to primitive value")},XA={exports:{}},n1=Ln,Zj=Object.defineProperty,WR=function(t,e){try{Zj(n1,t,{value:e,configurable:!0,writable:!0})}catch{n1[t]=e}return e},Jj=Ln,Qj=WR,i1="__core-js_shared__",r1=XA.exports=Jj[i1]||Qj(i1,{});(r1.versions||(r1.versions=[])).push({version:"3.38.1",mode:"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.38.1/LICENSE",source:"https://github.com/zloirock/core-js"});var BR=XA.exports,s1=BR,qA=function(t,e){return s1[t]||(s1[t]=e||{})},eU=Sf,tU=Object,Ef=function(t){return tU(eU(t))},nU=gn,iU=Ef,rU=nU({}.hasOwnProperty),$s=Object.hasOwn||function(e,n){return rU(iU(e),n)},sU=gn,oU=0,aU=Math.random(),lU=sU(1 .toString),ZA=function(t){return"Symbol("+(t===void 0?"":t)+")_"+lU(++oU+aU,36)},uU=Ln,cU=qA,o1=$s,hU=ZA,dU=FR,fU=KA,lc=uU.Symbol,pC=cU("wks"),gU=fU?lc.for||lc:lc&&lc.withoutSetter||hU,Fa=function(t){return o1(pC,t)||(pC[t]=dU&&o1(lc,t)?lc[t]:gU("Symbol."+t)),pC[t]},mU=Yr,a1=ks,l1=VR,pU=Gw,wU=qj,vU=Fa,CU=TypeError,yU=vU("toPrimitive"),bU=function(t,e){if(!a1(t)||l1(t))return t;var n=pU(t,yU),i;if(n){if(e===void 0&&(e="default"),i=mU(n,t,e),!a1(i)||l1(i))return i;throw new CU("Can't convert object to primitive value")}return e===void 0&&(e="number"),wU(t,e)},SU=bU,RU=VR,JA=function(t){var e=SU(t,"string");return RU(e)?e:e+""},EU=Ln,u1=ks,Zb=EU.document,TU=u1(Zb)&&u1(Zb.createElement),jR=function(t){return TU?Zb.createElement(t):{}},MU=Ur,_U=Mi,OU=jR,QA=!MU&&!_U(function(){return Object.defineProperty(OU("div"),"a",{get:function(){return 7}}).a!==7}),PU=Ur,IU=Yr,xU=WA,AU=Ww,HU=jw,NU=JA,DU=$s,LU=QA,c1=Object.getOwnPropertyDescriptor;$R.f=PU?c1:function(e,n){if(e=HU(e),n=NU(n),LU)try{return c1(e,n)}catch{}if(DU(e,n))return AU(!IU(xU.f,e,n),e[n])};var Va={},kU=Ur,$U=Mi,eH=kU&&$U(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),FU=ks,VU=String,WU=TypeError,ko=function(t){if(FU(t))return t;throw new WU(VU(t)+" is not an object")},BU=Ur,jU=QA,UU=eH,dg=ko,h1=JA,YU=TypeError,wC=Object.defineProperty,zU=Object.getOwnPropertyDescriptor,vC="enumerable",CC="configurable",yC="writable";Va.f=BU?UU?function(e,n,i){if(dg(e),n=h1(n),dg(i),typeof e=="function"&&n==="prototype"&&"value"in i&&yC in i&&!i[yC]){var r=zU(e,n);r&&r[yC]&&(e[n]=i.value,i={configurable:CC in i?i[CC]:r[CC],enumerable:vC in i?i[vC]:r[vC],writable:!1})}return wC(e,n,i)}:wC:function(e,n,i){if(dg(e),n=h1(n),dg(i),jU)try{return wC(e,n,i)}catch{}if("get"in i||"set"in i)throw new YU("Accessors not supported");return"value"in i&&(e[n]=i.value),e};var GU=Ur,KU=Va,XU=Ww,Tf=GU?function(t,e,n){return KU.f(t,e,XU(1,n))}:function(t,e,n){return t[e]=n,t},tH={exports:{}},Jb=Ur,qU=$s,nH=Function.prototype,ZU=Jb&&Object.getOwnPropertyDescriptor,UR=qU(nH,"name"),JU=UR&&(function(){}).name==="something",QU=UR&&(!Jb||Jb&&ZU(nH,"name").configurable),e2={EXISTS:UR,PROPER:JU,CONFIGURABLE:QU},t2=gn,n2=kn,Qb=BR,i2=t2(Function.toString);n2(Qb.inspectSource)||(Qb.inspectSource=function(t){return i2(t)});var r2=Qb.inspectSource,s2=Ln,o2=kn,d1=s2.WeakMap,a2=o2(d1)&&/native code/.test(String(d1)),l2=qA,u2=ZA,f1=l2("keys"),iH=function(t){return f1[t]||(f1[t]=u2(t))},YR={},c2=a2,rH=Ln,h2=ks,d2=Tf,bC=$s,SC=BR,f2=iH,g2=YR,g1="Object already initialized",eS=rH.TypeError,m2=rH.WeakMap,Dp,Zd,Lp,p2=function(t){return Lp(t)?Zd(t):Dp(t,{})},w2=function(t){return function(e){var n;if(!h2(e)||(n=Zd(e)).type!==t)throw new eS("Incompatible receiver, "+t+" required");return n}};if(c2||SC.state){var qr=SC.state||(SC.state=new m2);qr.get=qr.get,qr.has=qr.has,qr.set=qr.set,Dp=function(t,e){if(qr.has(t))throw new eS(g1);return e.facade=t,qr.set(t,e),e},Zd=function(t){return qr.get(t)||{}},Lp=function(t){return qr.has(t)}}else{var vu=f2("state");g2[vu]=!0,Dp=function(t,e){if(bC(t,vu))throw new eS(g1);return e.facade=t,d2(t,vu,e),e},Zd=function(t){return bC(t,vu)?t[vu]:{}},Lp=function(t){return bC(t,vu)}}var v2={set:Dp,get:Zd,has:Lp,enforce:p2,getterFor:w2},zR=gn,C2=Mi,y2=kn,fg=$s,tS=Ur,b2=e2.CONFIGURABLE,S2=r2,sH=v2,R2=sH.enforce,E2=sH.get,m1=String,Qm=Object.defineProperty,T2=zR("".slice),M2=zR("".replace),_2=zR([].join),O2=tS&&!C2(function(){return Qm(function(){},"length",{value:8}).length!==8}),P2=String(String).split("String"),I2=tH.exports=function(t,e,n){T2(m1(e),0,7)==="Symbol("&&(e="["+M2(m1(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!fg(t,"name")||b2&&t.name!==e)&&(tS?Qm(t,"name",{value:e,configurable:!0}):t.name=e),O2&&n&&fg(n,"arity")&&t.length!==n.arity&&Qm(t,"length",{value:n.arity});try{n&&fg(n,"constructor")&&n.constructor?tS&&Qm(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var i=R2(t);return fg(i,"source")||(i.source=_2(P2,typeof e=="string"?e:"")),t};Function.prototype.toString=I2(function(){return y2(this)&&E2(this).source||S2(this)},"toString");var x2=tH.exports,A2=kn,H2=Va,N2=x2,D2=WR,L2=function(t,e,n,i){i||(i={});var r=i.enumerable,s=i.name!==void 0?i.name:e;if(A2(n)&&N2(n,s,i),i.global)r?t[e]=n:D2(e,n);else{try{i.unsafe?t[e]&&(r=!0):delete t[e]}catch{}r?t[e]=n:H2.f(t,e,{value:n,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t},oH={},k2=Math.ceil,$2=Math.floor,F2=Math.trunc||function(e){var n=+e;return(n>0?$2:k2)(n)},V2=F2,Mf=function(t){var e=+t;return e!==e||e===0?0:V2(e)},W2=Mf,B2=Math.max,j2=Math.min,U2=function(t,e){var n=W2(t);return n<0?B2(n+e,0):j2(n,e)},Y2=Mf,z2=Math.min,G2=function(t){var e=Y2(t);return e>0?z2(e,9007199254740991):0},K2=G2,_f=function(t){return K2(t.length)},X2=jw,q2=U2,Z2=_f,p1=function(t){return function(e,n,i){var r=X2(e),s=Z2(r);if(s===0)return!t&&-1;var o=q2(i,s),a;if(t&&n!==n){for(;s>o;)if(a=r[o++],a!==a)return!0}else for(;s>o;o++)if((t||o in r)&&r[o]===n)return t||o||0;return!t&&-1}},J2={includes:p1(!0),indexOf:p1(!1)},Q2=gn,RC=$s,eY=jw,tY=J2.indexOf,nY=YR,w1=Q2([].push),aH=function(t,e){var n=eY(t),i=0,r=[],s;for(s in n)!RC(nY,s)&&RC(n,s)&&w1(r,s);for(;e.length>i;)RC(n,s=e[i++])&&(~tY(r,s)||w1(r,s));return r},GR=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],iY=aH,rY=GR,sY=rY.concat("length","prototype");oH.f=Object.getOwnPropertyNames||function(e){return iY(e,sY)};var lH={};lH.f=Object.getOwnPropertySymbols;var oY=kc,aY=gn,lY=oH,uY=lH,cY=ko,hY=aY([].concat),dY=oY("Reflect","ownKeys")||function(e){var n=lY.f(cY(e)),i=uY.f;return i?hY(n,i(e)):n},v1=$s,fY=dY,gY=$R,mY=Va,uH=function(t,e,n){for(var i=fY(e),r=mY.f,s=gY.f,o=0;o<i.length;o++){var a=i[o];!v1(t,a)&&!(n&&v1(n,a))&&r(t,a,s(e,a))}},pY=Mi,wY=kn,vY=/#|\.prototype\./,Of=function(t,e){var n=yY[CY(t)];return n===SY?!0:n===bY?!1:wY(e)?pY(e):!!e},CY=Of.normalize=function(t){return String(t).replace(vY,".").toLowerCase()},yY=Of.data={},bY=Of.NATIVE="N",SY=Of.POLYFILL="P",RY=Of,gg=Ln,EY=$R.f,TY=Tf,MY=L2,_Y=WR,OY=uH,PY=RY,$n=function(t,e){var n=t.target,i=t.global,r=t.stat,s,o,a,l,u,c;if(i?o=gg:r?o=gg[n]||_Y(n,{}):o=gg[n]&&gg[n].prototype,o)for(a in e){if(u=e[a],t.dontCallGetSet?(c=EY(o,a),l=c&&c.value):l=o[a],s=PY(i?a:n+(r?".":"#")+a,t.forced),!s&&l!==void 0){if(typeof u==typeof l)continue;OY(u,l)}(t.sham||l&&l.sham)&&TY(u,"sham",!0),MY(o,a,u,t)}},IY=Vw,cH=Function.prototype,C1=cH.apply,y1=cH.call,Kw=typeof Reflect=="object"&&Reflect.apply||(IY?y1.bind(C1):function(){return y1.apply(C1,arguments)}),xY=gn,AY=Rf,hH=function(t,e,n){try{return xY(AY(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},HY=ks,NY=function(t){return HY(t)||t===null},DY=NY,LY=String,kY=TypeError,$Y=function(t){if(DY(t))return t;throw new kY("Can't set "+LY(t)+" as a prototype")},FY=hH,VY=ks,WY=Sf,BY=$Y,dH=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=FY(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(r,s){return WY(r),BY(s),VY(r)&&(t?n(r,s):r.__proto__=s),r}}():void 0),jY=Va.f,UY=function(t,e,n){n in t||jY(t,n,{configurable:!0,get:function(){return e[n]},set:function(i){e[n]=i}})},YY=kn,zY=ks,b1=dH,GY=function(t,e,n){var i,r;return b1&&YY(i=e.constructor)&&i!==n&&zY(r=i.prototype)&&r!==n.prototype&&b1(t,r),t},KY=Fa,XY=KY("toStringTag"),fH={};fH[XY]="z";var qY=String(fH)==="[object z]",ZY=qY,JY=kn,ep=iu,QY=Fa,ez=QY("toStringTag"),tz=Object,nz=ep(function(){return arguments}())==="Arguments",iz=function(t,e){try{return t[e]}catch{}},gH=ZY?ep:function(t){var e,n,i;return t===void 0?"Undefined":t===null?"Null":typeof(n=iz(e=tz(t),ez))=="string"?n:nz?ep(e):(i=ep(e))==="Object"&&JY(e.callee)?"Arguments":i},rz=gH,sz=String,Xw=function(t){if(rz(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return sz(t)},oz=Xw,az=function(t,e){return t===void 0?arguments.length<2?"":e:oz(t)},lz=ks,uz=Tf,cz=function(t,e){lz(e)&&"cause"in e&&uz(t,"cause",e.cause)},hz=gn,mH=Error,dz=hz("".replace),fz=function(t){return String(new mH(t).stack)}("zxcasd"),pH=/\n\s*at [^:]*:[^\n]*/,gz=pH.test(fz),mz=function(t,e){if(gz&&typeof t=="string"&&!mH.prepareStackTrace)for(;e--;)t=dz(t,pH,"");return t},pz=Mi,wz=Ww,vz=!pz(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",wz(1,7)),t.stack!==7):!0}),Cz=Tf,yz=mz,bz=vz,S1=Error.captureStackTrace,Sz=function(t,e,n,i){bz&&(S1?S1(t,e):Cz(t,"stack",yz(n,i)))},R1=kc,Rz=$s,E1=Tf,Ez=Uw,T1=dH,M1=uH,_1=UY,Tz=GY,Mz=az,_z=cz,Oz=Sz,Pz=Ur,Iz=function(t,e,n,i){var r="stackTraceLimit",s=i?2:1,o=t.split("."),a=o[o.length-1],l=R1.apply(null,o);if(l){var u=l.prototype;if(Rz(u,"cause")&&delete u.cause,!n)return l;var c=R1("Error"),h=e(function(d,f){var m=Mz(i?f:d,void 0),p=i?new l(d):new l;return m!==void 0&&E1(p,"message",m),Oz(p,h,p.stack,2),this&&Ez(u,this)&&Tz(p,this,h),arguments.length>s&&_z(p,arguments[s]),p});h.prototype=u,a!=="Error"?T1?T1(h,c):M1(h,c,{name:!0}):Pz&&r in l&&(_1(h,l,r),_1(h,l,"prepareStackTrace")),M1(h,l);try{u.name!==a&&E1(u,"name",a),u.constructor=h}catch{}return h}},wH=$n,xz=Ln,Fs=Kw,vH=Iz,nS="WebAssembly",O1=xz[nS],kp=new Error("e",{cause:7}).cause!==7,ru=function(t,e){var n={};n[t]=vH(t,e,kp),wH({global:!0,constructor:!0,arity:1,forced:kp},n)},KR=function(t,e){if(O1&&O1[t]){var n={};n[t]=vH(nS+"."+t,e,kp),wH({target:nS,stat:!0,constructor:!0,arity:1,forced:kp},n)}};ru("Error",function(t){return function(n){return Fs(t,this,arguments)}});ru("EvalError",function(t){return function(n){return Fs(t,this,arguments)}});ru("RangeError",function(t){return function(n){return Fs(t,this,arguments)}});ru("ReferenceError",function(t){return function(n){return Fs(t,this,arguments)}});ru("SyntaxError",function(t){return function(n){return Fs(t,this,arguments)}});ru("TypeError",function(t){return function(n){return Fs(t,this,arguments)}});ru("URIError",function(t){return function(n){return Fs(t,this,arguments)}});KR("CompileError",function(t){return function(n){return Fs(t,this,arguments)}});KR("LinkError",function(t){return function(n){return Fs(t,this,arguments)}});KR("RuntimeError",function(t){return function(n){return Fs(t,this,arguments)}});var Az=iu,CH=Array.isArray||function(e){return Az(e)==="Array"},Hz=Ur,Nz=CH,Dz=TypeError,Lz=Object.getOwnPropertyDescriptor,kz=Hz&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),yH=kz?function(t,e){if(Nz(t)&&!Lz(t,"length").writable)throw new Dz("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},$z=TypeError,Fz=9007199254740991,bH=function(t){if(t>Fz)throw $z("Maximum allowed index exceeded");return t},Vz=$n,Wz=Ef,Bz=_f,jz=yH,Uz=bH,Yz=Mi,zz=Yz(function(){return[].push.call({length:4294967296},1)!==4294967297}),Gz=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},Kz=zz||!Gz();Vz({target:"Array",proto:!0,arity:1,forced:Kz},{push:function(e){var n=Wz(this),i=Bz(n),r=arguments.length;Uz(i+r);for(var s=0;s<r;s++)n[i]=arguments[s],i++;return jz(n,i),i}});var EC=gn,mg=Set.prototype,Vs={Set,add:EC(mg.add),has:EC(mg.has),remove:EC(mg.delete),proto:mg},Xz=Vs.has,su=function(t){return Xz(t),t},qz=Yr,ou=function(t,e,n){for(var i=n?t:t.iterator,r=t.next,s,o;!(s=qz(r,i)).done;)if(o=e(s.value),o!==void 0)return o},SH=gn,Zz=ou,RH=Vs,Jz=RH.Set,EH=RH.proto,Qz=SH(EH.forEach),TH=SH(EH.keys),eG=TH(new Jz).next,Pf=function(t,e,n){return n?Zz({iterator:TH(t),next:eG},e):Qz(t,e)},MH=Vs,tG=Pf,nG=MH.Set,iG=MH.add,XR=function(t){var e=new nG;return tG(t,function(n){iG(e,n)}),e},rG=hH,sG=Vs,If=rG(sG.proto,"size","get")||function(t){return t.size},oG=function(t){return{iterator:t,next:t.next,done:!1}},P1=Rf,_H=ko,I1=Yr,aG=Mf,lG=oG,x1="Invalid size",uG=RangeError,cG=TypeError,hG=Math.max,OH=function(t,e){this.set=t,this.size=hG(e,0),this.has=P1(t.has),this.keys=P1(t.keys)};OH.prototype={getIterator:function(){return lG(_H(I1(this.keys,this.set)))},includes:function(t){return I1(this.has,this.set,t)}};var au=function(t){_H(t);var e=+t.size;if(e!==e)throw new cG(x1);var n=aG(e);if(n<0)throw new uG(x1);return new OH(t,n)},dG=su,PH=Vs,fG=XR,gG=If,mG=au,pG=Pf,wG=ou,vG=PH.has,A1=PH.remove,CG=function(e){var n=dG(this),i=mG(e),r=fG(n);return gG(n)<=i.size?pG(n,function(s){i.includes(s)&&A1(r,s)}):wG(i.getIterator(),function(s){vG(n,s)&&A1(r,s)}),r},yG=kc,H1=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},lu=function(t){var e=yG("Set");try{new e()[t](H1(0));try{return new e()[t](H1(-1)),!1}catch{return!0}}catch{return!1}},bG=$n,SG=CG,RG=lu;bG({target:"Set",proto:!0,real:!0,forced:!RG("difference")},{difference:SG});var EG=su,qR=Vs,TG=If,MG=au,_G=Pf,OG=ou,PG=qR.Set,N1=qR.add,IG=qR.has,xG=function(e){var n=EG(this),i=MG(e),r=new PG;return TG(n)>i.size?OG(i.getIterator(),function(s){IG(n,s)&&N1(r,s)}):_G(n,function(s){i.includes(s)&&N1(r,s)}),r},AG=$n,HG=Mi,NG=xG,DG=lu,LG=!DG("intersection")||HG(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});AG({target:"Set",proto:!0,real:!0,forced:LG},{intersection:NG});var kG=Yr,D1=ko,$G=Gw,ZR=function(t,e,n){var i,r;D1(t);try{if(i=$G(t,"return"),!i){if(e==="throw")throw n;return n}i=kG(i,t)}catch(s){r=!0,i=s}if(e==="throw")throw n;if(r)throw i;return D1(i),n},FG=su,VG=Vs.has,WG=If,BG=au,jG=Pf,UG=ou,YG=ZR,zG=function(e){var n=FG(this),i=BG(e);if(WG(n)<=i.size)return jG(n,function(s){if(i.includes(s))return!1},!0)!==!1;var r=i.getIterator();return UG(r,function(s){if(VG(n,s))return YG(r,"normal",!1)})!==!1},GG=$n,KG=zG,XG=lu;GG({target:"Set",proto:!0,real:!0,forced:!XG("isDisjointFrom")},{isDisjointFrom:KG});var qG=su,ZG=If,JG=Pf,QG=au,eK=function(e){var n=qG(this),i=QG(e);return ZG(n)>i.size?!1:JG(n,function(r){if(!i.includes(r))return!1},!0)!==!1},tK=$n,nK=eK,iK=lu;tK({target:"Set",proto:!0,real:!0,forced:!iK("isSubsetOf")},{isSubsetOf:nK});var rK=su,sK=Vs.has,oK=If,aK=au,lK=ou,uK=ZR,cK=function(e){var n=rK(this),i=aK(e);if(oK(n)<i.size)return!1;var r=i.getIterator();return lK(r,function(s){if(!sK(n,s))return uK(r,"normal",!1)})!==!1},hK=$n,dK=cK,fK=lu;hK({target:"Set",proto:!0,real:!0,forced:!fK("isSupersetOf")},{isSupersetOf:dK});var gK=su,JR=Vs,mK=XR,pK=au,wK=ou,vK=JR.add,CK=JR.has,yK=JR.remove,bK=function(e){var n=gK(this),i=pK(e).getIterator(),r=mK(n);return wK(i,function(s){CK(n,s)?yK(r,s):vK(r,s)}),r},SK=$n,RK=bK,EK=lu;SK({target:"Set",proto:!0,real:!0,forced:!EK("symmetricDifference")},{symmetricDifference:RK});var TK=su,MK=Vs.add,_K=XR,OK=au,PK=ou,IK=function(e){var n=TK(this),i=OK(e).getIterator(),r=_K(n);return PK(i,function(s){MK(r,s)}),r},xK=$n,AK=IK,HK=lu;xK({target:"Set",proto:!0,real:!0,forced:!HK("union")},{union:AK});var NK=iu,DK=gn,LK=function(t){if(NK(t)==="Function")return DK(t)},L1=LK,kK=Rf,$K=Vw,FK=L1(L1.bind),IH=function(t,e){return kK(t),e===void 0?t:$K?FK(t,e):function(){return t.apply(e,arguments)}},VK=kc,xH=VK("document","documentElement"),WK=gn,QR=WK([].slice),BK=TypeError,AH=function(t,e){if(t<e)throw new BK("Not enough arguments");return t},jK=Yw,UK=/(?:ipad|iphone|ipod).*applewebkit/i.test(jK),eh=Ln,YK=Yw,zK=iu,pg=function(t){return YK.slice(0,t.length)===t},HH=function(){return pg("Bun/")?"BUN":pg("Cloudflare-Workers")?"CLOUDFLARE":pg("Deno/")?"DENO":pg("Node.js/")?"NODE":eh.Bun&&typeof Bun.version=="string"?"BUN":eh.Deno&&typeof Deno.version=="object"?"DENO":zK(eh.process)==="process"?"NODE":eh.window&&eh.document?"BROWSER":"REST"}(),GK=HH,KK=GK==="NODE",Wi=Ln,XK=Kw,qK=IH,k1=kn,ZK=$s,NH=Mi,$1=xH,JK=QR,F1=jR,QK=AH,e3=UK,t3=KK,iS=Wi.setImmediate,rS=Wi.clearImmediate,n3=Wi.process,TC=Wi.Dispatch,i3=Wi.Function,V1=Wi.MessageChannel,r3=Wi.String,MC=0,vd={},W1="onreadystatechange",Jd,Ga,_C,OC;NH(function(){Jd=Wi.location});var e0=function(t){if(ZK(vd,t)){var e=vd[t];delete vd[t],e()}},PC=function(t){return function(){e0(t)}},B1=function(t){e0(t.data)},j1=function(t){Wi.postMessage(r3(t),Jd.protocol+"//"+Jd.host)};(!iS||!rS)&&(iS=function(e){QK(arguments.length,1);var n=k1(e)?e:i3(e),i=JK(arguments,1);return vd[++MC]=function(){XK(n,void 0,i)},Ga(MC),MC},rS=function(e){delete vd[e]},t3?Ga=function(t){n3.nextTick(PC(t))}:TC&&TC.now?Ga=function(t){TC.now(PC(t))}:V1&&!e3?(_C=new V1,OC=_C.port2,_C.port1.onmessage=B1,Ga=qK(OC.postMessage,OC)):Wi.addEventListener&&k1(Wi.postMessage)&&!Wi.importScripts&&Jd&&Jd.protocol!=="file:"&&!NH(j1)?(Ga=j1,Wi.addEventListener("message",B1,!1)):W1 in F1("script")?Ga=function(t){$1.appendChild(F1("script"))[W1]=function(){$1.removeChild(this),e0(t)}}:Ga=function(t){setTimeout(PC(t),0)});var DH={set:iS,clear:rS},s3=$n,o3=Ln,U1=DH.clear;s3({global:!0,bind:!0,enumerable:!0,forced:o3.clearImmediate!==U1},{clearImmediate:U1});var LH=Ln,a3=Kw,l3=kn,u3=HH,c3=Yw,h3=QR,d3=AH,f3=LH.Function,g3=/MSIE .\./.test(c3)||u3==="BUN"&&function(){var t=LH.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),m3=function(t,e){var n=e?2:1;return g3?function(i,r){var s=d3(arguments.length,1)>n,o=l3(i)?i:f3(i),a=s?h3(arguments,n):[],l=s?function(){a3(o,this,a)}:o;return e?t(l,r):t(l)}:t},p3=$n,kH=Ln,Y1=DH.set,w3=m3,z1=kH.setImmediate?w3(Y1,!1):Y1;p3({global:!0,bind:!0,enumerable:!0,forced:kH.setImmediate!==z1},{setImmediate:z1});/*! @license DOMPurify 2.5.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.6/LICENSE */function ga(t){"@babel/helpers - typeof";return ga=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ga(t)}function sS(t,e){return sS=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},sS(t,e)}function v3(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tp(t,e,n){return v3()?tp=Reflect.construct:tp=function(r,s,o){var a=[null];a.push.apply(a,s);var l=Function.bind.apply(r,a),u=new l;return o&&sS(u,o.prototype),u},tp.apply(null,arguments)}function Mr(t){return C3(t)||y3(t)||b3(t)||S3()}function C3(t){if(Array.isArray(t))return oS(t)}function y3(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function b3(t,e){if(t){if(typeof t=="string")return oS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oS(t,e)}}function oS(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function S3(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var R3=Object.hasOwnProperty,G1=Object.setPrototypeOf,E3=Object.isFrozen,T3=Object.getPrototypeOf,M3=Object.getOwnPropertyDescriptor,hi=Object.freeze,ur=Object.seal,_3=Object.create,$H=typeof Reflect<"u"&&Reflect,$p=$H.apply,aS=$H.construct;$p||($p=function(e,n,i){return e.apply(n,i)});hi||(hi=function(e){return e});ur||(ur=function(e){return e});aS||(aS=function(e,n){return tp(e,Mr(n))});var O3=cr(Array.prototype.forEach),K1=cr(Array.prototype.pop),th=cr(Array.prototype.push),np=cr(String.prototype.toLowerCase),IC=cr(String.prototype.toString),X1=cr(String.prototype.match),pr=cr(String.prototype.replace),P3=cr(String.prototype.indexOf),I3=cr(String.prototype.trim),An=cr(RegExp.prototype.test),xC=x3(TypeError);function cr(t){return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return $p(t,e,i)}}function x3(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return aS(t,n)}}function Xe(t,e,n){var i;n=(i=n)!==null&&i!==void 0?i:np,G1&&G1(t,null);for(var r=e.length;r--;){var s=e[r];if(typeof s=="string"){var o=n(s);o!==s&&(E3(e)||(e[r]=o),s=o)}t[s]=!0}return t}function Ka(t){var e=_3(null),n;for(n in t)$p(R3,t,[n])===!0&&(e[n]=t[n]);return e}function wg(t,e){for(;t!==null;){var n=M3(t,e);if(n){if(n.get)return cr(n.get);if(typeof n.value=="function")return cr(n.value)}t=T3(t)}function i(r){return console.warn("fallback value for",r),null}return i}var q1=hi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),AC=hi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),HC=hi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),A3=hi(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),NC=hi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),H3=hi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Z1=hi(["#text"]),J1=hi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),DC=hi(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Q1=hi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),vg=hi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),N3=ur(/\{\{[\w\W]*|[\w\W]*\}\}/gm),D3=ur(/<%[\w\W]*|[\w\W]*%>/gm),L3=ur(/\${[\w\W]*}/gm),k3=ur(/^data-[\-\w.\u00B7-\uFFFF]/),$3=ur(/^aria-[\-\w]+$/),F3=ur(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),V3=ur(/^(?:\w+script|data):/i),W3=ur(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),B3=ur(/^html$/i),j3=ur(/^[a-z][.\w]*(-[.\w]+)+$/i),U3=function(){return typeof window>"u"?null:window},Y3=function(e,n){if(ga(e)!=="object"||typeof e.createPolicy!="function")return null;var i=null,r="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(r)&&(i=n.currentScript.getAttribute(r));var s="dompurify"+(i?"#"+i:"");try{return e.createPolicy(s,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function FH(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:U3(),e=function(V){return FH(V)};if(e.version="2.5.6",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,i=t.document,r=t.DocumentFragment,s=t.HTMLTemplateElement,o=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,h=t.HTMLFormElement,d=t.DOMParser,f=t.trustedTypes,m=a.prototype,p=wg(m,"cloneNode"),y=wg(m,"nextSibling"),E=wg(m,"childNodes"),T=wg(m,"parentNode");if(typeof s=="function"){var M=i.createElement("template");M.content&&M.content.ownerDocument&&(i=M.content.ownerDocument)}var P=Y3(f,n),H=P?P.createHTML(""):"",U=i,Y=U.implementation,Q=U.createNodeIterator,q=U.createDocumentFragment,Z=U.getElementsByTagName,te=n.importNode,ue={};try{ue=Ka(i).documentMode?i.documentMode:{}}catch{}var ce={};e.isSupported=typeof T=="function"&&Y&&Y.createHTMLDocument!==void 0&&ue!==9;var Ee=N3,He=D3,Le=L3,be=k3,le=$3,ve=V3,st=W3,g=j3,w=F3,b=null,L=Xe({},[].concat(Mr(q1),Mr(AC),Mr(HC),Mr(NC),Mr(Z1))),k=null,B=Xe({},[].concat(Mr(J1),Mr(DC),Mr(Q1),Mr(vg))),X=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ee=null,ge=null,me=!0,se=!0,ke=!1,O=!0,S=!1,W=!0,K=!1,G=!1,z=!1,J=!1,v=!1,C=!1,R=!0,N=!1,_="user-content-",D=!0,I=!1,x={},F=null,$=Xe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),j=null,re=Xe({},["audio","video","img","source","image","track"]),he=null,Ce=Xe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),$e="http://www.w3.org/1998/Math/MathML",Qe="http://www.w3.org/2000/svg",Ne="http://www.w3.org/1999/xhtml",Oe=Ne,nt=!1,Yt=null,gu=Xe({},[$e,Qe,Ne],IC),mr,Xc=["application/xhtml+xml","text/html"],ji="text/html",Vt,mn=null,In=i.createElement("form"),Dt=function(V){return V instanceof RegExp||V instanceof Function},Gv=function(V){mn&&mn===V||((!V||ga(V)!=="object")&&(V={}),V=Ka(V),mr=Xc.indexOf(V.PARSER_MEDIA_TYPE)===-1?mr=ji:mr=V.PARSER_MEDIA_TYPE,Vt=mr==="application/xhtml+xml"?IC:np,b="ALLOWED_TAGS"in V?Xe({},V.ALLOWED_TAGS,Vt):L,k="ALLOWED_ATTR"in V?Xe({},V.ALLOWED_ATTR,Vt):B,Yt="ALLOWED_NAMESPACES"in V?Xe({},V.ALLOWED_NAMESPACES,IC):gu,he="ADD_URI_SAFE_ATTR"in V?Xe(Ka(Ce),V.ADD_URI_SAFE_ATTR,Vt):Ce,j="ADD_DATA_URI_TAGS"in V?Xe(Ka(re),V.ADD_DATA_URI_TAGS,Vt):re,F="FORBID_CONTENTS"in V?Xe({},V.FORBID_CONTENTS,Vt):$,ee="FORBID_TAGS"in V?Xe({},V.FORBID_TAGS,Vt):{},ge="FORBID_ATTR"in V?Xe({},V.FORBID_ATTR,Vt):{},x="USE_PROFILES"in V?V.USE_PROFILES:!1,me=V.ALLOW_ARIA_ATTR!==!1,se=V.ALLOW_DATA_ATTR!==!1,ke=V.ALLOW_UNKNOWN_PROTOCOLS||!1,O=V.ALLOW_SELF_CLOSE_IN_ATTR!==!1,S=V.SAFE_FOR_TEMPLATES||!1,W=V.SAFE_FOR_XML!==!1,K=V.WHOLE_DOCUMENT||!1,J=V.RETURN_DOM||!1,v=V.RETURN_DOM_FRAGMENT||!1,C=V.RETURN_TRUSTED_TYPE||!1,z=V.FORCE_BODY||!1,R=V.SANITIZE_DOM!==!1,N=V.SANITIZE_NAMED_PROPS||!1,D=V.KEEP_CONTENT!==!1,I=V.IN_PLACE||!1,w=V.ALLOWED_URI_REGEXP||w,Oe=V.NAMESPACE||Ne,X=V.CUSTOM_ELEMENT_HANDLING||{},V.CUSTOM_ELEMENT_HANDLING&&Dt(V.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(X.tagNameCheck=V.CUSTOM_ELEMENT_HANDLING.tagNameCheck),V.CUSTOM_ELEMENT_HANDLING&&Dt(V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(X.attributeNameCheck=V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),V.CUSTOM_ELEMENT_HANDLING&&typeof V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(X.allowCustomizedBuiltInElements=V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),S&&(se=!1),v&&(J=!0),x&&(b=Xe({},Mr(Z1)),k=[],x.html===!0&&(Xe(b,q1),Xe(k,J1)),x.svg===!0&&(Xe(b,AC),Xe(k,DC),Xe(k,vg)),x.svgFilters===!0&&(Xe(b,HC),Xe(k,DC),Xe(k,vg)),x.mathMl===!0&&(Xe(b,NC),Xe(k,Q1),Xe(k,vg))),V.ADD_TAGS&&(b===L&&(b=Ka(b)),Xe(b,V.ADD_TAGS,Vt)),V.ADD_ATTR&&(k===B&&(k=Ka(k)),Xe(k,V.ADD_ATTR,Vt)),V.ADD_URI_SAFE_ATTR&&Xe(he,V.ADD_URI_SAFE_ATTR,Vt),V.FORBID_CONTENTS&&(F===$&&(F=Ka(F)),Xe(F,V.FORBID_CONTENTS,Vt)),D&&(b["#text"]=!0),K&&Xe(b,["html","head","body"]),b.table&&(Xe(b,["tbody"]),delete ee.tbody),hi&&hi(V),mn=V)},NM=Xe({},["mi","mo","mn","ms","mtext"]),DM=Xe({},["foreignobject","annotation-xml"]),k$=Xe({},["title","style","font","a","script"]),Qf=Xe({},AC);Xe(Qf,HC),Xe(Qf,A3);var Kv=Xe({},NC);Xe(Kv,H3);var $$=function(V){var ae=T(V);(!ae||!ae.tagName)&&(ae={namespaceURI:Oe,tagName:"template"});var we=np(V.tagName),ft=np(ae.tagName);return Yt[V.namespaceURI]?V.namespaceURI===Qe?ae.namespaceURI===Ne?we==="svg":ae.namespaceURI===$e?we==="svg"&&(ft==="annotation-xml"||NM[ft]):!!Qf[we]:V.namespaceURI===$e?ae.namespaceURI===Ne?we==="math":ae.namespaceURI===Qe?we==="math"&&DM[ft]:!!Kv[we]:V.namespaceURI===Ne?ae.namespaceURI===Qe&&!DM[ft]||ae.namespaceURI===$e&&!NM[ft]?!1:!Kv[we]&&(k$[we]||!Qf[we]):!!(mr==="application/xhtml+xml"&&Yt[V.namespaceURI]):!1},Ui=function(V){th(e.removed,{element:V});try{V.parentNode.removeChild(V)}catch{try{V.outerHTML=H}catch{V.remove()}}},eg=function(V,ae){try{th(e.removed,{attribute:ae.getAttributeNode(V),from:ae})}catch{th(e.removed,{attribute:null,from:ae})}if(ae.removeAttribute(V),V==="is"&&!k[V])if(J||v)try{Ui(ae)}catch{}else try{ae.setAttribute(V,"")}catch{}},LM=function(V){var ae,we;if(z)V="<remove></remove>"+V;else{var ft=X1(V,/^[\r\n\t ]+/);we=ft&&ft[0]}mr==="application/xhtml+xml"&&Oe===Ne&&(V='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+V+"</body></html>");var fi=P?P.createHTML(V):V;if(Oe===Ne)try{ae=new d().parseFromString(fi,mr)}catch{}if(!ae||!ae.documentElement){ae=Y.createDocument(Oe,"template",null);try{ae.documentElement.innerHTML=nt?H:fi}catch{}}var Vn=ae.body||ae.documentElement;return V&&we&&Vn.insertBefore(i.createTextNode(we),Vn.childNodes[0]||null),Oe===Ne?Z.call(ae,K?"html":"body")[0]:K?ae.documentElement:Vn},kM=function(V){return Q.call(V.ownerDocument||V,V,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null,!1)},$M=function(V){return V instanceof h&&(typeof V.nodeName!="string"||typeof V.textContent!="string"||typeof V.removeChild!="function"||!(V.attributes instanceof c)||typeof V.removeAttribute!="function"||typeof V.setAttribute!="function"||typeof V.namespaceURI!="string"||typeof V.insertBefore!="function"||typeof V.hasChildNodes!="function")},qc=function(V){return ga(o)==="object"?V instanceof o:V&&ga(V)==="object"&&typeof V.nodeType=="number"&&typeof V.nodeName=="string"},Us=function(V,ae,we){ce[V]&&O3(ce[V],function(ft){ft.call(e,ae,we,mn)})},FM=function(V){var ae;if(Us("beforeSanitizeElements",V,null),$M(V)||An(/[\u0080-\uFFFF]/,V.nodeName))return Ui(V),!0;var we=Vt(V.nodeName);if(Us("uponSanitizeElement",V,{tagName:we,allowedTags:b}),V.hasChildNodes()&&!qc(V.firstElementChild)&&(!qc(V.content)||!qc(V.content.firstElementChild))&&An(/<[/\w]/g,V.innerHTML)&&An(/<[/\w]/g,V.textContent)||we==="select"&&An(/<template/i,V.innerHTML)||V.nodeType===7||W&&V.nodeType===8&&An(/<[/\w]/g,V.data))return Ui(V),!0;if(!b[we]||ee[we]){if(!ee[we]&&WM(we)&&(X.tagNameCheck instanceof RegExp&&An(X.tagNameCheck,we)||X.tagNameCheck instanceof Function&&X.tagNameCheck(we)))return!1;if(D&&!F[we]){var ft=T(V)||V.parentNode,fi=E(V)||V.childNodes;if(fi&&ft)for(var Vn=fi.length,xn=Vn-1;xn>=0;--xn){var ja=p(fi[xn],!0);ja.__removalCount=(V.__removalCount||0)+1,ft.insertBefore(ja,y(V))}}return Ui(V),!0}return V instanceof a&&!$$(V)||(we==="noscript"||we==="noembed"||we==="noframes")&&An(/<\/no(script|embed|frames)/i,V.innerHTML)?(Ui(V),!0):(S&&V.nodeType===3&&(ae=V.textContent,ae=pr(ae,Ee," "),ae=pr(ae,He," "),ae=pr(ae,Le," "),V.textContent!==ae&&(th(e.removed,{element:V.cloneNode()}),V.textContent=ae)),Us("afterSanitizeElements",V,null),!1)},VM=function(V,ae,we){if(R&&(ae==="id"||ae==="name")&&(we in i||we in In))return!1;if(!(se&&!ge[ae]&&An(be,ae))){if(!(me&&An(le,ae))){if(!k[ae]||ge[ae]){if(!(WM(V)&&(X.tagNameCheck instanceof RegExp&&An(X.tagNameCheck,V)||X.tagNameCheck instanceof Function&&X.tagNameCheck(V))&&(X.attributeNameCheck instanceof RegExp&&An(X.attributeNameCheck,ae)||X.attributeNameCheck instanceof Function&&X.attributeNameCheck(ae))||ae==="is"&&X.allowCustomizedBuiltInElements&&(X.tagNameCheck instanceof RegExp&&An(X.tagNameCheck,we)||X.tagNameCheck instanceof Function&&X.tagNameCheck(we))))return!1}else if(!he[ae]){if(!An(w,pr(we,st,""))){if(!((ae==="src"||ae==="xlink:href"||ae==="href")&&V!=="script"&&P3(we,"data:")===0&&j[V])){if(!(ke&&!An(ve,pr(we,st,"")))){if(we)return!1}}}}}}return!0},WM=function(V){return V!=="annotation-xml"&&X1(V,g)},BM=function(V){var ae,we,ft,fi;Us("beforeSanitizeAttributes",V,null);var Vn=V.attributes;if(Vn){var xn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:k};for(fi=Vn.length;fi--;){ae=Vn[fi];var ja=ae,pn=ja.name,Xv=ja.namespaceURI;if(we=pn==="value"?ae.value:I3(ae.value),ft=Vt(pn),xn.attrName=ft,xn.attrValue=we,xn.keepAttr=!0,xn.forceKeepAttr=void 0,Us("uponSanitizeAttribute",V,xn),we=xn.attrValue,W&&An(/((--!?|])>)|<\/(style|title)/i,we)){eg(pn,V);continue}if(!xn.forceKeepAttr&&(eg(pn,V),!!xn.keepAttr)){if(!O&&An(/\/>/i,we)){eg(pn,V);continue}S&&(we=pr(we,Ee," "),we=pr(we,He," "),we=pr(we,Le," "));var jM=Vt(V.nodeName);if(VM(jM,ft,we)){if(N&&(ft==="id"||ft==="name")&&(eg(pn,V),we=_+we),P&&ga(f)==="object"&&typeof f.getAttributeType=="function"&&!Xv)switch(f.getAttributeType(jM,ft)){case"TrustedHTML":{we=P.createHTML(we);break}case"TrustedScriptURL":{we=P.createScriptURL(we);break}}try{Xv?V.setAttributeNS(Xv,pn,we):V.setAttribute(pn,we),$M(V)?Ui(V):K1(e.removed)}catch{}}}}Us("afterSanitizeAttributes",V,null)}},F$=function Ie(V){var ae,we=kM(V);for(Us("beforeSanitizeShadowDOM",V,null);ae=we.nextNode();)Us("uponSanitizeShadowNode",ae,null),!FM(ae)&&(ae.content instanceof r&&Ie(ae.content),BM(ae));Us("afterSanitizeShadowDOM",V,null)};return e.sanitize=function(Ie){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae,we,ft,fi,Vn;if(nt=!Ie,nt&&(Ie="<!-->"),typeof Ie!="string"&&!qc(Ie))if(typeof Ie.toString=="function"){if(Ie=Ie.toString(),typeof Ie!="string")throw xC("dirty is not a string, aborting")}else throw xC("toString is not a function");if(!e.isSupported){if(ga(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Ie=="string")return t.toStaticHTML(Ie);if(qc(Ie))return t.toStaticHTML(Ie.outerHTML)}return Ie}if(G||Gv(V),e.removed=[],typeof Ie=="string"&&(I=!1),I){if(Ie.nodeName){var xn=Vt(Ie.nodeName);if(!b[xn]||ee[xn])throw xC("root node is forbidden and cannot be sanitized in-place")}}else if(Ie instanceof o)ae=LM("<!---->"),we=ae.ownerDocument.importNode(Ie,!0),we.nodeType===1&&we.nodeName==="BODY"||we.nodeName==="HTML"?ae=we:ae.appendChild(we);else{if(!J&&!S&&!K&&Ie.indexOf("<")===-1)return P&&C?P.createHTML(Ie):Ie;if(ae=LM(Ie),!ae)return J?null:C?H:""}ae&&z&&Ui(ae.firstChild);for(var ja=kM(I?Ie:ae);ft=ja.nextNode();)ft.nodeType===3&&ft===fi||FM(ft)||(ft.content instanceof r&&F$(ft.content),BM(ft),fi=ft);if(fi=null,I)return Ie;if(J){if(v)for(Vn=q.call(ae.ownerDocument);ae.firstChild;)Vn.appendChild(ae.firstChild);else Vn=ae;return(k.shadowroot||k.shadowrootmod)&&(Vn=te.call(n,Vn,!0)),Vn}var pn=K?ae.outerHTML:ae.innerHTML;return K&&b["!doctype"]&&ae.ownerDocument&&ae.ownerDocument.doctype&&ae.ownerDocument.doctype.name&&An(B3,ae.ownerDocument.doctype.name)&&(pn="<!DOCTYPE "+ae.ownerDocument.doctype.name+`>
`+pn),S&&(pn=pr(pn,Ee," "),pn=pr(pn,He," "),pn=pr(pn,Le," ")),P&&C?P.createHTML(pn):pn},e.setConfig=function(Ie){Gv(Ie),G=!0},e.clearConfig=function(){mn=null,G=!1},e.isValidAttribute=function(Ie,V,ae){mn||Gv({});var we=Vt(Ie),ft=Vt(V);return VM(we,ft,ae)},e.addHook=function(Ie,V){typeof V=="function"&&(ce[Ie]=ce[Ie]||[],th(ce[Ie],V))},e.removeHook=function(Ie){if(ce[Ie])return K1(ce[Ie])},e.removeHooks=function(Ie){ce[Ie]&&(ce[Ie]=[])},e.removeAllHooks=function(){ce={}},e}var z3=FH();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var VH;function ne(){return VH.apply(null,arguments)}function G3(t){VH=t}function Vr(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Ul(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function ht(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function t0(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(ht(t,e))return!1;return!0}function Ci(t){return t===void 0}function xo(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function xf(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function WH(t,e){var n=[],i,r=t.length;for(i=0;i<r;++i)n.push(e(t[i],i));return n}function Ca(t,e){for(var n in e)ht(e,n)&&(t[n]=e[n]);return ht(e,"toString")&&(t.toString=e.toString),ht(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Ws(t,e,n,i){return cN(t,e,n,i,!0).utc()}function K3(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ge(t){return t._pf==null&&(t._pf=K3()),t._pf}var lS;Array.prototype.some?lS=Array.prototype.some:lS=function(t){var e=Object(this),n=e.length>>>0,i;for(i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function n0(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=Ge(t),n=lS.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function qw(t){var e=Ws(NaN);return t!=null?Ca(Ge(e),t):Ge(e).userInvalidated=!0,e}var eO=ne.momentProperties=[],LC=!1;function i0(t,e){var n,i,r,s=eO.length;if(Ci(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Ci(e._i)||(t._i=e._i),Ci(e._f)||(t._f=e._f),Ci(e._l)||(t._l=e._l),Ci(e._strict)||(t._strict=e._strict),Ci(e._tzm)||(t._tzm=e._tzm),Ci(e._isUTC)||(t._isUTC=e._isUTC),Ci(e._offset)||(t._offset=e._offset),Ci(e._pf)||(t._pf=Ge(e)),Ci(e._locale)||(t._locale=e._locale),s>0)for(n=0;n<s;n++)i=eO[n],r=e[i],Ci(r)||(t[i]=r);return t}function Af(t){i0(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),LC===!1&&(LC=!0,ne.updateOffset(this),LC=!1)}function Wr(t){return t instanceof Af||t!=null&&t._isAMomentObject!=null}function BH(t){ne.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function dr(t,e){var n=!0;return Ca(function(){if(ne.deprecationHandler!=null&&ne.deprecationHandler(null,t),n){var i=[],r,s,o,a=arguments.length;for(s=0;s<a;s++){if(r="",typeof arguments[s]=="object"){r+=`
[`+s+"] ";for(o in arguments[0])ht(arguments[0],o)&&(r+=o+": "+arguments[0][o]+", ");r=r.slice(0,-2)}else r=arguments[s];i.push(r)}BH(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var tO={};function jH(t,e){ne.deprecationHandler!=null&&ne.deprecationHandler(t,e),tO[t]||(BH(e),tO[t]=!0)}ne.suppressDeprecationWarnings=!1;ne.deprecationHandler=null;function Bs(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function X3(t){var e,n;for(n in t)ht(t,n)&&(e=t[n],Bs(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function uS(t,e){var n=Ca({},t),i;for(i in e)ht(e,i)&&(Ul(t[i])&&Ul(e[i])?(n[i]={},Ca(n[i],t[i]),Ca(n[i],e[i])):e[i]!=null?n[i]=e[i]:delete n[i]);for(i in t)ht(t,i)&&!ht(e,i)&&Ul(t[i])&&(n[i]=Ca({},n[i]));return n}function r0(t){t!=null&&this.set(t)}var cS;Object.keys?cS=Object.keys:cS=function(t){var e,n=[];for(e in t)ht(t,e)&&n.push(e);return n};var q3={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Z3(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return Bs(i)?i.call(e,n):i}function Ls(t,e,n){var i=""+Math.abs(t),r=e-i.length,s=t>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var s0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Cg=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,kC={},Cc={};function Ae(t,e,n,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),t&&(Cc[t]=r),e&&(Cc[e[0]]=function(){return Ls(r.apply(this,arguments),e[1],e[2])}),n&&(Cc[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function J3(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Q3(t){var e=t.match(s0),n,i;for(n=0,i=e.length;n<i;n++)Cc[e[n]]?e[n]=Cc[e[n]]:e[n]=J3(e[n]);return function(r){var s="",o;for(o=0;o<i;o++)s+=Bs(e[o])?e[o].call(r,t):e[o];return s}}function ip(t,e){return t.isValid()?(e=UH(e,t.localeData()),kC[e]=kC[e]||Q3(e),kC[e](t)):t.localeData().invalidDate()}function UH(t,e){var n=5;function i(r){return e.longDateFormat(r)||r}for(Cg.lastIndex=0;n>=0&&Cg.test(t);)t=t.replace(Cg,i),Cg.lastIndex=0,n-=1;return t}var e4={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function t4(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(s0).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var n4="Invalid date";function i4(){return this._invalidDate}var r4="%d",s4=/\d{1,2}/;function o4(t){return this._ordinal.replace("%d",t)}var a4={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function l4(t,e,n,i){var r=this._relativeTime[n];return Bs(r)?r(t,e,n,i):r.replace(/%d/i,t)}function u4(t,e){var n=this._relativeTime[t>0?"future":"past"];return Bs(n)?n(e):n.replace(/%s/i,e)}var nO={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function fr(t){return typeof t=="string"?nO[t]||nO[t.toLowerCase()]:void 0}function o0(t){var e={},n,i;for(i in t)ht(t,i)&&(n=fr(i),n&&(e[n]=t[i]));return e}var c4={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function h4(t){var e=[],n;for(n in t)ht(t,n)&&e.push({unit:n,priority:c4[n]});return e.sort(function(i,r){return i.priority-r.priority}),e}var YH=/\d/,Bi=/\d\d/,zH=/\d{3}/,a0=/\d{4}/,Zw=/[+-]?\d{6}/,Ft=/\d\d?/,GH=/\d\d\d\d?/,KH=/\d\d\d\d\d\d?/,Jw=/\d{1,3}/,l0=/\d{1,4}/,Qw=/[+-]?\d{1,6}/,$c=/\d+/,ev=/[+-]?\d+/,d4=/Z|[+-]\d\d:?\d\d/gi,tv=/Z|[+-]\d\d(?::?\d\d)?/gi,f4=/[+-]?\d+(\.\d{1,3})?/,Hf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Fc=/^[1-9]\d?/,u0=/^([1-9]\d|\d)/,Fp;Fp={};function Re(t,e,n){Fp[t]=Bs(e)?e:function(i,r){return i&&n?n:e}}function g4(t,e){return ht(Fp,t)?Fp[t](e._strict,e._locale):new RegExp(m4(t))}function m4(t){return Oo(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,i,r,s){return n||i||r||s}))}function Oo(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function rr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function it(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=rr(e)),n}var hS={};function _t(t,e){var n,i=e,r;for(typeof t=="string"&&(t=[t]),xo(e)&&(i=function(s,o){o[e]=it(s)}),r=t.length,n=0;n<r;n++)hS[t[n]]=i}function Nf(t,e){_t(t,function(n,i,r,s){r._w=r._w||{},e(n,r._w,r,s)})}function p4(t,e,n){e!=null&&ht(hS,t)&&hS[t](e,n._a,n,t)}function nv(t){return t%4===0&&t%100!==0||t%400===0}var Xn=0,Co=1,Ms=2,Sn=3,Dr=4,yo=5,Nl=6,w4=7,v4=8;Ae("Y",0,0,function(){var t=this.year();return t<=9999?Ls(t,4):"+"+t});Ae(0,["YY",2],0,function(){return this.year()%100});Ae(0,["YYYY",4],0,"year");Ae(0,["YYYYY",5],0,"year");Ae(0,["YYYYYY",6,!0],0,"year");Re("Y",ev);Re("YY",Ft,Bi);Re("YYYY",l0,a0);Re("YYYYY",Qw,Zw);Re("YYYYYY",Qw,Zw);_t(["YYYYY","YYYYYY"],Xn);_t("YYYY",function(t,e){e[Xn]=t.length===2?ne.parseTwoDigitYear(t):it(t)});_t("YY",function(t,e){e[Xn]=ne.parseTwoDigitYear(t)});_t("Y",function(t,e){e[Xn]=parseInt(t,10)});function Cd(t){return nv(t)?366:365}ne.parseTwoDigitYear=function(t){return it(t)+(it(t)>68?1900:2e3)};var XH=Vc("FullYear",!0);function C4(){return nv(this.year())}function Vc(t,e){return function(n){return n!=null?(qH(this,t,n),ne.updateOffset(this,e),this):Qd(this,t)}}function Qd(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function qH(t,e,n){var i,r,s,o,a;if(!(!t.isValid()||isNaN(n))){switch(i=t._d,r=t._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(r?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(r?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(r?i.setUTCHours(n):i.setHours(n));case"Date":return void(r?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}s=n,o=t.month(),a=t.date(),a=a===29&&o===1&&!nv(s)?28:a,r?i.setUTCFullYear(s,o,a):i.setFullYear(s,o,a)}}function y4(t){return t=fr(t),Bs(this[t])?this[t]():this}function b4(t,e){if(typeof t=="object"){t=o0(t);var n=h4(t),i,r=n.length;for(i=0;i<r;i++)this[n[i].unit](t[n[i].unit])}else if(t=fr(t),Bs(this[t]))return this[t](e);return this}function S4(t,e){return(t%e+e)%e}var an;Array.prototype.indexOf?an=Array.prototype.indexOf:an=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function c0(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=S4(e,12);return t+=(e-n)/12,n===1?nv(t)?29:28:31-n%7%2}Ae("M",["MM",2],"Mo",function(){return this.month()+1});Ae("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ae("MMMM",0,0,function(t){return this.localeData().months(this,t)});Re("M",Ft,Fc);Re("MM",Ft,Bi);Re("MMM",function(t,e){return e.monthsShortRegex(t)});Re("MMMM",function(t,e){return e.monthsRegex(t)});_t(["M","MM"],function(t,e){e[Co]=it(t)-1});_t(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);r!=null?e[Co]=r:Ge(n).invalidMonth=t});var R4="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ZH="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),JH=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,E4=Hf,T4=Hf;function M4(t,e){return t?Vr(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||JH).test(e)?"format":"standalone"][t.month()]:Vr(this._months)?this._months:this._months.standalone}function _4(t,e){return t?Vr(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[JH.test(e)?"format":"standalone"][t.month()]:Vr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function O4(t,e,n){var i,r,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)s=Ws([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(s,"").toLocaleLowerCase();return n?e==="MMM"?(r=an.call(this._shortMonthsParse,o),r!==-1?r:null):(r=an.call(this._longMonthsParse,o),r!==-1?r:null):e==="MMM"?(r=an.call(this._shortMonthsParse,o),r!==-1?r:(r=an.call(this._longMonthsParse,o),r!==-1?r:null)):(r=an.call(this._longMonthsParse,o),r!==-1?r:(r=an.call(this._shortMonthsParse,o),r!==-1?r:null))}function P4(t,e,n){var i,r,s;if(this._monthsParseExact)return O4.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=Ws([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(s="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(s.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(n&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function QH(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=it(e);else if(e=t.localeData().monthsParse(e),!xo(e))return t}var n=e,i=t.date();return i=i<29?i:Math.min(i,c0(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function eN(t){return t!=null?(QH(this,t),ne.updateOffset(this,!0),this):Qd(this,"Month")}function I4(){return c0(this.year(),this.month())}function x4(t){return this._monthsParseExact?(ht(this,"_monthsRegex")||tN.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(ht(this,"_monthsShortRegex")||(this._monthsShortRegex=E4),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function A4(t){return this._monthsParseExact?(ht(this,"_monthsRegex")||tN.call(this),t?this._monthsStrictRegex:this._monthsRegex):(ht(this,"_monthsRegex")||(this._monthsRegex=T4),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function tN(){function t(l,u){return u.length-l.length}var e=[],n=[],i=[],r,s,o,a;for(r=0;r<12;r++)s=Ws([2e3,r]),o=Oo(this.monthsShort(s,"")),a=Oo(this.months(s,"")),e.push(o),n.push(a),i.push(a),i.push(o);e.sort(t),n.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function H4(t,e,n,i,r,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,i,r,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,i,r,s,o),a}function ef(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Vp(t,e,n){var i=7+e-n,r=(7+ef(t,0,i).getUTCDay()-e)%7;return-r+i-1}function nN(t,e,n,i,r){var s=(7+n-i)%7,o=Vp(t,i,r),a=1+7*(e-1)+s+o,l,u;return a<=0?(l=t-1,u=Cd(l)+a):a>Cd(t)?(l=t+1,u=a-Cd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function tf(t,e,n){var i=Vp(t.year(),e,n),r=Math.floor((t.dayOfYear()-i-1)/7)+1,s,o;return r<1?(o=t.year()-1,s=r+Po(o,e,n)):r>Po(t.year(),e,n)?(s=r-Po(t.year(),e,n),o=t.year()+1):(o=t.year(),s=r),{week:s,year:o}}function Po(t,e,n){var i=Vp(t,e,n),r=Vp(t+1,e,n);return(Cd(t)-i+r)/7}Ae("w",["ww",2],"wo","week");Ae("W",["WW",2],"Wo","isoWeek");Re("w",Ft,Fc);Re("ww",Ft,Bi);Re("W",Ft,Fc);Re("WW",Ft,Bi);Nf(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=it(t)});function N4(t){return tf(t,this._week.dow,this._week.doy).week}var D4={dow:0,doy:6};function L4(){return this._week.dow}function k4(){return this._week.doy}function $4(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function F4(t){var e=tf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ae("d",0,"do","day");Ae("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ae("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ae("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ae("e",0,0,"weekday");Ae("E",0,0,"isoWeekday");Re("d",Ft);Re("e",Ft);Re("E",Ft);Re("dd",function(t,e){return e.weekdaysMinRegex(t)});Re("ddd",function(t,e){return e.weekdaysShortRegex(t)});Re("dddd",function(t,e){return e.weekdaysRegex(t)});Nf(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);r!=null?e.d=r:Ge(n).invalidWeekday=t});Nf(["d","e","E"],function(t,e,n,i){e[i]=it(t)});function V4(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function W4(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function h0(t,e){return t.slice(e,7).concat(t.slice(0,e))}var B4="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),iN="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),j4="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),U4=Hf,Y4=Hf,z4=Hf;function G4(t,e){var n=Vr(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?h0(n,this._week.dow):t?n[t.day()]:n}function K4(t){return t===!0?h0(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function X4(t){return t===!0?h0(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function q4(t,e,n){var i,r,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)s=Ws([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(s,"").toLocaleLowerCase();return n?e==="dddd"?(r=an.call(this._weekdaysParse,o),r!==-1?r:null):e==="ddd"?(r=an.call(this._shortWeekdaysParse,o),r!==-1?r:null):(r=an.call(this._minWeekdaysParse,o),r!==-1?r:null):e==="dddd"?(r=an.call(this._weekdaysParse,o),r!==-1||(r=an.call(this._shortWeekdaysParse,o),r!==-1)?r:(r=an.call(this._minWeekdaysParse,o),r!==-1?r:null)):e==="ddd"?(r=an.call(this._shortWeekdaysParse,o),r!==-1||(r=an.call(this._weekdaysParse,o),r!==-1)?r:(r=an.call(this._minWeekdaysParse,o),r!==-1?r:null)):(r=an.call(this._minWeekdaysParse,o),r!==-1||(r=an.call(this._weekdaysParse,o),r!==-1)?r:(r=an.call(this._shortWeekdaysParse,o),r!==-1?r:null))}function Z4(t,e,n){var i,r,s;if(this._weekdaysParseExact)return q4.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=Ws([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(s="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(s.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(n&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(n&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function J4(t){if(!this.isValid())return t!=null?this:NaN;var e=Qd(this,"Day");return t!=null?(t=V4(t,this.localeData()),this.add(t-e,"d")):e}function Q4(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function e6(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=W4(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function t6(t){return this._weekdaysParseExact?(ht(this,"_weekdaysRegex")||d0.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(ht(this,"_weekdaysRegex")||(this._weekdaysRegex=U4),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function n6(t){return this._weekdaysParseExact?(ht(this,"_weekdaysRegex")||d0.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(ht(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Y4),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function i6(t){return this._weekdaysParseExact?(ht(this,"_weekdaysRegex")||d0.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(ht(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=z4),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function d0(){function t(c,h){return h.length-c.length}var e=[],n=[],i=[],r=[],s,o,a,l,u;for(s=0;s<7;s++)o=Ws([2e3,1]).day(s),a=Oo(this.weekdaysMin(o,"")),l=Oo(this.weekdaysShort(o,"")),u=Oo(this.weekdays(o,"")),e.push(a),n.push(l),i.push(u),r.push(a),r.push(l),r.push(u);e.sort(t),n.sort(t),i.sort(t),r.sort(t),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function f0(){return this.hours()%12||12}function r6(){return this.hours()||24}Ae("H",["HH",2],0,"hour");Ae("h",["hh",2],0,f0);Ae("k",["kk",2],0,r6);Ae("hmm",0,0,function(){return""+f0.apply(this)+Ls(this.minutes(),2)});Ae("hmmss",0,0,function(){return""+f0.apply(this)+Ls(this.minutes(),2)+Ls(this.seconds(),2)});Ae("Hmm",0,0,function(){return""+this.hours()+Ls(this.minutes(),2)});Ae("Hmmss",0,0,function(){return""+this.hours()+Ls(this.minutes(),2)+Ls(this.seconds(),2)});function rN(t,e){Ae(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}rN("a",!0);rN("A",!1);function sN(t,e){return e._meridiemParse}Re("a",sN);Re("A",sN);Re("H",Ft,u0);Re("h",Ft,Fc);Re("k",Ft,Fc);Re("HH",Ft,Bi);Re("hh",Ft,Bi);Re("kk",Ft,Bi);Re("hmm",GH);Re("hmmss",KH);Re("Hmm",GH);Re("Hmmss",KH);_t(["H","HH"],Sn);_t(["k","kk"],function(t,e,n){var i=it(t);e[Sn]=i===24?0:i});_t(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});_t(["h","hh"],function(t,e,n){e[Sn]=it(t),Ge(n).bigHour=!0});_t("hmm",function(t,e,n){var i=t.length-2;e[Sn]=it(t.substr(0,i)),e[Dr]=it(t.substr(i)),Ge(n).bigHour=!0});_t("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[Sn]=it(t.substr(0,i)),e[Dr]=it(t.substr(i,2)),e[yo]=it(t.substr(r)),Ge(n).bigHour=!0});_t("Hmm",function(t,e,n){var i=t.length-2;e[Sn]=it(t.substr(0,i)),e[Dr]=it(t.substr(i))});_t("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[Sn]=it(t.substr(0,i)),e[Dr]=it(t.substr(i,2)),e[yo]=it(t.substr(r))});function s6(t){return(t+"").toLowerCase().charAt(0)==="p"}var o6=/[ap]\.?m?\.?/i,a6=Vc("Hours",!0);function l6(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var oN={calendar:q3,longDateFormat:e4,invalidDate:n4,ordinal:r4,dayOfMonthOrdinalParse:s4,relativeTime:a4,months:R4,monthsShort:ZH,week:D4,weekdays:B4,weekdaysMin:j4,weekdaysShort:iN,meridiemParse:o6},jt={},nh={},nf;function u6(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function iO(t){return t&&t.toLowerCase().replace("_","-")}function c6(t){for(var e=0,n,i,r,s;e<t.length;){for(s=iO(t[e]).split("-"),n=s.length,i=iO(t[e+1]),i=i?i.split("-"):null;n>0;){if(r=iv(s.slice(0,n).join("-")),r)return r;if(i&&i.length>=n&&u6(s,i)>=n-1)break;n--}e++}return nf}function h6(t){return!!(t&&t.match("^[^/\\\\]*$"))}function iv(t){var e=null,n;if(jt[t]===void 0&&typeof Mp<"u"&&Mp&&Mp.exports&&h6(t))try{e=nf._abbr,n=require,n("./locale/"+t),Ta(e)}catch{jt[t]=null}return jt[t]}function Ta(t,e){var n;return t&&(Ci(e)?n=$o(t):n=g0(t,e),n?nf=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),nf._abbr}function g0(t,e){if(e!==null){var n,i=oN;if(e.abbr=t,jt[t]!=null)jH("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=jt[t]._config;else if(e.parentLocale!=null)if(jt[e.parentLocale]!=null)i=jt[e.parentLocale]._config;else if(n=iv(e.parentLocale),n!=null)i=n._config;else return nh[e.parentLocale]||(nh[e.parentLocale]=[]),nh[e.parentLocale].push({name:t,config:e}),null;return jt[t]=new r0(uS(i,e)),nh[t]&&nh[t].forEach(function(r){g0(r.name,r.config)}),Ta(t),jt[t]}else return delete jt[t],null}function d6(t,e){if(e!=null){var n,i,r=oN;jt[t]!=null&&jt[t].parentLocale!=null?jt[t].set(uS(jt[t]._config,e)):(i=iv(t),i!=null&&(r=i._config),e=uS(r,e),i==null&&(e.abbr=t),n=new r0(e),n.parentLocale=jt[t],jt[t]=n),Ta(t)}else jt[t]!=null&&(jt[t].parentLocale!=null?(jt[t]=jt[t].parentLocale,t===Ta()&&Ta(t)):jt[t]!=null&&delete jt[t]);return jt[t]}function $o(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return nf;if(!Vr(t)){if(e=iv(t),e)return e;t=[t]}return c6(t)}function f6(){return cS(jt)}function m0(t){var e,n=t._a;return n&&Ge(t).overflow===-2&&(e=n[Co]<0||n[Co]>11?Co:n[Ms]<1||n[Ms]>c0(n[Xn],n[Co])?Ms:n[Sn]<0||n[Sn]>24||n[Sn]===24&&(n[Dr]!==0||n[yo]!==0||n[Nl]!==0)?Sn:n[Dr]<0||n[Dr]>59?Dr:n[yo]<0||n[yo]>59?yo:n[Nl]<0||n[Nl]>999?Nl:-1,Ge(t)._overflowDayOfYear&&(e<Xn||e>Ms)&&(e=Ms),Ge(t)._overflowWeeks&&e===-1&&(e=w4),Ge(t)._overflowWeekday&&e===-1&&(e=v4),Ge(t).overflow=e),t}var g6=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,m6=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,p6=/Z|[+-]\d\d(?::?\d\d)?/,yg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],$C=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],w6=/^\/?Date\((-?\d+)/i,v6=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,C6={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function aN(t){var e,n,i=t._i,r=g6.exec(i)||m6.exec(i),s,o,a,l,u=yg.length,c=$C.length;if(r){for(Ge(t).iso=!0,e=0,n=u;e<n;e++)if(yg[e][1].exec(r[1])){o=yg[e][0],s=yg[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(r[3]){for(e=0,n=c;e<n;e++)if($C[e][1].exec(r[3])){a=(r[2]||" ")+$C[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(r[4])if(p6.exec(r[4]))l="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(l||""),w0(t)}else t._isValid=!1}function y6(t,e,n,i,r,s){var o=[b6(t),ZH.indexOf(e),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return s&&o.push(parseInt(s,10)),o}function b6(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function S6(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function R6(t,e,n){if(t){var i=iN.indexOf(t),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return Ge(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function E6(t,e,n){if(t)return C6[t];if(e)return 0;var i=parseInt(n,10),r=i%100,s=(i-r)/100;return s*60+r}function lN(t){var e=v6.exec(S6(t._i)),n;if(e){if(n=y6(e[4],e[3],e[2],e[5],e[6],e[7]),!R6(e[1],n,t))return;t._a=n,t._tzm=E6(e[8],e[9],e[10]),t._d=ef.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ge(t).rfc2822=!0}else t._isValid=!1}function T6(t){var e=w6.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(aN(t),t._isValid===!1)delete t._isValid;else return;if(lN(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:ne.createFromInputFallback(t)}ne.createFromInputFallback=dr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function ic(t,e,n){return t??e??n}function M6(t){var e=new Date(ne.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function p0(t){var e,n,i=[],r,s,o;if(!t._d){for(r=M6(t),t._w&&t._a[Ms]==null&&t._a[Co]==null&&_6(t),t._dayOfYear!=null&&(o=ic(t._a[Xn],r[Xn]),(t._dayOfYear>Cd(o)||t._dayOfYear===0)&&(Ge(t)._overflowDayOfYear=!0),n=ef(o,0,t._dayOfYear),t._a[Co]=n.getUTCMonth(),t._a[Ms]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=r[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Sn]===24&&t._a[Dr]===0&&t._a[yo]===0&&t._a[Nl]===0&&(t._nextDay=!0,t._a[Sn]=0),t._d=(t._useUTC?ef:H4).apply(null,i),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Sn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(Ge(t).weekdayMismatch=!0)}}function _6(t){var e,n,i,r,s,o,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,n=ic(e.GG,t._a[Xn],tf($t(),1,4).year),i=ic(e.W,1),r=ic(e.E,1),(r<1||r>7)&&(l=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,u=tf($t(),s,o),n=ic(e.gg,t._a[Xn],u.year),i=ic(e.w,u.week),e.d!=null?(r=e.d,(r<0||r>6)&&(l=!0)):e.e!=null?(r=e.e+s,(e.e<0||e.e>6)&&(l=!0)):r=s),i<1||i>Po(n,s,o)?Ge(t)._overflowWeeks=!0:l!=null?Ge(t)._overflowWeekday=!0:(a=nN(n,i,r,s,o),t._a[Xn]=a.year,t._dayOfYear=a.dayOfYear)}ne.ISO_8601=function(){};ne.RFC_2822=function(){};function w0(t){if(t._f===ne.ISO_8601){aN(t);return}if(t._f===ne.RFC_2822){lN(t);return}t._a=[],Ge(t).empty=!0;var e=""+t._i,n,i,r,s,o,a=e.length,l=0,u,c;for(r=UH(t._f,t._locale).match(s0)||[],c=r.length,n=0;n<c;n++)s=r[n],i=(e.match(g4(s,t))||[])[0],i&&(o=e.substr(0,e.indexOf(i)),o.length>0&&Ge(t).unusedInput.push(o),e=e.slice(e.indexOf(i)+i.length),l+=i.length),Cc[s]?(i?Ge(t).empty=!1:Ge(t).unusedTokens.push(s),p4(s,i,t)):t._strict&&!i&&Ge(t).unusedTokens.push(s);Ge(t).charsLeftOver=a-l,e.length>0&&Ge(t).unusedInput.push(e),t._a[Sn]<=12&&Ge(t).bigHour===!0&&t._a[Sn]>0&&(Ge(t).bigHour=void 0),Ge(t).parsedDateParts=t._a.slice(0),Ge(t).meridiem=t._meridiem,t._a[Sn]=O6(t._locale,t._a[Sn],t._meridiem),u=Ge(t).era,u!==null&&(t._a[Xn]=t._locale.erasConvertYear(u,t._a[Xn])),p0(t),m0(t)}function O6(t,e,n){var i;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(i=t.isPM(n),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function P6(t){var e,n,i,r,s,o,a=!1,l=t._f.length;if(l===0){Ge(t).invalidFormat=!0,t._d=new Date(NaN);return}for(r=0;r<l;r++)s=0,o=!1,e=i0({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[r],w0(e),n0(e)&&(o=!0),s+=Ge(e).charsLeftOver,s+=Ge(e).unusedTokens.length*10,Ge(e).score=s,a?s<i&&(i=s,n=e):(i==null||s<i||o)&&(i=s,n=e,o&&(a=!0));Ca(t,n||e)}function I6(t){if(!t._d){var e=o0(t._i),n=e.day===void 0?e.date:e.day;t._a=WH([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),p0(t)}}function x6(t){var e=new Af(m0(uN(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function uN(t){var e=t._i,n=t._f;return t._locale=t._locale||$o(t._l),e===null||n===void 0&&e===""?qw({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Wr(e)?new Af(m0(e)):(xf(e)?t._d=e:Vr(n)?P6(t):n?w0(t):A6(t),n0(t)||(t._d=null),t))}function A6(t){var e=t._i;Ci(e)?t._d=new Date(ne.now()):xf(e)?t._d=new Date(e.valueOf()):typeof e=="string"?T6(t):Vr(e)?(t._a=WH(e.slice(0),function(n){return parseInt(n,10)}),p0(t)):Ul(e)?I6(t):xo(e)?t._d=new Date(e):ne.createFromInputFallback(t)}function cN(t,e,n,i,r){var s={};return(e===!0||e===!1)&&(i=e,e=void 0),(n===!0||n===!1)&&(i=n,n=void 0),(Ul(t)&&t0(t)||Vr(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=r,s._l=n,s._i=t,s._f=e,s._strict=i,x6(s)}function $t(t,e,n,i){return cN(t,e,n,i,!1)}var H6=dr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=$t.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:qw()}),N6=dr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=$t.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:qw()});function hN(t,e){var n,i;if(e.length===1&&Vr(e[0])&&(e=e[0]),!e.length)return $t();for(n=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](n))&&(n=e[i]);return n}function D6(){var t=[].slice.call(arguments,0);return hN("isBefore",t)}function L6(){var t=[].slice.call(arguments,0);return hN("isAfter",t)}var k6=function(){return Date.now?Date.now():+new Date},ih=["year","quarter","month","week","day","hour","minute","second","millisecond"];function $6(t){var e,n=!1,i,r=ih.length;for(e in t)if(ht(t,e)&&!(an.call(ih,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<r;++i)if(t[ih[i]]){if(n)return!1;parseFloat(t[ih[i]])!==it(t[ih[i]])&&(n=!0)}return!0}function F6(){return this._isValid}function V6(){return zr(NaN)}function rv(t){var e=o0(t),n=e.year||0,i=e.quarter||0,r=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=$6(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+r+i*3+n*12,this._data={},this._locale=$o(),this._bubble()}function rp(t){return t instanceof rv}function dS(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function W6(t,e,n){var i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),s=0,o;for(o=0;o<i;o++)it(t[o])!==it(e[o])&&s++;return s+r}function dN(t,e){Ae(t,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+Ls(~~(n/60),2)+e+Ls(~~n%60,2)})}dN("Z",":");dN("ZZ","");Re("Z",tv);Re("ZZ",tv);_t(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=v0(tv,t)});var B6=/([\+\-]|\d\d)/gi;function v0(t,e){var n=(e||"").match(t),i,r,s;return n===null?null:(i=n[n.length-1]||[],r=(i+"").match(B6)||["-",0,0],s=+(r[1]*60)+it(r[2]),s===0?0:r[0]==="+"?s:-s)}function C0(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(Wr(t)||xf(t)?t.valueOf():$t(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),ne.updateOffset(n,!1),n):$t(t).local()}function fS(t){return-Math.round(t._d.getTimezoneOffset())}ne.updateOffset=function(){};function j6(t,e,n){var i=this._offset||0,r;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=v0(tv,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(r=fS(this)),this._offset=t,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==t&&(!e||this._changeInProgress?mN(this,zr(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ne.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:fS(this)}function U6(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Y6(t){return this.utcOffset(0,t)}function z6(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(fS(this),"m")),this}function G6(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=v0(d4,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function K6(t){return this.isValid()?(t=t?$t(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function X6(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function q6(){if(!Ci(this._isDSTShifted))return this._isDSTShifted;var t={},e;return i0(t,this),t=uN(t),t._a?(e=t._isUTC?Ws(t._a):$t(t._a),this._isDSTShifted=this.isValid()&&W6(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Z6(){return this.isValid()?!this._isUTC:!1}function J6(){return this.isValid()?this._isUTC:!1}function fN(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Q6=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,e5=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function zr(t,e){var n=t,i=null,r,s,o;return rp(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:xo(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(i=Q6.exec(t))?(r=i[1]==="-"?-1:1,n={y:0,d:it(i[Ms])*r,h:it(i[Sn])*r,m:it(i[Dr])*r,s:it(i[yo])*r,ms:it(dS(i[Nl]*1e3))*r}):(i=e5.exec(t))?(r=i[1]==="-"?-1:1,n={y:Xa(i[2],r),M:Xa(i[3],r),w:Xa(i[4],r),d:Xa(i[5],r),h:Xa(i[6],r),m:Xa(i[7],r),s:Xa(i[8],r)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(o=t5($t(n.from),$t(n.to)),n={},n.ms=o.milliseconds,n.M=o.months),s=new rv(n),rp(t)&&ht(t,"_locale")&&(s._locale=t._locale),rp(t)&&ht(t,"_isValid")&&(s._isValid=t._isValid),s}zr.fn=rv.prototype;zr.invalid=V6;function Xa(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function rO(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function t5(t,e){var n;return t.isValid()&&e.isValid()?(e=C0(e,t),t.isBefore(e)?n=rO(t,e):(n=rO(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function gN(t,e){return function(n,i){var r,s;return i!==null&&!isNaN(+i)&&(jH(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=n,n=i,i=s),r=zr(n,i),mN(this,r,t),this}}function mN(t,e,n,i){var r=e._milliseconds,s=dS(e._days),o=dS(e._months);t.isValid()&&(i=i??!0,o&&QH(t,Qd(t,"Month")+o*n),s&&qH(t,"Date",Qd(t,"Date")+s*n),r&&t._d.setTime(t._d.valueOf()+r*n),i&&ne.updateOffset(t,s||o))}var n5=gN(1,"add"),i5=gN(-1,"subtract");function pN(t){return typeof t=="string"||t instanceof String}function r5(t){return Wr(t)||xf(t)||pN(t)||xo(t)||o5(t)||s5(t)||t===null||t===void 0}function s5(t){var e=Ul(t)&&!t0(t),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,s,o=i.length;for(r=0;r<o;r+=1)s=i[r],n=n||ht(t,s);return e&&n}function o5(t){var e=Vr(t),n=!1;return e&&(n=t.filter(function(i){return!xo(i)&&pN(t)}).length===0),e&&n}function a5(t){var e=Ul(t)&&!t0(t),n=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,s;for(r=0;r<i.length;r+=1)s=i[r],n=n||ht(t,s);return e&&n}function l5(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function u5(t,e){arguments.length===1&&(arguments[0]?r5(arguments[0])?(t=arguments[0],e=void 0):a5(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||$t(),i=C0(n,this).startOf("day"),r=ne.calendarFormat(this,i)||"sameElse",s=e&&(Bs(e[r])?e[r].call(this,n):e[r]);return this.format(s||this.localeData().calendar(r,this,$t(n)))}function c5(){return new Af(this)}function h5(t,e){var n=Wr(t)?t:$t(t);return this.isValid()&&n.isValid()?(e=fr(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function d5(t,e){var n=Wr(t)?t:$t(t);return this.isValid()&&n.isValid()?(e=fr(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function f5(t,e,n,i){var r=Wr(t)?t:$t(t),s=Wr(e)?e:$t(e);return this.isValid()&&r.isValid()&&s.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,n):!this.isBefore(r,n))&&(i[1]===")"?this.isBefore(s,n):!this.isAfter(s,n))):!1}function g5(t,e){var n=Wr(t)?t:$t(t),i;return this.isValid()&&n.isValid()?(e=fr(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function m5(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function p5(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function w5(t,e,n){var i,r,s;if(!this.isValid())return NaN;if(i=C0(t,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=fr(e),e){case"year":s=sp(this,i)/12;break;case"month":s=sp(this,i);break;case"quarter":s=sp(this,i)/3;break;case"second":s=(this-i)/1e3;break;case"minute":s=(this-i)/6e4;break;case"hour":s=(this-i)/36e5;break;case"day":s=(this-i-r)/864e5;break;case"week":s=(this-i-r)/6048e5;break;default:s=this-i}return n?s:rr(s)}function sp(t,e){if(t.date()<e.date())return-sp(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(n,"months"),r,s;return e-i<0?(r=t.clone().add(n-1,"months"),s=(e-i)/(i-r)):(r=t.clone().add(n+1,"months"),s=(e-i)/(r-i)),-(n+s)||0}ne.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ne.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function v5(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function C5(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?ip(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Bs(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",ip(n,"Z")):ip(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function y5(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,i,r,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(n+i+r+s)}function b5(t){t||(t=this.isUtc()?ne.defaultFormatUtc:ne.defaultFormat);var e=ip(this,t);return this.localeData().postformat(e)}function S5(t,e){return this.isValid()&&(Wr(t)&&t.isValid()||$t(t).isValid())?zr({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function R5(t){return this.from($t(),t)}function E5(t,e){return this.isValid()&&(Wr(t)&&t.isValid()||$t(t).isValid())?zr({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function T5(t){return this.to($t(),t)}function wN(t){var e;return t===void 0?this._locale._abbr:(e=$o(t),e!=null&&(this._locale=e),this)}var vN=dr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function CN(){return this._locale}var Wp=1e3,yc=60*Wp,Bp=60*yc,yN=(365*400+97)*24*Bp;function bc(t,e){return(t%e+e)%e}function bN(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-yN:new Date(t,e,n).valueOf()}function SN(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-yN:Date.UTC(t,e,n)}function M5(t){var e,n;if(t=fr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?SN:bN,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=bc(e+(this._isUTC?0:this.utcOffset()*yc),Bp);break;case"minute":e=this._d.valueOf(),e-=bc(e,yc);break;case"second":e=this._d.valueOf(),e-=bc(e,Wp);break}return this._d.setTime(e),ne.updateOffset(this,!0),this}function _5(t){var e,n;if(t=fr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?SN:bN,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Bp-bc(e+(this._isUTC?0:this.utcOffset()*yc),Bp)-1;break;case"minute":e=this._d.valueOf(),e+=yc-bc(e,yc)-1;break;case"second":e=this._d.valueOf(),e+=Wp-bc(e,Wp)-1;break}return this._d.setTime(e),ne.updateOffset(this,!0),this}function O5(){return this._d.valueOf()-(this._offset||0)*6e4}function P5(){return Math.floor(this.valueOf()/1e3)}function I5(){return new Date(this.valueOf())}function x5(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function A5(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function H5(){return this.isValid()?this.toISOString():null}function N5(){return n0(this)}function D5(){return Ca({},Ge(this))}function L5(){return Ge(this).overflow}function k5(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ae("N",0,0,"eraAbbr");Ae("NN",0,0,"eraAbbr");Ae("NNN",0,0,"eraAbbr");Ae("NNNN",0,0,"eraName");Ae("NNNNN",0,0,"eraNarrow");Ae("y",["y",1],"yo","eraYear");Ae("y",["yy",2],0,"eraYear");Ae("y",["yyy",3],0,"eraYear");Ae("y",["yyyy",4],0,"eraYear");Re("N",y0);Re("NN",y0);Re("NNN",y0);Re("NNNN",K5);Re("NNNNN",X5);_t(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,i){var r=n._locale.erasParse(t,i,n._strict);r?Ge(n).era=r:Ge(n).invalidEra=t});Re("y",$c);Re("yy",$c);Re("yyy",$c);Re("yyyy",$c);Re("yo",q5);_t(["y","yy","yyy","yyyy"],Xn);_t(["yo"],function(t,e,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Xn]=n._locale.eraYearOrdinalParse(t,r):e[Xn]=parseInt(t,10)});function $5(t,e){var n,i,r,s=this._eras||$o("en")._eras;for(n=0,i=s.length;n<i;++n){switch(typeof s[n].since){case"string":r=ne(s[n].since).startOf("day"),s[n].since=r.valueOf();break}switch(typeof s[n].until){case"undefined":s[n].until=1/0;break;case"string":r=ne(s[n].until).startOf("day").valueOf(),s[n].until=r.valueOf();break}}return s}function F5(t,e,n){var i,r,s=this.eras(),o,a,l;for(t=t.toUpperCase(),i=0,r=s.length;i<r;++i)if(o=s[i].name.toUpperCase(),a=s[i].abbr.toUpperCase(),l=s[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[i];break;case"NNNN":if(o===t)return s[i];break;case"NNNNN":if(l===t)return s[i];break}else if([o,a,l].indexOf(t)>=0)return s[i]}function V5(t,e){var n=t.since<=t.until?1:-1;return e===void 0?ne(t.since).year():ne(t.since).year()+(e-t.offset)*n}function W5(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].name;return""}function B5(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].narrow;return""}function j5(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].abbr;return""}function U5(){var t,e,n,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=r[t].since<=r[t].until?1:-1,i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return(this.year()-ne(r[t].since).year())*n+r[t].offset;return this.year()}function Y5(t){return ht(this,"_erasNameRegex")||b0.call(this),t?this._erasNameRegex:this._erasRegex}function z5(t){return ht(this,"_erasAbbrRegex")||b0.call(this),t?this._erasAbbrRegex:this._erasRegex}function G5(t){return ht(this,"_erasNarrowRegex")||b0.call(this),t?this._erasNarrowRegex:this._erasRegex}function y0(t,e){return e.erasAbbrRegex(t)}function K5(t,e){return e.erasNameRegex(t)}function X5(t,e){return e.erasNarrowRegex(t)}function q5(t,e){return e._eraYearOrdinalRegex||$c}function b0(){var t=[],e=[],n=[],i=[],r,s,o,a,l,u=this.eras();for(r=0,s=u.length;r<s;++r)o=Oo(u[r].name),a=Oo(u[r].abbr),l=Oo(u[r].narrow),e.push(o),t.push(a),n.push(l),i.push(o),i.push(a),i.push(l);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ae(0,["gg",2],0,function(){return this.weekYear()%100});Ae(0,["GG",2],0,function(){return this.isoWeekYear()%100});function sv(t,e){Ae(0,[t,t.length],0,e)}sv("gggg","weekYear");sv("ggggg","weekYear");sv("GGGG","isoWeekYear");sv("GGGGG","isoWeekYear");Re("G",ev);Re("g",ev);Re("GG",Ft,Bi);Re("gg",Ft,Bi);Re("GGGG",l0,a0);Re("gggg",l0,a0);Re("GGGGG",Qw,Zw);Re("ggggg",Qw,Zw);Nf(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=it(t)});Nf(["gg","GG"],function(t,e,n,i){e[i]=ne.parseTwoDigitYear(t)});function Z5(t){return RN.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function J5(t){return RN.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Q5(){return Po(this.year(),1,4)}function eX(){return Po(this.isoWeekYear(),1,4)}function tX(){var t=this.localeData()._week;return Po(this.year(),t.dow,t.doy)}function nX(){var t=this.localeData()._week;return Po(this.weekYear(),t.dow,t.doy)}function RN(t,e,n,i,r){var s;return t==null?tf(this,i,r).year:(s=Po(t,i,r),e>s&&(e=s),iX.call(this,t,e,n,i,r))}function iX(t,e,n,i,r){var s=nN(t,e,n,i,r),o=ef(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Ae("Q",0,"Qo","quarter");Re("Q",YH);_t("Q",function(t,e){e[Co]=(it(t)-1)*3});function rX(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ae("D",["DD",2],"Do","date");Re("D",Ft,Fc);Re("DD",Ft,Bi);Re("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});_t(["D","DD"],Ms);_t("Do",function(t,e){e[Ms]=it(t.match(Ft)[0])});var EN=Vc("Date",!0);Ae("DDD",["DDDD",3],"DDDo","dayOfYear");Re("DDD",Jw);Re("DDDD",zH);_t(["DDD","DDDD"],function(t,e,n){n._dayOfYear=it(t)});function sX(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ae("m",["mm",2],0,"minute");Re("m",Ft,u0);Re("mm",Ft,Bi);_t(["m","mm"],Dr);var oX=Vc("Minutes",!1);Ae("s",["ss",2],0,"second");Re("s",Ft,u0);Re("ss",Ft,Bi);_t(["s","ss"],yo);var aX=Vc("Seconds",!1);Ae("S",0,0,function(){return~~(this.millisecond()/100)});Ae(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ae(0,["SSS",3],0,"millisecond");Ae(0,["SSSS",4],0,function(){return this.millisecond()*10});Ae(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ae(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ae(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ae(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ae(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Re("S",Jw,YH);Re("SS",Jw,Bi);Re("SSS",Jw,zH);var ya,TN;for(ya="SSSS";ya.length<=9;ya+="S")Re(ya,$c);function lX(t,e){e[Nl]=it(("0."+t)*1e3)}for(ya="S";ya.length<=9;ya+="S")_t(ya,lX);TN=Vc("Milliseconds",!1);Ae("z",0,0,"zoneAbbr");Ae("zz",0,0,"zoneName");function uX(){return this._isUTC?"UTC":""}function cX(){return this._isUTC?"Coordinated Universal Time":""}var oe=Af.prototype;oe.add=n5;oe.calendar=u5;oe.clone=c5;oe.diff=w5;oe.endOf=_5;oe.format=b5;oe.from=S5;oe.fromNow=R5;oe.to=E5;oe.toNow=T5;oe.get=y4;oe.invalidAt=L5;oe.isAfter=h5;oe.isBefore=d5;oe.isBetween=f5;oe.isSame=g5;oe.isSameOrAfter=m5;oe.isSameOrBefore=p5;oe.isValid=N5;oe.lang=vN;oe.locale=wN;oe.localeData=CN;oe.max=N6;oe.min=H6;oe.parsingFlags=D5;oe.set=b4;oe.startOf=M5;oe.subtract=i5;oe.toArray=x5;oe.toObject=A5;oe.toDate=I5;oe.toISOString=C5;oe.inspect=y5;typeof Symbol<"u"&&Symbol.for!=null&&(oe[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});oe.toJSON=H5;oe.toString=v5;oe.unix=P5;oe.valueOf=O5;oe.creationData=k5;oe.eraName=W5;oe.eraNarrow=B5;oe.eraAbbr=j5;oe.eraYear=U5;oe.year=XH;oe.isLeapYear=C4;oe.weekYear=Z5;oe.isoWeekYear=J5;oe.quarter=oe.quarters=rX;oe.month=eN;oe.daysInMonth=I4;oe.week=oe.weeks=$4;oe.isoWeek=oe.isoWeeks=F4;oe.weeksInYear=tX;oe.weeksInWeekYear=nX;oe.isoWeeksInYear=Q5;oe.isoWeeksInISOWeekYear=eX;oe.date=EN;oe.day=oe.days=J4;oe.weekday=Q4;oe.isoWeekday=e6;oe.dayOfYear=sX;oe.hour=oe.hours=a6;oe.minute=oe.minutes=oX;oe.second=oe.seconds=aX;oe.millisecond=oe.milliseconds=TN;oe.utcOffset=j6;oe.utc=Y6;oe.local=z6;oe.parseZone=G6;oe.hasAlignedHourOffset=K6;oe.isDST=X6;oe.isLocal=Z6;oe.isUtcOffset=J6;oe.isUtc=fN;oe.isUTC=fN;oe.zoneAbbr=uX;oe.zoneName=cX;oe.dates=dr("dates accessor is deprecated. Use date instead.",EN);oe.months=dr("months accessor is deprecated. Use month instead",eN);oe.years=dr("years accessor is deprecated. Use year instead",XH);oe.zone=dr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",U6);oe.isDSTShifted=dr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",q6);function hX(t){return $t(t*1e3)}function dX(){return $t.apply(null,arguments).parseZone()}function MN(t){return t}var dt=r0.prototype;dt.calendar=Z3;dt.longDateFormat=t4;dt.invalidDate=i4;dt.ordinal=o4;dt.preparse=MN;dt.postformat=MN;dt.relativeTime=l4;dt.pastFuture=u4;dt.set=X3;dt.eras=$5;dt.erasParse=F5;dt.erasConvertYear=V5;dt.erasAbbrRegex=z5;dt.erasNameRegex=Y5;dt.erasNarrowRegex=G5;dt.months=M4;dt.monthsShort=_4;dt.monthsParse=P4;dt.monthsRegex=A4;dt.monthsShortRegex=x4;dt.week=N4;dt.firstDayOfYear=k4;dt.firstDayOfWeek=L4;dt.weekdays=G4;dt.weekdaysMin=X4;dt.weekdaysShort=K4;dt.weekdaysParse=Z4;dt.weekdaysRegex=t6;dt.weekdaysShortRegex=n6;dt.weekdaysMinRegex=i6;dt.isPM=s6;dt.meridiem=l6;function jp(t,e,n,i){var r=$o(),s=Ws().set(i,e);return r[n](s,t)}function _N(t,e,n){if(xo(t)&&(e=t,t=void 0),t=t||"",e!=null)return jp(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=jp(t,i,n,"month");return r}function S0(t,e,n,i){typeof t=="boolean"?(xo(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,xo(e)&&(n=e,e=void 0),e=e||"");var r=$o(),s=t?r._week.dow:0,o,a=[];if(n!=null)return jp(e,(n+s)%7,i,"day");for(o=0;o<7;o++)a[o]=jp(e,(o+s)%7,i,"day");return a}function fX(t,e){return _N(t,e,"months")}function gX(t,e){return _N(t,e,"monthsShort")}function mX(t,e,n){return S0(t,e,n,"weekdays")}function pX(t,e,n){return S0(t,e,n,"weekdaysShort")}function wX(t,e,n){return S0(t,e,n,"weekdaysMin")}Ta("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=it(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});ne.lang=dr("moment.lang is deprecated. Use moment.locale instead.",Ta);ne.langData=dr("moment.langData is deprecated. Use moment.localeData instead.",$o);var zs=Math.abs;function vX(){var t=this._data;return this._milliseconds=zs(this._milliseconds),this._days=zs(this._days),this._months=zs(this._months),t.milliseconds=zs(t.milliseconds),t.seconds=zs(t.seconds),t.minutes=zs(t.minutes),t.hours=zs(t.hours),t.months=zs(t.months),t.years=zs(t.years),this}function ON(t,e,n,i){var r=zr(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function CX(t,e){return ON(this,t,e,1)}function yX(t,e){return ON(this,t,e,-1)}function sO(t){return t<0?Math.floor(t):Math.ceil(t)}function bX(){var t=this._milliseconds,e=this._days,n=this._months,i=this._data,r,s,o,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=sO(gS(n)+e)*864e5,e=0,n=0),i.milliseconds=t%1e3,r=rr(t/1e3),i.seconds=r%60,s=rr(r/60),i.minutes=s%60,o=rr(s/60),i.hours=o%24,e+=rr(o/24),l=rr(PN(e)),n+=l,e-=sO(gS(l)),a=rr(n/12),n%=12,i.days=e,i.months=n,i.years=a,this}function PN(t){return t*4800/146097}function gS(t){return t*146097/4800}function SX(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if(t=fr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,n=this._months+PN(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(gS(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function Fo(t){return function(){return this.as(t)}}var IN=Fo("ms"),RX=Fo("s"),EX=Fo("m"),TX=Fo("h"),MX=Fo("d"),_X=Fo("w"),OX=Fo("M"),PX=Fo("Q"),IX=Fo("y"),xX=IN;function AX(){return zr(this)}function HX(t){return t=fr(t),this.isValid()?this[t+"s"]():NaN}function uu(t){return function(){return this.isValid()?this._data[t]:NaN}}var NX=uu("milliseconds"),DX=uu("seconds"),LX=uu("minutes"),kX=uu("hours"),$X=uu("days"),FX=uu("months"),VX=uu("years");function WX(){return rr(this.days()/7)}var co=Math.round,uc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function BX(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function jX(t,e,n,i){var r=zr(t).abs(),s=co(r.as("s")),o=co(r.as("m")),a=co(r.as("h")),l=co(r.as("d")),u=co(r.as("M")),c=co(r.as("w")),h=co(r.as("y")),d=s<=n.ss&&["s",s]||s<n.s&&["ss",s]||o<=1&&["m"]||o<n.m&&["mm",o]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=i,BX.apply(null,d)}function UX(t){return t===void 0?co:typeof t=="function"?(co=t,!0):!1}function YX(t,e){return uc[t]===void 0?!1:e===void 0?uc[t]:(uc[t]=e,t==="s"&&(uc.ss=e-1),!0)}function zX(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,i=uc,r,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(i=Object.assign({},uc,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),s=jX(this,!n,i,r),n&&(s=r.pastFuture(+this,s)),r.postformat(s)}var FC=Math.abs;function Cu(t){return(t>0)-(t<0)||+t}function ov(){if(!this.isValid())return this.localeData().invalidDate();var t=FC(this._milliseconds)/1e3,e=FC(this._days),n=FC(this._months),i,r,s,o,a=this.asSeconds(),l,u,c,h;return a?(i=rr(t/60),r=rr(i/60),t%=60,i%=60,s=rr(n/12),n%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Cu(this._months)!==Cu(a)?"-":"",c=Cu(this._days)!==Cu(a)?"-":"",h=Cu(this._milliseconds)!==Cu(a)?"-":"",l+"P"+(s?u+s+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(r||i||t?"T":"")+(r?h+r+"H":"")+(i?h+i+"M":"")+(t?h+o+"S":"")):"P0D"}var lt=rv.prototype;lt.isValid=F6;lt.abs=vX;lt.add=CX;lt.subtract=yX;lt.as=SX;lt.asMilliseconds=IN;lt.asSeconds=RX;lt.asMinutes=EX;lt.asHours=TX;lt.asDays=MX;lt.asWeeks=_X;lt.asMonths=OX;lt.asQuarters=PX;lt.asYears=IX;lt.valueOf=xX;lt._bubble=bX;lt.clone=AX;lt.get=HX;lt.milliseconds=NX;lt.seconds=DX;lt.minutes=LX;lt.hours=kX;lt.days=$X;lt.weeks=WX;lt.months=FX;lt.years=VX;lt.humanize=zX;lt.toISOString=ov;lt.toString=ov;lt.toJSON=ov;lt.locale=wN;lt.localeData=CN;lt.toIsoString=dr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ov);lt.lang=vN;Ae("X",0,0,"unix");Ae("x",0,0,"valueOf");Re("x",ev);Re("X",f4);_t("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});_t("x",function(t,e,n){n._d=new Date(it(t))});//! moment.js
ne.version="2.30.1";G3($t);ne.fn=oe;ne.min=D6;ne.max=L6;ne.now=k6;ne.utc=Ws;ne.unix=hX;ne.months=fX;ne.isDate=xf;ne.locale=Ta;ne.invalid=qw;ne.duration=zr;ne.isMoment=Wr;ne.weekdays=mX;ne.parseZone=dX;ne.localeData=$o;ne.isDuration=rp;ne.monthsShort=gX;ne.weekdaysMin=wX;ne.defineLocale=g0;ne.updateLocale=d6;ne.locales=f6;ne.weekdaysShort=pX;ne.normalizeUnits=fr;ne.relativeTimeRounding=UX;ne.relativeTimeThreshold=YX;ne.calendarFormat=l5;ne.prototype=oe;ne.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function xN(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function mS(t,e){const n=e.length;let i=0;for(;i<n;)t.push(e[i]),i+=1}function yd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,i=t[0].length;for(let r=0;r<n;r++)for(let s=0;s<i;s++)e[s]||(e[s]=[]),e[s][r]=t[r][s];return e}function cn(t,e,n,i){let r=-1,s=t,o=n;Array.isArray(t)||(s=Array.from(t));const a=s.length;for(i&&a&&(r+=1,o=s[r]),r+=1;r<a;)o=e(o,s[r],r,s),r+=1;return o}function Ao(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,s=[];let o=-1;for(;n<r;){const a=i[n];e(a,n,i)&&(o+=1,s[o]=a),n+=1}return s}function tt(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,s=[];let o=-1;for(;n<r;){const a=i[n];o+=1,s[o]=e(a,n,i),n+=1}return s}function A(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length;for(;n<r&&e(i[n],n,i)!==!1;)n+=1;return t}function AN(t){return cn(t,(e,n)=>e+n,0)}function GX(t){return cn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function KX(t){return cn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function XX(t){return t.length?AN(t)/t.length:0}function HN(t){return cn(t,(e,n)=>e.concat(Array.isArray(n)?HN(n):n),[])}function R0(t){const e=[];return A(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function pS(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let s=i;return A(r,o=>{s=s.filter(a=>!o.includes(a))}),s}function qX(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let s=i;return A(r,o=>{s=s.filter(a=>o.includes(a))}),s}function ZX(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e],s=new Set(i);return A(r,o=>{A(o,a=>{s.has(a)||s.add(a)})}),Array.from(s)}function wS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const JX=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:XX,arrayEach:A,arrayFilter:Ao,arrayFlatten:HN,arrayMap:tt,arrayMax:GX,arrayMin:KX,arrayReduce:cn,arraySum:AN,arrayUnique:R0,extendArray:mS,getDifferenceOfArrays:pS,getIntersectionOfArrays:qX,getUnionOfArrays:ZX,pivot:yd,stringToArray:wS,to2dArray:xN},Symbol.toStringTag,{value:"Module"}));function Ct(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return cn(t,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return s+l+u},"").trim()}function Jt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Se(t){return typeof t<"u"}function xt(t){return typeof t>"u"}function Qt(t){return t===null||t===""||xt(t)}function NN(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const rd="length",bd=t=>parseInt(t,16),oO=t=>parseInt(t,10),Up=(t,e,n)=>t.substr(e,n),Sd=t=>t.codePointAt(0)-65,vS=t=>`${t}`.replace(/\-/g,""),QX=t=>bd(Up(vS(t),bd("12"),Sd("F")))/(bd(Up(vS(t),Sd("B"),~~![][rd]))||9),e9=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let aO=!1;const lO={invalid:()=>Ct`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},uO={invalid:()=>Ct`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function DN(t,e){const n=!Qt(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",r="14.5.0";let s,o="invalid",a="invalid";t=vS(t||"");const l=t9(t);if(n||i||l)if(l){const u=ne("30/07/2024","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=QX(t);s=ne((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(o="expired",a="expired"):(o="valid",a="valid")}else i?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(e9()&&(o="valid",a="valid"),!aO&&o!=="valid"&&(lO[o]({keyValidityDate:s,hotVersion:r})&&console[o==="non_commercial"?"info":"warn"](lO[o]({keyValidityDate:s,hotVersion:r})),aO=!0),a!=="valid"&&e.parentNode&&uO[a]({keyValidityDate:s,hotVersion:r})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=uO[a]({keyValidityDate:s,hotVersion:r}),e.parentNode.insertBefore(c,e.nextSibling)}}function t9(t){let e=[][rd],n=e;if(t[rd]!==Sd("Z"))return!1;for(let i="",r="B<H4P+".split(""),s=Sd(r.shift());s;s=Sd(r.shift()||"A"))--s<""[rd]?n=n|(oO(`${oO(bd(i)+(bd(Up(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=Up(t,s,s?r[rd]===1?9:8:6);return n===e}const n9=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:DN,isDefined:Se,isEmpty:Qt,isRegExp:NN,isUndefined:xt,stringify:Jt},Symbol.toStringTag,{value:"Module"}));function Zn(t){return t[0].toUpperCase()+t.substr(1)}function i9(){const t=[];for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];let r=n.length;for(;r;){r-=1;const s=Jt(n[r]).toLowerCase();t.indexOf(s)===-1&&t.push(s)}return t.length===1}function E0(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function T0(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function M0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,i)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[i]===void 0?"":e[i])}function CS(t){return av(`${t}`,{ALLOWED_TAGS:[]})}function av(t,e){return z3.sanitize(t,e)}const r9=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:i9,isPercentValue:T0,randomString:E0,sanitize:av,stripTags:CS,substitute:M0,toUpperCaseFirst:Zn},Symbol.toStringTag,{value:"Module"})),Wc=t=>["tabindex",t],s9=()=>["role","treegrid"],xs=()=>["role","presentation"],o9=()=>["role","gridcell"],a9=()=>["role","rowheader"],LN=()=>["role","rowgroup"],l9=()=>["role","columnheader"],yS=()=>["role","row"],u9=()=>["role","menu"],c9=()=>["role","menuitem"],h9=()=>["role","combobox"],kN=()=>["role","listbox"],d9=()=>["role","option"],f9=()=>["role","checkbox"],g9=()=>["scope","col"],m9=()=>["scope","row"],p9=()=>["type","text"],_0=t=>["aria-label",t],Vo=()=>["aria-hidden","true"],w9=()=>["aria-disabled","true"],v9=()=>["aria-multiselectable","true"],$N=t=>["aria-haspopup",t],FN=t=>["aria-rowcount",t],lv=t=>["aria-colcount",t],VN=t=>["aria-rowindex",t],O0=t=>["aria-colindex",t],lr=t=>["aria-expanded",t],C9=t=>["aria-sort",t],cO=()=>["aria-readonly","true"],hO=()=>["aria-invalid","true"],y9=t=>["aria-checked",t],P0=()=>["aria-selected","true"],b9=()=>["aria-autocomplete","list"],S9=t=>["aria-controls",t],R9=t=>["aria-activedescendant",t],E9=t=>["aria-live",t],T9=t=>["aria-relevant",t],M9=t=>["aria-setsize",t],_9=t=>["aria-posinset",t];function WN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=null,r=t;for(;r!==null;){if(n===e){i=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(n+=1,r=r.parentNode)}return i}function BN(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function jN(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Gl(t){return jN(t)&&t.parent}function O9(t){return!!Object.getPrototypeOf(t.parent)}function Aa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:r}=Node;let s=t;for(;s!=null&&s!==n;){const{nodeType:o,nodeName:a}=s;if(o===i&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===r?s=l:s=s.parentNode}return null}function sd(t,e,n){const i=[];let r=t;for(;r&&(r=Aa(r,e,n),!(!r||n&&!n.contains(r)));)i.push(r),r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:r=r.parentNode;const s=i.length;return s?i[s-1]:null}function Ma(t,e){let n=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);n!==null;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function UN(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function ra(t,e,n){const i=n.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function YN(t){return!t||!t.length?[]:t.filter(e=>!!e)}function zN(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],i=[];return i.push(...t.filter(r=>{const s=r instanceof RegExp;return s&&e&&n.push(r),!s})),{regexFree:i,regexes:n}}function De(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function ie(t,e){typeof e=="string"&&(e=e.split(" ")),e=YN(e),e.length>0&&t.classList.add(...e)}function We(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:i}=zN(e,!0);n=YN(n),n.length>0&&t.classList.remove(...n),i.forEach(r=>{t.classList.forEach(s=>{r.test(s)&&t.classList.remove(s)})})}function xe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function cu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:i}=zN(e,!0);n.forEach(r=>{r!==""&&t.removeAttribute(r)}),i.forEach(r=>{t.getAttributeNames().forEach(s=>{r.test(s)&&t.removeAttribute(s)})})}function I0(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)I0(e[n])}}function Br(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const GN=/(<(.*)>|&(.*);)/;function hu(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;GN.test(e)?t.innerHTML=n?av(e):e:Ha(t,e)}function Ha(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Br(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Kl(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Kl(n.host.impl);if(n.host)return Kl(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(Ho(n).display==="none")return!1;n=n.parentNode}return!0}function bn(t){const e=t.ownerDocument,n=e.defaultView,i=e.documentElement;let r=t,s,o,a;for(s=r.offsetLeft,o=r.offsetTop,a=r;(r=r.offsetParent)&&!(r===e.body||!("offsetLeft"in r));)s+=r.offsetLeft,o+=r.offsetTop,a=r;return a&&a.style.position==="fixed"&&(s+=n.pageXOffset||i.scrollLeft,o+=n.pageYOffset||i.scrollTop),{left:s,top:o}}function x0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function uv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function cv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?x0(e):t.scrollTop}function A0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?uv(e):t.scrollLeft}function rf(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const i=["auto","scroll"];let r=t.parentNode;for(;r&&r.style&&e.body!==r;){let{overflow:s,overflowX:o,overflowY:a}=r.style;if([s,o,a].includes("scroll"))return r;if({overflow:s,overflowX:o,overflowY:a}=n.getComputedStyle(r),i.includes(s)||i.includes(o)||i.includes(a)||r.clientHeight<=r.scrollHeight+1&&(i.includes(a)||i.includes(s))||r.clientWidth<=r.scrollWidth+1&&(i.includes(o)||i.includes(s)))return r;r=r.parentNode}return n}function KN(t){return t.scrollHeight-t.clientHeight}function XN(t){return t.scrollWidth-t.clientWidth}function Xl(t){const e=t.ownerDocument,n=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const r=Ho(i,n),s=["scroll","hidden","auto"],o=r.getPropertyValue("overflow"),a=r.getPropertyValue("overflow-y"),l=r.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return i;i=i.parentNode}return n}function Pc(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const r=Ho(t,n);if(r[e]!==""&&r[e]!==void 0)return r[e]}function P9(t,e){const{selectorText:n}=e;let i=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?i=t.msMatchesSelector(n):t.matches&&(i=t.matches(n))),i}function Ho(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function At(t){return t.offsetWidth}function sn(t){return t.offsetHeight}function Dl(t){return t.clientHeight||t.innerHeight}function H0(t){return t.clientWidth||t.innerWidth}function I9(t,e,n){t.addEventListener(e,n,!1)}function x9(t,e,n){t.removeEventListener(e,n,!1)}function N0(t){return t.selectionStart?t.selectionStart:0}function qN(t){return t.selectionEnd?t.selectionEnd:0}function A9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function bS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Df(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const r=t.parentNode,s=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=s}}}let VC;function H9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const i=e.offsetWidth;n.style.overflow="scroll";let r=e.offsetWidth;return i===r&&(r=n.clientWidth),(t.body||t.documentElement).removeChild(n),i-r}function Rn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return VC===void 0&&(VC=H9(t)),VC}function ZN(t){return t.offsetWidth!==t.clientWidth}function JN(t){return t.offsetHeight!==t.clientHeight}function hv(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function N9(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Lf(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Rd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function dv(t){return Rd(t)&&t.hasAttribute("data-hot-input")===!1}function D9(t){const e=t.ownerDocument.activeElement;dv(e)||t.select()}function D0(t){return!t.parentNode}function QN(t,e){new IntersectionObserver((i,r)=>{i.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function L0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,r=i.createRange(),s=i.defaultView.getSelection();xe(t,"contenteditable",!0),n&&xe(t,...Vo()),e&&ie(t,"invisibleSelection"),r.selectNodeContents(t),s.removeAllRanges(),s.addRange(r)}function k0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&We(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function eD(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;L0(t,n),e(),k0(t,n)}const L9=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:GN,addClass:ie,addEvent:I9,clearTextSelection:bS,closest:Aa,closestDown:sd,empty:Br,fastInnerHTML:hu,fastInnerText:Ha,getCaretPosition:N0,getComputedStyle:Ho,getCssTransform:N9,getFrameElement:jN,getMaximumScrollLeft:XN,getMaximumScrollTop:KN,getParent:WN,getParentWindow:Gl,getScrollLeft:A0,getScrollTop:cv,getScrollableElement:rf,getScrollbarWidth:Rn,getSelectionEndPosition:qN,getSelectionText:A9,getStyle:Pc,getTrimmingContainer:Xl,getWindowScrollLeft:uv,getWindowScrollTop:x0,hasAccessToParentWindow:O9,hasClass:De,hasHorizontalScrollbar:JN,hasVerticalScrollbar:ZN,index:UN,innerHeight:Dl,innerWidth:H0,isChildOf:Ma,isDetached:D0,isInput:Rd,isOutsideInput:dv,isThisHotChild:BN,isVisible:Kl,makeElementContentEditableAndSelectItsContent:L0,matchesCSSRules:P9,observeVisibilityChangeOnce:QN,offset:bn,outerHeight:sn,outerWidth:At,overlayContainsElement:ra,removeAttribute:cu,removeClass:We,removeContentEditableFromElementAndDeselect:k0,removeEvent:x9,removeTextNodes:I0,resetCssTransform:Lf,runWithSelectedContendEditableElement:eD,selectElementIfAllowed:D9,setAttribute:xe,setCaretPosition:Df,setOverlayPosition:hv},Symbol.toStringTag,{value:"Module"}));function Pt(t){return typeof t=="function"}function tD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const i={lastCallThrottled:!0};let r=null;function s(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];const u=Date.now();let c=!1;i.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(i.lastCallThrottled=!1,t.apply(this,a)):(r&&clearTimeout(r),r=setTimeout(()=>{i.lastCallThrottled=!1,t.apply(this,a),n=0,r=void 0},h)),i}return s}function k9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const i=tD(t,e);let r=n;function s(){r=n}function o(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return r?(r-=1,t.apply(this,l)):i.apply(this,l)}return o.clearHits=s,o}function fv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,i;function r(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{i=t.apply(this,o)},e),i}return r}function $9(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=e;return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return cn(r,(u,c)=>c(u),i.apply(this,a))}}function $0(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,n.concat(o))}}function nD(t){const e=t.length;function n(i){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=i.concat(o);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function F9(t){const e=t.length;function n(i){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=i.concat(o.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Yp(t,e,n,i,r,s,o,a){return Se(a)?t.call(e,n,i,r,s,o,a):Se(o)?t.call(e,n,i,r,s,o):Se(s)?t.call(e,n,i,r,s):Se(r)?t.call(e,n,i,r):Se(i)?t.call(e,n,i):Se(n)?t.call(e,n):t.call(e)}const V9=Object.freeze(Object.defineProperty({__proto__:null,curry:nD,curryRight:F9,debounce:fv,fastCall:Yp,isFunction:Pt,partial:$0,pipe:$9,throttle:tD,throttleAfterHits:k9},Symbol.toStringTag,{value:"Module"}));var W9=gn,dO=CH,B9=kn,fO=iu,j9=Xw,gO=W9([].push),U9=function(t){if(B9(t))return t;if(dO(t)){for(var e=t.length,n=[],i=0;i<e;i++){var r=t[i];typeof r=="string"?gO(n,r):(typeof r=="number"||fO(r)==="Number"||fO(r)==="String")&&gO(n,j9(r))}var s=n.length,o=!0;return function(a,l){if(o)return o=!1,l;if(dO(this))return l;for(var u=0;u<s;u++)if(n[u]===a)return l}}},Y9=$n,iD=kc,rD=Kw,z9=Yr,kf=gn,sD=Mi,mO=kn,pO=VR,oD=QR,G9=U9,K9=FR,X9=String,_a=iD("JSON","stringify"),bg=kf(/./.exec),wO=kf("".charAt),q9=kf("".charCodeAt),Z9=kf("".replace),J9=kf(1 .toString),Q9=/[\uD800-\uDFFF]/g,vO=/^[\uD800-\uDBFF]$/,CO=/^[\uDC00-\uDFFF]$/,yO=!K9||sD(function(){var t=iD("Symbol")("stringify detection");return _a([t])!=="[null]"||_a({a:t})!=="{}"||_a(Object(t))!=="{}"}),bO=sD(function(){return _a("\uDF06\uD834")!=='"\\udf06\\ud834"'||_a("\uDEAD")!=='"\\udead"'}),e8=function(t,e){var n=oD(arguments),i=G9(e);if(!(!mO(i)&&(t===void 0||pO(t))))return n[1]=function(r,s){if(mO(i)&&(s=z9(i,this,X9(r),s)),!pO(s))return s},rD(_a,null,n)},t8=function(t,e,n){var i=wO(n,e-1),r=wO(n,e+1);return bg(vO,t)&&!bg(CO,r)||bg(CO,t)&&!bg(vO,i)?"\\u"+J9(q9(t,0),16):t};_a&&Y9({target:"JSON",stat:!0,arity:3,forced:yO||bO},{stringify:function(e,n,i){var r=oD(arguments),s=rD(yO?e8:_a,null,r);return bO&&typeof s=="string"?Z9(s,Q9,t8):s}});function Ic(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},ze(t,(n,i)=>{i!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[i]=Ic(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[i]=[Ic(n[0])]:e[i]=[]:e[i]=null)})),e}function Gr(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function un(t,e,n){const i=Array.isArray(n);return ze(e,(r,s)=>{(i===!1||n.includes(s))&&(t[s]=r)}),t}function $f(t,e){ze(e,(n,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),$f(t[i],e[i])):t[i]=e[i]})}function Jn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function jr(t){const e={};return ze(t,(n,i)=>{e[i]=n}),e}function yt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return A(n,r=>{t.MIXINS.push(r.MIXIN_NAME),ze(r,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{const a=function(c,h){const d=`_${c}`,f=m=>{let p=m;return(Array.isArray(p)||Ye(p))&&(p=Jn(p)),p};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),t}function gv(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ye(t){return Object.prototype.toString.call(t)==="[object Object]"}function js(t,e,n,i){i.value=n,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function ze(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function aD(t,e){const n=e.split(".");let i=t;return ze(n,r=>{if(i=i[r],i===void 0)return i=void 0,!1}),i}function op(t,e,n){const i=e.split(".");let r=t;i.forEach((s,o)=>{o!==i.length-1?(Ut(r,s)||(r[s]={}),r=r[s]):r[s]=n})}function mv(t){if(!Ye(t))return 0;const e=function(n){let i=0;return Ye(n)?ze(n,(r,s)=>{s!=="__children"&&(i+=e(r))}):i+=1,i};return e(t)}function ar(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,i={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[n]},set(r){this._touched=!0,this[n]=r},enumerable:!0,configurable:!0}),i}function Ut(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const n8=Object.freeze(Object.defineProperty({__proto__:null,clone:jr,createObjectPropListener:ar,deepClone:Jn,deepExtend:$f,deepObjectSize:mv,defineGetter:js,duckSchema:Ic,extend:un,getProperty:aD,hasOwnProperty:Ut,inherit:Gr,isObject:Ye,isObjectEqual:gv,mixin:yt,objectEach:ze,setProperty:op},Symbol.toStringTag,{value:"Module"}));function pv(t){return window.requestAnimationFrame(t)}function sf(t){window.cancelAnimationFrame(t)}function F0(){return"ontouchstart"in window}function lD(){return typeof window<"u"}let yu;function uD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return yu||(typeof Intl=="object"?yu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?yu=(n,i)=>`${n}`.localeCompare(i):yu=(n,i)=>n===i?0:n>i?-1:1,yu)}const i8=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:sf,getComparisonFunction:uD,isCSR:lD,isTouchSupported:F0,requestAnimationFrame:pv},Symbol.toStringTag,{value:"Module"})),Qi=t=>{const e={value:!1};return e.test=(n,i)=>{e.value=t(n,i)},e},Wo={chrome:Qi((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Qi(t=>/CriOS/.test(t)),edge:Qi(t=>/Edge/.test(t)),edgeWebKit:Qi(t=>/EdgiOS/.test(t)),firefox:Qi(t=>/Firefox/.test(t)),firefoxWebKit:Qi(t=>/FxiOS/.test(t)),mobile:Qi(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Qi((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Bc={mac:Qi(t=>/^Mac/.test(t)),win:Qi(t=>/^Win/.test(t)),linux:Qi(t=>/^Linux/.test(t)),ios:Qi(t=>/iPhone|iPad|iPod/i.test(t))};function cD(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ze(Wo,n=>{let{test:i}=n;return void i(t,e)})}function hD(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ze(Bc,e=>{let{test:n}=e;return void n(t)})}lD()&&(cD(),hD());function V0(){return Wo.chrome.value}function dD(){return Wo.chromeWebKit.value}function ap(){return Wo.firefox.value}function fD(){return Wo.firefoxWebKit.value}function W0(){return Wo.safari.value}function gD(){return Wo.edge.value}function r8(){return Wo.edgeWebKit.value}function bo(){return Wo.mobile.value}function B0(){return Bc.ios.value}function j0(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Bc.mac.value}function SS(){return Bc.win.value}function of(){return Bc.mac.value}function s8(){return Bc.linux.value}const o8=Object.freeze(Object.defineProperty({__proto__:null,isChrome:V0,isChromeWebKit:dD,isEdge:gD,isEdgeWebKit:r8,isFirefox:ap,isFirefoxWebKit:fD,isIOS:B0,isIpadOS:j0,isLinuxOS:s8,isMacOS:of,isMobileBrowser:bo,isSafari:W0,isWindowsOS:SS,setBrowserMeta:cD,setPlatformMeta:hD},Symbol.toStringTag,{value:"Module"})),Me={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:ap()?182:174,AUDIO_MUTE:ap()?181:173,AUDIO_UP:ap()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},a8=[Me.ALT,Me.ARROW_DOWN,Me.ARROW_LEFT,Me.ARROW_RIGHT,Me.ARROW_UP,Me.AUDIO_DOWN,Me.AUDIO_MUTE,Me.AUDIO_UP,Me.BACKSPACE,Me.CAPS_LOCK,Me.DELETE,Me.END,Me.ENTER,Me.ESCAPE,Me.F1,Me.F2,Me.F3,Me.F4,Me.F5,Me.F6,Me.F7,Me.F8,Me.F9,Me.F10,Me.F11,Me.F12,Me.F13,Me.F14,Me.F15,Me.F16,Me.F17,Me.F18,Me.F19,Me.HOME,Me.INSERT,Me.MEDIA_NEXT,Me.MEDIA_PLAY_PAUSE,Me.MEDIA_PREV,Me.MEDIA_STOP,Me.NULL,Me.NUM_LOCK,Me.PAGE_DOWN,Me.PAGE_UP,Me.PAUSE,Me.SCROLL_LOCK,Me.SHIFT,Me.TAB];function mD(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function U0(t){return a8.includes(t)}function l8(t){const e=[];return of()?e.push(Me.COMMAND_LEFT,Me.COMMAND_RIGHT,Me.COMMAND_FIREFOX):e.push(Me.CONTROL),e.includes(t)}function pD(t){return[Me.CONTROL,Me.COMMAND_LEFT,Me.COMMAND_RIGHT,Me.COMMAND_FIREFOX].includes(t)}function jc(t,e){const n=e.split("|");let i=!1;return A(n,r=>{if(t===Me[r])return i=!0,!1}),i}const u8=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:Me,isCtrlKey:l8,isCtrlMetaKey:pD,isFunctionKey:U0,isKey:jc,isPrintableChar:mD},Symbol.toStringTag,{value:"Module"}));function gr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ma(t){return t.isImmediatePropagationEnabled===!1}function Na(t){return t.button===2}function wv(t){return t.button===0}function wD(t){return t instanceof TouchEvent}function vD(t,e){const n={x:t.offsetX,y:t.offsetY};let i=t.target;if(!(e instanceof HTMLElement)||i!==e&&i.contains(e))return n;for(;i!==e;)n.x+=i.offsetLeft,n.y+=i.offsetTop,i=i.offsetParent;return n}const c8=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:ma,isLeftClick:wv,isRightClick:Na,isTouchEvent:wD,offsetRelativeTo:vD,stopImmediatePropagation:gr},Symbol.toStringTag,{value:"Module"}));var CD={},h8=aH,d8=GR,f8=Object.keys||function(e){return h8(e,d8)},g8=Ur,m8=eH,p8=Va,w8=ko,v8=jw,C8=f8;CD.f=g8&&!m8?Object.defineProperties:function(e,n){w8(e);for(var i=v8(n),r=C8(n),s=r.length,o=0,a;s>o;)p8.f(e,a=r[o++],i[a]);return e};var y8=ko,b8=CD,SO=GR,S8=YR,R8=xH,E8=jR,T8=iH,RO=">",EO="<",RS="prototype",ES="script",yD=T8("IE_PROTO"),WC=function(){},bD=function(t){return EO+ES+RO+t+EO+"/"+ES+RO},TO=function(t){t.write(bD("")),t.close();var e=t.parentWindow.Object;return t=null,e},M8=function(){var t=E8("iframe"),e="java"+ES+":",n;return t.style.display="none",R8.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(bD("document.F=Object")),n.close(),n.F},Sg,lp=function(){try{Sg=new ActiveXObject("htmlfile")}catch{}lp=typeof document<"u"?document.domain&&Sg?TO(Sg):M8():TO(Sg);for(var t=SO.length;t--;)delete lp[RS][SO[t]];return lp()};S8[yD]=!0;var _8=Object.create||function(e,n){var i;return e!==null?(WC[RS]=y8(e),i=new WC,WC[RS]=null,i[yD]=e):i=lp(),n===void 0?i:b8.f(i,n)},O8=Fa,P8=_8,I8=Va.f,TS=O8("unscopables"),MS=Array.prototype;MS[TS]===void 0&&I8(MS,TS,{configurable:!0,value:P8(null)});var Y0=function(t){MS[TS][t]=!0},x8=Y0;x8("flatMap");function vt(){Se(console)&&console.warn(...arguments)}function z0(){Se(console)&&console.error(...arguments)}function A8(t,e,n){return(e=H8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H8(t){var e=N8(t,"string");return typeof e=="symbol"?e:e+""}function N8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bu=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],D8=Ct`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,BC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),jC=new Map([[]]),Rg=new WeakMap;class ye{static getSingleton(){return k8()}constructor(){A8(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return A(bu,n=>{e[n]=[],this.initOrderMap(e,n)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;if(Array.isArray(n))A(n,s=>this.add(e,s,i));else{BC.has(e)&&vt(M0(D8,{hookName:e,removedInVersion:BC.get(e)})),jC.has(e)&&vt(jC.get(e));const s=this.getBucket(i);if(typeof s[e]>"u"&&(this.register(e),s[e]=[],this.initOrderMap(s,e)),n.skip=!1,s[e].indexOf(n)===-1){let o=!1;n.initialHook&&A(s[e],(a,l)=>{if(a.initialHook)return s[e][l]=n,o=!0,!1}),o||s[e].push(n)}this.setCallbackOrderIndex(s,e,n,r),this.orderBucketByOrderIndex(s,e)}return this}once(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;Array.isArray(n)?A(n,s=>this.once(e,s,i)):(n.runOnce=!0,this.add(e,n,i,r))}remove(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const r=this.getBucket(i);return typeof r[e]<"u"&&r[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const i=this.getBucket(n);return!!(i[e]!==void 0&&i[e].length)}run(e,n,i,r,s,o,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Yp(u[h],e,i,r,s,o,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h]),h+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Yp(u[h],e,i,r,s,o,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h],e),h+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ze(this.getBucket(e),(n,i,r)=>r[i].length=0)}register(e){this.isRegistered(e)||bu.push(e)}deregister(e){this.isRegistered(e)&&bu.splice(bu.indexOf(e),1)}isDeprecated(e){return jC.has(e)||BC.has(e)}isRegistered(e){return bu.indexOf(e)>=0}getRegistered(){return bu}setCallbackOrderIndex(e,n,i,r){const s=Number.isInteger(r)?r:0,o=this.getCallbackOrderMap(e,n);o.set(s,[...o.get(s)||[],i])}orderBucketByOrderIndex(e,n){const i=this.getCallbackOrderMap(e,n);i===void 0||i.size===0||i.size===1&&i.has(0)||(e[n]=[...i].sort((r,s)=>r[0]-s[0]).flatMap(r=>{let[,s]=r;return s}))}initOrderMap(e,n){Rg.has(e)||Rg.set(e,[]),Rg.get(e)[n]=new Map}getCallbackOrderMap(e,n){return Rg.get(e)[n]}}const L8=new ye;function k8(){return L8}const UC=new Map;function Kr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";UC.has(t)||UC.set(t,new Map);const e=UC.get(t);function n(a,l){e.set(a,l)}function i(a){return e.get(a)}function r(a){return e.has(a)}function s(){return[...e.keys()]}function o(){return[...e.values()]}return{register:n,getItem:i,hasItem:r,getNames:s,getValues:o}}const _S=new WeakMap,{register:$8,getItem:SD,hasItem:RD,getNames:F8,getValues:qwe}=Kr("editors");function V8(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new n(i)),e[i.guid]},ye.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function ED(t,e){let n;if(typeof t=="function")_S.get(t)||yi(null,t),n=_S.get(t);else if(typeof t=="string")n=SD(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function zp(t){if(typeof t=="function")return t;if(!RD(t))throw Error(`No registered editor found under "${t}" name`);return SD(t).getConstructor()}function yi(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new V8(e);typeof t=="string"&&$8(t,n),_S.set(e,n)}function W8(t,e,n){return(e=B8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B8(t){var e=j8(t,"string");return typeof e=="symbol"?e:e+""}function j8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let up=0;class hr{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;W8(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){i.call(this,U8(o))}return this.context.eventListeners.push({element:e,event:n,callback:i,callbackProxy:s,options:r,eventManager:this}),e.addEventListener(n,s,r),up+=1,()=>{this.removeEventListener(e,n,i)}}removeEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===n&&o.element===e){if(i&&i!==o.callback||r&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),up-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const i=this.context.eventListeners[n];e&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),up-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let i=e.document,r=e;i||(i=e.ownerDocument?e.ownerDocument:e,r=i.defaultView);const s={bubbles:!0,cancelable:n!=="mousemove",view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;i.createEvent?(o=i.createEvent("MouseEvents"),o.initMouseEvent(n,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,i.body.parentNode)):o=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${n}`,o)}}function U8(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),gr(this)},t}function Y8(){return up}function z8(t,e){G8(t,e),e.add(t)}function G8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qa(t,e,n){return(e=K8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K8(t){var e=X8(t,"string");return typeof e=="symbol"?e:e+""}function X8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MO(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var YC=new WeakSet;class OS{constructor(e,n,i){z8(this,YC),qa(this,"hot",void 0),qa(this,"tableMeta",void 0),qa(this,"selection",void 0),qa(this,"eventManager",void 0),qa(this,"destroyed",!1),qa(this,"activeEditor",void 0),qa(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=i,this.eventManager=new hr(e),this.hot.addHook("afterDocumentKeyDown",r=>MO(YC,this,q8).call(this,r)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",r=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",r)}),this.hot.view._wt.update("onCellDblClick",(r,s,o)=>MO(YC,this,Z8).call(this,r,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:i,col:r}=n,s=this.hot.runHooks("modifyGetCellCoords",i,r);let o=i,a=r;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(i,r,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=ED(u,this.hot),this.activeEditor.prepare(i,r,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const r=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,n,i);if(n instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&r.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,i){this.activeEditor?this.activeEditor.finishEditing(e,n,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(i))||o.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function q8(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ma(t))return;const{keyCode:n}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!U0(n)&&!pD(n)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function Z8(t,e){e.isCell()&&this.openEditor(null,t,!0)}const _O=new WeakMap;OS.getInstance=function(t,e,n){let i=_O.get(t);return i||(i=new OS(t,e,n),_O.set(t,i)),i};function J8(t,e){TD(t,e),e.add(t)}function rh(t,e,n){TD(t,e),e.set(t,n)}function TD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wt(t,e){return t.get(wo(t,e))}function sh(t,e,n){return t.set(wo(t,e),n),n}function wo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Sc=Object.freeze({CELL:"cell",MIXED:"mixed"});var _n=new WeakMap,Eg=new WeakMap,Tg=new WeakMap,Mg=new WeakMap,_g=new WeakMap,la=new WeakSet;class Q8{constructor(e){var n=this;J8(this,la),rh(this,_n,void 0),rh(this,Eg,void 0),rh(this,Tg,1),rh(this,Mg,null),rh(this,_g,new Map);const i=e.getSettings();sh(_n,this,e),sh(Eg,this,i.imeFastEdit?Sc.MIXED:Sc.CELL),Wt(_n,this).addHook("afterUpdateSettings",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return wo(la,n,tq).call(n,...s)}),Wt(_n,this).addHook("afterSelection",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return wo(la,n,OO).call(n,...s)}),Wt(_n,this).addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return wo(la,n,OO).call(n,...s)}),Wt(_n,this).addHook("afterSelectionEnd",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return wo(la,n,eq).call(n,...s)})}getFocusMode(){return Wt(Eg,this)}setFocusMode(e){Object.values(Sc).includes(e)?sh(Eg,this,e):vt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Wt(Tg,this)}setRefocusDelay(e){sh(Tg,this,e)}setRefocusElementGetter(e){sh(Mg,this,e)}getRefocusElement(){if(typeof Wt(Mg,this)=="function")return Wt(Mg,this).call(this);var e;return(e=Wt(_n,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=i=>{var r,s;const o=(r=Wt(_n,this).getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;if(!o)return;let a=Wt(_n,this).runHooks("modifyFocusedElement",o.row,o.col,i);a instanceof HTMLElement||(a=i),a&&!((s=Wt(_n,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?n(e):wo(la,this,G0).call(this,i=>n(i))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Wt(Tg,this);const i=this.getRefocusElement();Wt(_n,this).getSettings().imeFastEdit&&!((e=Wt(_n,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&i&&(Wt(_g,this).has(n)||Wt(_g,this).set(n,fv(()=>{i.select()},n)),Wt(_g,this).get(n)())}}function G0(t){var e;const n=(e=Wt(_n,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Wt(_n,this).selection.isCellVisible(n)){t(null);return}const i=Wt(_n,this).getCell(n.row,n.col,!0);i===null?Wt(_n,this).addHookOnce("afterScroll",()=>{t(Wt(_n,this).getCell(n.row,n.col,!0))}):t(i)}function OO(){wo(la,this,G0).call(this,t=>{const{activeElement:e}=Wt(_n,this).rootDocument;e&&dv(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function eq(){wo(la,this,G0).call(this,t=>{this.getFocusMode()===Sc.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function tq(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Sc.MIXED:Sc.CELL)}var nq=ks,iq=iu,rq=Fa,sq=rq("match"),oq=function(t){var e;return nq(t)&&((e=t[sq])!==void 0?!!e:iq(t)==="RegExp")},aq=ko,lq=function(){var t=aq(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},uq=Yr,cq=$s,hq=Uw,dq=lq,PO=RegExp.prototype,fq=function(t){var e=t.flags;return e===void 0&&!("flags"in PO)&&!cq(t,"flags")&&hq(PO,t)?uq(dq,t):e},K0=gn,gq=Ef,mq=Math.floor,zC=K0("".charAt),pq=K0("".replace),GC=K0("".slice),wq=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,vq=/\$([$&'`]|\d{1,2})/g,Cq=function(t,e,n,i,r,s){var o=n+t.length,a=i.length,l=vq;return r!==void 0&&(r=gq(r),l=wq),pq(s,l,function(u,c){var h;switch(zC(c,0)){case"$":return"$";case"&":return t;case"`":return GC(e,0,n);case"'":return GC(e,o);case"<":h=r[GC(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=mq(d/10);return f===0?u:f<=a?i[f-1]===void 0?zC(c,1):i[f-1]+zC(c,1):u}h=i[d-1]}return h===void 0?"":h})},yq=$n,bq=Yr,X0=gn,IO=Sf,Sq=kn,Rq=Bw,Eq=oq,oh=Xw,Tq=Gw,Mq=fq,_q=Cq,Oq=Fa,Pq=Oq("replace"),Iq=TypeError,KC=X0("".indexOf);X0("".replace);var xO=X0("".slice),xq=Math.max;yq({target:"String",proto:!0},{replaceAll:function(e,n){var i=IO(this),r,s,o,a,l,u,c,h,d,f,m=0,p="";if(!Rq(e)){if(r=Eq(e),r&&(s=oh(IO(Mq(e))),!~KC(s,"g")))throw new Iq("`.replaceAll` does not allow non-global regexes");if(o=Tq(e,Pq),o)return bq(o,e,i,n)}for(a=oh(i),l=oh(e),u=Sq(n),u||(n=oh(n)),c=l.length,h=xq(1,c),d=KC(a,l);d!==-1;)f=u?oh(n(l,d,a)):_q(l,a,d,[],void 0,n),p+=xO(a,m,d)+f,m=d+c,d=d+h>a.length?-1:KC(a,l,d+h);return m<a.length&&(p+=xO(a,m)),p}});const MD={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Aq=new RegExp(Object.keys(MD).map(t=>`(${t})`).join("|"),"gi");function Hq(t){return(t&&t.nodeName||"")==="TABLE"}function PS(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),i=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],r=t.getData(...i),s=r.length,o=s>0?r[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<s;d+=1){const f=e&&d===0,m=[];for(let y=0;y<o;y+=1){const E=!f&&n&&y===0;let T="";if(f)T=`<th>${t.getColHeader(y-c)}</th>`;else if(E)T=`<th>${t.getRowHeader(d-h)}</th>`;else{const M=r[d][y],{hidden:P,rowspan:H,colspan:U}=t.getCellMeta(d-h,y-c);if(!P){const Y=[];if(H&&Y.push(`rowspan="${H}"`),U&&Y.push(`colspan="${U}"`),Qt(M))T=`<td ${Y.join(" ")}></td>`;else{const Q=M.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");T=`<td ${Y.join(" ")}>${Q}</td>`}}}m.push(T)}const p=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,p):u.splice(-1,0,p)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function IS(t){const e=t.length,n=["<table>"];for(let i=0;i<e;i+=1){const r=t[i],s=r.length,o=[];i===0&&n.push("<tbody>");for(let a=0;a<s;a+=1){const l=r[a],u=Qt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${u}</td>`)}n.push("<tr>",...o,"</tr>"),i+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function _D(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},i=e.createDocumentFragment(),r=e.createElement("div");i.appendChild(r);let s=t;if(typeof s=="string"){const M=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,P=>{const H=P.match(/<td\b[^>]*?>/g)[0],U=/<p.*?>/g,Y=P.substring(H.length,P.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(U,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${H}${Y}</td>`});r.insertAdjacentHTML("afterbegin",`${M}`),s=r.querySelector("table")}if(!s||!Hq(s))return;const o=r.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),u=l?Array.from(l.cells).reduce((M,P)=>M+P.colSpan,0)-(a?1:0):0,c=s.tFoot&&Array.from(s.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(s.tHead){const M=Array.from(s.tHead.rows).filter(P=>{const H=P.querySelector("td")!==null;return H&&h.push(P),!H});f=M.length,d=f>0,f>1?n.nestedHeaders=Array.from(M).reduce((P,H)=>{const U=Array.from(H.cells).reduce((Y,Q,q)=>{if(a&&q===0)return Y;const{colSpan:Z,innerHTML:te}=Q,ue=Z>1?{label:te,colspan:Z}:te;return Y.push(ue),Y},[]);return P.push(U),P},[]):d&&(n.colHeaders=Array.from(M[0].children).reduce((P,H,U)=>(a&&U===0||P.push(H.innerHTML),P),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const p=[...h,...Array.from(s.tBodies).reduce((M,P)=>(M.push(...Array.from(P.rows)),M),[]),...c];m=p.length;const y=new Array(m);for(let M=0;M<m;M++)y[M]=new Array(u);const E=[],T=[];for(let M=0;M<m;M++){const P=p[M],H=Array.from(P.cells),U=H.length;for(let Y=0;Y<U;Y++){const Q=H[Y],{nodeName:q,innerHTML:Z,rowSpan:te,colSpan:ue}=Q,ce=y[M].findIndex(Ee=>Ee===void 0);if(q==="TD"){if(te>1||ue>1){for(let be=M;be<M+te;be++)if(be<m)for(let le=ce;le<ce+ue;le++)y[be][le]=null;const He=Q.getAttribute("style");He&&He.includes("mso-ignore:colspan")||E.push({col:ce,row:M,rowspan:te,colspan:ue})}let Ee="";o&&/excel/gi.test(o.content)?Ee=Z.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):Ee=Z.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[M][ce]=Ee.replace(Aq,He=>MD[He])}else T.push(Z)}}return E.length&&(n.mergeCells=E),T.length&&(n.rowHeaders=T),y.length&&(n.data=y),n}const Nq=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:IS,htmlToGridSettings:_D,instanceToHTML:PS},Symbol.toStringTag,{value:"Module"}));function zn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(r=>`\\${r}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function OD(t){return zn(t,[","])}function _e(t,e,n){let i=-1;for(typeof e=="function"?(n=e,e=t):i=t-1;++i<=e&&n(i)!==!1;);}function Gp(t,e,n){let i=t+1;for(typeof e=="function"&&(n=e,e=0);--i>=e&&n(i)!==!1;);}function q0(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function pt(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const Dq=Object.freeze(Object.defineProperty({__proto__:null,clamp:pt,isNumeric:zn,isNumericLike:OD,rangeEach:_e,rangeEachReverse:Gp,valueAccordingPercent:q0},Symbol.toStringTag,{value:"Module"})),xS="asc",Lq="desc",AO=new Map([[xS,[-1,1]],[Lq,[1,-1]]]),kq=t=>`The priority '${t}' is already declared in a map.`,$q=t=>`The priority '${t}' is not a number.`;function Fq(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=Pt(t)?t:kq,e=Pt(e)?e:$q;function i(s,o){if(!zn(s))throw new Error(e(s));if(n.has(s))throw new Error(t(s));n.set(s,o)}function r(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xS;const[o,a]=AO.get(s)||AO.get(xS);return[...n].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:i,getItems:r}}const Vq=t=>`The id '${t}' is already declared in a map.`;function vv(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Pt(t)?t:Vq;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function i(u){return e.delete(u)}function r(){e.clear()}function s(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function o(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:r,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:i}}const Wq=t=>`'${t}' value is already declared in a unique set.`;function Bq(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Pt(t)?t:Wq;function n(s){if(e.has(s))throw new Error(t(s));e.add(s)}function i(){return[...e]}function r(){e.clear()}return{addItem:n,clear:r,getItems:i}}const Z0=t=>`There is already registered "${t}" plugin.`,jq=t=>`There is already registered plugin on priority "${t}".`,Uq=t=>`The priority "${t}" is not a number.`,PD=Fq({errorPriorityExists:jq,errorPriorityNaN:Uq}),ID=Bq({errorItemExists:Z0}),AS=vv({errorIdExists:Z0});function J0(){return[...PD.getItems(),...ID.getItems()]}function Ff(t){const e=Zn(t);return AS.getItem(e)}function Yq(t){return!!Ff(t)}function ot(t,e,n){[t,e,n]=Gq(t,e,n),Ff(t)===void 0&&zq(t,e,n)}function zq(t,e,n){const i=Zn(t);if(AS.hasItem(i))throw new Error(Z0(i));n===void 0?ID.addItem(i):PD.addItem(n,i),AS.addItem(i,e)}function Gq(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:Kq,getItem:Xq,hasItem:xD,getNames:qq,getValues:Zwe}=Kr("renderers");function Kp(t){if(typeof t=="function")return t;if(!xD(t))throw Error(`No registered renderer found under "${t}" name`);return Xq(t)}function xi(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Kq(t,e)}const{register:Zq,getItem:Jq,hasItem:AD,getNames:Qq,getValues:Jwe}=Kr("validators");function Q0(t){if(typeof t=="function")return t;if(!AD(t))throw Error(`No registered validator found under "${t}" name`);return Jq(t)}function Hl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Zq(t,e)}var e7=$n,t7=Ef,n7=_f,i7=Mf,r7=Y0;e7({target:"Array",proto:!0},{at:function(e){var n=t7(this),i=n7(n),r=i7(e),s=r>=0?r:i+r;return s<0||s>=i?void 0:n[s]}});r7("at");var s7=$n,o7=gn,a7=Sf,l7=Mf,u7=Xw,c7=Mi,h7=o7("".charAt),d7=c7(function(){return"𠮷".at(-2)!=="\uD842"});s7({target:"String",proto:!0,forced:d7},{at:function(e){var n=u7(a7(this)),i=n.length,r=l7(e),s=r>=0?r:i+r;return s<0||s>=i?void 0:h7(n,s)}});function ah(t,e,n){return(e=f7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f7(t){var e=g7(t,"string");return typeof e=="symbol"?e:e+""}function g7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m7{constructor(){ah(this,"count",0),ah(this,"startColumn",null),ah(this,"endColumn",null),ah(this,"startPosition",null),ah(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:s,columnWidth:o}=n,a=r>0?s+1:s;i>=r&&i+o<=r+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(m<=r&&(this.startColumn-=1),m>=r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=o>0?r+1:r,d=i+r-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*s||i>u.at(-1)||-1*i-r>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function lh(t,e,n){return(e=p7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p7(t){var e=w7(t,"string");return typeof e=="symbol"?e:e+""}function w7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v7{constructor(){lh(this,"count",0),lh(this,"startRow",null),lh(this,"endRow",null),lh(this,"startPosition",null),lh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:s,rowHeight:o}=n;i>=r&&i+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=r-s&&(this.startRow-=1),d>=r-s)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=i+r-s,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||i>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function uh(t,e,n){return(e=C7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C7(t){var e=y7(t,"string");return typeof e=="symbol"?e:e+""}function y7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HD{constructor(){uh(this,"count",0),uh(this,"startColumn",null),uh(this,"endColumn",null),uh(this,"startPosition",null),uh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:s}=n;i<=r&&(this.startColumn=e);const o=r>0?s+1:s;i>=r&&i<=r+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=o>0?r+1:r;i+r-h<-1*s||i>u.at(-1)+c||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function ch(t,e,n){return(e=b7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b7(t){var e=S7(t,"string");return typeof e=="symbol"?e:e+""}function S7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ND{constructor(){ch(this,"count",0),ch(this,"startRow",null),ch(this,"endRow",null),ch(this,"startPosition",null),ch(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:s}=n;i<=r&&(this.startRow=e),i>=r&&i<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=r-s)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,i+r-s<0||i>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function hh(t,e,n){return(e=R7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R7(t){var e=E7(t,"string");return typeof e=="symbol"?e:e+""}function E7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T7{constructor(){hh(this,"count",0),hh(this,"startColumn",0),hh(this,"endColumn",0),hh(this,"startPosition",0),hh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function dh(t,e,n){return(e=M7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M7(t){var e=_7(t,"string");return typeof e=="symbol"?e:e+""}function _7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O7{constructor(){dh(this,"count",0),dh(this,"startRow",0),dh(this,"endRow",0),dh(this,"startPosition",0),dh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}class P7 extends HD{finalize(e){var n;super.finalize(e);const{overrideFn:i,totalColumns:r,startPositions:s}=e;this.startColumn!==null&&typeof i=="function"&&i(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=s[this.startColumn])!==null&&n!==void 0?n:null,r<this.endColumn&&(this.endColumn=r-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}class I7 extends ND{finalize(e){var n;super.finalize(e);const{overrideFn:i,totalRows:r,startPositions:s}=e;this.startRow!==null&&typeof i=="function"&&i(this),this.startRow<0&&(this.startRow=0),this.startPosition=(n=s[this.startRow])!==null&&n!==void 0?n:null,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function HO(t,e,n){return(e=x7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x7(t){var e=A7(t,"string");return typeof e=="symbol"?e:e+""}function A7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DD{constructor(e){HO(this,"calculationTypes",[]),HO(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[i,r]=n;this.calculationResults.set(i,r),r.initialize(e)})}_process(e,n){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,i]=n;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function wr(t,e,n){return(e=H7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H7(t){var e=N7(t,"string");return typeof e=="symbol"?e:e+""}function N7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Cv=50;class D7 extends DD{constructor(e){let{calculationTypes:n,viewportWidth:i,scrollOffset:r,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(n),wr(this,"viewportWidth",0),wr(this,"scrollOffset",0),wr(this,"zeroBasedScrollOffset",0),wr(this,"totalColumns",0),wr(this,"columnWidthFn",null),wr(this,"columnWidth",0),wr(this,"overrideFn",null),wr(this,"inlineStartOffset",0),wr(this,"totalCalculatedWidth",0),wr(this,"startPositions",[]),wr(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Cv:n}}function Yi(t,e,n){return(e=L7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L7(t){var e=k7(t,"string");return typeof e=="symbol"?e:e+""}function k7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const LD=23;class $7 extends DD{constructor(e){let{calculationTypes:n,viewportHeight:i,scrollOffset:r,totalRows:s,rowHeightFn:o,overrideFn:a,horizontalScrollbarHeight:l}=e;super(n),Yi(this,"viewportHeight",0),Yi(this,"scrollOffset",0),Yi(this,"zeroBasedScrollOffset",0),Yi(this,"totalRows",0),Yi(this,"rowHeightFn",null),Yi(this,"rowHeight",0),Yi(this,"overrideFn",null),Yi(this,"horizontalScrollbarHeight",0),Yi(this,"innerViewportHeight",0),Yi(this,"totalCalculatedHeight",0),Yi(this,"startPositions",[]),Yi(this,"needReverse",!0),this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=s,this.rowHeightFn=o,this.overrideFn=a,this.horizontalScrollbarHeight=l??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?LD:n}}function F7(t,e,n){V7(t,e),e.set(t,n)}function V7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NO(t,e,n){return(e=W7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W7(t){var e=B7(t,"string");return typeof e=="symbol"?e:e+""}function B7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Su(t,e){return t.get(kD(t,e))}function DO(t,e,n){return t.set(kD(t,e),n),n}function kD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gs=new WeakMap;class ql{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;NO(this,"row",null),NO(this,"col",null),F7(this,Gs,!1),DO(Gs,this,i),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:i,countRowHeaders:r,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-r||this.row>=n||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Su(Gs,this)}isSouthEastOf(e){return this.row>=e.row&&(Su(Gs,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Su(Gs,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Su(Gs,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Su(Gs,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof ql&&DO(Gs,this,e.isRtl()),this}clone(){return new ql(this.row,this.col,Su(Gs,this))}toObject(){return{row:this.row,col:this.col}}}function j7(t,e,n){U7(t,e),e.set(t,n)}function U7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XC(t,e,n){return(e=Y7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y7(t){var e=z7(t,"string");return typeof e=="symbol"?e:e+""}function z7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zi(t,e){return t.get($D(t,e))}function G7(t,e,n){return t.set($D(t,e),n),n}function $D(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gi=new WeakMap;class Vf{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;XC(this,"highlight",null),XC(this,"from",null),XC(this,"to",null),j7(this,gi,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=i.clone(),G7(gi,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:i}=e,r=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return r.row<=n&&s.row>=n&&r.col<=i&&s.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(i.row,o.row),u=Math.min(i.col,o.col),c=Math.max(r.row,a.row),h=Math.max(r.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(s),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return zi(gi,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return zi(gi,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return zi(gi,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return zi(gi,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return zi(gi,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return zi(gi,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return zi(gi,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return zi(gi,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof ql))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return n.top===i.top&&r.push("top"),n.right===i.right&&r.push(zi(gi,this)?"left":"right"),n.bottom===i.bottom&&r.push("bottom"),n.left===i.left&&r.push(zi(gi,this)?"right":"left"),r}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let s=e.col;s<=n.col;s++)!(this.from.row===r&&this.from.col===s)&&!(this.to.row===r&&this.to.col===s)&&i.push(this._createCellCoords(r,s));return i}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let s=e.col;s<=n.col;s++)e.row===r&&e.col===s?i.push(e):n.row===r&&n.col===s?i.push(n):i.push(this._createCellCoords(r,s));return i}forAll(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=n.row;r<=i.row;r++)for(let s=n.col;s<=i.col;s++)if(e(r,s)===!1)return}clone(){return new Vf(this.highlight,this.from,this.to,zi(gi,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new ql(e,n,zi(gi,this))}}function Zr(t,e,n){K7(t,e),e.set(t,n)}function K7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pe(t,e){return t.get(FD(t,e))}function Yo(t,e,n){return t.set(FD(t,e),n),n}function FD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gi=new WeakMap,qC=new WeakMap,En=new WeakMap,Ru=new WeakMap,Og=new WeakMap,vr=new WeakMap,ZC=new WeakMap,fh=new WeakMap,Za=new WeakMap,Jr=new WeakMap;let VD=class{constructor(e,n,i,r,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Zr(this,Gi,void 0),Zr(this,qC,void 0),Zr(this,En,void 0),Zr(this,Ru,void 0),Zr(this,Og,void 0),Zr(this,vr,void 0),Zr(this,ZC,void 0),Zr(this,fh,void 0),Zr(this,Za,[null,null]),Zr(this,Jr,[null,null]),Yo(Gi,this,i),Yo(qC,this,n),Yo(En,this,s),Yo(Ru,this,o),Yo(Og,this,a),Yo(vr,this,r),Yo(ZC,this,e),this.registerEvents()}registerEvents(){Pe(vr,this).addEventListener(Pe(En,this).holder,"contextmenu",i=>this.onContextMenu(i)),Pe(vr,this).addEventListener(Pe(En,this).TABLE,"mouseover",i=>this.onMouseOver(i)),Pe(vr,this).addEventListener(Pe(En,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{Pe(vr,this).addEventListener(Pe(En,this).holder,"touchstart",i=>this.onTouchStart(i)),Pe(vr,this).addEventListener(Pe(En,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),Pe(vr,this).addEventListener(Pe(En,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Pe(Gi,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Pe(Gi,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{Pe(vr,this).addEventListener(Pe(En,this).holder,"mouseup",i=>this.onMouseUp(i)),Pe(vr,this).addEventListener(Pe(En,this).holder,"mousedown",i=>this.onMouseDown(i))};bo()?e():(F0()&&e(),n())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(Pe(fh,this)&&i){const[r,s]=[i.row,Pe(fh,this).from.row],[o,a]=[i.col,Pe(fh,this).from.col];return r===s&&o===a}return!1}parentCell(e){const n={},i=Pe(En,this).TABLE,r=sd(e,["TD","TH"],i);return r?(n.coords=Pe(En,this).getCoords(r),n.TD=r):De(e,"wtBorder")&&De(e,"current")?(n.coords=Pe(Ru,this).getFocusSelection().cellRange.highlight,n.TD=Pe(En,this).getCell(n.coords)):De(e,"wtBorder")&&De(e,"area")&&Pe(Ru,this).getAreaSelection().cellRange&&(n.coords=Pe(Ru,this).getAreaSelection().cellRange.to,n.TD=Pe(En,this).getCell(n.coords)),n}onMouseDown(e){const n=Pe(qC,this).rootDocument.activeElement,i=$0(WN,e.target),r=e.target;if(!["TD","TH"].includes(n.nodeName)&&(r===n||i(0)===n||i(1)===n))return;const s=this.parentCell(r);De(r,"corner")?Pe(Gi,this).getSetting("onCellCornerMouseDown",e,r):s.TD&&Pe(Gi,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(Pe(Jr,this)[0]=s.TD,clearTimeout(Pe(Za,this)[0]),Pe(Za,this)[0]=setTimeout(()=>{Pe(Jr,this)[0]=null},1e3))}onContextMenu(e){if(Pe(Gi,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!Pe(Gi,this).has("onCellMouseOver"))return;const n=Pe(En,this).TABLE,i=sd(e.target,["TD","TH"],n),r=Pe(Og,this)||this;i&&i!==r.lastMouseOver&&Ma(i,n)&&(r.lastMouseOver=i,this.callListener("onCellMouseOver",e,Pe(En,this).getCoords(i),i))}onMouseOut(e){if(!Pe(Gi,this).has("onCellMouseOut"))return;const n=Pe(En,this).TABLE,i=sd(e.target,["TD","TH"],n),r=sd(e.relatedTarget,["TD","TH"],n),s=Pe(Og,this)||this;i&&i!==r&&Ma(i,n)&&(this.callListener("onCellMouseOut",e,Pe(En,this).getCoords(i),i),r===null&&(s.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&Pe(Gi,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===Pe(Jr,this)[0]&&n.TD===Pe(Jr,this)[1]?(De(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),Pe(Jr,this)[0]=null,Pe(Jr,this)[1]=null):n.TD===Pe(Jr,this)[0]&&(Pe(Jr,this)[1]=n.TD,clearTimeout(Pe(Za,this)[1]),Pe(Za,this)[1]=setTimeout(()=>{Pe(Jr,this)[1]=null},500)))}onTouchStart(e){Yo(fh,this,Pe(Ru,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const i=e.target,r=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,s=Se(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&s&&Pe(Gi,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];B0()&&(dD()||fD())&&this.selectedCellWasTouched(i)&&!a.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,i,r){const s=Pe(Gi,this).getSettingPure(e);s&&s(n,i,r,Pe(ZC,this).call(this))}destroy(){clearTimeout(Pe(Za,this)[0]),clearTimeout(Pe(Za,this)[1]),Pe(vr,this).destroy()}};function JC(t,e,n){return(e=X7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X7(t){var e=q7(t,"string");return typeof e=="symbol"?e:e+""}function q7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z7{constructor(e,n,i){JC(this,"offset",void 0),JC(this,"total",void 0),JC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function QC(t,e,n){return(e=J7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J7(t){var e=Q7(t,"string");return typeof e=="symbol"?e:e+""}function Q7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eZ{constructor(e,n,i){QC(this,"offset",void 0),QC(this,"total",void 0),QC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const tZ=0,Xp=1,qp=2;function Pg(t,e,n){return(e=nZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nZ(t){var e=iZ(t,"string");return typeof e=="symbol"?e:e+""}function iZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LO{constructor(){Pg(this,"currentSize",0),Pg(this,"nextSize",0),Pg(this,"currentOffset",0),Pg(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function ey(t,e,n){return(e=rZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rZ(t){var e=sZ(t,"string");return typeof e=="symbol"?e:e+""}function sZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oZ{constructor(){ey(this,"size",new LO),ey(this,"workingSpace",tZ),ey(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof LO}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Xp,e.workingSpace=qp,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=qp,e.workingSpace=Xp,this.sharedSize=e.getViewSize()}}function Eu(t,e,n){return(e=aZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aZ(t){var e=lZ(t,"string");return typeof e=="symbol"?e:e+""}function lZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WD{constructor(e,n,i){Eu(this,"rootNode",void 0),Eu(this,"nodesPool",void 0),Eu(this,"sizeSet",new oZ),Eu(this,"childNodeType",void 0),Eu(this,"visualIndex",0),Eu(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=i.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let i=0;if(this.isSharedViewSet()){let r=e.firstElementChild;for(;r;){if(r.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(Xp))break;r=r.nextElementSibling}}else i=e.childElementCount;return i}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,i=this.isSharedViewSet(),{nextSize:r}=n.getViewSize();let s=this.getRenderedChildCount();for(;s<r;){const a=this.nodesPool();!i||i&&n.isPlaceOn(qp)?e.appendChild(a):e.insertBefore(a,e.firstChild),s+=1}const o=i&&n.isPlaceOn(Xp);for(;s>r;)e.removeChild(o?e.firstChild:e.lastChild),s-=1}render(){const{rootNode:e,sizeSet:n}=this;let i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(qp)&&(i+=n.sharedSize.nextSize);let r=e.childNodes[i];if(r.tagName!==this.childNodeType){const s=this.nodesPool();e.replaceChild(s,r),r=s}this.collectedNodes.push(r),this.visualIndex+=1}end(){}}class BD extends WD{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function uZ(t,e,n){return(e=cZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cZ(t){var e=hZ(t,"string");return typeof e=="symbol"?e:e+""}function hZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dZ{constructor(e){uZ(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function gh(t,e,n){return(e=fZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fZ(t){var e=gZ(t,"string");return typeof e=="symbol"?e:e+""}function gZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wf{constructor(e,n){gh(this,"nodesPool",null),gh(this,"nodeType",void 0),gh(this,"rootNode",void 0),gh(this,"table",null),gh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new dZ(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function kO(t,e,n){return(e=mZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mZ(t){var e=pZ(t,"string");return typeof e=="symbol"?e:e+""}function pZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wZ extends Wf{constructor(){super("TH"),kO(this,"orderViews",new WeakMap),kO(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new BD(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:i,rows:r,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=r.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=s.obtainOrderView(l);u.appendView(c).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<i;h++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),cu(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&xe(d,[a9(),m9(),O0(h+1),Wc(-1)]),n[h](a,d,h)}u.end()}}}class vZ extends Wf{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,s=r+n;for(let a=0,l=e;a<l;a++){for(i=this.rootNode.childNodes[a],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<s;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)i.removeChild(i.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&Br(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&xe(this.rootNode,[LN()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:i,columnsToRender:r,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&xe(o,[yS(),VN(n+1)]);for(let a=-1*s;a<r;a+=1){const l=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),cu(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&xe(u,[O0(a+1+this.table.rowHeadersCount),Wc(-1),l9(),...a>=0?[g9()]:[yS()]]),i[n](l,u,n)}}}}let $O=!1;class CZ extends Wf{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,i=e+n;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!$O&&e>1e3&&($O=!0,vt(Ct`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<n;r++){const s=this.table.renderedColumnToSource(r),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[r].style.width=`${o}px`}for(let r=0;r<e;r++){const s=this.table.renderedColumnToSource(r),o=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[r+n].style.width=`${o}px`}const i=this.rootNode.firstChild;i&&ie(i,"rowHeader")}}function yZ(t,e,n){return(e=bZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bZ(t){var e=SZ(t,"string");return typeof e=="symbol"?e:e+""}function SZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let FO=!1;class RZ extends Wf{constructor(e){super("TR",e),yZ(this,"orderView",void 0),this.orderView=new WD(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!FO&&e>1e3&&(FO=!0,vt(Ct`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&xe(this.rootNode,[LN()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var n,i;xe(s,[yS(),VN(o+((n=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function VO(t,e,n){return(e=EZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EZ(t){var e=TZ(t,"string");return typeof e=="symbol"?e:e+""}function TZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MZ extends Wf{constructor(){super("TD"),VO(this,"orderViews",new WeakMap),VO(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new BD(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:i,rowHeaders:r}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=i.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=r.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<n;d++){c.render();const f=c.getCurrentNode(),m=this.table.renderedColumnToSource(d);if(De(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),cu(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,m,f),this.table.isAriaEnabled()){var s,o;xe(f,[...f.hasAttribute("role")?[]:[o9()],Wc(-1),O0(m+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}c.end()}}}function wn(t,e,n){return(e=_Z(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Z(t){var e=OZ(t,"string");return typeof e=="symbol"?e:e+""}function OZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PZ{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};wn(this,"rootNode",void 0),wn(this,"rootDocument",void 0),wn(this,"rowHeaders",null),wn(this,"columnHeaders",null),wn(this,"colGroup",null),wn(this,"rows",null),wn(this,"cells",null),wn(this,"rowFilter",null),wn(this,"columnFilter",null),wn(this,"rowUtils",null),wn(this,"columnUtils",null),wn(this,"rowsToRender",0),wn(this,"columnsToRender",0),wn(this,"rowHeaderFunctions",[]),wn(this,"rowHeadersCount",0),wn(this,"columnHeaderFunctions",[]),wn(this,"columnHeadersCount",0),wn(this,"cellRenderer",void 0),wn(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:i,rows:r,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),i.setTable(this),r.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=i,this.rows=r,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let i=0;i<e;i++){const r=n.getRenderedNode(i);if(r.firstChild){const s=this.renderedRowToSource(i),o=this.rowUtils.getHeightByOverlayName(s,this.activeOverlayName);o?r.firstChild.style.height=`${o-1}px`:r.firstChild.style.height=""}}}}class IZ{constructor(){let{TABLE:e,THEAD:n,COLGROUP:i,TBODY:r,rowUtils:s,columnUtils:o,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new PZ(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new wZ,columnHeaders:new vZ(n),colGroup:new CZ(i),rows:new RZ(r),cells:new MZ}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function mh(t,e,n){xZ(t,e),e.set(t,n)}function xZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ig(t,e,n){return(e=AZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AZ(t){var e=HZ(t,"string");return typeof e=="symbol"?e:e+""}function HZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wn(t,e){return t.get(jD(t,e))}function ph(t,e,n){return t.set(jD(t,e),n),n}function jD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xg=new WeakMap,Tu=new WeakMap,wh=new WeakMap,Ag=new WeakMap,Ja=new WeakMap;class NZ{constructor(e){let{totalColumns:n,stretchMode:i,stretchingColumnWidthFn:r,columnWidthFn:s}=e;Ig(this,"stretchAllRatio",0),Ig(this,"stretchLastWidth",0),Ig(this,"stretchAllColumnsWidth",[]),mh(this,xg,0),Ig(this,"needVerifyLastColumnWidth",!0),mh(this,Tu,()=>0),mh(this,wh,o=>o),mh(this,Ag,o=>o),mh(this,Ja,()=>"none"),ph(Tu,this,n),ph(Ja,this,i),ph(wh,this,r??Wn(wh,this)),ph(Ag,this,s??Wn(Ag,this))}refreshStretching(e){if(Wn(Ja,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,ph(xg,this,e);let n=0;for(let r=0;r<Wn(Tu,this).call(this);r++){const s=this._getColumnWidth(r),o=Wn(wh,this).call(this,void 0,r);typeof o=="number"?e-=o:n+=s}const i=e-n;if(Wn(Ja,this).call(this)==="all"&&i>0)this.stretchAllRatio=e/n,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(Wn(Ja,this).call(this)==="last"&&e!==1/0){const r=this._getColumnWidth(Wn(Tu,this).call(this)-1),s=i+r;this.stretchLastWidth=s>=0?s:r}}getStretchedColumnWidth(e,n){let i=null;return Wn(Ja,this).call(this)==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(e,n):Wn(Ja,this).call(this)==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(e)),i}_getStretchedAllColumnWidth(e,n){let i=0;if(!this.stretchAllColumnsWidth[e]){const r=Math.round(n*this.stretchAllRatio),s=Wn(wh,this).call(this,r,e);s===void 0?this.stretchAllColumnsWidth[e]=r:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===Wn(Tu,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let r=0;r<this.stretchAllColumnsWidth.length;r++)i+=this.stretchAllColumnsWidth[r];i!==Wn(xg,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=Wn(xg,this)-i)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===Wn(Tu,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=Wn(Ag,this).call(this,e);return isNaN(n)&&(n=Cv),n}}function Hg(t,e,n){return(e=DZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DZ(t){var e=LZ(t,"string");return typeof e=="symbol"?e:e+""}function LZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kZ{constructor(e,n){Hg(this,"dataAccessObject",void 0),Hg(this,"wtSettings",void 0),Hg(this,"headerWidths",new Map),Hg(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=n,this.stretching=new NZ({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(i,r)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",i,r),columnWidthFn:i=>this.dataAccessObject.wtTable.getColumnWidth(i)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let n=this.getWidth(e);const i=this.stretching.getStretchedColumnWidth(e,n);return i&&(n=i),n}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(n=n?Math.max(n,i):i),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:n,cloneSource:i}=this.dataAccessObject,r=i?i.wtTable.holder:e.holder,s=r.offsetHeight<r.scrollHeight?Rn():0;this.stretching.refreshStretching(n.getViewportWidth()-s)}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const i=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let s=0;s<i;s++){let o=Array.isArray(n)?n[s]:n;o=o??r,this.headerWidths.set(s,o)}}}}function WO(t,e,n){return(e=$Z(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Z(t){var e=FZ(t,"string");return typeof e=="symbol"?e:e+""}function FZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VZ{constructor(e,n){WO(this,"dataAccessObject",void 0),WO(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}getHeightByOverlayName(e,n){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(i=i===void 0?r:Math.max(i,r)),i}}function Qr(t,e,n){return(e=WZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WZ(t){var e=BZ(t,"string");return typeof e=="symbol"?e:e+""}function BZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uc{constructor(e,n,i,r,s){Qr(this,"wtSettings",null),Qr(this,"domBindings",void 0),Qr(this,"TBODY",null),Qr(this,"THEAD",null),Qr(this,"COLGROUP",null),Qr(this,"hasTableHeight",!0),Qr(this,"hasTableWidth",!0),Qr(this,"isTableVisible",!1),Qr(this,"tableOffset",0),Qr(this,"holderOffset",0),this.domBindings=i,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,I0(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new VZ(this.dataAccessObject,this.wtSettings),this.columnUtils=new kZ(this.dataAccessObject,this.wtSettings),this.tableRenderer=new IZ({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&xe(i,[xs()]),i}createHider(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&xe(i,[xs()]),i}createHolder(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&xe(i.parentNode,[xs()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&xe(i,[xs()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:i,wtViewport:r}=this.dataAccessObject,s=n.getSetting("totalRows"),o=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=bn(this.holder),h=r.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=i.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=bn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=s>0?this.getFirstRenderedRow():0,m=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new eZ(f,s,c),this.columnFilter=new Z7(m,o,l);let p=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),p=y.skipRender!==!0}if(p){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(_s)||this.is(Oa))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let y;if(this.isMaster&&(y=this.dataAccessObject.workspaceWidth,r.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(_s))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),i.refresh(!1),i.applyToDOM();const E=At(this.hider),T=At(this.TABLE);E!==0&&T!==E&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),y!==r.getWorkspaceWidth()&&(r.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(_s)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(d=i.bottomOverlay.resetFixedPosition()||d),d=i.inlineStartOverlay.resetFixedPosition()||d,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const r=this.wtSettings.getSetting("defaultRowHeight");let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,s=this.getColumnHeaderHeight(i),o=this.getColumnHeader(n,i),o&&(a=Dl(o),(!s&&r<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a),Array.isArray(l)?l[i]!==null&&l[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let s=0,o=r.length;s<o;s++)if(i[s]){if(!n[s]||n[s].childNodes.length===0)return;n[s].childNodes[0].style.height=`${i[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(_s))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let r=0;r<i;r++){const s=this.rowFilter.renderedToSource(r);n.oversizedRows&&n.oversizedRows[s]&&(n.oversizedRows[s]=void 0)}}}getCell(e){let n=e.row,i=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",n,i);if(r&&Array.isArray(r)&&([n,i]=r),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!o&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let n=null,i=null;if(e<0){var r;n=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var s;n=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(r=>{const s=r.childNodes[i];s&&n.push(s)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(n>=i)return;const r=this.rowFilter.sourceToRendered(e),s=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,a=(r<0?this.THEAD:this.TBODY).childNodes[s];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s==null?void 0:s.childNodes[r];o&&n.push(o)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Aa(n,["TD","TH"])),n===null)return null;const i=n.parentNode,r=i.parentNode;let s=UN(i),o=n.cellIndex;return ra(Ql,n,this.wtRootElement)||ra(Zl,n,this.wtRootElement)?r.nodeName==="THEAD"&&(s-=r.childNodes.length):ra(Oa,n,this.wtRootElement)||ra(_s,n,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-r.childNodes.length+s:r===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s),ra(Ql,n,this.wtRootElement)||ra(Jl,n,this.wtRootElement)||ra(Oa,n,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),i=Dl(this.TBODY)-1;let r,s,o,a,l;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,o=this.rowFilter.renderedToSource(e),r=this.getRowHeight(o),a=this.getTrForRow(o),l=a.querySelector("th"),l?s=Dl(l):s=Dl(a)-1,(!r&&this.wtSettings.getSetting("defaultRowHeight")<s||r<s)&&(s+=1,this.dataAccessObject.wtViewport.oversizedRows[o]=s)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return At(this.TABLE)}getHeight(){return sn(this.TABLE)}getTotalWidth(){const e=At(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=sn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Kl(this.TABLE)}_modifyRowHeaderWidth(e){let n=Pt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const jZ="stickyRowsBottom",eE={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};js(eE,"MIXIN_NAME",jZ,{writable:!1,enumerable:!1});const UZ="stickyColumnsStart",yv={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};js(yv,"MIXIN_NAME",UZ,{writable:!1,enumerable:!1});class tE extends Uc{constructor(e,n,i,r){super(e,n,i,r,Oa)}}yt(tE,eE);yt(tE,yv);const Zl="top",_s="bottom",Jl="inline_start",Ql="top_inline_start_corner",Oa="bottom_inline_start_corner",UD=[Zl,_s,Jl,Ql,Oa],YZ=new Map([[Zl,`ht_clone_${Zl}`],[_s,`ht_clone_${_s}`],[Jl,`ht_clone_${Jl} ht_clone_left`],[Ql,`ht_clone_${Ql} ht_clone_top_left_corner`],[Oa,`ht_clone_${Oa} ht_clone_bottom_left_corner`]]);function zZ(t,e){GZ(t,e),e.add(t)}function GZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KZ(t,e,n){return(e=XZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XZ(t){var e=qZ(t,"string");return typeof e=="symbol"?e:e+""}function qZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ng(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vh=new WeakSet;class ZZ{constructor(e){zZ(this,vh),KZ(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,i,r,s){const o=this.scrollViewportHorizontally(e.col,i,s),a=this.scrollViewportVertically(e.row,n,r);return o||a}scrollViewportHorizontally(e,n,i){const{drawn:r,totalColumns:s}=this.dataAccessObject;if(!r||!Number.isInteger(e)||e<0||e>s)return!1;const o=n===void 0&&i===void 0,{fixedColumnsStart:a,inlineStartOverlay:l}=this.dataAccessObject;if(o&&e<a||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>s))return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(o&&(e<u||e>c)||!o)&&(h=l.scrollTo(e,o?e>=this.getLastPartiallyVisibleColumn():n)),h}scrollViewportVertically(e,n,i){const{drawn:r,totalRows:s}=this.dataAccessObject;if(!r||!Number.isInteger(e)||e<0||e>s)return!1;const o=n===void 0&&i===void 0,{fixedRowsBottom:a,fixedRowsTop:l,topOverlay:u}=this.dataAccessObject;if(o&&(e<l||e>s-a-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>s))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(o&&(e<c||e>h)||!o)&&(d=u.scrollTo(e,o?e>=this.getLastPartiallyVisibleRow():i)),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Ng(vh,this,jO).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Ng(vh,this,jO).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Ng(vh,this,BO).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Ng(vh,this,BO).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function BO(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:i,wtViewport:r,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(n.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const c=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=bn(i.wtRootElement).left;const u=Math.abs(A0(o,o));if(l>u){const c=H0(o);let h=r.getRowHeaderWidth();for(let d=1;d<=s;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function jO(t){const{topOverlay:e,wtTable:n,wtViewport:i,totalRows:r,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=bn(n.wtRootElement),a=cv(s,s);if(o.top>a){const l=Dl(s);let u=i.getColumnHeaderHeight();for(let c=1;c<=r;c++)if(u+=e.sumCellSizes(c-1,c),o.top+u-a>=l){t=c-2;break}}}return t}function Cr(t,e,n){return(e=JZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JZ(t){var e=QZ(t,"string");return typeof e=="symbol"?e:e+""}function QZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nE{get eventManager(){return new hr(this)}constructor(e,n){Cr(this,"wtTable",void 0),Cr(this,"wtScroll",void 0),Cr(this,"wtViewport",void 0),Cr(this,"wtOverlays",void 0),Cr(this,"selectionManager",void 0),Cr(this,"wtEvent",void 0),Cr(this,"guid",`wt_${E0()}`),Cr(this,"drawInterrupted",!1),Cr(this,"drawn",!1),Cr(this,"domBindings",void 0),Cr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new ZZ(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,i){Ha(i,e[n])}])}}createCellCoords(e,n){return new ql(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,i){return new Vf(e,n,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=i-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,i,r,s){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,i,r,s)}scrollViewportHorizontally(e,n,i){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,i)}scrollViewportVertically(e,n,i){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,i)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function UO(t,e,n){return(e=eJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eJ(t){var e=tJ(t,"string");return typeof e=="symbol"?e:e+""}function tJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nJ extends nE{constructor(e,n,i){super(e,n),UO(this,"cloneSource",void 0),UO(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new VD(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function iJ(t,e,n){return(e=rJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rJ(t){var e=sJ(t,"string");return typeof e=="symbol"?e:e+""}function sJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bf{constructor(e,n,i,r,s){iJ(this,"wtSettings",null),js(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=n,this.wtSettings=r;const{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Xl(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Xl(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=rf(e.TABLE)}getRelativeCellPosition(e,n,i){if(this.clone.wtTable.holder.contains(e)===!1){vt(`The provided element is not a child of the ${this.type} overlay`);return}const r=this.mainTableScrollableElement===this.domBindings.rootWindow,s=i<this.wtSettings.getSetting("fixedColumnsStart"),o=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return r?h=this.getRelativeCellPositionWithinWindow(o,s,c,u):h=this.getRelativeCellPositionWithinHolder(o,a,s,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,i,r){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!n)o=r.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+Rn())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=r.top,{start:i.start+o,top:i.top+a}}getRelativeCellPositionWithinHolder(e,n,i,r,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(i||(a=o.horizontal-s.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-s.top);return{start:r.start-a,top:r.top-l}}makeClone(){if(UD.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=i.createElement("div"),o=i.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${YZ.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,n.getSetting("ariaTags")&&xe(s,[xs()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Zl||u==="vertical"&&this.type===Jl?this.mainTableScrollableElement=r:r.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=rf(e.TABLE),new nJ(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=e.style,r=n.style,s=e.parentNode.style;[i,r,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class oJ extends Bf{constructor(e,n,i,r,s,o){super(e,n,Oa,i,r),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new tE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${s}px`,n.style.bottom=`${o}px`}else Lf(n),this.repositionOverlay();let i=sn(this.clone.wtTable.TABLE);const r=At(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),n.style.height=`${i}px`,n.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let s=0;n.hasVerticalScroll()||(s+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(s+=Rn(i)),r.style.bottom=`${s}px`}}const aJ="calculatedColumns",bv={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};js(bv,"MIXIN_NAME",aJ,{writable:!1,enumerable:!1});class iE extends Uc{constructor(e,n,i,r){super(e,n,i,r,_s)}}yt(iE,eE);yt(iE,bv);function lJ(t,e,n){return(e=uJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uJ(t){var e=cJ(t,"string");return typeof e=="symbol"?e:e+""}function cJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hJ extends Bf{constructor(e,n,i,r){super(e,n,_s,i,r),lJ(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new iE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let i=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!r||r!=="vertical")?(i=this.getOverlayOffset(),n.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let s=0;n.hasVerticalScroll()||(s+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(s+=Rn(i)),r.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;return this.mainTableScrollableElement===n?(n.scrollTo(uv(n),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:i,wtSettings:r}=this.wot,s=r.getSetting("defaultRowHeight");let o=e,a=0;for(;o<n;){const l=i.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=Rn(i),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=s),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=sn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let i=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;n&&s.offsetHeight!==s.clientHeight&&(o=Rn(this.domBindings.rootDocument)),n?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=o,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return cv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=r-s,a=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+r,0),i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==n,r=this.wtSettings.getSetting("columnHeaders");let s=!1;if((i||n===0)&&r.length>0){const o=this.wot.wtTable.holder.parentNode,a=De(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(ie(o,"innerBorderBottom"),s=!a):(We(o,"innerBorderBottom"),s=a)}return s}}const dJ="calculatedRows",rE={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};js(rE,"MIXIN_NAME",dJ,{writable:!1,enumerable:!1});class sE extends Uc{constructor(e,n,i,r){super(e,n,i,r,Jl)}}yt(sE,rE);yt(sE,yv);const fJ="localHooks",Fn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,i,r,s,o){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Yp(this._localHooks[t][l],this,e,n,i,r,s,o)}},clearLocalHooks(){return this._localHooks={},this}};js(Fn,"MIXIN_NAME",fJ,{writable:!1,enumerable:!1});let YD=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};yt(YD,Fn);const zD="active-header",oE="header",aE="area",lE="focus",gJ="fill",mJ="row",pJ="column",wJ="custom-selection",uE=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var vJ=Y0;vJ("flat");function CJ(t,e){GD(t,e),e.add(t)}function YO(t,e,n){GD(t,e),e.set(t,n)}function GD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function on(t,e){return t.get(Ed(t,e))}function zO(t,e,n){return t.set(Ed(t,e),n),n}function Ed(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yr=new WeakMap,wi=new WeakMap,Dg=new WeakSet;class yJ{constructor(){CJ(this,Dg),YO(this,yr,void 0),YO(this,wi,void 0)}setActiveOverlay(e){return zO(wi,this,e),this}setActiveSelection(e){return zO(yr,this,e),this}scan(){const e=on(yr,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="area"?this.scanCellsRange(i=>n.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i)),this.scanCellsRange(i=>n.add(i))):e==="fill"?this.scanCellsRange(i=>n.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>n.add(i)),this.scanRowsInCellsRange(i=>n.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanColumnsInCellsRange(i=>n.add(i))),n}scanColumnsInHeadersRange(e){const[n,i,r,s]=on(yr,this).getCorners(),{wtTable:o}=on(wi,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let u=0;for(let c=-o.getRowHeadersCount();c<a;c++){const h=o.columnFilter.renderedToSource(c);if(!(h<i||h>s)){for(let d=-l;d<0;d++){if(d<n||d>r)continue;const f=d+l;let m=o.getColumnHeader(h,f);const p=on(wi,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:on(yr,this).settings.selectionType,columnCursor:u,selectionWidth:s-i+1});p!==null&&(p!==h&&(m=o.getColumnHeader(p,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[n,i,r,s]=on(yr,this).getCorners(),{wtTable:o}=on(wi,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let u=0;for(let c=-o.getColumnHeadersCount();c<a;c++){const h=o.rowFilter.renderedToSource(c);if(!(h<n||h>r)){for(let d=-l;d<0;d++){if(d<i||d>s)continue;const f=d+l;let m=o.getRowHeader(h,f);const p=on(wi,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:on(yr,this).settings.selectionType,rowCursor:u,selectionHeight:r-n+1});p!==null&&(p!==h&&(m=o.getRowHeader(p,f)),e(m))}u+=1}}}scanCellsRange(e){const[n,i,r,s]=on(yr,this).getCorners(),{wtTable:o}=on(wi,this);Ed(Dg,this,ty).call(this,(a,l)=>{if(a>=n&&a<=r&&l>=i&&l<=s){const u=o.getCell(on(wi,this).createCellCoords(a,l)),c=on(wi,this).getSetting("onAfterDrawSelection",a,l,on(yr,this).settings.layerLevel);typeof c=="string"&&ie(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,i]=on(yr,this).getCorners(),{wtTable:r}=on(wi,this);Ed(Dg,this,ty).call(this,(s,o)=>{if(s>=n&&s<=i){const a=r.getCell(on(wi,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,n,,i]=on(yr,this).getCorners(),{wtTable:r}=on(wi,this);Ed(Dg,this,ty).call(this,(s,o)=>{if(o>=n&&o<=i){const a=r.getCell(on(wi,this).createCellCoords(s,o));e(a)}})}}function ty(t){const{wtTable:e}=on(wi,this),n=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let r=0;r<n;r+=1){const s=e.rowFilter.renderedToSource(r);for(let o=0;o<i;o+=1)t(s,e.columnFilter.renderedToSource(o))}}class GO{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=uE,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,i=this.main.childNodes.length;n<i;n++){const r=this.main.childNodes[n];this.eventManager.addEventListener(r,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),gr(e);const i=this,r=this.wot.rootDocument.body,s=n.getBoundingClientRect();n.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(i.eventManager.removeEventListener(r,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(r,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const i=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let a=0;a<5;a++){const l=i[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),r=u.style,r.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,r.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,r.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),bo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=n.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const r={position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${parseInt(i/1.5,10)}px`};ze(r,(o,a)=>{this.selectionHandles.styles.bottomHitArea[a]=o,this.selectionHandles.styles.topHitArea[a]=o});const s={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};ze(s,(o,a)=>{this.selectionHandles.styles.bottom[a]=o,this.selectionHandles.styles.top[a]=o}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||n!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,i,r,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),p=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(i-m-1,10)}px`,u[l]=`${parseInt(r-m-1,10)}px`,c.top=`${parseInt(i-p/4*3,10)}px`,c[l]=`${parseInt(r-p/4*3,10)}px`;const T=Math.min(parseInt(r+s,10),y-m-f*2),M=Math.min(parseInt(r+s-p/4,10),y-p-f*2);h[l]=`${T}px`,d[l]=`${M}px`;const P=Math.min(parseInt(i+o,10),E-m-f*2),H=Math.min(parseInt(i+o-p/4,10),E-p-f*2);h.top=`${P}px`,d.top=`${H}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:i,rootWindow:r}=this.wot;let s,o,a,l,u,c;const h=n.getRenderedRowsCount();for(let le=0;le<h;le+=1){const ve=n.rowFilter.renderedToSource(le);if(ve>=e[0]&&ve<=e[2]){s=ve,u=e[0];break}}for(let le=h-1;le>=0;le-=1){const ve=n.rowFilter.renderedToSource(le);if(ve>=e[0]&&ve<=e[2]){o=ve;break}}const d=n.getRenderedColumnsCount();for(let le=0;le<d;le+=1){const ve=n.columnFilter.renderedToSource(le);if(ve>=e[1]&&ve<=e[3]){a=ve,c=e[1];break}}for(let le=d-1;le>=0;le-=1){const ve=n.columnFilter.renderedToSource(le);if(ve>=e[1]&&ve<=e[3]){l=ve;break}}if(s===void 0||a===void 0){this.disappear();return}let f=n.getCell(this.wot.createCellCoords(s,a));const m=s!==o||a!==l,p=m?n.getCell(this.wot.createCellCoords(o,l)):f,y=bn(f),E=m?bn(p):y,T=bn(n.TABLE),M=At(n.TABLE),P=y.top,H=y.left,U=this.wot.wtSettings.getSetting("rtlMode");let Y=0,Q=0;if(U){const le=At(f),ve=r.innerWidth-T.left-M;Q=H+le-E.left,Y=r.innerWidth-H-le-ve-1}else Q=E.left+At(p)-H,Y=H-T.left-1;if(this.isEntireColumnSelected(s,o)){const le=this.getDimensionsFromHeader("columns",a,l,u,T);let ve=null;le&&([ve,Y,Q]=le),ve&&(f=ve)}let q=P-T.top-1,Z=E.top+sn(p)-P;if(this.isEntireRowSelected(a,l)){const le=this.getDimensionsFromHeader("rows",s,o,c,T);let ve=null;le&&([ve,q,Z]=le),ve&&(f=ve)}const te=Ho(f,r);parseInt(te.borderTopWidth,10)>0&&(q+=1,Z=Z>0?Z-1:0),parseInt(te[U?"borderRightWidth":"borderLeftWidth"],10)>0&&(Y+=1,Q=Q>0?Q-1:0);const ue=U?"right":"left";this.topStyle.top=`${q}px`,this.topStyle[ue]=`${Y}px`,this.topStyle.width=`${Q}px`,this.topStyle.display="block",this.startStyle.top=`${q}px`,this.startStyle[ue]=`${Y}px`,this.startStyle.height=`${Z}px`,this.startStyle.display="block";const ce=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${q+Z-ce}px`,this.bottomStyle[ue]=`${Y}px`,this.bottomStyle.width=`${Q}px`,this.bottomStyle.display="block",this.endStyle.top=`${q}px`,this.endStyle[ue]=`${Y+Q-ce}px`,this.endStyle.height=`${Z+1}px`,this.endStyle.display="block";let Ee=this.settings.border.cornerVisible;Ee=typeof Ee=="function"?Ee(this.settings.layerLevel):Ee;const He=this.wot.getSetting("onModifyGetCellCoords",o,l);let[Le,be]=[o,l];if(He&&Array.isArray(He)&&([,,Le,be]=He),bo()||!Ee||this.isPartRange(Le,be))this.cornerStyle.display="none";else{this.cornerStyle.top=`${q+Z+this.cornerCenterPointOffset-1}px`,this.cornerStyle[ue]=`${Y+Q+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let le=Xl(n.TABLE);const ve=le===r;ve&&(le=i.documentElement);const st=parseInt(this.cornerDefaultStyle.width,10)/2,g=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const w=ve?p.getBoundingClientRect().left:p.offsetLeft;let b=!1,L=0;U?(L=w-parseInt(this.cornerDefaultStyle.width,10)/2,b=L<0):(L=w+At(p)+parseInt(this.cornerDefaultStyle.width,10)/2,b=L>=H0(le)),b&&(this.cornerStyle[ue]=`${Math.floor(Y+Q+this.cornerCenterPointOffset-st)}px`,this.cornerStyle[U?"borderLeftWidth":"borderRightWidth"]=0)}o===this.wot.getSetting("totalRows")-1&&(ve?p.getBoundingClientRect().top:p.offsetTop)+sn(p)+parseInt(this.cornerDefaultStyle.height,10)/2>=Dl(le)&&(this.cornerStyle.top=`${Math.floor(q+Z+this.cornerCenterPointOffset-g)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}bo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(o,l,q,Y,Q,Z)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,i,r,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,m=null,p=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return sn(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return At(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(m=l(n,y-r),p=l(i,y-r),!m||!p)return!1;const E=bn(m),T=bn(p);return m&&p&&(h=E[f]-s[f]-1,d=T[f]+u(p)-E[f]),[m,h,d]}return!1}changeBorderStyle(e,n){const i=this[e].style,r=n[e];!r||r.hide?ie(this[e],"hidden"):(De(this[e],"hidden")&&We(this[e],"hidden"),i.backgroundColor=r.color,(e==="top"||e==="bottom")&&(i.height=`${r.width}px`),(e==="start"||e==="end")&&(i.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},i=this[e].style;i.backgroundColor=n.color,i.width=`${n.width}px`,i.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?ie(this[e],"hidden"):We(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",bo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function bJ(t,e){KD(t,e),e.add(t)}function Mu(t,e,n){KD(t,e),e.set(t,n)}function KD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ze(t,e){return t.get(cE(t,e))}function KO(t,e,n){return t.set(cE(t,e),n),n}function cE(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yn=new WeakMap,bi=new WeakMap,ny=new WeakMap,od=new WeakMap,iy=new WeakMap,Qa=new WeakMap,XO=new WeakSet;class SJ{constructor(e){bJ(this,XO),Mu(this,Yn,void 0),Mu(this,bi,void 0),Mu(this,ny,new yJ),Mu(this,od,new WeakMap),Mu(this,iy,new WeakSet),Mu(this,Qa,new Map),KO(bi,this,e)}setActiveOverlay(e){return KO(Yn,this,e),Ze(ny,this).setActiveOverlay(Ze(Yn,this)),Ze(od,this).has(Ze(Yn,this))||Ze(od,this).set(Ze(Yn,this),new Set),this}getFocusSelection(){return Ze(bi,this)!==null?Ze(bi,this).getFocus():null}getAreaSelection(){return Ze(bi,this)!==null?Ze(bi,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Ze(Qa,this).has(e)){const i=Ze(Qa,this).get(e);if(i.has(Ze(Yn,this)))return i.get(Ze(Yn,this));const r=new GO(Ze(Yn,this),e.settings);return i.set(Ze(Yn,this),r),r}const n=new GO(Ze(Yn,this),e.settings);return Ze(Qa,this).set(e,new Map([[Ze(Yn,this),n]])),n}getBorderInstances(e){var n,i;return Array.from((n=(i=Ze(Qa,this).get(e))===null||i===void 0?void 0:i.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Ze(Qa,this).get(e).forEach(n=>n.destroy()),Ze(Qa,this).delete(e)}render(e){if(Ze(bi,this)===null)return;e&&cE(XO,this,RJ).call(this);const n=Array.from(Ze(bi,this)),i=new Map,r=new Map;for(let s=0;s<n.length;s++){const o=n[s],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=o.settings;Ze(iy,this).has(o)||(Ze(iy,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const h=this.getBorderInstance(o);if(o.isEmpty()){h==null||h.disappear();continue}a&&Ze(ny,this).setActiveSelection(o).scan().forEach(m=>{if(i.has(m)){const p=i.get(m);p.has(a)&&u===!0?p.set(a,p.get(a)+1):p.set(a,1)}else i.set(m,new Map([[a,1]]));l&&(r.has(m)||r.set(m,[]),m.nodeName==="TH"&&r.get(m).push(...l))});const d=o.getCorners();Ze(Yn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}i.forEach((s,o)=>{var a;const l=Array.from(s).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Ze(od,this).get(Ze(Yn,this)).add(u)),ie(o,l),o.nodeName==="TD"&&Array.isArray((a=Ze(bi,this).options)===null||a===void 0?void 0:a.cellAttributes)&&xe(o,Ze(bi,this).options.cellAttributes)}),Array.from(r.keys()).forEach(s=>{xe(s,[...r.get(s)])})}}function RJ(){const t=Ze(od,this).get(Ze(Yn,this)),e=Ze(Yn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var i,r;const s=Ze(Yn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let o=[];Array.isArray((i=Ze(bi,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(o=Ze(bi,this).options.cellAttributes.map(a=>a[0])),Array.isArray((r=Ze(bi,this).options)===null||r===void 0?void 0:r.headerAttributes)&&(o=[...o,...Ze(bi,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)We(s[a],n),cu(s[a],o)}),t.clear()}class EJ extends Bf{constructor(e,n,i,r){super(e,n,Jl,i,r)}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new sE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===n&&(!r||r!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),hv(i,`${s}px`,"0px")):(s=this.getScrollPosition(),Lf(i));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,x0(n)),i=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("defaultColumnWidth");let r=e,s=0;for(;r<n;)s+=this.wot.wtTable.getStretchedColumnWidth(r)||i,r+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,r=Rn(n),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=r),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=At(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(uE.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:i}=this,r=i.getSetting("rowHeaders"),s=i.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&r.length>0&&!De(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=Rn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,XN(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(A0(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const r=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=r-s;i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,r=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),o=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";o?We(i,"emptyRows"):ie(i,"emptyRows");let l=!1;if(!a){if(s&&!r.length)ie(i,"innerBorderLeft innerBorderInlineStart");else if(!s&&r.length){const u=De(i,"innerBorderInlineStart");e?(ie(i,"innerBorderLeft innerBorderInlineStart"),l=!u):(We(i,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const TJ="stickyRowsTop",hE={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};js(hE,"MIXIN_NAME",TJ,{writable:!1,enumerable:!1});class dE extends Uc{constructor(e,n,i,r){super(e,n,i,r,Ql)}}yt(dE,hE);yt(dE,yv);function qO(t,e,n){return(e=MJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MJ(t){var e=_J(t,"string");return typeof e=="symbol"?e:e+""}function _J(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OJ extends Bf{constructor(e,n,i,r,s,o){super(e,n,Ql,i,r),qO(this,"topOverlay",void 0),qO(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new dE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();hv(e,`${r}px`,`${s}px`)}else Lf(e);let n=sn(this.clone.wtTable.TABLE);const i=At(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${i}px`,!1}}class fE extends Uc{constructor(e,n,i,r){super(e,n,i,r,Zl)}}yt(fE,hE);yt(fE,bv);function PJ(t,e,n){return(e=IJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IJ(t){var e=xJ(t,"string");return typeof e=="symbol"?e:e+""}function xJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AJ extends Bf{constructor(e,n,i,r){super(e,n,Zl,i,r),PJ(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new fE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let r=0,s=!1;if(this.trimmingContainer===n&&(!i||i!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;s=u===c,r=this.getOverlayOffset(),hv(e,"0px",`${r}px`)}else r=this.getScrollPosition(),Lf(e);const o=this.adjustHeaderBordersPosition(r,s);return this.adjustElementsSize(),o}setScrollPosition(e){const n=this.domBindings.rootWindow;let i=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(uv(n),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("defaultRowHeight");let r=e,s=0;for(;r<n;){const o=this.wot.wtTable.getRowHeight(r);s+=o===void 0?i:o,r+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,r=Rn(n),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=r),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=sn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(uE.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:i,wtSettings:r}=this,o=(i.cloneSource?i.cloneSource:i).wtTable.holder,a=r.getSetting("columnHeaders"),u=r.getSetting("fixedRowsTop")===0&&a.length>0&&!De(o.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&o.offsetHeight!==o.clientHeight&&(h=Rn(this.domBindings.rootDocument)),n){const d=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=i.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return c+=h,KN(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return cv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=r-s;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,r=this.wot.wtTable.holder.parentNode,s=i.getSetting("totalColumns"),o=i.getSetting("preventOverflow")==="horizontal";s?We(r,"emptyColumns"):ie(r,"emptyColumns");let a=!1;if(!n&&!o){const l=i.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=i.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=De(r,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(ie(r,"innerBorderTop"),a=!h):(We(r,"innerBorderTop"),a=h)}}return a}}function Lg(t,e,n){HJ(t,e),e.set(t,n)}function HJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ks(t,e,n){return(e=NJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NJ(t){var e=DJ(t,"string");return typeof e=="symbol"?e:e+""}function DJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function el(t,e,n){return t.set(XD(t,e),n),n}function Xs(t,e){return t.get(XD(t,e))}function XD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _u=new WeakMap,kg=new WeakMap,Ou=new WeakMap,$g=new WeakMap;class LJ{constructor(e,n,i,r,s,o){Ks(this,"wot",null),Lg(this,_u,[]),Ks(this,"topOverlay",null),Ks(this,"bottomOverlay",null),Ks(this,"inlineStartOverlay",null),Ks(this,"topInlineStartCornerOverlay",null),Ks(this,"bottomInlineStartCornerOverlay",null),Ks(this,"browserLineHeight",void 0),Ks(this,"wtSettings",null),Lg(this,kg,!1),Lg(this,Ou,0),Lg(this,$g,null),Ks(this,"resizeObserver",new ResizeObserver(c=>{pv(()=>{!Array.isArray(c)||!c.length||(el(Ou,this,Xs(Ou,this)+1),Xs(Ou,this)===100&&(vt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Xs($g,this)!==null&&clearTimeout(Xs($g,this)),el($g,this,setTimeout(()=>{el(Ou,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=i,this.facadeGetter=n,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=Rn(a);const u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:rf(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...Xs(_u,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,i=e.getComputedStyle(n.body),r=parseInt(i.lineHeight,10),s=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=r||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new AJ(...e),this.bottomOverlay=new hJ(...e),this.inlineStartOverlay=new EJ(...e),this.topInlineStartCornerOverlay=new OJ(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new oJ(...e,this.bottomOverlay,this.inlineStartOverlay),el(_u,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){el(kg,this,Xs(_u,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),Xs(_u,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Xs(_u,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0}),i!==r&&this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0});const s=n.devicePixelRatio&&n.devicePixelRatio>1,o=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!V0())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:d}=h.clone.wtTable;this.eventManager.addEventListener(d,"wheel",f=>this.onCloneWheel(f,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),el(Ou,this,0)},200)}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(r!==n&&s!==n&&!e.target.contains(r)||i!==n&&s!==n&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==i&&o!==i&&!o.contains(s),l=r!==i&&o!==i&&!o.contains(r);if(this.keyPressed&&(a||l)||this.scrollableElement===i)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==i&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=jc(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);const r=this.scrollVertically(n),s=this.scrollHorizontally(i);return r||s}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,[r,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==r||this.lastScrollX!==e.scrollX,this.verticalScrolling=i.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(i.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){if(!Xs(kg,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),el(kg,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=rf(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,i=e.clientHeight,r=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,s),d=n.hider.style,f=()=>r?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),m=()=>r?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),p=f()?1:0,y=m()?1:0;if(d.width=`${c+y}px`,d.height=`${u+p}px`,this.scrollbarSize>0){const{scrollHeight:E,scrollWidth:T}=n.wtRootElement,{scrollHeight:M,scrollWidth:P}=n.holder;this.hasScrollbarRight=E<M,this.hasScrollbarBottom=T<P,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>T?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>E&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return A(n,r=>{r&&r.clone&&r.clone.wtTable.TABLE.contains(e)&&(i=r.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];A(n,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function ZO(t,e,n){return(e=kJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kJ(t){var e=$J(t,"string");return typeof e=="symbol"?e:e+""}function $J(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FJ{constructor(e){ZO(this,"settings",{}),ZO(this,"defaults",Object.freeze(this.getDefaults())),ze(this.defaults,(n,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(n===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,i)=>{const r=this.getSetting("data",e,n);Ha(i,r??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?ze(e,(i,r)=>{this.settings[r]=i}):this.settings[e]=n,this}getSetting(e,n,i,r,s){return typeof this.settings[e]=="function"?this.settings[e](n,i,r,s):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class gE extends Uc{constructor(e,n,i,r){super(e,n,i,r,"master")}alignOverlaysWithTrimmingContainer(){const e=Xl(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,r=Pc(e,"height",n),s=Pc(e,"overflow",n),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(s)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?i.insertBefore(d,e.nextElementSibling):i.appendChild(d);const f=parseInt(Ho(d,n).height,10);i.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),o.height=r==="auto"?"auto":`${c}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Kl(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,i="master",s=e.getSetting("columnHeaders").length;if(s&&!n.hasOversizedColumnHeadersMarked[i]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[i]=!0}}}yt(gE,rE);yt(gE,bv);class VJ{constructor(e,n,i,r,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=i,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new O7:new I7],["fullyVisible",()=>new v7],["partiallyVisible",()=>new ND]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new T7:new P7],["fullyVisible",()=>new m7],["partiallyVisible",()=>new HD]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return n===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=sn(n)>0&&n.clientHeight>0?n.clientHeight:1/0,i}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:i}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=n.documentElement.offsetWidth,o=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-s:u.left,h=s-c;let d,f;if(a)return At(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(h,s):d=Math.min(this.getContainerFillWidth(),h,s),r===i&&o>0&&this.sumColumnWidths(0,o-1)>d)return n.documentElement.clientWidth;if(r!==i&&(f=Pc(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),f==="scroll"||f==="hidden"||f==="auto"))return Math.max(d,r.clientWidth);const m=e.getSetting("stretchH");return m==="none"||!m?Math.max(d,At(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let i=0,r=e;for(;r<n;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const i=n.offsetWidth;return this.containerWidth=i,e.removeChild(n),i}getWorkspaceOffset(){return bn(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=sn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,r=n.length;i<r;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,s=n.length;r<s;r++)i?(this.rowHeaderWidth+=At(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,r-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),r-=o),i.holder.clientHeight===i.holder.offsetHeight?s=0:s=Rn(this.domBindings.rootDocument),new $7({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:r,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:h=>i.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=n.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,r-=a}return i.holder.clientWidth!==i.holder.offsetWidth&&(r-=Rn(this.domBindings.rootDocument)),new D7({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:r,scrollOffset:s,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>i.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!n.getSetting("renderAllColumns")){const s=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:r,endRow:s}=this.rowsRenderCalculator;return n<r||n===r&&n>0?!1:!(i>s||i===s&&i<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:r,endColumn:s}=this.columnsRenderCalculator;return n<r||n===r&&n>0?!1:!(i>s||i===s&&i<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){ze(this.hasOversizedColumnHeadersMarked,(e,n,i)=>{i[n]=void 0})}}class WJ extends nE{constructor(e,n){super(e,new FJ(n));const i=this.wtSettings.getSetting("facade",this);this.wtTable=new gE(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new VJ(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new SJ(this.wtSettings.getSetting("selections")),this.wtEvent=new VD(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new LJ(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],i=[];ze(e,(r,s)=>{this.wtSettings.getSetting(s).length&&i.push(r),n.push(r)}),We(this.wtTable.wtRootElement.parentNode,n),ie(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var n;if(!UD.includes(e))return null;const i=e.replace(/_([a-z])/g,r=>r[1].toUpperCase());return(n=this.wtOverlays[`${i}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class mE{constructor(e){e instanceof nE?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const i=new mE(n);return()=>i},this._wot=new WJ(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,i){return this._wot.createCellRange(e,n,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,i,r,s){return this._wot.scrollViewport(e,n,i,r,s)}scrollViewportHorizontally(e,n,i){return this._wot.scrollViewportHorizontally(e,n,i)}scrollViewportVertically(e,n,i){return this._wot.scrollViewportVertically(e,n,i)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,i,r,s){return this._wot.wtSettings.getSetting(e,n,i,r,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function JO(t){let{isShiftKey:e,isLeftClick:n,isRightClick:i,coords:r,selection:s,controller:o,cellCoordsFactory:a}=t;const l=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),c=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)r.row>=0&&r.col>=0&&!o.cell?s.setRangeEnd(r):(u||c)&&r.row>=0&&r.col>=0&&!o.cell?s.setRangeEnd(a(r.row,r.col)):u&&r.row<0&&!o.column?s.setRangeEnd(a(l.to.row,r.col)):c&&r.col<0&&!o.row?s.setRangeEnd(a(r.row,l.to.col)):(!u&&!c&&r.col<0||u&&r.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),r.row,r.col):(!u&&!c&&r.row<0||c&&r.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),r.col,r.row);else{const h=!s.inInSelection(r),d=n||i&&h;r.row<0&&r.col>=0&&!o.column?d&&s.selectColumns(r.col,r.col,r.row):r.col<0&&r.row>=0&&!o.row?d&&s.selectRows(r.row,r.row,r.col):r.col>=0&&r.row>=0&&!o.cell?d&&s.setRangeStart(r):r.col<0&&r.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function BJ(t){let{isLeftClick:e,coords:n,selection:i,controller:r,cellCoordsFactory:s}=t;if(!e)return;const o=i.isSelectedByRowHeader(),a=i.isSelectedByColumnHeader(),l=i.tableProps.countCols(),u=i.tableProps.countRows();i.markSource("mouse"),a&&!r.column?i.setRangeEnd(s(u-1,n.col)):o&&!r.row?i.setRangeEnd(s(n.row,l-1)):r.cell||i.setRangeEnd(n),i.markEndSource()}const jJ=new Map([["mousedown",JO],["mouseover",BJ],["touchstart",JO]]);function QO(t,e){let{coords:n,selection:i,controller:r,cellCoordsFactory:s}=e;jJ.get(t.type)({coords:n,selection:i,controller:r,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:wv(t)||t.type==="touchstart",isRightClick:Na(t)})}const qD=new WeakMap,pE=Symbol("rootInstance");function UJ(t){qD.set(t,!0)}function YJ(t){return t===pE}function cp(t){return qD.has(t)}function zJ(t,e){ZD(t,e),e.add(t)}function tl(t,e,n){ZD(t,e),e.set(t,n)}function ZD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zo(t,e,n){return(e=GJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GJ(t){var e=KJ(t,"string");return typeof e=="symbol"?e:e+""}function KJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tn(t,e){return t.get(af(t,e))}function Ki(t,e,n){return t.set(af(t,e),n),n}function af(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ry=new WeakMap,Fg=new WeakMap,Vg=new WeakMap,qs=new WeakMap,br=new WeakMap,sy=new WeakMap,oy=new WeakMap,hp=new WeakSet;class XJ{constructor(e){zJ(this,hp),zo(this,"hot",void 0),zo(this,"eventManager",void 0),zo(this,"settings",void 0),zo(this,"THEAD",void 0),zo(this,"TBODY",void 0),zo(this,"_wt",void 0),zo(this,"activeWt",void 0),tl(this,ry,0),tl(this,Fg,0),zo(this,"postponedAdjustElementsSize",!1),tl(this,Vg,!1),tl(this,qs,void 0),tl(this,br,void 0),tl(this,sy,0),tl(this,oy,0),this.hot=e,this.eventManager=new hr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const i=this._wt.getCell(e,n);return i<0?null:i}scrollViewport(e,n,i,r,s){return this._wt.scrollViewport(e,n,i,r,s)}scrollViewportHorizontally(e,n,i){return this._wt.scrollViewportHorizontally(e,n,i)}scrollViewportVertically(e,n,i){return this._wt.scrollViewportVertically(e,n,i)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),ie(e,"handsontable"),Ki(br,this,n.createElement("TABLE")),ie(Tn(br,this),"htCore"),this.hot.getSettings().tableClassName&&ie(Tn(br,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(xe(Tn(br,this),[xs()]),xe(e,[s9(),FN(-1),lv(this.hot.countCols()),v9()])),this.THEAD=n.createElement("THEAD"),Tn(br,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Tn(br,this).appendChild(this.TBODY),this.hot.table=Tn(br,this),this.hot.container.insertBefore(Tn(br,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:i,rootWindow:r}=this.hot,s=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Ki(Vg,this,!0),this.isTextSelectionAllowed(a.target)||(bS(r),a.preventDefault(),r.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Ki(Vg,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Tn(Vg,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&bS(r),a.preventDefault())}),this.eventManager.addEventListener(s,"keyup",a=>{i.isInProgress()&&!a.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",a=>{i.isInProgress()&&wv(a)&&i.finish(),Ki(qs,this,!1);const l=dv(n.activeElement);Rd(n.activeElement)&&!l||(l||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Na(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",a=>{i.isInProgress()&&Na(a)&&(i.finish(),Ki(qs,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),Ki(qs,this,!1)}),this.eventManager.addEventListener(s,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Tn(qs,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const m=Rn(n);if(n.elementFromPoint(u+m,c)!==d||n.elementFromPoint(u,c+m)!==d)return}else for(;h!==s;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=Gl(r);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=Gl(o);this.eventManager.addEventListener(Tn(br,this),"selectstart",a=>{this.settings.fragmentSelection||Rd(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,i))}translateFromRenderableToVisualIndex(e,n){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=e),r===null&&(r=n),[i,r]}countRenderableIndexes(e,n){const i=Math.min(e.getNotTrimmedIndexesLength(),n),r=e.getNearestNotHiddenIndex(i-1,-1);return r===null?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,i,r){if(isNaN(e)||e<0)return 0;const s=i.getNearestNotHiddenIndex(e,n),o=i.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return n<0?a=o+1:n>0&&(a=r-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}countRenderableRowsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Tn(br,this),isDataViewInstance:()=>cp(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),Ki(Fg,this,s.length),this.hot.getSettings().ariaTags&&af(hp,this,JD).call(this)===this.hot.countCols()&&af(hp,this,qJ).call(this,Tn(Fg,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),Ki(ry,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(s,o),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let p=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(p=this.hot.runHooks("beforeValueRender",p,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,p,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,p,f),this.hot.runHooks("afterRenderer",a,l,u,m,p,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Kl(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Ki(qs,this,!0),this.hot.runHooks("beforeOnCellMouseDown",s,u,a,c),!ma(s)&&(QO(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",s,u,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,Ki(qs,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,u,a),!ma(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,u,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,u,a),!ma(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,u,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,u,a,c),!ma(s)&&(Tn(qs,this)&&QO(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",s,u,a),this.activeWt=this._wt)},onCellMouseUp:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,u,a),!(ma(s)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",s,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:s=>{const o=this.hot.rowIndexMapper,a=s<0;let l=s;return!a&&(l=o.getVisualFromRenderableIndex(s),l===null)?s:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:s=>{const o=this.hot.columnIndexMapper,a=s<0;let l=s;return!a&&(l=o.getVisualFromRenderableIndex(s),l===null)?s:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,u,c]=s,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(s,o)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.runHooks("beforeStretchingColumnWidth",s,a)},onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=o>=0?u.getVisualFromRenderableIndex(o):o,h=s>=0?l.getVisualFromRenderableIndex(s):s,d=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(d)){const[f,m,p,y]=d;return[f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f,m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,p>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(p,-1)):p,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,u=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(u+o,a-1);else if(o==="auto"){const c=Math.ceil(u/a*12);s.startRow=Math.max(l-c,0),s.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,u=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(u+o,a-1)),o==="auto"){const c=Math.ceil(u/a*6);s.startColumn=Math.max(l-c,0),s.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new mE(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:i,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,r),this.eventManager.addEventListener(n,"mousedown",s=>{s.target===n&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",s=>{s.target===n&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Rd(e))return!0;const n=Ma(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Tn(qs,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const i=n.firstChild;if(!De(i,"relative")){Br(n),this.appendRowHeader(e,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:r}=this.hot,s=i.createElement("div"),o=i.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,r),s.appendChild(o),n.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(n.firstChild){const o=n.firstChild;De(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,i,r),o.className="",ie(o,["relative",...s()])):(Br(n),this.appendColHeader(e,n,i,r))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),u=s();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(xe(a,...xs()),xe(l,...xs())),this.updateCellHeader(l,e,i,r),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,r)}updateCellHeader(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=n;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(De(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(n):De(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(n))),s>-1?hu(e,i(n,r)):(Ha(e," "),ie(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,n){Ki(sy,this,e),Ki(oy,this,n)}getLastSize(){return{width:Tn(sy,this),height:Tn(oy,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Tn(ry,this)}getRowHeadersCount(){return Tn(Fg,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function JD(){return parseInt(this.hot.rootElement.getAttribute(lv()[0]),10)}function qJ(t){const e=af(hp,this,JD).call(this)+t;xe(this.hot.rootElement,...lv(e))}const QD="ABCDEFGHIJKLMNOPQRSTUVWXYZ",HS=QD.length;function Sv(t){let e=t+1,n="",i;for(;e>0;)i=(e-1)%HS,n=String.fromCharCode(65+i)+n,e=parseInt((e-i)/HS,10);return n}function ZJ(t){let e=0;if(t)for(let n=0,i=t.length-1;n<t.length;n+=1,i-=1)e+=HS**i*(QD.indexOf(t[n])+1);return e-=1,e}function JJ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let i,r;for(i=0;i<t;i++){const s=[];for(r=0;r<e;r++)s.push(Sv(r)+(i+1));n.push(s)}return n}function QJ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let i,r;for(i=0;i<t;i++){const s={};for(r=0;r<e;r++)s[`prop${r}`]=Sv(r)+(i+1);n.push(s)}return n}function eQ(t,e){const n=[];let i;for(let r=0;r<t;r++){i=[];for(let s=0;s<e;s++)i.push("");n.push(i)}return n}function wE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((r,s)=>{Array.isArray(r)?r.forEach((o,a)=>{i.push([s+e,a,o])}):Object.keys(r).forEach(o=>{i.push([s+e,o,r[o]])})}),i}function vE(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ye(t[0])&&(e=mv(t[0]))),e}function eL(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function tL(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const tQ=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:vE,createEmptySpreadsheetData:eQ,createSpreadsheetData:JJ,createSpreadsheetObjectData:QJ,dataRowToChangesArray:wE,isArrayOfArrays:eL,isArrayOfObjects:tL,spreadsheetColumnIndex:ZJ,spreadsheetColumnLabel:Sv},Symbol.toStringTag,{value:"Module"}));function Ch(t,e,n){return(e=nQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nQ(t){var e=iQ(t,"string");return typeof e=="symbol"?e:e+""}function iQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rQ{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Ch(this,"hot",void 0),Ch(this,"data",void 0),Ch(this,"dataType","array"),Ch(this,"colToProp",()=>{}),Ch(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return A(this.data,(i,r)=>{const s=this.getAtCell(r,e);n.push(s)}),n}getAtRow(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=n===void 0&&i===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):_e(n,i,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(Ye(a)||Pt(a))if(r?l=[]:l={},!s||r){const c=this.countFirstRowKeys()-1;_e(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(i||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);r?l.push(f):o?op(l,d,f):l[d]=f}})}else ze(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);o?op(l,c,h):l[c]=h});return l}setAtCell(e,n,i){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=ar(i);this.hot.runHooks("modifySourceData",e,n,r,"set"),r.isTouched()&&(i=r.value)}Number.isInteger(n)?this.data[e][n]=i:op(this.data[e],n,i)}}getAtPhysicalCell(e,n,i){let r=null;if(i)if(typeof n=="string"){const{dataDotNotation:s}=this.hot.getSettings();r=s?aD(i,n):i[n]}else typeof n=="function"?r=n(i):r=i[n];if(this.hot.hasHook("modifySourceData")){const s=ar(r);this.hot.runHooks("modifySourceData",e,n,s,"get"),s.isTouched()&&(r=s.value)}return r}getAtCell(e,n){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=!1,s=null,o=null,a=null,l=null;e===null||n===null?(r=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,n.row),o=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return _e(s,a,c=>{u.push(r?this.getAtRow(c,void 0,void 0,i):this.getAtRow(c,o,l,i))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return vE(this.data)}destroy(){this.data=null,this.hot=null}}function eP(t,e,n){return(e=sQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sQ(t){var e=oQ(t,"string");return typeof e=="symbol"?e:e+""}function oQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class du{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;eP(this,"indexedValues",[]),eP(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Pt(this.initValueOrFn)?_e(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):_e(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}yt(du,Fn);function CE(t,e,n,i){const r=n.length?n[0]:void 0;return[...t.slice(0,r),...n.map((s,o)=>Pt(i)?i(s,o):i),...r===void 0?[]:t.slice(r)]}function yE(t,e){return Ao(t,(n,i)=>e.includes(i)===!1)}class Wa extends du{insert(e,n){this.indexedValues=CE(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=yE(this.indexedValues,e),super.remove(e)}}class Rv extends Wa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return cn(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}function bE(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function lf(t,e){return Ao(t,n=>e.includes(n)===!1)}function SE(t,e){return tt(t,n=>n-e.filter(i=>i<n).length)}function RE(t,e){const n=e[0],i=e.length;return tt(t,r=>r>=n?r+i:r)}function aQ(t,e,n){return(e=lQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lQ(t){var e=uQ(t,"string");return typeof e=="symbol"?e:e+""}function uQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ev extends du{constructor(){super(...arguments),aQ(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=lf(this.orderOfIndexes,[e]),Pt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=CE(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=RE(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=yE(this.indexedValues,e),this.orderOfIndexes=lf(this.orderOfIndexes,e),this.orderOfIndexes=SE(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class jf extends Wa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return cn(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}const tP=new Map([["indexesSequence",{getListWithInsertedItems:bE,getListWithRemovedItems:lf}],["physicallyIndexed",{getListWithInsertedItems:CE,getListWithRemovedItems:yE}]]),nL=t=>{if(tP.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return tP.get(t)};class iL extends du{constructor(){super(e=>e)}insert(e,n){const i=RE(this.indexedValues,n);this.indexedValues=bE(i,e,n),super.insert(e,n)}remove(e){const n=lf(this.indexedValues,e);this.indexedValues=SE(n,e),super.remove(e)}}const nP=new Map([["hiding",Rv],["index",du],["linkedPhysicalIndexToValue",Ev],["physicalIndexToValue",Wa],["trimming",jf]]);function cQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!nP.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(nP.get(t))(e)}function hQ(t,e,n){return(e=dQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dQ(t){var e=fQ(t,"string");return typeof e=="symbol"?e:e+""}function fQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let NS=0;class EE{constructor(){hQ(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),NS+=1)}unregister(e){const n=this.collection.get(e);Se(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),NS-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return xt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(i=>{i.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}yt(EE,Fn);function gQ(){return NS}function ay(t,e,n){return(e=mQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mQ(t){var e=pQ(t,"string");return typeof e=="symbol"?e:e+""}function pQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iP extends EE{constructor(e,n){super(),ay(this,"mergedValuesCache",[]),ay(this,"aggregationFunction",void 0),ay(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=tt(this.get(),s=>s.getValues()),i=[],r=Se(n[0])&&n[0].length||0;for(let s=0;s<r;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(n[a][s]);i.push(o)}return tt(i,this.aggregationFunction)}getMergedValueAtIndex(e,n){const i=this.getMergedValues(n)[e];return Se(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function wQ(t,e,n){vQ(t,e),e.set(t,n)}function vQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CQ(t,e,n){return t.set(rL(t,e),n),n}function yQ(t,e){return t.get(rL(t,e))}function rL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ly=new WeakMap;class sL{constructor(){wQ(this,ly,[])}subscribe(e){return this.addLocalHook("change",e),this._write(yQ(ly,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){CQ(ly,this,e)}}yt(sL,Fn);function rP(t,e){const n=[];let i=0,r=0;for(;i<t.length&&r<e.length;i++,r++)t[i]!==e[r]&&n.push({op:"replace",index:r,oldValue:t[i],newValue:e[r]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;r<t.length;r++)n.push({op:"remove",index:r,oldValue:t[r],newValue:void 0});return n}function yh(t,e,n){bQ(t,e),e.set(t,n)}function bQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xi(t,e){return t.get(oL(t,e))}function Wg(t,e,n){return t.set(oL(t,e),n),n}function oL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bg=new WeakMap,bh=new WeakMap,jg=new WeakMap,Ug=new WeakMap,Yg=new WeakMap;class SQ{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};yh(this,Bg,new Set),yh(this,bh,[]),yh(this,jg,[]),yh(this,Ug,!1),yh(this,Yg,!1),Wg(Yg,this,e??!1)}createObserver(){const e=new sL;return Xi(Bg,this).add(e),e.addLocalHook("unsubscribe",()=>{Xi(Bg,this).delete(e)}),e._writeInitialChanges(rP(Xi(bh,this),Xi(jg,this))),e}emit(e){let n=Xi(jg,this);(!Xi(Ug,this)||Xi(bh,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Xi(Yg,this)):Wg(bh,this,new Array(e.length).fill(Xi(Yg,this))),Xi(Ug,this)||(Wg(Ug,this,!0),n=Xi(bh,this)));const i=rP(n,e);Xi(Bg,this).forEach(r=>r._write(i)),Wg(jg,this,e)}}function Qn(t,e,n){return(e=RQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RQ(t){var e=EQ(t,"string");return typeof e=="symbol"?e:e+""}function EQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DS{constructor(){Qn(this,"indexesSequence",new iL),Qn(this,"trimmingMapsCollection",new iP(e=>e.some(n=>n===!0),!1)),Qn(this,"hidingMapsCollection",new iP(e=>e.some(n=>n===!0),!1)),Qn(this,"variousMapsCollection",new EE),Qn(this,"hidingChangesObservable",new SQ({initialIndexValue:!1})),Qn(this,"notTrimmedIndexesCache",[]),Qn(this,"notHiddenIndexesCache",[]),Qn(this,"isBatched",!1),Qn(this,"indexesSequenceChanged",!1),Qn(this,"indexesChangeSource",void 0),Qn(this,"trimmedIndexesChanged",!1),Qn(this,"hiddenIndexesChanged",!1),Qn(this,"renderablePhysicalIndexesCache",[]),Qn(this,"fromPhysicalToVisualIndexesCache",new Map),Qn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,i){return this.registerMap(e,cQ(n,i))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof jf?this.trimmingMapsCollection.register(e,n):n instanceof Rv?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const i=this.getNumberOfIndexes();return i>0&&n.init(i),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return Se(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return Se(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return Se(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return Se(n)?n:null}getNearestNotHiddenIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return n>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?i?this.getNearestNotHiddenIndex(e,-n,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(r=>r+e);this.removeIndexes(i)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const i=tt(e,u=>this.getPhysicalFromVisualIndex(u)),r=this.getNotTrimmedIndexesLength(),s=e.length,o=lf(this.getIndexesSequence(),i),a=o.filter(u=>this.isTrimmed(u)===!1);let l=o.indexOf(a[a.length-1])+1;if(n+s<r){const u=a[n];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(bE(o,l,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const i=this.getNotTrimmedIndexes()[e],r=Se(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),o=tt(new Array(n).fill(r),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,o),this.hidingMapsCollection.insertToEvery(s,o),this.variousMapsCollection.insertToEvery(s,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromRenderableIndex(n),r=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(r,n)}}}yt(DS,Fn);function TQ(t,e){return ze(e,(n,i)=>{xt(t[i])&&(t[i]=n)}),t}function aL(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function lL(t){Se(t)&&z0(Ct`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function MQ(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:_Q,getValues:OQ}=Kr("phraseFormatters");function PQ(t,e){_Q(t,e)}function IQ(){return OQ()}PQ("pluralize",MQ);const uL="ContextMenu:items",je=uL,TE=`${je}.noItems`,ME=`${je}.insertRowAbove`,_E=`${je}.insertRowBelow`,OE=`${je}.insertColumnOnTheLeft`,PE=`${je}.insertColumnOnTheRight`,IE=`${je}.removeRow`,xE=`${je}.removeColumn`,AE=`${je}.undo`,HE=`${je}.redo`,NE=`${je}.readOnly`,DE=`${je}.clearColumn`,LE=`${je}.copy`,kE=`${je}.copyWithHeaders`,$E=`${je}.copyWithGroupHeaders`,FE=`${je}.copyHeadersOnly`,VE=`${je}.cut`,WE=`${je}.freezeColumn`,BE=`${je}.unfreezeColumn`,jE=`${je}.mergeCells`,UE=`${je}.unmergeCells`,YE=`${je}.addComment`,zE=`${je}.editComment`,GE=`${je}.removeComment`,KE=`${je}.readOnlyComment`,XE=`${je}.align`,qE=`${je}.align.left`,ZE=`${je}.align.center`,JE=`${je}.align.right`,QE=`${je}.align.justify`,eT=`${je}.align.top`,tT=`${je}.align.middle`,nT=`${je}.align.bottom`,iT=`${je}.borders`,rT=`${je}.borders.top`,sT=`${je}.borders.right`,oT=`${je}.borders.bottom`,aT=`${je}.borders.left`,lT=`${je}.borders.remove`,uT=`${je}.nestedHeaders.insertChildRow`,cT=`${je}.nestedHeaders.detachFromParent`,hT=`${je}.hideColumn`,dT=`${je}.showColumn`,fT=`${je}.hideRow`,gT=`${je}.showRow`,di="Filters:",en=`${di}conditions`,Tv=`${en}.none`,mT=`${en}.isEmpty`,pT=`${en}.isNotEmpty`,wT=`${en}.isEqualTo`,vT=`${en}.isNotEqualTo`,CT=`${en}.beginsWith`,yT=`${en}.endsWith`,bT=`${en}.contains`,ST=`${en}.doesNotContain`,xQ=`${en}.byValue`,RT=`${en}.greaterThan`,ET=`${en}.greaterThanOrEqualTo`,TT=`${en}.lessThan`,MT=`${en}.lessThanOrEqualTo`,_T=`${en}.isBetween`,OT=`${en}.isNotBetween`,PT=`${en}.after`,IT=`${en}.before`,xT=`${en}.today`,AT=`${en}.tomorrow`,HT=`${en}.yesterday`,NT=`${di}labels.filterByCondition`,DT=`${di}labels.filterByValue`,LT=`${di}labels.conjunction`,Mv=`${di}labels.disjunction`,Zp=`${di}values.blankCells`,kT=`${di}buttons.selectAll`,$T=`${di}buttons.clear`,FT=`${di}buttons.ok`,VT=`${di}buttons.cancel`,WT=`${di}buttons.placeholder.search`,BT=`${di}buttons.placeholder.value`,jT=`${di}buttons.placeholder.secondValue`,UT="CheckboxRenderer:",YT=`${UT}checked`,zT=`${UT}unchecked`,AQ=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:YT,CHECKBOX_RENDERER_NAMESPACE:UT,CHECKBOX_UNCHECKED:zT,CONTEXTMENU_ITEMS_ADD_COMMENT:YE,CONTEXTMENU_ITEMS_ALIGNMENT:XE,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:nT,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:ZE,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:QE,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:qE,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:tT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:JE,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:eT,CONTEXTMENU_ITEMS_BORDERS:iT,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:oT,CONTEXTMENU_ITEMS_BORDERS_LEFT:aT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:sT,CONTEXTMENU_ITEMS_BORDERS_TOP:rT,CONTEXTMENU_ITEMS_CLEAR_COLUMN:DE,CONTEXTMENU_ITEMS_COPY:LE,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:FE,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:$E,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:kE,CONTEXTMENU_ITEMS_CUT:VE,CONTEXTMENU_ITEMS_EDIT_COMMENT:zE,CONTEXTMENU_ITEMS_FREEZE_COLUMN:WE,CONTEXTMENU_ITEMS_HIDE_COLUMN:hT,CONTEXTMENU_ITEMS_HIDE_ROW:fT,CONTEXTMENU_ITEMS_INSERT_LEFT:OE,CONTEXTMENU_ITEMS_INSERT_RIGHT:PE,CONTEXTMENU_ITEMS_MERGE_CELLS:jE,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:cT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:uT,CONTEXTMENU_ITEMS_NO_ITEMS:TE,CONTEXTMENU_ITEMS_READ_ONLY:NE,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:KE,CONTEXTMENU_ITEMS_REDO:HE,CONTEXTMENU_ITEMS_REMOVE_BORDERS:lT,CONTEXTMENU_ITEMS_REMOVE_COLUMN:xE,CONTEXTMENU_ITEMS_REMOVE_COMMENT:GE,CONTEXTMENU_ITEMS_REMOVE_ROW:IE,CONTEXTMENU_ITEMS_ROW_ABOVE:ME,CONTEXTMENU_ITEMS_ROW_BELOW:_E,CONTEXTMENU_ITEMS_SHOW_COLUMN:dT,CONTEXTMENU_ITEMS_SHOW_ROW:gT,CONTEXTMENU_ITEMS_UNDO:AE,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:BE,CONTEXTMENU_ITEMS_UNMERGE_CELLS:UE,CONTEXT_MENU_ITEMS_NAMESPACE:uL,FILTERS_BUTTONS_CANCEL:VT,FILTERS_BUTTONS_CLEAR:$T,FILTERS_BUTTONS_OK:FT,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:WT,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:jT,FILTERS_BUTTONS_PLACEHOLDER_VALUE:BT,FILTERS_BUTTONS_SELECT_ALL:kT,FILTERS_CONDITIONS_AFTER:PT,FILTERS_CONDITIONS_BEFORE:IT,FILTERS_CONDITIONS_BEGINS_WITH:CT,FILTERS_CONDITIONS_BETWEEN:_T,FILTERS_CONDITIONS_BY_VALUE:xQ,FILTERS_CONDITIONS_CONTAINS:bT,FILTERS_CONDITIONS_EMPTY:mT,FILTERS_CONDITIONS_ENDS_WITH:yT,FILTERS_CONDITIONS_EQUAL:wT,FILTERS_CONDITIONS_GREATER_THAN:RT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:ET,FILTERS_CONDITIONS_LESS_THAN:TT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:MT,FILTERS_CONDITIONS_NAMESPACE:en,FILTERS_CONDITIONS_NONE:Tv,FILTERS_CONDITIONS_NOT_BETWEEN:OT,FILTERS_CONDITIONS_NOT_CONTAIN:ST,FILTERS_CONDITIONS_NOT_EMPTY:pT,FILTERS_CONDITIONS_NOT_EQUAL:vT,FILTERS_CONDITIONS_TODAY:xT,FILTERS_CONDITIONS_TOMORROW:AT,FILTERS_CONDITIONS_YESTERDAY:HT,FILTERS_DIVS_FILTER_BY_CONDITION:NT,FILTERS_DIVS_FILTER_BY_VALUE:DT,FILTERS_LABELS_CONJUNCTION:LT,FILTERS_LABELS_DISJUNCTION:Mv,FILTERS_NAMESPACE:di,FILTERS_VALUES_BLANK_CELLS:Zp},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const cL={languageCode:"en-US",[TE]:"No available options",[ME]:"Insert row above",[_E]:"Insert row below",[OE]:"Insert column left",[PE]:"Insert column right",[IE]:["Remove row","Remove rows"],[xE]:["Remove column","Remove columns"],[AE]:"Undo",[HE]:"Redo",[NE]:"Read only",[DE]:"Clear column",[XE]:"Alignment",[qE]:"Left",[ZE]:"Center",[JE]:"Right",[QE]:"Justify",[eT]:"Top",[tT]:"Middle",[nT]:"Bottom",[WE]:"Freeze column",[BE]:"Unfreeze column",[iT]:"Borders",[rT]:"Top",[sT]:"Right",[oT]:"Bottom",[aT]:"Left",[lT]:"Remove border(s)",[YE]:"Add comment",[zE]:"Edit comment",[GE]:"Delete comment",[KE]:"Read-only comment",[jE]:"Merge cells",[UE]:"Unmerge cells",[LE]:"Copy",[kE]:["Copy with header","Copy with headers"],[$E]:["Copy with group header","Copy with group headers"],[FE]:["Copy header only","Copy headers only"],[VE]:"Cut",[uT]:"Insert child row",[cT]:"Detach from parent",[hT]:["Hide column","Hide columns"],[dT]:["Show column","Show columns"],[fT]:["Hide row","Hide rows"],[gT]:["Show row","Show rows"],[Tv]:"None",[mT]:"Is empty",[pT]:"Is not empty",[wT]:"Is equal to",[vT]:"Is not equal to",[CT]:"Begins with",[yT]:"Ends with",[bT]:"Contains",[ST]:"Does not contain",[RT]:"Greater than",[ET]:"Greater than or equal to",[TT]:"Less than",[MT]:"Less than or equal to",[_T]:"Is between",[OT]:"Is not between",[PT]:"After",[IT]:"Before",[xT]:"Today",[AT]:"Tomorrow",[HT]:"Yesterday",[Zp]:"Blank cells",[NT]:"Filter by condition",[DT]:"Filter by value",[LT]:"And",[Mv]:"Or",[kT]:"Select all",[$T]:"Clear",[FT]:"OK",[VT]:"Cancel",[WT]:"Search",[BT]:"Value",[jT]:"Second value",[YT]:"Checked",[zT]:"Unchecked"},HQ=AQ,LS=cL.languageCode,{register:NQ,getItem:hL,hasItem:DQ,getValues:LQ}=Kr("languagesDictionaries");dL(cL);function dL(t,e){let n=t,i=e;return Ye(t)&&(i=t,n=i.languageCode),kQ(n,i),NQ(n,Jn(i)),Jn(i)}function kQ(t,e){t!==LS&&TQ(e,hL(LS))}function fL(t){return GT(t)?Jn(hL(t)):null}function GT(t){return DQ(t)}function $Q(){return LQ()}function gL(t,e,n){const i=fL(t);if(i===null)return null;const r=i[e];if(xt(r))return null;const s=FQ(r,n);return Array.isArray(s)?s[0]:s}function FQ(t,e){let n=t;return A(IQ(),i=>{n=i(t,e)}),n}function VQ(t){let e=aL(t);return GT(e)||(e=LS,lL(t)),e}function WQ(t,e,n){return(e=BQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BQ(t){var e=jQ(t,"string");return typeof e=="symbol"?e:e+""}function jQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bo extends YD{constructor(e,n){super(e,null),WQ(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:i}=e,r=this.getNearestNotHiddenCoords(n,1),s=this.getNearestNotHiddenCoords(i,-1);return r===null||s===null?null:((r.row>s.row||r.col>s.col)&&(r=n,s=i),this.settings.createCellRange(r,r,s))}getNearestNotHiddenCoords(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(r===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return s===null?null:this.settings.createCellCoords(r,s)}getNearestNotHiddenIndex(e,n,i){return n<0?n:e.getNearestNotHiddenIndex(n,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(n,i,r)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const i=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(n);return i.row===null||i.col===null||r.row===null||r.col===null?null:this.settings.createCellRange(i,i,r)}}function uy(t){let{activeHeaderClassName:e,...n}=t;return new Bo({className:e,...n,selectionType:zD})}function UQ(t){let{areaCornerVisible:e,...n}=t;return new Bo({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:aE})}function YQ(t){let{...e}=t;return new Bo({className:"highlight",...e,selectionType:aE})}function zQ(t){let{columnClassName:e,...n}=t;return new Bo({className:e,...n,selectionType:pJ})}function GQ(t){let{cellCornerVisible:e,...n}=t;return new Bo({className:"current",headerAttributes:[P0()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:lE})}function KQ(t){let{border:e,visualCellRange:n,...i}=t;return new Bo({...e,...i,selectionType:wJ},n)}function XQ(t){let{...e}=t;return new Bo({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:gJ})}function sP(t){let{headerClassName:e,...n}=t;return new Bo({className:e,...n,selectionType:oE})}function qQ(t){let{rowClassName:e,...n}=t;return new Bo({className:e,...n,selectionType:mJ})}function ZQ(t,e){JQ(t,e),e.add(t)}function JQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mi(t,e,n){return(e=QQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QQ(t){var e=eee(t,"string");return typeof e=="symbol"?e:e+""}function eee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var es=new WeakSet;class tee{constructor(e){ZQ(this,es),mi(this,"options",void 0),mi(this,"layerLevel",0),mi(this,"focus",void 0),mi(this,"fill",void 0),mi(this,"layeredAreas",new Map),mi(this,"areas",new Map),mi(this,"rowHeaders",new Map),mi(this,"columnHeaders",new Map),mi(this,"activeRowHeaders",new Map),mi(this,"activeColumnHeaders",new Map),mi(this,"activeCornerHeaders",new Map),mi(this,"rowHighlights",new Map),mi(this,"columnHighlights",new Map),mi(this,"customSelections",[]),this.options=e,this.focus=GQ(e),this.fill=XQ(e)}isEnabledFor(e,n){let i=e;e===lE&&(i="current");let r=this.options.disabledCellSelection(n.row,n.col);return typeof r=="string"&&(r=[r]),r===!1||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Zs(es,this,Js).call(this,this.layeredAreas,UQ)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Zs(es,this,Js).call(this,this.areas,YQ)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Zs(es,this,Js).call(this,this.rowHeaders,sP)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Zs(es,this,Js).call(this,this.columnHeaders,sP)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Zs(es,this,Js).call(this,this.activeRowHeaders,uy)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Zs(es,this,Js).call(this,this.activeColumnHeaders,uy)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Zs(es,this,Js).call(this,this.activeCornerHeaders,uy)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Zs(es,this,Js).call(this,this.rowHighlights,qQ)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Zs(es,this,Js).call(this,this.columnHighlights,zQ)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(KQ({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),A(this.areas.values(),e=>void e.clear()),A(this.layeredAreas.values(),e=>void e.clear()),A(this.rowHeaders.values(),e=>void e.clear()),A(this.columnHeaders.values(),e=>void e.clear()),A(this.activeRowHeaders.values(),e=>void e.clear()),A(this.activeColumnHeaders.values(),e=>void e.clear()),A(this.activeCornerHeaders.values(),e=>void e.clear()),A(this.rowHighlights.values(),e=>void e.clear()),A(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Js(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const i=e({layerLevel:n,...this.options});return t.set(n,i),i}function oP(t,e,n){return(e=nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nee(t){var e=iee(t,"string");return typeof e=="symbol"?e:e+""}function iee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ree{constructor(e){oP(this,"ranges",[]),oP(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function see(t,e){mL(t,e),e.add(t)}function cy(t,e,n){mL(t,e),e.set(t,n)}function mL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function at(t,e){return t.get(dn(t,e))}function zg(t,e,n){return t.set(dn(t,e),n),n}function dn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gg=new WeakMap,Ht=new WeakMap,$r=new WeakMap,Cn=new WeakSet;class kS{constructor(e,n){see(this,Cn),cy(this,Gg,void 0),cy(this,Ht,void 0),cy(this,$r,{x:0,y:0}),zg(Gg,this,e),zg(Ht,this,n)}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=at(Ht,this).createCellCoords(e,n);let s=at(Gg,this).current().highlight;const o=at(Ht,this).visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",r),o.row!==null&&o.col!==null){const{width:u,height:c}=dn(Cn,this,pL).call(this),{row:h,col:d}=dn(Cn,this,lP).call(this,s),f=at(Ht,this).fixedRowsBottom(),m=at(Ht,this).minSpareRows(),p=at(Ht,this).minSpareCols(),y=at(Ht,this).autoWrapRow(),E=at(Ht,this).autoWrapCol(),T=at(Ht,this).createCellCoords(h+r.row,d+r.col);if(T.row>=c){const H=ar(i&&m>0&&f===0),U=T.col+1,Y=at(Ht,this).createCellCoords(T.row-c,U>=u?U-u:U);this.runLocalHooks("beforeColumnWrap",H,dn(Cn,this,Pu).call(this,Y),U>=u),H.value?this.runLocalHooks("insertRowRequire",at(Ht,this).countRenderableRows()):E&&T.assign(Y)}else if(T.row<0){const H=ar(E),U=T.col-1,Y=at(Ht,this).createCellCoords(c+T.row,U<0?u+U:U);this.runLocalHooks("beforeColumnWrap",H,dn(Cn,this,Pu).call(this,Y),U<0),E&&T.assign(Y)}if(T.col>=u){const H=ar(i&&p>0),U=T.row+1,Y=at(Ht,this).createCellCoords(U>=c?U-c:U,T.col-u);this.runLocalHooks("beforeRowWrap",H,dn(Cn,this,Pu).call(this,Y),U>=c),H.value?this.runLocalHooks("insertColRequire",at(Ht,this).countRenderableColumns()):y&&T.assign(Y)}else if(T.col<0){const H=ar(y),U=T.row-1,Y=at(Ht,this).createCellCoords(U<0?c+U:U,u+T.col);this.runLocalHooks("beforeRowWrap",H,dn(Cn,this,Pu).call(this,Y),U<0),y&&T.assign(Y)}const{rowDir:M,colDir:P}=dn(Cn,this,aP).call(this,T);a=M,l=P,s=dn(Cn,this,Pu).call(this,T)}return this.runLocalHooks("afterTransformStart",s,a,l),s}transformEnd(e,n){const i=at(Ht,this).createCellCoords(e,n),r=at(Gg,this).current(),s=at(Ht,this).visualToRenderableCoords(r.highlight),o=dn(Cn,this,hy).call(this,r.to.row,r.from.row),a=dn(Cn,this,dy).call(this,r.to.col,r.from.col),l=r.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",i),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:h,col:d}=dn(Cn,this,lP).call(this,r.highlight),f=at(Ht,this).createCellCoords(o+i.row,a+i.col),m=r.getTopStartCorner(),p=r.getTopEndCorner(),y=r.getBottomEndCorner();if(i.col<0&&a>=d&&f.col<d){const P=f.col-d;f.col=dn(Cn,this,dy).call(this,m.col,p.col)+P}else if(i.col>0&&a<=d&&f.col>d){const P=dn(Cn,this,dy).call(this,p.col,m.col),H=Math.max(f.col-P,1);f.col=P+H}if(i.row<0&&o>=h&&f.row<h){const P=f.row-h;f.row=dn(Cn,this,hy).call(this,m.row,y.row)+P}else if(i.row>0&&o<=h&&f.row>h){const P=dn(Cn,this,hy).call(this,y.row,m.row),H=Math.max(f.row-P,1);f.row=P+H}const{rowDir:E,colDir:T}=dn(Cn,this,aP).call(this,f);u=E,c=T;const M=dn(Cn,this,Pu).call(this,f);i.row===0&&i.col!==0?l.col=M.col:i.row!==0&&i.col===0?l.row=M.row:(l.row=M.row,l.col=M.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:i}=e;zg($r,this,{x:n,y:i})}resetOffsetSize(){zg($r,this,{x:0,y:0})}}function aP(t){const{width:e,height:n}=dn(Cn,this,pL).call(this);let i=0,r=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=n&&(i=1,t.row=n-1),t.col<0?(r=-1,t.col=0):t.col>0&&t.col>=e&&(r=1,t.col=e-1),{rowDir:i,colDir:r}}function pL(){return{width:at($r,this).x+at(Ht,this).countRenderableColumns(),height:at($r,this).y+at(Ht,this).countRenderableRows()}}function hy(t,e){const n=at(Ht,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:at($r,this).y+n}function dy(t,e){const n=at(Ht,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:at($r,this).x+n}function lP(t){const{row:e,col:n}=at(Ht,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return at(Ht,this).createCellCoords(at($r,this).y+e,at($r,this).x+n)}function Pu(t){const e=t.clone();return e.col=t.col-at($r,this).x,e.row=t.row-at($r,this).y,at(Ht,this).renderableToVisualCoords(e)}yt(kS,Fn);const _v=0,Ov=1,wL=2,KT=3,oee=[KT,wL],aee=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],fy=Symbol("root"),uP=Symbol("child");function xc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fy;if(e!==fy&&e!==uP)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),i=e===fy;let r=_v;if(n){const s=t[0];t.length===0?r=Ov:i&&s instanceof Vf?r=KT:i&&Array.isArray(s)?r=xc(s,uP):t.length>=2&&t.length<=4&&!t.some((a,l)=>!aee[l].includes(typeof a))&&(r=wL)}return r}function uf(t){let{createCellCoords:e,createCellRange:n,keepDirection:i=!1,propToCol:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!oee.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=t===KT;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],u=o?s.to.row:s[2],c=o?s.to.col:s[3];if(typeof r=="function"&&(typeof l=="string"&&(l=r(l)),typeof c=="string"&&(c=r(c))),xt(u)&&(u=a),xt(c)&&(c=l),!i){const f=a,m=l,p=u,y=c;a=Math.min(f,p),l=Math.min(m,y),u=Math.max(f,p),c=Math.max(m,y)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function lee(t){const e=xc(t.getSelected());if(e===_v||e===Ov)return[];const n=uf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;A(t.getSelected(),o=>{const{from:a,to:l}=n(o),u=Math.max(a.col,0),c=l.col-u+1;A(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((o,a)=>o-a);return cn(r,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function uee(t){const e=xc(t.getSelected());if(e===_v||e===Ov)return[];const n=uf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;A(t.getSelected(),o=>{const{from:a,to:l}=n(o),u=Math.max(a.row,0),c=l.row-u+1;A(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((o,a)=>o-a);return cn(r,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function Iu(t,e,n){cee(t,e),e.set(t,n)}function cee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nl(t,e,n){return(e=hee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hee(t){var e=dee(t,"string");return typeof e=="symbol"?e:e+""}function dee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lt(t,e){return t.get(vL(t,e))}function ts(t,e,n){return t.set(vL(t,e),n),n}function vL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bn=new WeakMap,il=new WeakMap,Kg=new WeakMap,Sh=new WeakMap,Xg=new WeakMap,Rh=new WeakMap;class CL{constructor(e,n){var i=this;nl(this,"settings",void 0),nl(this,"tableProps",void 0),nl(this,"inProgress",!1),nl(this,"selectedRange",new ree((r,s,o)=>this.tableProps.createCellRange(r,s,o))),nl(this,"highlight",void 0),Iu(this,Bn,void 0),Iu(this,il,void 0),nl(this,"selectedByRowHeader",new Set),nl(this,"selectedByColumnHeader",new Set),Iu(this,Kg,!1),Iu(this,Sh,!1),Iu(this,Xg,"unknown"),Iu(this,Rh,-1),this.settings=e,this.tableProps=n,this.highlight=new tee({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[P0()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,s)=>this.tableProps.isDisabledCellSelection(r,s),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,s)=>this.tableProps.createCellCoords(r,s),createCellRange:(r,s,o)=>this.tableProps.createCellRange(r,s,o)}),ts(Bn,this,new kS(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,s)=>this.tableProps.createCellCoords(r,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),ts(il,this,new kS(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,r.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,r.getOuterBottomEndCorner().col)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,s)=>this.tableProps.createCellCoords(r,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Lt(Bn,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformStart",...s)}),Lt(Bn,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("afterModifyTransformStart",...s)}),Lt(Bn,this).addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformEnd",...s)}),Lt(Bn,this).addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("afterModifyTransformEnd",...s)}),Lt(Bn,this).addLocalHook("insertRowRequire",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("insertRowRequire",...s)}),Lt(Bn,this).addLocalHook("insertColRequire",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("insertColRequire",...s)}),Lt(Bn,this).addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeRowWrap",...s)}),Lt(Bn,this).addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeColumnWrap",...s)}),Lt(il,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformFocus",...s)}),Lt(il,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){ts(Xg,this,e)}markEndSource(){ts(Xg,this,"unknown")}getSelectionSource(){return Lt(Xg,this)}setExpectedLayers(e){ts(Rh,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,ts(Rh,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=xt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();ts(Kg,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,a),(!s||s&&!o&&xt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(r.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),i=this.tableProps.countRows(),r=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||r>0)&&(i===0&&n.col<0&&!s||r===0&&n.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),u=o.getVerticalDirection(),c=this.isMultiple();o.setTo(n),c&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),c&&(u!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}i>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Lt(Rh,this)===-1||this.selectedRange.size()===Lt(Rh,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),r=this.tableProps.countCols();n<this.highlight.layerLevel&&(A(this.highlight.getAreas(),m=>void m.clear()),A(this.highlight.getLayeredAreas(),m=>void m.clear()),A(this.highlight.getRowHeaders(),m=>void m.clear()),A(this.highlight.getColumnHeaders(),m=>void m.clear()),A(this.highlight.getActiveRowHeaders(),m=>void m.clear()),A(this.highlight.getActiveColumnHeaders(),m=>void m.clear()),A(this.highlight.getActiveCornerHeaders(),m=>void m.clear()),A(this.highlight.getRowHighlights(),m=>void m.clear()),A(this.highlight.getColumnHighlights(),m=>void m.clear())),this.highlight.useLayerLevel(n);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(aE,e.highlight)&&(this.isMultiple()||n>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),n===1)){const m=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(oE,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),T=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),M=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(T).commit(),d.add(y).commit(),f.add(T).commit()):(a.add(y).add(E).commit(),l.add(T).add(M).commit(),d.add(y).add(E).commit(),f.add(T).add(M).commit())}const m=!Lt(Sh,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||r===0&&this.isSelectedByRowHeader()),p=!Lt(Sh,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),p&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&p&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(lE,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(ts(Kg,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Lt(Bn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Lt(Bn,this).resetOffsetSize(),this.setRangeStart(Lt(Bn,this).transformStart(e,n,i))}transformEnd(e,n){this.settings.navigableHeaders?Lt(Bn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Lt(Bn,this).resetOffsetSize(),this.setRangeEnd(Lt(Bn,this).transformEnd(e,n))}transformFocus(e,n){const i=this.selectedRange.current(),{row:r,col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,s-1),a=this.tableProps.countRenderableRowsInRange(0,r-1);i.highlight.isHeader()?Lt(il,this).setOffsetSize({x:s<0?Math.abs(s):-o,y:r<0?Math.abs(r):-a}):Lt(il,this).setOffsetSize({x:s<0?0:-o,y:r<0?0:-a});const l=Lt(il,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:r,to:s,highlight:o}=i,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(pt(r.row+h,c,a-1),r.col),f=this.tableProps.createCellCoords(pt(s.row+n,c,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(pt(o.row+n,0,a-1),o.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:r,to:s,highlight:o}=i,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(r.row,pt(r.col+h,c,a-1)),f=this.tableProps.createCellCoords(s.row,pt(s.col+n,c,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(o.row,pt(o.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=ar(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Lt(Kg,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{col:s}=r.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&r.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{row:s}=r.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&r.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=i?-l:0,c=n?-a:0;if(u===0&&c===0&&(s===0||o===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=r;ts(Sh,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(pt(d.row,u,s-1),pt(d.col,c,o-1)));const m=this.tableProps.createCellCoords(u,c),p=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(m,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.finish(),ts(Sh,this,!1)}selectCells(e){var n=this;const i=xc(e);if(i===Ov)return!1;if(i===_v)throw new Error(Ct`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=uf(i,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=r(l),c=u.isValid(o);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),A(e,l=>{const{from:u,to:c}=r(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof n=="string"?this.tableProps.propToCol(n):n,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,r),h=this.tableProps.createCellCoords(o-1,s),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,m=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(f=pt(i.row,u,o-1),m=pt(i.col,Math.min(r,s),Math.max(r,s))):(f=pt(i,u,o-1),m=r);const p=this.tableProps.createCellCoords(f,m),y=l===0?0:pt(p.row,u,-1),E=o-1,T=this.tableProps.createCellCoords(y,r),M=this.tableProps.createCellCoords(E,s);this.runLocalHooks("beforeSelectColumns",T,M,p),T.row=y,M.row=E,this.setRangeStartOnly(T,void 0,p),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(M),this.runLocalHooks("afterSelectColumns",T,M,p),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,s-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:r,countCols:s,countRowHeaders:o,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(h=pt(i.row,Math.min(e,n),Math.max(e,n)),d=pt(i.col,a,s-1)):(h=e,d=pt(i,a,s-1));const f=this.tableProps.createCellCoords(h,d),m=o===0?0:pt(f.col,a,-1),p=s-1,y=this.tableProps.createCellCoords(e,m),E=this.tableProps.createCellCoords(n,p);this.runLocalHooks("beforeSelectRows",y,E,f),y.col=m,E.col=p,this.setRangeStartOnly(y,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",y,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const i=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:r,to:s,highlight:o}=i;this.clear(),o.assign({row:pt(o.row,-1/0,e-1),col:pt(o.col,-1/0,n-1)}),r.assign({row:pt(r.row,-1/0,e-1),col:pt(r.col,-1/0,n-1)}),s.assign({row:pt(s.row,0,e-1),col:pt(s.col,0,n-1)}),this.selectedRange.ranges.push(i),this.highlight.getFocus().add(o).commit().syncWith(i),this.applyAndCommit(i)}commit(){if(this.highlight.getCustomSelections().forEach(r=>{r.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),i=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(i)}}yt(CL,Fn);const cP=/^(\r\n|\n\r|\r|\n)/,fee=/^[^\t\r\n]+/,hP=/^\t/;function gee(t){const e=[[""]];if(t.length===0)return e;let n=0,i=0,r;for(;t.length>0&&r!==t.length;)if(r=t.length,t.match(hP))t=t.replace(hP,""),n+=1,e[i][n]="";else if(t.match(cP))t=t.replace(cP,""),n=0,i+=1,e[i]=[""];else{let s="";if(t.startsWith('"')){let o=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(o+=1),s+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=t.match(fee);s=o?o[0]:"",t=t.slice(s.length)}e[i][n]=s}return e}function Td(t){let e,n,i,r,s="",o;for(e=0,n=t.length;e<n;e+=1){for(r=t[e].length,i=0;i<r;i+=1)i>0&&(s+="	"),o=t[e][i],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==n-1&&(s+=`
`)}return s}function rl(t,e,n){return(e=mee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mee(t){var e=pee(t,"string");return typeof e=="symbol"?e:e+""}function pee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,i){rl(this,"hot",void 0),rl(this,"metaManager",void 0),rl(this,"tableMeta",void 0),rl(this,"dataSource",void 0),rl(this,"duckSchema",void 0),rl(this,"colToPropCache",void 0),rl(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,n){let r=0,s=0,o=!1;if(typeof n=="function"){const a=mv(e);r=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;r=Math.min(a,n.length)}for(i=0;i<r;i++){const a=o?n(i):n[i];if(Ye(a)){if(typeof a.data<"u"){const l=o?s:i;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return vE(this.dataSource)}recursiveDuckColumns(e,n,i){let r=n,s=i,o;return typeof r>"u"&&(r=0,s=""),typeof e=="object"&&!Array.isArray(e)&&ze(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,r),r+=1):r=this.recursiveDuckColumns(a,r,`${l}.`)}),r}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&Se(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(Se(n))return this.hot.toVisualColumn(n);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Ic(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,i)===!1||o===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&s+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=Jn(this.getSchema()):(m=[],_e(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},$f(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),r==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,d);const f=this.hot.toVisualRow(o);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):i!=="auto"&&this.metaManager.createRow(o,n)),this.hot.runHooks("afterCreateRow",f,a,i),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:o}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,i)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,m=c;r==="end"&&(m=Math.min(m+1,a));const p=m;for(;f<n&&d<o;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof s[E]>"u"&&(s[E]=[]),s[E].push(null);else s.push([null]);else for(let E=0;E<h;E++)s[E].splice(m,0,null);f+=1,m+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):i!=="auto"&&this.metaManager.createColumn(p,n));const y=this.hot.toVisualColumn(p);return this.hot.runHooks("afterCreateCol",y,f,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:p}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-n;const s=this.visualRowsToPhysical(r,n),o=this.hot.countSourceRows();if(r=(o+r)%o,this.hot.runHooks("beforeRemoveRow",r,s.length,s,i)===!1)return!1;const l=s.length;if(this.filterData(r,l,s),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const c=Se(this.tableMeta.columns)||Se(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",r,l,s,i),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r=typeof e!="number"?-n:e;r=(this.hot.countCols()+r)%this.hot.countCols();const s=this.visualColumnsToPhysical(r,n),o=s.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",r,n,s,i)===!1)return!1;let l=!0;const u=o.length,c=this.dataSource;for(let h=0;h<u;h++)l&&s[0]!==s[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(s[0],n),h===0&&this.metaManager.removeColumn(s[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(o[f],1),h===0&&this.metaManager.removeColumn(o[f],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,n,s,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,i){const r=this.hot.getDataAtCol(e),s=r.slice(n,n+i),o=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];mS(l,o);let c=0;for(;c<i;)l.push(null),c+=1;return xN(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),s}spliceRow(e,n,i){const r=this.hot.getSourceDataAtRow(e),s=r.slice(n,n+i),o=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];mS(l,o);let c=0;for(;c<i;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),s}spliceData(e,n,i){if(this.hot.runHooks("beforeDataSplice",e,n,i)!==!1){const s=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,n,i){let r=this.hot.runHooks("filterData",e,n,i);Array.isArray(r)===!1&&(r=this.dataSource.filter((s,o)=>i.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,n){const i=this.hot.toPhysicalRow(e);let r=this.dataSource[i];const s=this.hot.runHooks("modifyRowData",i);r=isNaN(s)?s:r;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(r&&r.hasOwnProperty&&Ut(r,n))a=r[n];else if(o&&typeof n=="string"&&n.indexOf(".")>-1){let l=r;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){const l=ar(a);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,i){const r=this.hot.toPhysicalRow(e);let s=i,o=this.dataSource[r];const a=this.hot.runHooks("modifyRowData",r);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const u=ar(s);this.hot.runHooks("modifyData",r,this.propToCol(n),u,"set"),u.isTouched()&&(s=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&Ut(o,n))o[n]=s;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=o,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++)typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]];u[d[c]]=s}else typeof n=="function"?n(this.dataSource.slice(r,r+1)[0],s):o[n]=s}visualRowsToPhysical(e,n){const i=this.hot.countSourceRows(),r=[];let s=(i+e)%i,o=n,a;for(;s<i&&o;)a=this.hot.toPhysicalRow(s),r.push(a),o-=1,s+=1;return r}visualColumnsToPhysical(e,n){const i=this.hot.countCols(),r=[];let s=(i+e)%i,o=n;for(;s<i&&o;){const a=this.hot.toPhysicalColumn(s);r.push(a),o-=1,s+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,cc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,i){const r=[];let s,o,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=i===cc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(s=Math.min(e.row,n.row);s<=h;s++){a=[];const f=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,n.col);o<=d&&f!==null;o++)a.push(c.call(this,s,this.colToProp(o)));f!==null&&r.push(a)}return r}getText(e,n){return Td(this.getRange(e,n,cc.DESTINATION_RENDERER))}getCopyableText(e,n){return Td(this.getRange(e,n,cc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:wee,getItem:vee,hasItem:yL,getNames:Cee,getValues:tve}=Kr("cellTypes");function XT(t){if(!yL(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return vee(t)}function Zi(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:i,validator:r}=e;n&&yi(t,n),i&&xi(t,i),r&&Hl(t,r),wee(t,e)}function yee(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Ut(e,t)}function Pv(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?XT(e.type):e.type;if(t._automaticallyAssignedMetaProps&&ze(e,(s,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!Ye(i))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const r={};ze(i,(s,o)=>{if(yee(o,n)){var a;r[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),un(t,r)}function bee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Gr(n,t);for(let i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}function dp(t){return Number.isInteger(t)&&t>=0}function fp(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function qg(t){return t==null}const bL=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,i;for(e=0,n=this.countRows();e<n;e++)if(i=this.getDataAtCell(e,t),Qt(i)===!1)return!1;return!0},isEmptyRow(t){let e,n,i,r;for(e=0,n=this.countCols();e<n;e++)if(i=this.getDataAtCell(t,e),Qt(i)===!1)return typeof i=="object"?(r=this.getCellMeta(t,e),gv(this.getSchema()[r.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function dP(t,e,n){return(e=See(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function See(t){var e=Ree(t,"string");return typeof e=="symbol"?e:e+""}function Ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Eee(){return class{}}class Tee{constructor(e){dP(this,"metaCtor",Eee()),dP(this,"meta",void 0),this.meta=this.metaCtor.prototype,un(this.meta,bL()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;un(this.meta,e),Pv(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function Mee(t,e,n){return(e=_ee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ee(t){var e=Oee(t,"string");return typeof e=="symbol"?e:e+""}function Oee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pee{constructor(e){Mee(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){un(this.meta,e),Pv(this.meta,e,e)}}function Zg(t,e,n){return(e=Iee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iee(t){var e=xee(t,"string");return typeof e=="symbol"?e:e+""}function xee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jp{constructor(e){Zg(this,"valueFactory",void 0),Zg(this,"data",[]),Zg(this,"index",[]),Zg(this,"holes",new Set),this.valueFactory=e}obtain(e){fp(()=>dp(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let i;if(n>=0)i=this.data[n],i===void 0&&(i=this.valueFactory(e),this.data[n]=i);else if(i=this.valueFactory(e),this.holes.size>0){const r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=i,this.index[e]=r}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;fp(()=>dp(e)||qg(e),"Expecting an unsigned number or null/undefined argument.");const i=[],r=this.data.length;for(let o=0;o<n;o++)i.push(r+o),this.data.push(void 0);const s=qg(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...i,...this.index.slice(s)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;fp(()=>dp(e)||qg(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(qg(e)?this.index.length-n:e,n);for(let r=0;r<i.length;r++){const s=i[r];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return Ao(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const r=this._getKeyByStorageIndex(i);r!==-1&&e.push([r,this.data[i]])}let n=0;return{next:()=>{if(n<e.length){const i=e[n];return n+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function fP(t,e,n){return(e=Aee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aee(t){var e=Hee(t,"string");return typeof e=="symbol"?e:e+""}function Hee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Nee=["data","width"];class Dee{constructor(e){fP(this,"globalMeta",void 0),fP(this,"metas",new Jp(()=>this._createMeta())),this.globalMeta=e,this.metas=new Jp(()=>this._createMeta())}updateMeta(e,n){const i=this.getMeta(e);un(i,n),Pv(i,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return bee(this.globalMeta.getMetaConstructor(),Nee).prototype}}function gP(t,e,n){return(e=Lee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lee(t){var e=kee(t,"string");return typeof e=="symbol"?e:e+""}function kee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ee{constructor(e){gP(this,"columnMeta",void 0),gP(this,"metas",new Jp(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,i){const r=this.getMeta(e,n);un(r,i),Pv(r,i)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,n)}getMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);return i===void 0?r:r[i]}setMeta(e,n,i,r){var s;const o=this.metas.obtain(e).obtain(n);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(i),o[i]=r}removeMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);delete r[i]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let i=0;i<n.length;i++)Se(n[i])&&e.push(...n[i].values());return e}getMetasAtRow(e){fp(()=>dp(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Jp(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class SL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Tee(e),this.tableMeta=new Pee(this.globalMeta),this.columnMeta=new Dee(this.globalMeta),this.cellMeta=new $ee(this.columnMeta),i.forEach(r=>new r(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,i){let{visualRow:r,visualColumn:s}=i;const o=this.cellMeta.getMeta(e,n);return o.visualRow=r,o.visualCol=s,o.row=e,o.col=n,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,i)}setCellMeta(e,n,i,r){this.cellMeta.setMeta(e,n,i,r)}updateCellMeta(e,n,i){this.cellMeta.updateMeta(e,n,i)}removeCellMeta(e,n,i){this.cellMeta.removeMeta(e,n,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}yt(SL,Fn);function mP(t,e,n,i){const{hotInstance:r,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:c}=i,h=Zn(a),d=r.getSettings();Array.isArray(d.dataSchema)?r.dataType="array":Pt(d.dataSchema)?r.dataType="function":r.dataType="object",s&&s.destroy(),t=r.runHooks(`before${h}`,t,c,l);const f=new cc(r,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const m=f.getSchema();t=[];let p,y=0,E=0;for(y=0,E=d.startRows;y<E;y++)if((r.dataType==="object"||r.dataType==="function")&&d.dataSchema)p=Jn(m),t.push(p);else if(r.dataType==="array")p=Jn(m[0]),t.push(p);else{p=[];for(let T=0,M=d.startCols;T<M;T++)p.push(null);t.push(p)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(r.dataType="array"),d.data=t,f.dataSource=t,o.data=t,o.dataType=r.dataType,o.colToProp=f.colToProp.bind(f),o.propToCol=f.propToCol.bind(f),o.countCachedColumns=f.countCachedColumns.bind(f),n(f),r.runHooks(`after${h}`,t,c,l),c||(r.runHooks("afterChange",null,a),r.render()),r.getSettings().ariaTags&&xe(r.rootElement,[FN(-1),lv(r.countCols()+(r.view?r.countRowHeaders():0))])}function pP(t,e,n){return(e=Fee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fee(t){var e=Vee(t,"string");return typeof e=="symbol"?e:e+""}function Vee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wee{constructor(e){pP(this,"metaManager",void 0),pP(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),ye.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:i,col:r}=e;if((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(r))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const u=Ut(e,"type")?e.type:null;let c=Pt(e.cells)?e.cells(i,r,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(i,r,c),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(r)}}function Bee(t,e,n){jee(t,e),e.set(t,n)}function jee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gy(t,e,n){return(e=Uee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uee(t){var e=Yee(t,"string");return typeof e=="symbol"?e:e+""}function Yee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zee(t,e){return t.get(Gee(t,e))}function Gee(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wP=new WeakMap;class Kee{constructor(e){gy(this,"metaManager",void 0),gy(this,"usageTracker",new Set),gy(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Bee(this,wP,(n,i,r)=>{if(!r)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:i,target:r,onChange:s}=e,o=typeof r=="string",a=o?r:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(n,l,s),o&&this.installPropWatcher(r,l,s)):i&&(this.installPropWatcher(n,l,zee(wP,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,i){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(s){const o=!r.usageTracker.has(e);r.usageTracker.add(e),i.call(r,e,s,o),this[n]=s},enumerable:!0,configurable:!0})}}const RL="gridDefault",Ba="editorManager.handlingEditor",Xee={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},qee="hooksRefRegisterer",EL={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){A(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){ze(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};js(EL,"MIXIN_NAME",qee,{writable:!1,enumerable:!1});function Sr(t,e,n){return(e=Zee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zee(t){var e=Jee(t,"string");return typeof e=="symbol"?e:e+""}function Jee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Qee="base",nn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Yc{static get EDITOR_TYPE(){return Qee}constructor(e){Sr(this,"hot",void 0),Sr(this,"state",nn.VIRGIN),Sr(this,"_opened",!1),Sr(this,"_fullEditMode",!1),Sr(this,"_closeCallback",null),Sr(this,"TD",null),Sr(this,"row",null),Sr(this,"col",null),Sr(this,"prop",null),Sr(this,"originalValue",null),Sr(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,i,r,s,o){this.TD=r,this.row=e,this.col=n,this.prop=i,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:nn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let i,r,s,o;if(n){const l=this.hot.getSelectedLast();i=Math.max(Math.min(l[0],l[2]),0),r=Math.max(Math.min(l[1],l[3]),0),s=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[i,r,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",i,r);Array.isArray(a)&&([i,r]=a),this.hot.populateFromArray(i,r,e,s,o,"edit")}beginEditing(e,n){if(this.state!==nn.VIRGIN)return;const i=this.hot,r=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(r,s)),this.state=nn.EDITING,this.isInFullEditMode()){const o=typeof e=="string"?e:Jt(this.originalValue);this.setValue(o)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,i){let r;if(i){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),i(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===nn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===nn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?r=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:r=[[s]],this.state=nn.WAITING,this.saveValue(r,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=nn.FINISHED,this.discardEditor(o)}):(this.state=nn.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=nn.FINISHED,this.discardEditor()}discardEditor(e){this.state===nn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=nn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=nn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===nn.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:i,wtViewport:r}=this.hot.view._wt,s=this.hot.rootWindow,o=bn(n),a=At(n),l=bn(this.hot.rootElement),u=At(this.hot.rootElement),c=i.topOverlay.holder,h=i.inlineStartOverlay.holder,d=c!==s?c.scrollTop:0,f=h!==s?h.scrollLeft:0,m=s.innerWidth-l.left-u,{wtTable:p}=(e=i.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=p.name,E=["master","inline_start"].includes(y)?d:0,T=["master","top","bottom"].includes(y)?f:0,M=o.top===l.top?0:1;let P=o.top-l.top-M-E,H=0;this.hot.isRtl()?H=s.innerWidth-o.left-a-m-1+T:H=o.left-l.left-1-T,["top","top_inline_start_corner"].includes(y)&&(P+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(H+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const U=this.hot.hasColHeaders(),Y=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),Z=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(U&&Y<=0||Y===Z)&&(P+=1),Q<=0&&(H+=1);const te=r.rowsRenderCalculator.startPosition,ue=r.columnsRenderCalculator.startPosition,ce=Math.abs(i.inlineStartOverlay.getScrollPosition()),Ee=i.topOverlay.getScrollPosition(),He=Rn(this.hot.rootDocument);let Le=n.offsetTop;if(["inline_start","master"].includes(y)&&(Le+=te-Ee),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:ee,wtTable:ge}=i.bottomOverlay.clone;Le+=ee.getWorkspaceHeight()-ge.getHeight()-He}let be=n.offsetLeft;this.hot.isRtl()?(be>=0?be=p.getWidth()-n.offsetLeft:be=Math.abs(be),be+=ue-ce-a):["top","master","bottom"].includes(y)&&(be+=ue-ce);const le=Ho(this.TD,this.hot.rootWindow),ve=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",st=parseInt(le[ve],10)>0?0:1,g=parseInt(le.borderTopWidth,10)>0?0:1,w=At(n)+st,b=sn(n)+g,L=ZN(c)?He:0,k=JN(h)?He:0,B=this.hot.view.maximumVisibleElementWidth(be)-L+st,X=Math.max(this.hot.view.maximumVisibleElementHeight(Le)-k+g,23);return{top:P,start:H,height:b,maxHeight:X,width:w,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}yt(Yc,EL);const ete={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const i=t._getEditorManager(),r=i.getActiveEditor();r.isInFullEditMode()&&r.state===nn.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},tte={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},nte={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},ite={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},rte={name:"editorOpen",callback(t,e,n){const i=t._getEditorManager(),r=t.getSelectedRangeLast(),{highlight:s}=r;if(t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),gr(e))}};function ste(){return[Xee,ete,tte,nte,ite,rte]}const ote={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},ate={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),i=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(i!==null){const r=t._createCellCoords(i,e.col),s=e.row-t.view.getFirstFullyVisibleRow(),o=Math.min(r.row-s,t.countRows()-1);t.selection.setRangeEnd(r),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},lte={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},ute={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},cte={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,i.col,e)}},hte={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast(),o=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||o){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=r.clone();l.row=i.row,e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col))}}},dte={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const o=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=r.clone();a.col=i.col,e.setRangeStart(a,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(s.row,o))}}},fte={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(o,1),l=r.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},gte={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast(),o=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||o){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=r.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},mte={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast(),o=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||o){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=r.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},pte={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast(),o=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||o){const a=n.getNearestNotHiddenIndex(0,1),l=r.clone();l.row=i.row,e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col))}}},wte={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,i.row,e)}},vte={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},Cte={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),i=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(i!==null){const r=t._createCellCoords(i,e.col),s=e.row-t.view.getFirstFullyVisibleRow(),o=Math.max(r.row-s,0);t.selection.setRangeEnd(r),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}};function yte(){return[ote,ate,lte,ute,cte,hte,dte,fte,gte,mte,pte,wte,vte,Cte]}const bte={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},Ste={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let r=t.countVisibleRows()+n;i===t.countRows()-1?r=1:i+r>t.countRows()&&(r=t.countRows()-i-1),t.selection.transformStart(r,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},Rte={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),i=t.getSelectedRangeLast(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-r.row,-r.col):t.selection.transformStart(-r.row,-r.col)}},Ete={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),i=t.getSelectedRangeLast(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(r.row,r.col):t.selection.transformStart(r.row,r.col)}},Tte={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},Mte={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},_te={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},Ote={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsBottom,10),s=n.getNearestNotHiddenIndex(t.countRows()-r-1,-1),o=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(s,o))}},Pte={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},Ite={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),r=t.getSelectedRangeLast().highlight.row,s=n.getNearestNotHiddenIndex(i,1);e.setRangeStart(t._createCellCoords(r,s))}},xte={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,i=t.getSelectedRangeLast().highlight.row;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);r===null&&(r=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(i,r))}},Ate={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:i}=t.getSelectedRangeLast().highlight;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);r===null&&(r=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(i,r))}},Hte={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},Nte={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),o=n.getNearestNotHiddenIndex(r,1),a=i.getNearestNotHiddenIndex(s,1);e.setRangeStart(t._createCellCoords(o,a))}},Dte={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},Lte={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let r=-(t.countVisibleRows()+n);i===-n?r=-1:i+r<n&&(r=-(i+n)),t.selection.transformStart(r,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function kte(){return[bte,Ste,Rte,Ete,Tte,Mte,_te,Ote,Pte,Ite,xte,Ate,Hte,Nte,Dte,Lte]}const $te={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Fte={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,i=t.view.getFirstFullyVisibleColumn()-1,r=t.view.getLastFullyVisibleRow()+1,s=t.view.getLastFullyVisibleColumn()+1,o=t._createCellCoords(n,i),a=t._createCellCoords(r,s);if(!t._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},Vte={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},Wte={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},Bte={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:i}=e[e.length-1].highlight.normalize(),r=t.getDataAtCell(n,i),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==i)){const{readOnly:u}=t.getCellMeta(a,l);u||s.set(`${a}x${l}`,[a,l,r])}});t.setDataAtCell(Array.from(s.values()))}},jte=[...ste(),...yte(),...kte(),$te,Fte,Vte,Wte,Bte];function TL(t){const e={};return jte.forEach(n=>{let{name:i,callback:r}=n;e[i]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r(t,...o)}}),e}function Ute(t){const e=t.getShortcutManager().addContext("editor"),n=TL(t),i={group:Ba};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(r,s)=>n.editorCloseAndSaveByEnter(r,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(r,s)=>n.editorCloseAndSaveByEnter(r,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(r,s)=>n.editorCloseAndSave(r,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(r,s)=>n.editorCloseAndSaveByArrowKeys(r,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],i)}function Yte(t){const e=t.getShortcutManager().addContext("grid"),n=TL(t),i={runOnlyIf:()=>{const{navigableHeaders:r}=t.getSettings();return Se(t.getSelected())&&(r||!r&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:RL};e.addShortcuts([{keys:[["F2"]],callback:r=>n.editorFastOpen(r)},{keys:[["Enter"],["Enter","Shift"]],callback:(r,s)=>n.editorOpen(r,s)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Ba,runOnlyIf:()=>Se(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>t.getSelectedRangeLast().highlight.isHeader(),preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineStart(r)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineEnd(r)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],i)}function zte(t){[Yte,Ute].forEach(e=>e(t))}function Gte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,i=vP(t),r=vP(t);return i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(i),n.lastChild.after(r),{activate(){t._registerTimeout(()=>{i.tabIndex=0,r.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{i.tabIndex=-1,r.tabIndex=-1},10)}}}function vP(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&xe(n,[xs(),Vo()]),n}function Kte(t){const e=Xte(t);let n;const{activate:i,deactivate:r}=Gte(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:$S(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:FS(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>i()),t.addHook("afterSelection",(h,d,f,m,p)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,p.value=!0),o){var y;n=(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{s.wrapped=!0,s.flipped=f});function u(){s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:RL,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(o=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,o=!0,!d||!t.selection.isSelected()||f&&s.wrapped&&s.flipped||!f&&s.wrapped)return f&&s.wrapped&&s.flipped&&(n=h.shiftKey?$S(t):FS(t)),u(),!1;h.preventDefault()},position:"after"}])}function $S(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:i}=t.getSettings();let r=i&&t.countColHeaders()>0?-t.countColHeaders():0,s=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return r===0&&(r=e.getVisualFromRenderableIndex(r)),s===0&&(s=n.getVisualFromRenderableIndex(s)),r===null||s===null?null:t._createCellCoords(r,s)}function FS(t){var e,n;const{rowIndexMapper:i,columnIndexMapper:r}=t,{navigableHeaders:s}=t.getSettings();let o=i.getRenderableIndexesLength()-1,a=r.getRenderableIndexesLength()-1;if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(n=r.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function Xte(t){return e=>{if(!e)return null;const n=$S(t),i=FS(t);return e.col<n.col&&(e.col=n.col),e.col>i.col&&(e.col=i.col),e.row<n.row&&(e.row=n.row),e.row>i.row&&(e.row=i.row),e}}function qte(t){return e=>{let{col:n}=e;t.scrollViewportTo({col:n})}}function Zte(){return()=>{}}function Jte(t){return e=>{t.scrollViewportTo(e.toObject())}}function Qte(t){return e=>{t.scrollViewportTo(e.toObject())}}function ene(t){return e=>{t.scrollViewportTo(e.toObject())}}function tne(t){return e=>{let{row:n}=e;t.scrollViewportTo({row:n})}}function nne(t){return e=>{const n=t.selection.getSelectionSource(),{row:i,col:r}=e;if(i<0&&r>=0)t.scrollViewportTo({col:r});else if(r<0&&i>=0)t.scrollViewportTo({row:i});else{if(n==="mouse"&&(r===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:r})}}}function ine(t){const{selection:e}=t;let n=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){n=!0},scrollTo(r){var s;if(n||i){n=!1;return}let o;e.isFocusSelectionChanged()?o=Jte(t):e.isSelectedByCorner()?o=Zte():e.isSelectedByRowHeader()?o=tne(t):e.isSelectedByColumnHeader()?o=qte(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=Qte(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=nne(t):e.getSelectedRange().size()>1&&(o=ene(t)),(s=o)===null||s===void 0||s(r)}}}const CP=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Jg=t=>t.map(e=>{const n=e.toLowerCase();return CP.has(n)?CP.get(n):n}).sort().join("+"),rne=t=>t.split("+"),yP=new Map([[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),my=t=>{let{which:e,key:n}=t;if(yP.has(e))return yP.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:n.toLowerCase()},ML=Symbol("shortcut-context");function _L(t){return Ye(t)&&t.__kindOf===ML}const sne=t=>{const e=vv({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:m=!1,relativeToGroup:p,position:y,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(xt(c))throw new Error("You need to define the shortcut's group.");if(Pt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Ct`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const T={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:m};Se(p)&&(T.relativeToGroup=p,T.position=y),_L(E)&&(T.forwardToContext=E),l.forEach(M=>{const P=Jg(M);if(e.hasItem(P)){const U=e.getItem(P);let Y=U.findIndex(Q=>Q.group===p);Y!==-1?y==="before"?Y-=1:Y+=1:Y=U.length,U.splice(Y,0,T)}else e.addItem(P,[T])})},i=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{ze(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},r=l=>{const u=Jg(l);e.removeItem(u)};return{__kindOf:ML,addShortcut:n,addShortcuts:i,getShortcuts:l=>{const u=Jg(l),c=e.getItem(u);return Se(c)?c.slice():[]},hasShortcut:l=>{const u=Jg(l);return e.hasItem(u)},removeShortcutsByKeys:r,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(m=>m.group!==l);f.length===0?r(rne(h)):(d.length=0,d.push(...f))})}}};function one(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const ane=["meta","alt","shift","control"],Eh=one(),Th=[];let Qg=0;function lne(t,e,n,i,r){const s=f=>ane.includes(f),o=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=[];return f.altKey&&p.push("alt"),m&&(f.ctrlKey||f.metaKey)?p.push("control/meta"):(f.ctrlKey&&p.push("control"),f.metaKey&&p.push("meta")),f.shiftKey&&p.push("shift"),p},a=f=>{if(e(f)===!1)return;const m=n(f);if(f.keyCode===229||m===!1||ma(f))return;const p=my(f);let y=[];s(p)||(y=o(f));const E=[p].concat(y);!r(f,E)&&(of()&&y.includes("meta")||!of()&&y.includes("control"))&&r(f,[p].concat(o(f,!0))),i(f)},l=f=>{if(f.key){const m=my(f);s(m)&&Eh.press(m)}},u=f=>{if(f.key){const m=my(f);s(m)&&Eh.release(m)}},c=()=>{Eh.releaseAll()};return{mount:()=>{let f=t;for(Qg+=1;f;)Qg===1&&(f.document.documentElement.addEventListener("keydown",l),Th.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Th.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=Gl(f)},unmount:()=>{let f=t;for(Qg-=1;f;){if(Qg===0){for(let m=0;m<Th.length;m++){const{event:p,listener:y}=Th[m];f.document.documentElement.removeEventListener(p,y)}Th.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=Gl(f)}},isPressed:f=>Eh.isPressed(f),releasePressedKeys:()=>Eh.releaseAll()}}const une=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:i,afterKeyDown:r}=t;const s=vv({errorIdExists:m=>`The "${m}" context name is already registered.`});let o="grid";const a=m=>{const p=sne(m);return s.addItem(m,p),p},l=()=>o,u=m=>s.getItem(m),c=m=>{if(!s.hasItem(m))throw new Error(Ct`You've tried to activate the "${m}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=m};let h=!1;const d=function(m,p){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=_L(y)?y:u(y);let T=!1;if(!E.hasShortcut(p))return T;const M=E.getShortcuts(p);for(let P=0;P<M.length;P++){const{callback:H,runOnlyIf:U,preventDefault:Y,stopPropagation:Q,captureCtrl:q,forwardToContext:Z}=M[P];if(U(m)===!0){if(h=q,T=H(m,p)===!1,h=!1,Y&&m.preventDefault(),Q&&(gr(m),m.stopPropagation()),T)break;Z&&d(m,p,Z)}}return T},f=lne(e,n,i,r,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};let py=null;const wy=new Map;function OL(t,e){var n,i=this;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const o=new hr(s);let a,l,u,c,h,d,f=!0;YJ(r)&&UJ(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",p=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return p==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=VQ(e.language);const y=new SL(s,e,[Wee,Kee]),E=y.getTableMeta(),T=y.getGlobalMeta(),M=vv();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),cp(this)&&DN(e.licenseKey,t),this.guid=`ht_${E0()}`,wy.set(this.guid,this),this.columnIndexMapper=new DS,this.rowIndexMapper=new DS,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterRowSequenceChange",g)}),l=new rQ(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const P=g=>{const{row:w,col:b}=g;return s._createCellCoords(w>=0?s.rowIndexMapper.getRenderableFromVisualIndex(w):w,b>=0?s.columnIndexMapper.getRenderableFromVisualIndex(b):b)},H=g=>{const{row:w,col:b}=g;return s._createCellCoords(w>=0?s.rowIndexMapper.getVisualFromRenderableIndex(w):w,b>=0?s.columnIndexMapper.getVisualFromRenderableIndex(b):b)},U=(g,w)=>{const b=w>g?1:-1,L=Math.min(g,w),k=Math.max(g,w),B=s.rowIndexMapper.getNearestNotHiddenIndex(g,b);return B===null||b===1&&B>k||b===-1&&B<L?null:B>=0?s.rowIndexMapper.getRenderableFromVisualIndex(B):B},Y=(g,w)=>{const b=w>g?1:-1,L=Math.min(g,w),k=Math.max(g,w),B=s.columnIndexMapper.getNearestNotHiddenIndex(g,b);return B===null||b===1&&B>k||b===-1&&B<L?null:B>=0?s.columnIndexMapper.getRenderableFromVisualIndex(B):B};let Q=new CL(E,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:g=>a.propToCol(g),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(g,w)=>s._createCellCoords(g,w),createCellRange:(g,w,b)=>s._createCellRange(g,w,b),visualToRenderableCoords:P,renderableToVisualCoords:H,findFirstNonHiddenRenderableRow:U,findFirstNonHiddenRenderableColumn:Y,isDisabledCellSelection:(g,w)=>g<0||w<0?s.getSettings().disableVisualSelection:s.getCellMeta(g,w).disableVisualSelection});this.selection=Q;const q=g=>{let{hiddenIndexesChanged:w}=g;w&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",q),this.rowIndexMapper.addLocalHook("cacheUpdated",q),this.selection.addLocalHook("afterSetRangeEnd",(g,w)=>{const b=ar(!1),L=this.selection.getSelectedRange(),{from:k,to:B}=L.current(),X=L.size()-1;this.runHooks("afterSelection",k.row,k.col,B.row,B.col,b,X),this.runHooks("afterSelectionByProp",k.row,s.colToProp(k.col),B.row,s.colToProp(B.col),b,X),w&&(!b.isTouched()||b.isTouched()&&!b.value)&&d.scrollTo(g);const ee=Q.isSelectedByRowHeader(),ge=Q.isSelectedByColumnHeader();ee&&ge?ie(this.rootElement,["ht__selection--rows","ht__selection--columns"]):ee?(We(this.rootElement,"ht__selection--columns"),ie(this.rootElement,"ht__selection--rows")):ge?(We(this.rootElement,"ht__selection--rows"),ie(this.rootElement,"ht__selection--columns")):We(this.rootElement,["ht__selection--rows","ht__selection--columns"]),Q.getSelectionSource()!=="shift"&&c.closeEditor(null),s.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",g=>{this.runHooks("beforeSelectionFocusSet",g.row,g.col)}),this.selection.addLocalHook("afterSetFocus",g=>{const w=ar(!1);this.runHooks("afterSelectionFocusSet",g.row,g.col,w),(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(g),c.closeEditor(),s.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",g=>{const w=g.length-1,{from:b,to:L}=g[w];this.runHooks("afterSelectionEnd",b.row,b.col,L.row,L.col,w),this.runHooks("afterSelectionEndByProp",b.row,s.colToProp(b.col),L.row,s.colToProp(L.col),w)}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const w=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=w)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),s.view.render(),We(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("beforeSetRangeStart",...w)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("beforeSetRangeStartOnly",...w)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("beforeSetRangeEnd",...w)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("beforeSelectColumns",...w)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("afterSelectColumns",...w)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("beforeSelectRows",...w)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("afterSelectRows",...w)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("modifyTransformStart",...w)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("afterModifyTransformStart",...w)}).addLocalHook("beforeModifyTransformFocus",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("modifyTransformFocus",...w)}).addLocalHook("afterModifyTransformFocus",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("afterModifyTransformFocus",...w)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("modifyTransformEnd",...w)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("afterModifyTransformEnd",...w)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("beforeRowWrap",...w)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return i.runHooks("beforeColumnWrap",...w)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),u={alter(g,w){var b,L;let k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,B=arguments.length>3?arguments[3]:void 0,X=arguments.length>4?arguments[4]:void 0;const ee=ge=>{if(ge.length===0)return[];const me=[...ge];return me.sort((ke,O)=>{let[S]=ke,[W]=O;return S===W?0:S>W?1:-1}),cn(me,(ke,O)=>{let[S,W]=O;const K=ke[ke.length-1],[G,z]=K,J=G+z;if(S<=J){const v=Math.max(W-(J-S),0);K[1]+=v}else ke.push([S,W]);return ke},[me[0]])};switch(g){case"insert_row_below":case"insert_row_above":const ge=s.countSourceRows();if(E.maxRows===ge)return;const me=g==="insert_row_below"?"below":"above";w=(b=w)!==null&&b!==void 0?b:me==="below"?ge:0;const{delta:se,startPhysicalIndex:ke}=a.createRow(w,k,{source:B,mode:me});Q.shiftRows(s.toVisualRow(ke),se);break;case"insert_col_start":case"insert_col_end":const O=g==="insert_col_end"?"end":"start";w=(L=w)!==null&&L!==void 0?L:O==="end"?s.countSourceCols():0;const{delta:S,startPhysicalIndex:W}=a.createCol(w,k,{source:B,mode:O});if(S){if(Array.isArray(E.colHeaders)){const z=[s.toVisualColumn(W),0];z.length+=S,Array.prototype.splice.apply(E.colHeaders,z)}Q.shiftColumns(s.toVisualColumn(W),S)}break;case"remove_row":const K=z=>{let J=0;A(z,v=>{let[C,R]=v;const N=Qt(C)?s.countRows()-1:Math.max(C-J,0);if(Number.isInteger(C)&&(C=Math.max(C-J,0)),!a.removeRow(C,R,B))return;if(Q.isSelected()){const{row:F}=s.getSelectedRangeLast().highlight;F>=C&&F<=C+R-1&&c.closeEditor(!0)}const D=s.countRows();D===0?Q.deselect():B==="ContextMenu.removeRow"?Q.refresh():Q.shiftRows(C,-R);const I=E.fixedRowsTop;I>=N+1&&(E.fixedRowsTop-=Math.min(R,I-N));const x=E.fixedRowsBottom;x&&N>=D-x&&(E.fixedRowsBottom-=Math.min(R,x)),J+=R})};Array.isArray(w)?K(ee(w)):K([[w,k]]);break;case"remove_col":const G=z=>{let J=0;A(z,v=>{let[C,R]=v;const N=Qt(C)?s.countCols()-1:Math.max(C-J,0);let _=s.toPhysicalColumn(N);if(Number.isInteger(C)&&(C=Math.max(C-J,0)),!a.removeCol(C,R,B))return;if(Q.isSelected()){const{col:F}=s.getSelectedRangeLast().highlight;F>=C&&F<=C+R-1&&c.closeEditor(!0)}s.countCols()===0?Q.deselect():B==="ContextMenu.removeColumn"?Q.refresh():Q.shiftColumns(C,-R);const x=E.fixedColumnsStart;x>=N+1&&(E.fixedColumnsStart-=Math.min(R,x-N)),Array.isArray(E.colHeaders)&&(typeof _>"u"&&(_=-1),E.colHeaders.splice(_,R)),J+=R})};Array.isArray(w)?G(ee(w)):G([[w,k]]);break;default:throw new Error(`There is no such action "${g}"`)}s.view.render(),X||u.adjustRowsAndCols()},adjustRowsAndCols(){const g=E.minRows,w=E.minSpareRows,b=E.minCols,L=E.minSpareCols;if(g){const k=s.countRows();k<g&&a.createRow(k,g-k,{source:"auto"})}if(w){const k=s.countEmptyRows(!0);if(k<w){const B=w-k,X=Math.min(B,E.maxRows-s.countSourceRows());a.createRow(s.countRows(),X,{source:"auto"})}}{let k;(b||L)&&(k=s.countEmptyCols(!0));let B=s.countCols();if(b&&!E.columns&&B<b){const X=b-B;k+=X,a.createCol(B,X,{source:"auto"})}if(L&&!E.columns&&s.dataType==="array"&&k<L){B=s.countCols();const X=L-k,ee=Math.min(X,E.maxCols-B);a.createCol(B,ee,{source:"auto"})}}s.view&&s.view.adjustElementsSize()},populateFromArray(g,w,b,L,k){let B,X,ee,ge;const me=[],se={},ke=[],O=g.row,S=g.col;if(X=w.length,X===0)return!1;let W=0,K=0;switch(Ye(b)&&(W=b.col-S+1,K=b.row-O+1),k){case"shift_down":const G=yd(w),z=G.length,J=Math.max(z,W),v=s.getData().slice(O),C=yd(v).slice(S,S+J);for(ee=0;ee<J;ee+=1)if(ee<z){for(B=0,X=G[ee].length;B<K-X;B+=1)G[ee].push(G[ee][B%X]);ee<C.length?ke.push(G[ee].concat(C[ee])):ke.push(G[ee].concat(new Array(v.length).fill(null)))}else ke.push(G[ee%z].concat(C[ee]));s.populateFromArray(O,S,yd(ke));break;case"shift_right":const R=w.length,N=Math.max(R,K),_=s.getData().slice(O).map(he=>he.slice(S));for(B=0;B<N;B+=1)if(B<R){for(ee=0,ge=w[B].length;ee<W-ge;ee+=1)w[B].push(w[B][ee%ge]);if(B<_.length)for(let he=0;he<_[B].length;he+=1)w[B].push(_[B][he]);else w[B].push(...new Array(_[0].length).fill(null))}else w.push(w[B%X].slice(0,N).concat(_[B]));s.populateFromArray(O,S,w);break;case"overwrite":default:se.row=g.row,se.col=g.col;let D=0,I=0,x=!0,F;const $=function(Ce){let $e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Qe=w[Ce%w.length];return $e!==null?Qe[$e%Qe.length]:Qe},j=w.length,re=b?b.row-g.row+1:0;for(b?X=re:X=Math.max(j,re),B=0;B<X&&!(b&&se.row>b.row&&re>j||!E.allowInsertRow&&se.row>s.countRows()-1||se.row>=E.maxRows);B++){const he=B-D,Ce=$(he).length,$e=b?b.col-g.col+1:0;if(b?ge=$e:ge=Math.max(Ce,$e),se.col=g.col,F=s.getCellMeta(se.row,se.col),(L==="CopyPaste.paste"||L==="Autofill.fill")&&F.skipRowOnPaste){D+=1,se.row+=1,X+=1;continue}for(I=0,ee=0;ee<ge&&!(b&&se.col>b.col&&$e>Ce||!E.allowInsertColumn&&se.col>s.countCols()-1||se.col>=E.maxCols);ee++){if(F=s.getCellMeta(se.row,se.col),(L==="CopyPaste.paste"||L==="Autofill.fill")&&F.skipColumnOnPaste){I+=1,se.col+=1,ge+=1;continue}if(F.readOnly&&L!=="UndoRedo.undo"){se.col+=1;continue}const Qe=ee-I;let Ne=$(he,Qe),Oe=s.getDataAtCell(se.row,se.col);if(Ne!==null&&typeof Ne=="object")if(Array.isArray(Ne)&&Oe===null&&(Oe=[]),Oe===null||typeof Oe!="object")x=!1;else{const nt=Ic(Array.isArray(Oe)?Oe:Oe[0]||Oe),Yt=Ic(Array.isArray(Ne)?Ne:Ne[0]||Ne);gv(nt,Yt)||Array.isArray(nt)&&Array.isArray(Yt)?Ne=Jn(Ne):x=!1}else Oe!==null&&typeof Oe=="object"&&(x=!1);x&&me.push([se.row,se.col,Ne]),x=!0,se.col+=1}se.row+=1}s.setDataAtCell(me,null,null,L||"populateFromArray");break}}};function Z(g){const w=aL(g);GT(w)?(s.runHooks("beforeLanguageChange",w),T.language=w,s.runHooks("afterLanguageChange",w)):lL(g)}function te(g,w){const b=g==="className"?s.rootElement:s.table;if(f)ie(b,w);else{let L=[],k=[];T[g]&&(L=Array.isArray(T[g])?T[g]:wS(T[g])),w&&(k=Array.isArray(w)?w:wS(w));const B=pS(L,k),X=pS(k,L);B.length&&We(b,B),X.length&&ie(b,X)}T[g]=w}this.init=function(){l.setData(E.data),s.runHooks("beforeInit"),(bo()||j0())&&ie(s.rootElement,"mobile"),this.updateSettings(E,!0),this.view=new XJ(this),c=OS.getInstance(s,E,Q),d=ine(s),h=new Q8(s),cp(this)&&Kte(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&s.rootElement.offsetParent===null&&QN(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof f=="object"&&(s.runHooks("afterChange",f[0],f[1]),f=!1),s.runHooks("afterInit")};function ue(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function ce(g){const w=g.replace(",",".");return isNaN(parseFloat(w))===!1?parseFloat(w):g}function Ee(g,w,b){if(!g.length){b();return}const L=s.getActiveEditor(),k=new ue;let B=!0;k.onQueueEmpty=()=>{L&&B&&L.cancelChanges(),b()};for(let X=g.length-1;X>=0;X--){const[ee,ge,,me]=g[X],se=a.propToCol(ge);let ke;Number.isInteger(se)?ke=s.getCellMeta(ee,se):ke={...Object.getPrototypeOf(E),...E},ke.type==="numeric"&&typeof me=="string"&&OD(me)&&(g[X][3]=ce(me)),s.getCellValidator(ke)&&(k.addValidatorToQueue(),s.validateCell(g[X][3],ke,function(O,S){return function(W){if(typeof W!="boolean")throw new Error("Validation error: result is not boolean");W===!1&&S.allowInvalid===!1&&(B=!1,g.splice(O,1),S.valid=!0),k.removeValidatorFormQueue()}}(X,ke),w))}k.checkIfQueueIsEmpty()}function He(g,w){for(let L=g.length-1;L>=0;L--){let k=!1;if(g[L]===null){g.splice(L,1);continue}if(!((g[L][2]===null||g[L][2]===void 0)&&(g[L][3]===null||g[L][3]===void 0))){if(E.allowInsertRow)for(;g[L][0]>s.countRows()-1;){const{delta:B}=a.createRow(void 0,void 0,{source:w});if(B===0){k=!0;break}}if(s.dataType==="array"&&(!E.columns||E.columns.length===0)&&E.allowInsertColumn)for(;a.propToCol(g[L][1])>s.countCols()-1;){const{delta:B}=a.createCol(void 0,void 0,{source:w});if(B===0){k=!0;break}}k||a.set(g[L][0],g[L][1],g[L][3])}}const b=g.length>0;if(s.forceFullRender=!0,b){u.adjustRowsAndCols(),s.runHooks("beforeChangeRender",g,w),c.closeEditor(),s.view.render(),c.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",g,w||"edit");const L=s.getActiveEditor();L&&Se(L.refreshValue)&&L.refreshValue()}else s.view.render()}this._createCellCoords=function(g,w){return s.view._wt.createCellCoords(g,w)},this._createCellRange=function(g,w,b){return s.view._wt.createCellRange(g,w,b)},this.validateCell=function(g,w,b,L){let k=s.getCellValidator(w);function B(X){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||w.hidden===!0){b(X);return}const ge=w.visualCol,me=w.visualRow,se=s.getCell(me,ge,!0);if(se&&se.nodeName!=="TH"){const ke=s.rowIndexMapper.getRenderableFromVisualIndex(me),O=s.columnIndexMapper.getRenderableFromVisualIndex(ge);s.view._wt.getSetting("cellRenderer",ke,O,se)}b(X)}NN(k)&&(k=function(X){return function(ee,ge){ge(X.test(ee))}}(k)),Pt(k)?(g=s.runHooks("beforeValidate",g,w.visualRow,w.prop,L),s._registerImmediate(()=>{k.call(w,g,X=>{s&&(X=s.runHooks("afterValidate",X,g,w.visualRow,w.prop,L),w.valid=X,B(X),s.runHooks("postAfterValidate",X,g,w.visualRow,w.prop,L))})})):s._registerImmediate(()=>{w.valid=!0,B(w.valid,!1)})};function Le(g,w,b){return Array.isArray(g)?g:[[g,w,b]]}function be(g,w){const b=s.getActiveEditor(),L=s.runHooks("beforeChange",g,w||"edit"),k=g.filter(B=>B!==null);return L===!1||k.length===0?(b&&b.cancelChanges(),[]):k}this.setDataAtCell=function(g,w,b,L){const k=Le(g,w,b),B=[];let X=L,ee,ge,me;for(ee=0,ge=k.length;ee<ge;ee++){if(typeof k[ee]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof k[ee][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");k[ee][1]>=this.countCols()?me=k[ee][1]:me=a.colToProp(k[ee][1]),B.push([k[ee][0],me,l.getAtCell(this.toPhysicalRow(k[ee][0]),k[ee][1]),k[ee][2]])}!X&&typeof g=="object"&&(X=w);const se=be(B,L);s.runHooks("afterSetDataAtCell",se,X),Ee(se,X,()=>{He(se,X)})},this.setDataAtRowProp=function(g,w,b,L){const k=Le(g,w,b),B=[];let X=L,ee,ge;for(ee=0,ge=k.length;ee<ge;ee++)B.push([k[ee][0],k[ee][1],l.getAtCell(this.toPhysicalRow(k[ee][0]),k[ee][1]),k[ee][2]]);!X&&typeof g=="object"&&(X=w);const me=be(B,L);s.runHooks("afterSetDataAtRowProp",me,X),Ee(me,X,()=>{He(me,X)})},this.listen=function(){s&&!s.isListening()&&(wy.forEach(g=>{s!==g&&g.unlisten()}),py=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(py=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return py===s.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(g),s.view.render(),w&&Q.isSelected()&&c.prepareEditor()},this.populateFromArray=function(g,w,b,L,k,B,X){if(!(typeof b=="object"&&typeof b[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const ee=typeof L=="number"?s._createCellCoords(L,k):null;return u.populateFromArray(s._createCellCoords(g,w),b,ee,B,X)},this.spliceCol=function(g,w,b){for(var L=arguments.length,k=new Array(L>3?L-3:0),B=3;B<L;B++)k[B-3]=arguments[B];return a.spliceCol(g,w,b,...k)},this.spliceRow=function(g,w,b){for(var L=arguments.length,k=new Array(L>3?L-3:0),B=3;B<L;B++)k[B-3]=arguments[B];return a.spliceRow(g,w,b,...k)},this.getSelected=function(){if(Q.isSelected())return tt(Q.getSelectedRange(),g=>{let{from:w,to:b}=g;return[w.row,w.col,b.row,b.col]})},this.getSelectedLast=function(){const g=this.getSelected();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.getSelectedRange=function(){if(Q.isSelected())return Array.from(Q.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.emptySelectedCells=function(g){if(!Q.isSelected()||this.countRows()===0||this.countCols()===0)return;const w=[];A(Q.getSelectedRange(),b=>{if(b.isSingleHeader())return;const L=b.getTopStartCorner(),k=b.getBottomEndCorner();_e(L.row,k.row,B=>{_e(L.col,k.col,X=>{this.getCellMeta(B,X).readOnly||w.push([B,X,null])})})}),w.length>0&&this.setDataAtCell(w,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():s.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(g){this.suspendRender();const w=g();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const b=g();return this.resumeExecution(w),b},this.batch=function(g){this.suspendRender(),this.suspendExecution();const w=g();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!s.view)return;const{width:g,height:w}=s.view.getLastSize(),{width:b,height:L}=s.rootElement.getBoundingClientRect(),k=b!==g||L!==w;s.runHooks("beforeRefreshDimensions",{width:g,height:w},{width:b,height:L},k)!==!1&&((k||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(b,L),s.render()),s.runHooks("afterRefreshDimensions",{width:g,height:w},{width:b,height:L},k))},this.updateData=function(g,w){mP(g,b=>{a=b},b=>{a=b,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),Q.refresh()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:w,metaManager:y,firstRun:f})},this.loadData=function(g,w){mP(g,b=>{a=b},()=>{y.clearCellsCache(),s.initIndexMappers(),u.adjustRowsAndCols(),Q.refresh(),f&&(f=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:w,metaManager:y,firstRun:f})},this.getInitialColumnCount=function(){const g=E.columns;let w=0;if(Array.isArray(g))w=g.length;else if(Pt(g))if(s.dataType==="array"){const b=this.countSourceCols();for(let L=0;L<b;L+=1)g(L)&&(w+=1)}else(s.dataType==="object"||s.dataType==="function")&&(w=a.colToPropCache.length);else if(Se(E.dataSchema)){const b=a.getSchema();w=Array.isArray(b)?b.length:mv(b)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,w,b,L){return xt(g)?a.getAll():a.getRange(s._createCellCoords(g,w),s._createCellCoords(b,L),a.DESTINATION_RENDERER)},this.getCopyableText=function(g,w,b,L){return a.getCopyableText(s._createCellCoords(g,w),s._createCellCoords(b,L))},this.getCopyableData=function(g,w){return a.getCopyable(g,a.colToProp(w))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const b=(f?s.loadData:s.updateData).bind(this);let L=!1,k,B;if(Se(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Se(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Se(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(k in g)k==="data"||(k==="language"?Z(g.language):k==="className"?te("className",g.className):k==="tableClassName"&&s.table?(te("tableClassName",g.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):ye.getSingleton().isRegistered(k)||ye.getSingleton().isDeprecated(k)?(Pt(g[k])||Array.isArray(g[k]))&&(g[k].initialHook=!0,s.addHook(k,g[k])):!w&&Ut(g,k)&&(T[k]=g[k]));g.data===void 0&&E.data===void 0?b(null,"updateSettings"):g.data!==void 0?b(g.data,"updateSettings"):g.columns!==void 0&&(a.createMap(),s.initIndexMappers());const X=s.countCols(),ee=E.columns;if(ee&&Pt(ee)&&(L=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&y.clearCache(),X>0)for(k=0,B=0;k<X;k++){if(ee){const se=L?ee(k):ee[B];se&&y.updateColumnMeta(B,se)}B+=1}Se(g.cell)&&ze(g.cell,se=>{s.setCellMetaObject(se.row,se.col,se)}),s.runHooks("afterCellMetaReset");let ge=s.rootElement.style.height;ge!==""&&(ge=parseInt(s.rootElement.style.height,10));let me=g.height;if(Pt(me)&&(me=me()),w&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),me===null){const se=s.rootElement.getAttribute("data-initialstyle");se&&(se.indexOf("height")>-1||se.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",se):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else me!==void 0&&(s.rootElement.style.height=isNaN(me)?`${me}`:`${me}px`,s.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let se=g.width;Pt(se)&&(se=se()),s.rootElement.style.width=isNaN(se)?`${se}`:`${se}px`}w||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",g)),u.adjustRowsAndCols(),s.view&&!f&&(s.forceFullRender=!0,s.view.render(),s.view._wt.wtOverlays.adjustElementsSize()),!w&&s.view&&(ge===""||me===""||me===void 0)&&ge!==me&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=s.getSelectedLast();if(E.getValue){if(Pt(E.getValue))return E.getValue.call(s);if(g)return s.getData()[g[0][0]][E.getValue]}else if(g)return s.getDataAtCell(g[0],g[1])},this.getSettings=function(){return E},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,w,b,L,k){u.alter(g,w,b,L,k)},this.getCell=function(g,w){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,L=w,k=g;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;L=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;k=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return k===null||L===null||k===void 0||L===void 0?null:s.view.getCellAtCoords(s._createCellCoords(k,L),b)},this.getCoords=function(g){const w=this.view._wt.wtTable.getCoords(g);if(w===null)return null;const{row:b,col:L}=w;let k=b,B=L;return b>=0&&(k=this.rowIndexMapper.getVisualFromRenderableIndex(b)),L>=0&&(B=this.columnIndexMapper.getVisualFromRenderableIndex(L)),s._createCellCoords(k,B)},this.colToProp=function(g){return a.colToProp(g)},this.propToCol=function(g){return a.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,w){return a.get(g,a.colToProp(w))},this.getDataAtRowProp=function(g,w){return a.get(g,w)},this.getDataAtCol=function(g){const w=[],b=a.getRange(s._createCellCoords(0,g),s._createCellCoords(E.data.length-1,g),a.DESTINATION_RENDERER);for(let L=0;L<b.length;L+=1)for(let k=0;k<b[L].length;k+=1)w.push(b[L][k]);return w},this.getDataAtProp=function(g){const w=[],b=a.getRange(s._createCellCoords(0,a.propToCol(g)),s._createCellCoords(E.data.length-1,a.propToCol(g)),a.DESTINATION_RENDERER);for(let L=0;L<b.length;L+=1)for(let k=0;k<b[L].length;k+=1)w.push(b[L][k]);return w},this.getSourceData=function(g,w,b,L){let k;return g===void 0?k=l.getData():k=l.getByRange(s._createCellCoords(g,w),s._createCellCoords(b,L)),k},this.getSourceDataArray=function(g,w,b,L){let k;return g===void 0?k=l.getData(!0):k=l.getByRange(s._createCellCoords(g,w),s._createCellCoords(b,L),!0),k},this.getSourceDataAtCol=function(g){return l.getAtColumn(g)},this.setSourceDataAtCell=function(g,w,b,L){const k=Le(g,w,b),B=this.hasHook("afterSetSourceDataAtCell"),X=[];B&&A(k,ge=>{let[me,se,ke]=ge;X.push([me,se,l.getAtCell(me,se),ke])}),A(k,ge=>{let[me,se,ke]=ge;l.setAtCell(me,se,ke)}),B&&this.runHooks("afterSetSourceDataAtCell",X,L),this.render();const ee=s.getActiveEditor();ee&&Se(ee.refreshValue)&&ee.refreshValue()},this.getSourceDataAtRow=function(g){return l.getAtRow(g)},this.getSourceDataAtCell=function(g,w){return l.getAtCell(g,w)},this.getDataAtRow=function(g){return a.getRange(s._createCellCoords(g,0),s._createCellCoords(g,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,w,b,L){const k=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,w,b,L],[B,X]=k;let[,,ee,ge]=k,me=null,se=null;ee===void 0&&(ee=B),ge===void 0&&(ge=X);let ke="mixed";return _e(Math.max(Math.min(B,ee),0),Math.max(B,ee),O=>{let S=!0;return _e(Math.max(Math.min(X,ge),0),Math.max(X,ge),W=>(se=this.getCellMeta(O,W).type,me?S=me===se:me=se,S)),ke=S?se:"mixed",S}),ke},this.removeCellMeta=function(g,w,b){const[L,k]=[this.toPhysicalRow(g),this.toPhysicalColumn(w)];let B=y.getCellMetaKeyValue(L,k,b);s.runHooks("beforeRemoveCellMeta",g,w,b,B)!==!1&&(y.removeCellMeta(L,k,b),s.runHooks("afterRemoveCellMeta",g,w,b,B)),B=null},this.spliceCellsMeta=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var b=arguments.length,L=new Array(b>2?b-2:0),k=2;k<b;k++)L[k-2]=arguments[k];if(L.length>0&&!Array.isArray(L[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&y.removeRow(this.toPhysicalRow(g),w),L.length>0&&A(L.reverse(),B=>{y.createRow(this.toPhysicalRow(g)),A(B,(X,ee)=>this.setCellMetaObject(g,ee,X))}),s.render()},this.setCellMetaObject=function(g,w,b){typeof b=="object"&&ze(b,(L,k)=>{this.setCellMeta(g,w,k,L)})},this.setCellMeta=function(g,w,b,L){if(s.runHooks("beforeSetCellMeta",g,w,b,L)===!1)return;let B=g,X=w;g<this.countRows()&&(B=this.toPhysicalRow(g)),w<this.countCols()&&(X=this.toPhysicalColumn(w)),y.setCellMeta(B,X,b,L),s.runHooks("afterSetCellMeta",g,w,b,L)},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(g,w){let b=this.toPhysicalRow(g),L=this.toPhysicalColumn(w);return b===null&&(b=g),L===null&&(L=w),y.getCellMeta(b,L,{visualRow:g,visualColumn:w})},this.getColumnMeta=function(g){return y.getColumnMeta(this.toPhysicalColumn(g))},this.getCellMetaAtRow=function(g){return y.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||E.columns)},this.getCellRenderer=function(g,w){const b=typeof g=="number"?s.getCellMeta(g,w).renderer:g.renderer;return typeof b=="string"?Kp(b):xt(b)?Kp("text"):b},this.getCellEditor=function(g,w){const b=typeof g=="number"?s.getCellMeta(g,w).editor:g.editor;return typeof b=="string"?zp(b):xt(b)?zp("text"):b},this.getCellValidator=function(g,w){const b=typeof g=="number"?s.getCellMeta(g,w).validator:g.validator;return typeof b=="string"?Q0(b):b},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,w){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,g)},this.validateColumns=function(g,w){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,g)},this._validateCells=function(g,w,b){const L=new ue;g&&(L.onQueueEmpty=g);let k=s.countRows()-1;for(;k>=0;){if(w!==void 0&&w.indexOf(k)===-1){k-=1;continue}let B=s.countCols()-1;for(;B>=0;){if(b!==void 0&&b.indexOf(B)===-1){B-=1;continue}L.addValidatorToQueue(),s.validateCell(s.getDataAtCell(k,B),s.getCellMeta(k,B),X=>{if(typeof X!="boolean")throw new Error("Validation error: result is not boolean");X===!1&&(L.valid=!1),L.removeValidatorFormQueue()},"validateCells"),B-=1}k-=1}L.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let w=E.rowHeaders,b=g;return b!==void 0&&(b=s.runHooks("modifyRowHeader",b)),b===void 0?(w=[],_e(s.countRows()-1,L=>{w.push(s.getRowHeader(L))})):Array.isArray(w)&&w[b]!==void 0?w=w[b]:Pt(w)?w=w(b):w&&typeof w!="string"&&typeof w!="number"&&(w=b+1),w},this.hasRowHeaders=function(){return!!E.rowHeaders},this.hasColHeaders=function(){if(E.colHeaders!==void 0&&E.colHeaders!==null)return!!E.colHeaders;for(let g=0,w=s.countCols();g<w;g++)if(s.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const b=s.runHooks("modifyColHeader",g);if(b===void 0){const ee=[],ge=s.countCols();for(let me=0;me<ge;me++)ee.push(s.getColHeader(me));return ee}let L=E.colHeaders;const k=function(ee){const ge=[],me=s.countCols();let se=0;for(;se<me;se++)Pt(E.columns)&&E.columns(se)&&ge.push(se);return ge[ee]},B=s.toPhysicalColumn(b),X=k(B);return E.colHeaders===!1?L=null:E.columns&&Pt(E.columns)&&E.columns(X)&&E.columns(X).title?L=E.columns(X).title:E.columns&&E.columns[B]&&E.columns[B].title?L=E.columns[B].title:Array.isArray(E.colHeaders)&&E.colHeaders[B]!==void 0?L=E.colHeaders[B]:Pt(E.colHeaders)?L=E.colHeaders(B):E.colHeaders&&typeof E.colHeaders!="string"&&typeof E.colHeaders!="number"&&(L=Sv(b)),L=s.runHooks("modifyColumnHeaderValue",L,g,w),L},this._getColWidthFromSettings=function(g){let w;if(g>=0&&(w=s.getCellMeta(0,g).width),(w===void 0||w===E.width)&&(w=E.colWidths),w!=null){switch(typeof w){case"object":w=w[g];break;case"function":w=w(g);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getColWidth=function(g){let w=s._getColWidthFromSettings(g);return w=s.runHooks("modifyColWidth",w,g),w===void 0&&(w=Cv),w},this._getRowHeightFromSettings=function(g){let w=E.rowHeights;if(w!=null){switch(typeof w){case"object":w=w[g];break;case"function":w=w(g);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getRowHeight=function(g){let w=s._getRowHeightFromSettings(g);return w=s.runHooks("modifyRowHeight",w,g),w},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const g=E.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,w)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return Gp(s.countRows()-1,b=>{if(s.isEmptyRow(b))w+=1;else if(g===!0)return!1}),w},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return Gp(s.countCols()-1,b=>{if(s.isEmptyCol(b))w+=1;else if(g===!0)return!1}),w},this.isEmptyRow=function(g){return E.isEmptyRow.call(s,g)},this.isEmptyCol=function(g){return E.isEmptyCol.call(s,g)},this.selectCell=function(g,w,b,L){let k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,B=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return xt(g)||xt(w)?!1:this.selectCells([[g,w,b,L]],k,B)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&d.suspend();const L=Q.selectCells(g);return L&&b&&s.listen(),d.resume(),L},this.selectColumns=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,b=arguments.length>2?arguments[2]:void 0;return Q.selectColumns(g,w,b)},this.selectRows=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,b=arguments.length>2?arguments[2]:void 0;return Q.selectRows(g,w,b)},this.deselectCell=function(){Q.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,b=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),Q.selectAll(g,w,b)};const le=(g,w)=>g.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(g){var w;if(typeof g=="number"){var b;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(b=arguments[4])!==null&&b!==void 0?b:!0}}const{row:L,col:k,verticalSnap:B,horizontalSnap:X,considerHiddenIndexes:ee}=(w=g)!==null&&w!==void 0?w:{};let ge,me,se,ke;B!==void 0&&(ge=B==="top",me=!ge),X!==void 0&&(se=X==="start",ke=!se);let O=L,S=k;if(ee===void 0||ee){const G=Number.isInteger(L)&&L>=0,z=Number.isInteger(k)&&k>=0,J=G?le(this.rowIndexMapper,L):void 0,v=z?le(this.columnIndexMapper,k):void 0;if(J===null||v===null)return!1;O=G?s.rowIndexMapper.getRenderableFromVisualIndex(J):L,S=z?s.columnIndexMapper.getRenderableFromVisualIndex(v):k}const W=Number.isInteger(O),K=Number.isInteger(S);return W&&O>=0&&K&&S>=0?s.view.scrollViewport(s._createCellCoords(O,S),ge,ke,me,se):W&&O>=0&&(K&&S<0||!K)?s.view.scrollViewportVertically(O,ge,me):K&&S>=0&&(W&&O<0||!W)?s.view.scrollViewportHorizontally(S,ke,se):!1},this.scrollToFocusedCell=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",g);const{highlight:w}=this.getSelectedRangeLast();this.scrollViewportTo(w.toObject())?this.view.render():(this.removeHook("afterScroll",g),this._registerImmediate(()=>g()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),y.clearCache(),wy.delete(this.guid),cp(s)){const g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}Br(s.rootElement),o.destroy(),c&&c.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),M.getItems().forEach(g=>{let[,w]=g;w.destroy()}),M.clear(),s.runHooks("afterDestroy")},!0),ye.getSingleton().destroy(s),ze(s,(g,w,b)=>{Pt(g)?b[w]=ve(w):w!=="guid"&&(b[w]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,u=null,Q=null,c=null,s=null};function ve(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(g){const w=Zn(g);return w==="UndoRedo"?this.undoRedo:M.getItem(w)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:M.getId(g)},this.getInstance=function(){return s},this.addHook=function(g,w,b){ye.getSingleton().add(g,w,s,b)},this.hasHook=function(g){return ye.getSingleton().has(g,s)||ye.getSingleton().has(g)},this.addHookOnce=function(g,w,b){ye.getSingleton().once(g,w,s,b)},this.removeHook=function(g,w){ye.getSingleton().remove(g,w,s)},this.runHooks=function(g,w,b,L,k,B,X){return ye.getSingleton().run(s,g,w,b,L,k,B,X)},this.getTranslatedPhrase=function(g,w){return gL(E.language,g,w)},this.toHTML=()=>PS(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",PS(this)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=g;typeof b=="function"&&(b=setTimeout(b,w)),this.timeouts.push(b)},this._clearTimeouts=function(){A(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){A(this.immediates,g=>{clearImmediate(g)})},this._getEditorManager=function(){return c},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const st=une({handleEvent(){return s.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&st.releasePressedKeys()}),this.getShortcutManager=function(){return st},this.getFocusManager=function(){return h},J0().forEach(g=>{const w=Ff(g);M.addItem(g,new w(this))}),zte(s),st.setActiveContextName("grid"),ye.getSingleton().run(s,"construct")}function bP(t,e,n){t.addEventListener(e,n,!1)}function SP(t,e,n){t.removeEventListener(e,n,!1)}function RP(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function cne(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,i=t.createTextNode(""),r=t.createElement("span");let s;function o(){i.textContent=s.value,r.style.position="absolute",r.style.fontSize=RP(s).fontSize,r.style.fontFamily=RP(s).fontFamily,r.style.whiteSpace="pre",n.appendChild(r);const c=r.clientWidth+2;n.removeChild(r);const h=s.style;h.height=`${e.minHeight}px`,e.minWidth>c?h.width=`${e.minWidth}px`:c>e.maxWidth?h.width=`${e.maxWidth}px`:h.width=`${c}px`;const d=s.scrollHeight?s.scrollHeight-1:0;e.minHeight>d?h.height=`${e.minHeight}px`:e.maxHeight<d?(h.height=`${e.maxHeight}px`,h.overflowY="visible"):h.height=`${d}px`}function a(){t.defaultView.setTimeout(o,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=s.clientHeight;else{const h=parseInt(c.minHeight,10);isNaN(h)||(e.minHeight=h)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=s.clientHeight;else{const h=parseInt(c.maxHeight,10);isNaN(h)||(e.maxHeight=h)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=s.clientWidth;else{const h=parseInt(c.minWidth,10);isNaN(h)||(e.minWidth=h)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=s.clientWidth;else{const h=parseInt(c.maxWidth,10);isNaN(h)||(e.maxWidth=h)}r.firstChild||(r.className="autoResize",r.style.display="inline-block",r.appendChild(i))}function u(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=c,l(h),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${e.minHeight}px`,s.style.minWidth=`${e.minWidth}px`,s.style.maxWidth=`${e.maxWidth}px`,s.style.overflowY="hidden"),d&&(bP(s,"input",o),bP(s,"keydown",a)),o()}return{init:u,resize:o,unObserve(){SP(s,"input",o),SP(s,"keydown",a)}}}function EP(t,e){const n=N0(e),i=e.value.split(`
`);let r=n,s=0;for(let o=0;o<i.length;o++){const a=i[o];o!==0&&(s+=i[o-1].length+1);const l=s+a.length;if(t==="home"?r=s:t==="end"&&(r=l),n<=l)break}Df(e,r)}function sl(t,e,n){return(e=hne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hne(t){var e=dne(t,"string");return typeof e=="symbol"?e:e+""}function dne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const fne="ht_editor_visible",em="ht_editor_hidden",TP="textEditor",gne="text";class fu extends Yc{static get EDITOR_TYPE(){return gne}constructor(e){super(e),sl(this,"eventManager",new hr(this)),sl(this,"autoResize",cne(this.hot.rootDocument)),sl(this,"TEXTAREA",void 0),sl(this,"textareaStyle",void 0),sl(this,"TEXTAREA_PARENT",void 0),sl(this,"textareaParentStyle",void 0),sl(this,"layerClass",void 0),this.eventManager=new hr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),BN(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,i,r,s,o){const a=this.state;if(super.prepare(e,n,i,r,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==nn.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===nn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Df(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),xe(this.TEXTAREA,[["data-hot-input",""],Wc(-1)]),this.hot.getSettings().ariaTags&&xe(this.TEXTAREA,[Vo()]),ie(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ie(this.TEXTAREA_PARENT,"handsontableInputHolder"),De(this.TEXTAREA_PARENT,this.layerClass)&&We(this.TEXTAREA_PARENT,this.layerClass),ie(this.TEXTAREA_PARENT,em),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){gD()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",We(this.TEXTAREA_PARENT,this.layerClass),ie(this.TEXTAREA_PARENT,em)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;_e(e.length-1,i=>{const r=e[i];if(De(r,"handsontableEditor"))return n=!0,!1}),De(this.TEXTAREA_PARENT,em)&&We(this.TEXTAREA_PARENT,em),n?(this.layerClass=fne,ie(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ie(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==nn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:i,width:r,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const l=Ho(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=Ho(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),d=r-c,f=o-h,m=s-c,p=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,m),minHeight:Math.min(f,p),maxWidth:m,maxHeight:p},!0)}bindEvents(){B0()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===nn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===nn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>Se(this.hot.getSelected()),group:TP},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;EP(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;EP(a,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(TP)}}const mne="base";function Uf(t,e,n,i,r,s,o){const a=o.ariaTags,l=[],u=[],c=[],h=[];o.className&&ie(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&h.push(cO())):a&&c.push(cO()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&h.push(hO())):(u.push(o.invalidCellClassName),a&&c.push(hO()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),We(e,u),ie(e,l),cu(e,c),xe(e,h)}Uf.RENDERER_TYPE=mne;const pne="text";function jo(t,e,n,i,r,s,o){Uf.apply(this,[t,e,n,i,r,s,o]);let a=s;if(!a&&o.placeholder&&(a=o.placeholder),a=Jt(a),o.trimWhitespace&&(a=a.trim()),o.rendererTemplate){Br(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else Ha(e,a)}jo.RENDERER_TYPE=pne;const wne="text",PL={CELL_TYPE:wne,editor:fu,renderer:jo};Zi(PL);Fe.editors={BaseEditor:Yc};function Fe(t,e){const n=new OL(t,e||{},pE);return n.init(),n}Fe.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new OL(t,e,pE)};Fe.DefaultSettings=bL();Fe.hooks=ye.getSingleton();Fe.CellCoords=ql;Fe.CellRange=Vf;Fe.packageName="handsontable";Fe.buildDate="30/07/2024 11:21:58";Fe.version="14.5.0";Fe.languages={dictionaryKeys:HQ,getLanguageDictionary:fL,getLanguagesDictionaries:$Q,registerLanguageDictionary:dL,getTranslatedPhrase:gL};const MP="handsontableEditor",vne="handsontable";class qT extends fu{static get EDITOR_TYPE(){return vne}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Df(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&un(l,o.handsontable),this.htOptions=l}beginEditing(e,n){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const r=this.htEditor.getValue();r!==void 0&&this.setValue(r)}super.finishEditing(e,n,i)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:MP,relativeToGroup:Ba,position:"before"},r=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||a.flipped&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),gr(o),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedLast()&&o.flipped?a=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),r(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedLast()&&!o.flipped)a=0;else if(o.getSelectedLast()){if(o.flipped)a=o.getSelectedLast()[0]+1;else if(!o.flipped){const u=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(u,l+1)}}return r(a,s)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(MP)}}function Cne(t,e,n){yne(t,e),e.set(t,n)}function yne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tm(t,e,n){return(e=bne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bne(t){var e=Sne(t,"string");return typeof e=="symbol"?e:e+""}function Sne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _P(t,e){return t.get(Rne(t,e))}function Rne(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ene="autocomplete";var vy=new WeakMap;class ZT extends qT{constructor(){super(...arguments),tm(this,"query",null),tm(this,"strippedChoices",[]),tm(this,"rawChoices",[]),Cne(this,vy,this.hot.guid.slice(0,9)),tm(this,"sortByRelevance",function(e,n,i){const r=[],s=[],o=e.length;let a=n.length,l,u,c,h;if(o===0){for(c=0;c<a;c++)s.push(c);return s}for(c=0;c<a;c++){if(u=CS(Jt(n[c])),i)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-o,r.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(r.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=r.length;c<a;c++)s.push(r[c].baseIndex);return s})}static get EDITOR_TYPE(){return Ene}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return Se(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ie(this.htContainer,"autocompleteEditor"),ie(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&xe(this.TEXTAREA,[p9(),h9(),$N("listbox"),b9()])}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o),this.hot.getSettings().ariaTags&&xe(this.TEXTAREA,[lr("false"),S9(`${_P(vy,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=i==null?void 0:i.length,{row:s,col:o}=this;this.showEditableElement(),this.focus();let a=Rn();a===0&&of()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[At(this.TEXTAREA)-2]:void 0,width:e?At(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,h,d,f,m)=>{jo(l,u,c,h,d,f,m);const{filteringCaseSensitive:p,allowHtml:y,locale:E}=this.cellProperties,T=this.query;let M=Jt(f),P,H;M&&!y&&(P=p===!0?M.indexOf(T):M.toLocaleLowerCase(E).indexOf(T.toLocaleLowerCase(E)),P!==-1&&(H=M.substr(P,T.length),M=M.replace(H,`<strong>${H}</strong>`))),n&&xe(u,[d9(),...i?[M9(r)]:[],...i?[_9(i.indexOf(f)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=M},afterSelectionEnd:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);xe(c,[P0()]),xe(this.TEXTAREA,...R9(c.id))}}}),n&&(xe(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...xs()),xe(this.htEditor.rootElement,[kN(),E9("polite"),T9("text"),["id",`${_P(vy,this)}-listbox-${s}-${o}`]]),xe(this.TEXTAREA,...lr("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&xe(this.TEXTAREA,[lr("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=N0(this.TEXTAREA),i=qN(this.TEXTAREA),r=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;r&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(o)?o.length:0;if(s===!1)u&&(a=o[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(r&&u<=h);h++)u?c.push(l[o[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(yd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Df(this.TEXTAREA,n,n===i?void 0:i)}flipDropdownIfNeeded(){const e=Xl(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,i=this.cellProperties.preventOverflow;if(n||!n&&(i||i==="horizontal"))return!1;const r=bn(this.TEXTAREA),s=sn(this.TEXTAREA),o=this.getDropdownHeight(),a=e.scrollTop,l=sn(this.hot.view._wt.wtTable.THEAD),u=bn(e),c=r.top-u.top-l+a,h=e.scrollHeight-c-l-s,d=o>h&&c>h;return d?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(d?c:h,o),d}limitDropdownIfNeeded(e,n){if(n>e){let i=0,r=0,s=0,o=null;do s=this.htEditor.getRowHeight(r)||this.htEditor.view._wt.getSetting("defaultRowHeight"),i+=s,r+=1;while(i<e);o=i-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(i-s)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const e=this.htEditor.getColWidth(0)+Rn(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,i=tt(e,s=>Jt(s));return tt(i,s=>n?s:CS(s))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),i={row:n?n.from.row:-1};let r=!1;return e===Me.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(r=!0),e===Me.ARROW_UP&&i.row>-1&&(r=!0),r}onBeforeKeyDown(e){if(mD(e.keyCode)||e.keyCode===Me.BACKSPACE||e.keyCode===Me.DELETE||e.keyCode===Me.INSERT){let n=10;if(e.keyCode===Me.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const Tne="checkbox";class IL extends Yc{static get EDITOR_TYPE(){return Tne}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');De(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const ba=()=>window,nr=()=>window.document,VS=(t,e)=>window.setTimeout(t,e),ms=function(t,e,n,i){t.addEventListener(e,n,!!i)},Qs=function(t,e,n,i){t.removeEventListener(e,n,!!i)},Mne=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Pi=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},Cy=function(t,e){Pi(t,e)||(t.className=t.className===""?e:t.className+" "+e)},yy=function(t,e){t.className=Mne((" "+t.className+" ").replace(" "+e+" "," "))},JT=function(t){return/Array/.test(Object.prototype.toString.call(t))},Ni=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},_ne=function(t){let e=t.getDay();return e===0||e===6},One=function(t){return t%4===0&&t%100!==0||t%400===0},OP=function(t,e){return[31,One(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},nm=function(t){Ni(t)&&t.setHours(0,0,0,0)},im=function(t,e){return t.getTime()===e.getTime()},Qp=function(t,e,n){let i,r;for(i in e)r=t[i]!==void 0,r&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?Ni(e[i])?n&&(t[i]=new Date(e[i].getTime())):JT(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=Qp({},e[i],n):(n||!r)&&(t[i]=e[i]);return t},PP=function(t,e,n){let i=nr().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=Qp(i,n),t.dispatchEvent(i)},IP=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},ns={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},xP=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},Pne=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},Ine=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),i=t.getDay(),r=e,s=r-1,o=7,a=function(d){return(d+o-1)%o};t.setDate(n+s-a(i));let l=new Date(t.getFullYear(),0,r),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-s+a(l.getDay()))/o)},xne=function(t,e,n,i,r){let s=new Date(i,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():Ine(s,r))+"</td>"},Ane=function(t,e,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},Hne=function(t){return"<tbody>"+t.join("")+"</tbody>"},Nne=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+xP(t,e)+'">'+xP(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},Dne=function(t,e,n,i,r,s){let o,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',f,m,p=!0,y=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(n===r?o-e:12+o-e)+'"'+(o===i?' selected="selected"':"")+(c&&o<u.minMonth||h&&o>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[o]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",JT(u.yearRange)?(o=u.yearRange[0],a=u.yearRange[1]+1):(o=n-u.yearRange,a=1+n+u.yearRange),l=[];o<a&&o<=u.maxYear;o++)o>=u.minYear&&l.push('<option value="'+o+'"'+(o===n?' selected="selected"':"")+">"+o+"</option>");return m='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,c&&(i===0||u.minMonth>=i)&&(p=!1),h&&(i===11||u.maxMonth<=i)&&(y=!1),e===0&&(d+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},Lne=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Nne(t)+Hne(e)+"</table>"};function WS(t){let e=this,n=e.config(t);e._onMouseDown=function(r){if(!e._v)return;r=r||ba().event;let s=r.target||r.srcElement;if(s)if(Pi(s,"is-disabled")||(Pi(s,"pika-button")&&!Pi(s,"is-empty")&&!Pi(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),n.bound&&VS(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Pi(s,"pika-prev")?e.prevMonth():Pi(s,"pika-next")&&e.nextMonth()),Pi(s,"pika-select"))e._c=!0;else if(r.preventDefault)r.preventDefault();else return r.returnValue=!1,!1},e._onChange=function(r){r=r||ba().event;let s=r.target||r.srcElement;s&&(Pi(s,"pika-select-month")?e.gotoMonth(s.value):Pi(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(r){if(r=r||ba().event,e.isVisible())switch(r.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let r=this.moment(n.field.value,n.format,n.formatStrict);return r&&r.isValid()?r.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(r){let s;r.firedBy!==e&&(s=e._parseFieldValue(),Ni(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let r=nr().activeElement;do if(Pi(r,"pika-single"))return;while(r=r.parentNode);e._c||(e._b=VS(function(){e.hide()},50)),e._c=!1},e._onClick=function(r){r=r||ba().event;let s=r.target||r.srcElement,o=s;if(s){!hasEventListeners&&Pi(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),ms(s,"change",e._onChange)));do if(Pi(o,"pika-single")||o===n.trigger)return;while(o=o.parentNode);e._v&&s!==n.trigger&&o!==n.trigger&&e.hide()}},e.el=nr().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),ms(e.el,"mousedown",e._onMouseDown,!0),ms(e.el,"touchend",e._onMouseDown,!0),ms(e.el,"change",e._onChange),n.keyboardInput&&ms(nr(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?nr().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),ms(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let i=n.defaultDate;Ni(i)?n.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",ms(n.trigger,"click",e._onInputClick),ms(n.trigger,"focus",e._onInputFocus),ms(n.trigger,"blur",e._onInputBlur)):this.show()}WS.prototype={config:function(t){this._o||(this._o=Qp({},ns,!0));let e=Qp(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Ni(e.minDate)||(e.minDate=!1),Ni(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),JT(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||ns.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Ni(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Ni(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",PP(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Ni(t))return;let n=this._o.minDate,i=this._o.maxDate;Ni(n)&&t<n?t=n:Ni(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),nm(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),PP(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Ni(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=r<n.getTime()||i.getTime()<r}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,r;t==="add"?r=new Date(n.valueOf()+i):t==="subtract"&&(r=new Date(n.valueOf()-i)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=IP(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=IP({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(nm(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=ns.minDate,this._o.minYear=ns.minYear,this._o.minMonth=ns.minMonth,this._o.startRange=ns.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(nm(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=ns.maxDate,this._o.maxYear=ns.maxYear,this._o.maxMonth=ns.maxMonth,this._o.endRange=ns.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,i=e.maxYear,r=e.minMonth,s=e.maxMonth,o="",a;this._y<=n&&(this._y=n,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+Dne(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&VS(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,i,r,s,o,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,i=ba().innerWidth||nr().documentElement.clientWidth,r=ba().innerHeight||nr().documentElement.clientHeight,s=nr().body.scrollTop||nr().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),o=l.left+ba().pageXOffset,a=l.bottom+ba().pageYOffset,(this._o.reposition&&o+e>i||this._o.position.indexOf("right")>-1&&o-e+t.offsetWidth>0)&&(o=o-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>r+s||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",Cy(this.el,u?"left-aligned":"right-aligned"),Cy(this.el,c?"bottom-aligned":"top-aligned"),yy(this.el,u?"right-aligned":"left-aligned"),yy(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let i=this._o,r=new Date,s=OP(t,e),o=new Date(t,e,1).getDay(),a=[],l=[];nm(r),i.firstDay>0&&(o-=i.firstDay,o<0&&(o+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=OP(h,u),m=s+o,p=m;for(;p>7;)p-=7;m+=7-p;let y=!1;for(let E=0,T=0;E<m;E++){let M=new Date(t,e,1+(E-o)),P=Ni(this._d)?im(M,this._d):!1,H=im(M,r),U=i.events.indexOf(M.toDateString())!==-1,Y=E<o||E>=s+o,Q=1+(E-o),q=e,Z=t,te=i.startRange&&im(i.startRange,M),ue=i.endRange&&im(i.endRange,M),ce=i.startRange&&i.endRange&&i.startRange<M&&M<i.endRange,Ee=i.minDate&&M<i.minDate||i.maxDate&&M>i.maxDate||i.disableWeekends&&_ne(M)||i.disableDayFn&&i.disableDayFn(M);Y&&(E<o?(Q=f+Q,q=u,Z=h):(Q=Q-s,q=c,Z=d));let He={day:Q,month:q,year:Z,hasEvent:U,isSelected:P,isToday:H,isDisabled:Ee,isEmpty:Y,isStartRange:te,isEndRange:ue,isInRange:ce,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&P&&(y=!0),l.push(Pne(He)),++T===7&&(i.showWeekNumber&&l.unshift(xne(this,E-o,e,t,i.firstWeekOfYearMinDays)),a.push(Ane(l,i.isRTL,i.pickWholeWeek,y)),l=[],T=0,y=!1)}return Lne(i,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),yy(this.el,"is-hidden"),this._o.bound&&(ms(nr(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Qs(nr(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Cy(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Qs(this.el,"mousedown",this._onMouseDown,!0),Qs(this.el,"touchend",this._onMouseDown,!0),Qs(this.el,"change",this._onChange),t.keyboardInput&&Qs(nr(),"keydown",this._onKeyChange),t.field&&(Qs(t.field,"change",this._onInputChange),t.bound&&(Qs(t.trigger,"click",this._onInputClick),Qs(t.trigger,"focus",this._onInputFocus),Qs(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function by(t,e,n){return(e=kne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kne(t){var e=$ne(t,"string");return typeof e=="symbol"?e:e+""}function $ne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xL="date",AP="dateEditor";class AL extends fu{constructor(){super(...arguments),by(this,"defaultDateFormat","DD/MM/YYYY"),by(this,"parentDestroyed",!1),by(this,"$datePicker",null)}static get EDITOR_TYPE(){return xL}init(){if(typeof ne!="function")throw new Error("You need to include moment.js to your project.");if(typeof WS!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ie(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{De(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:AP})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const r=this.hot._getEditorManager();r.closeEditor(),this.hot.view.render(),r.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(AP),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),r=e?U0(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new WS(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(ne),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,ne(s,n,!0).isValid()&&this.$datePicker.setMoment(ne(s,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,ne(s,n,!0).isValid()&&this.$datePicker.setMoment(ne(s,n),!0),!r&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&$f(n,this.cellProperties.datePickerConfig);const i=n.onSelect,r=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=s=>{let o=s;isNaN(o.getTime())||(o=ne(o).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(o),i&&i()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),r&&r()},n}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==nn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(n=s.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),u=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),c=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+sn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-At(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}const Fne="dropdown";class QT extends ZT{static get EDITOR_TYPE(){return Fne}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}ye.getSingleton().add("beforeValidate",function(t,e,n){const i=this.propToCol(n);if(Number.isInteger(i)){const r=this.getCellMeta(e,i);r.editor===QT&&r.strict===void 0&&(r.filter=!1,r.strict=!0)}});const Vne="numeric";class HL extends fu{static get EDITOR_TYPE(){return Vne}}const Wne="password";class NL extends fu{static get EDITOR_TYPE(){return Wne}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&xe(this.TEXTAREA,[Vo()]),Br(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Sy="ht_editor_visible",HP="selectEditor",Bne="select";class DL extends Yc{static get EDITOR_TYPE(){return Bne}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",ie(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",De(this.select,Sy)&&We(this.select,Sy),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Br(this.select),ze(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,hu(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)n[e[i]]=e[i];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==nn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:i,height:r}=this.getEditedCellRect(),s=this.select.style;s.height=`${r}px`,s.width=`${i}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${n}px`,s.margin="0px",ie(this.select,Sy)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={group:HP};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(HP)}}const jne="time";class LL extends fu{static get EDITOR_TYPE(){return jne}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o),this.TEXTAREA.dir="ltr"}}function Une(){yi(Yc),yi(ZT),yi(IL),yi(AL),yi(QT),yi(qT),yi(HL),yi(NL),yi(DL),yi(fu),yi(LL)}const Yne="html";function eM(t,e,n,i,r,s,o){Uf.apply(this,[t,e,n,i,r,s,o]),hu(e,s??"",!1)}eM.RENDERER_TYPE=Yne;const zne="autocomplete";function zc(t,e,n,i,r,s,o){const{rootDocument:a}=t,l=o.allowHtml?eM:jo,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Vo()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,i,r,s,o]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),ie(e,"htAutocomplete"),!t.acArrowListener){const h=new hr(t);t.acArrowListener=function(d){De(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,i),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}zc.RENDERER_TYPE=zne;const Gne="dropdown";function tM(t,e,n,i,r,s,o){zc.apply(this,[t,e,n,i,r,s,o])}tM.RENDERER_TYPE=Gne;const NP=new WeakMap,DP=new WeakMap,Kne="htBadValue",Ac="data-row",Hc="data-col",Xne="checkboxRenderer",kL="checkbox";ye.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:i,type:r,row:s,column:o,prop:a}=e;if(r===kL){if(i){const{value:l,property:u}=i;let c=n;if(l)c=typeof l=="function"?l(s,o,a,n):l;else if(u){const h=this.getDataAtRowProp(s,u);c=h!==null?h:n}t=c}return t}});function nM(t,e,n,i,r,s,o){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Uf.apply(this,[t,e,n,i,r,s,o]),qne(t);let u=Zne(a);const c=o.label;let h=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),Br(e),s===o.checkedTemplate||Jt(s).toLocaleLowerCase(o.locale)===Jt(o.checkedTemplate).toLocaleLowerCase(o.locale)?u.checked=!0:s===o.uncheckedTemplate||Jt(s).toLocaleLowerCase(o.locale)===Jt(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?u.checked=!1:Qt(s)?ie(u,"noValue"):(u.style.display="none",ie(u,Kne),h=!0),xe(u,[[Ac,n],[Hc,i]]),l&&xe(u,[_0(u.checked?t.getTranslatedPhrase(YT):t.getTranslatedPhrase(zT)),y9(u.checked),f9()]),!h&&c){let p="";if(c.value)p=typeof c.value=="function"?c.value.call(this,n,i,r,s):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);p=E!==null?E:""}const y=Jne(a,p,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),NP.has(t)||(NP.set(t,!0),d());function d(){const y=t.getShortcutManager().getContext("grid"),E={group:Xne,relativeToGroup:Ba,position:"before"};y.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var T;return(T=t.getSelectedRangeLast())===null||T===void 0?void 0:T.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{const T=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(T==null?void 0:T.isSingle())&&T.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var T;return(T=t.getSelectedRangeLast())===null||T===void 0?void 0:T.highlight.isCell()}}],E)}function f(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange(),E=[];let T=[],M=0;if(y){for(let P=0;P<y.length;P++){const{row:H,col:U}=y[P].getTopStartCorner(),{row:Y,col:Q}=y[P].getBottomEndCorner();for(let q=H;q<=Y;q+=1)for(let Z=U;Z<=Q;Z+=1){const te=t.getCellMeta(q,Z),ue={checkedTemplate:te.checkedTemplate,uncheckedTemplate:te.uncheckedTemplate};if(te.type!=="checkbox")return;if(te.readOnly===!0)continue;typeof te.checkedTemplate>"u"&&(te.checkedTemplate=!0),typeof te.uncheckedTemplate>"u"&&(te.uncheckedTemplate=!1);const ce=t.getDataAtCell(q,Z);p===!1?[te.checkedTemplate,te.checkedTemplate.toString()].includes(ce)?T.push([q,Z,te.uncheckedTemplate,ue]):[te.uncheckedTemplate,te.uncheckedTemplate.toString(),null,void 0].includes(ce)&&T.push([q,Z,te.checkedTemplate,ue]):T.push([q,Z,te.uncheckedTemplate,ue]),M+=1}E.push(M),M=0}T.every(P=>{let[,,H]=P;return H===T[0][2]})?T=T.map(P=>{let[H,U,Y]=P;return[H,U,Y]}):T=T.map(P=>{let[H,U,,Y]=P;return[H,U,Y.checkedTemplate]}),T.length>0&&E.forEach(P=>{const H=T.splice(0,P);t.setDataAtCell(H)})}}function m(){const p=t.getSelectedRange();if(p){for(let y=0;y<p.length;y++){const E=p[y].getTopStartCorner(),T=p[y].getBottomEndCorner();for(let M=E.row;M<=T.row;M++)for(let P=E.col;P<=T.col;P++){const H=t.getCellMeta(M,P);if(H.type!=="checkbox")return!1;const U=t.getCell(M,P);if(U==null)return!0;if(U.querySelectorAll("input[type=checkbox]").length>0&&!H.readOnly)return!0}}return!1}}}nM.RENDERER_TYPE=kL;function qne(t){let e=DP.get(t);if(!e){const{rootElement:n}=t;e=new hr(t),e.addEventListener(n,"click",i=>eie(i,t)),e.addEventListener(n,"mouseup",i=>Qne(i,t)),e.addEventListener(n,"change",i=>tie(i,t)),DP.set(t,e)}return e}function Zne(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Jne(t,e,n){const i=t.createElement("label");return i.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,i.appendChild(t.createTextNode(e)),i.cloneNode(!0)}function Qne(t,e){const{target:n}=t;iM(n)&&(!n.hasAttribute(Ac)||!n.hasAttribute(Hc)||setTimeout(e.listen,10))}function eie(t,e){const{target:n}=t;if(!iM(n)||!n.hasAttribute(Ac)||!n.hasAttribute(Hc))return;const i=parseInt(n.getAttribute(Ac),10),r=parseInt(n.getAttribute(Hc),10);e.getCellMeta(i,r).readOnly&&t.preventDefault()}function tie(t,e){const{target:n}=t;if(!iM(n)||!n.hasAttribute(Ac)||!n.hasAttribute(Hc))return;const i=parseInt(n.getAttribute(Ac),10),r=parseInt(n.getAttribute(Hc),10),s=e.getCellMeta(i,r);if(!s.readOnly){let o=null;t.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(i,r,o)}}function iM(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const nie="handsontable";function rM(t,e,n,i,r,s,o){zc.apply(this,[t,e,n,i,r,s,o])}rM.RENDERER_TYPE=nie;function rm(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var $L={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(i,r,s){function o(u,c){if(!r[u]){if(!i[u]){var h=typeof rm=="function"&&rm;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=r[u]={exports:{}};i[u][0].call(f.exports,function(m){return o(i[u][1][m]||m)},f,f.exports,n,i,r,s)}return r[u].exports}for(var a=typeof rm=="function"&&rm,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(n,i,r){(function(s){var o,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",d=1e14,f=14,m=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,E=1e9;function T(q){var Z=0|q;return 0<q||q===Z?Z:Z-1}function M(q){for(var Z,te,ue=1,ce=q.length,Ee=q[0]+"";ue<ce;){for(Z=q[ue++]+"",te=f-Z.length;te--;Z="0"+Z);Ee+=Z}for(ce=Ee.length;Ee.charCodeAt(--ce)===48;);return Ee.slice(0,ce+1||1)}function P(q,Z){var te,ue,ce=q.c,Ee=Z.c,He=q.s,Le=Z.s,be=q.e,le=Z.e;if(!He||!Le)return null;if(te=ce&&!ce[0],ue=Ee&&!Ee[0],te||ue)return te?ue?0:-Le:He;if(He!=Le)return He;if(te=He<0,ue=be==le,!ce||!Ee)return ue?0:!ce^te?1:-1;if(!ue)return le<be^te?1:-1;for(Le=(be=ce.length)<(le=Ee.length)?be:le,He=0;He<Le;He++)if(ce[He]!=Ee[He])return ce[He]>Ee[He]^te?1:-1;return be==le?0:le<be^te?1:-1}function H(q,Z,te,ue){if(q<Z||te<q||q!==(q<0?l(q):u(q)))throw Error(c+(ue||"Argument")+(typeof q=="number"?q<Z||te<q?" out of range: ":" not an integer: ":" not a primitive number: ")+String(q))}function U(q){var Z=q.c.length-1;return T(q.e/f)==Z&&q.c[Z]%2!=0}function Y(q,Z){return(1<q.length?q.charAt(0)+"."+q.slice(1):q)+(Z<0?"e":"e+")+Z}function Q(q,Z,te){var ue,ce;if(Z<0){for(ce=te+".";++Z;ce+=te);q=ce+q}else if(++Z>(ue=q.length)){for(ce=te,Z-=ue;--Z;ce+=te);q+=ce}else Z<ue&&(q=q.slice(0,Z)+"."+q.slice(Z));return q}(o=function q(Z){var te,ue,ce,Ee,He,Le,be,le,ve,st,g=S.prototype={constructor:S,toString:null,valueOf:null},w=new S(1),b=20,L=4,k=-7,B=21,X=-1e7,ee=1e7,ge=!1,me=1,se=0,ke={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},O="0123456789abcdefghijklmnopqrstuvwxyz";function S(v,C){var R,N,_,D,I,x,F,$,j=this;if(!(j instanceof S))return new S(v,C);if(C==null){if(v instanceof S)return j.s=v.s,j.e=v.e,void(j.c=(v=v.c)?v.slice():v);if((x=typeof v=="number")&&0*v==0){if(j.s=1/v<0?(v=-v,-1):1,v===~~v){for(D=0,I=v;10<=I;I/=10,D++);return j.e=D,void(j.c=[v])}$=String(v)}else{if($=String(v),!a.test($))return ce(j,$,x);j.s=$.charCodeAt(0)==45?($=$.slice(1),-1):1}-1<(D=$.indexOf("."))&&($=$.replace(".","")),0<(I=$.search(/e/i))?(D<0&&(D=I),D+=+$.slice(I+1),$=$.substring(0,I)):D<0&&(D=$.length)}else{if(H(C,2,O.length,"Base"),$=String(v),C==10)return z(j=new S(v instanceof S?v:$),b+j.e+1,L);if(x=typeof v=="number"){if(0*v!=0)return ce(j,$,x,C);if(j.s=1/v<0?($=$.slice(1),-1):1,S.DEBUG&&15<$.replace(/^0\.0*|\./,"").length)throw Error(h+v);x=!1}else j.s=$.charCodeAt(0)===45?($=$.slice(1),-1):1;for(R=O.slice(0,C),D=I=0,F=$.length;I<F;I++)if(R.indexOf(N=$.charAt(I))<0){if(N=="."){if(D<I){D=F;continue}}else if(!_&&($==$.toUpperCase()&&($=$.toLowerCase())||$==$.toLowerCase()&&($=$.toUpperCase()))){_=!0,I=-1,D=0;continue}return ce(j,String(v),x,C)}-1<(D=($=ue($,C,10,j.s)).indexOf("."))?$=$.replace(".",""):D=$.length}for(I=0;$.charCodeAt(I)===48;I++);for(F=$.length;$.charCodeAt(--F)===48;);if($=$.slice(I,++F)){if(F-=I,x&&S.DEBUG&&15<F&&(m<v||v!==u(v)))throw Error(h+j.s*v);if(ee<(D=D-I-1))j.c=j.e=null;else if(D<X)j.c=[j.e=0];else{if(j.e=D,j.c=[],I=(D+1)%f,D<0&&(I+=f),I<F){for(I&&j.c.push(+$.slice(0,I)),F-=f;I<F;)j.c.push(+$.slice(I,I+=f));$=$.slice(I),I=f-$.length}else I-=F;for(;I--;$+="0");j.c.push(+$)}}else j.c=[j.e=0]}function W(v,C,R,N){var _,D,I,x,F;if(R==null?R=L:H(R,0,8),!v.c)return v.toString();if(_=v.c[0],I=v.e,C==null)F=M(v.c),F=N==1||N==2&&(I<=k||B<=I)?Y(F,I):Q(F,I,"0");else if(D=(v=z(new S(v),C,R)).e,x=(F=M(v.c)).length,N==1||N==2&&(C<=D||D<=k)){for(;x<C;F+="0",x++);F=Y(F,D)}else if(C-=I,F=Q(F,D,"0"),x<D+1){if(0<--C)for(F+=".";C--;F+="0");}else if(0<(C+=D-x))for(D+1==x&&(F+=".");C--;F+="0");return v.s<0&&_?"-"+F:F}function K(v,C){for(var R,N=1,_=new S(v[0]);N<v.length;N++){if(!(R=new S(v[N])).s){_=R;break}C.call(_,R)&&(_=R)}return _}function G(v,C,R){for(var N=1,_=C.length;!C[--_];C.pop());for(_=C[0];10<=_;_/=10,N++);return(R=N+R*f-1)>ee?v.c=v.e=null:v.c=R<X?[v.e=0]:(v.e=R,C),v}function z(v,C,R,N){var _,D,I,x,F,$,j,re=v.c,he=p;if(re){e:{for(_=1,x=re[0];10<=x;x/=10,_++);if((D=C-_)<0)D+=f,I=C,j=(F=re[$=0])/he[_-I-1]%10|0;else if(($=l((D+1)/f))>=re.length){if(!N)break e;for(;re.length<=$;re.push(0));F=j=0,I=(D%=f)-f+(_=1)}else{for(F=x=re[$],_=1;10<=x;x/=10,_++);j=(I=(D%=f)-f+_)<0?0:F/he[_-I-1]%10|0}if(N=N||C<0||re[$+1]!=null||(I<0?F:F%he[_-I-1]),N=R<4?(j||N)&&(R==0||R==(v.s<0?3:2)):5<j||j==5&&(R==4||N||R==6&&(0<D?0<I?F/he[_-I]:0:re[$-1])%10&1||R==(v.s<0?8:7)),C<1||!re[0])return re.length=0,N?(C-=v.e+1,re[0]=he[(f-C%f)%f],v.e=-C||0):re[0]=v.e=0,v;if(D==0?(re.length=$,x=1,$--):(re.length=$+1,x=he[f-D],re[$]=0<I?u(F/he[_-I]%he[I])*x:0),N)for(;;){if($==0){for(D=1,I=re[0];10<=I;I/=10,D++);for(I=re[0]+=x,x=1;10<=I;I/=10,x++);D!=x&&(v.e++,re[0]==d&&(re[0]=1));break}if(re[$]+=x,re[$]!=d)break;re[$--]=0,x=1}for(D=re.length;re[--D]===0;re.pop());}v.e>ee?v.c=v.e=null:v.e<X&&(v.c=[v.e=0])}return v}function J(v){var C,R=v.e;return R===null?v.toString():(C=M(v.c),C=R<=k||B<=R?Y(C,R):Q(C,R,"0"),v.s<0?"-"+C:C)}return S.clone=q,S.ROUND_UP=0,S.ROUND_DOWN=1,S.ROUND_CEIL=2,S.ROUND_FLOOR=3,S.ROUND_HALF_UP=4,S.ROUND_HALF_DOWN=5,S.ROUND_HALF_EVEN=6,S.ROUND_HALF_CEIL=7,S.ROUND_HALF_FLOOR=8,S.EUCLID=9,S.config=S.set=function(v){var C,R;if(v!=null){if(typeof v!="object")throw Error(c+"Object expected: "+v);if(v.hasOwnProperty(C="DECIMAL_PLACES")&&(H(R=v[C],0,E,C),b=R),v.hasOwnProperty(C="ROUNDING_MODE")&&(H(R=v[C],0,8,C),L=R),v.hasOwnProperty(C="EXPONENTIAL_AT")&&((R=v[C])&&R.pop?(H(R[0],-E,0,C),H(R[1],0,E,C),k=R[0],B=R[1]):(H(R,-E,E,C),k=-(B=R<0?-R:R))),v.hasOwnProperty(C="RANGE"))if((R=v[C])&&R.pop)H(R[0],-E,-1,C),H(R[1],1,E,C),X=R[0],ee=R[1];else{if(H(R,-E,E,C),!R)throw Error(c+C+" cannot be zero: "+R);X=-(ee=R<0?-R:R)}if(v.hasOwnProperty(C="CRYPTO")){if((R=v[C])!==!!R)throw Error(c+C+" not true or false: "+R);if(R){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw ge=!R,Error(c+"crypto unavailable");ge=R}else ge=R}if(v.hasOwnProperty(C="MODULO_MODE")&&(H(R=v[C],0,9,C),me=R),v.hasOwnProperty(C="POW_PRECISION")&&(H(R=v[C],0,E,C),se=R),v.hasOwnProperty(C="FORMAT")){if(typeof(R=v[C])!="object")throw Error(c+C+" not an object: "+R);ke=R}if(v.hasOwnProperty(C="ALPHABET")){if(typeof(R=v[C])!="string"||/^.$|[+-.\s]|(.).*\1/.test(R))throw Error(c+C+" invalid: "+R);O=R}}return{DECIMAL_PLACES:b,ROUNDING_MODE:L,EXPONENTIAL_AT:[k,B],RANGE:[X,ee],CRYPTO:ge,MODULO_MODE:me,POW_PRECISION:se,FORMAT:ke,ALPHABET:O}},S.isBigNumber=function(v){return v instanceof S||v&&v._isBigNumber===!0||!1},S.maximum=S.max=function(){return K(arguments,g.lt)},S.minimum=S.min=function(){return K(arguments,g.gt)},S.random=(Ee=9007199254740992,He=Math.random()*Ee&2097151?function(){return u(Math.random()*Ee)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(v){var C,R,N,_,D,I=0,x=[],F=new S(w);if(v==null?v=b:H(v,0,E),_=l(v/f),ge)if(crypto.getRandomValues){for(C=crypto.getRandomValues(new Uint32Array(_*=2));I<_;)9e15<=(D=131072*C[I]+(C[I+1]>>>11))?(R=crypto.getRandomValues(new Uint32Array(2)),C[I]=R[0],C[I+1]=R[1]):(x.push(D%1e14),I+=2);I=_/2}else{if(!crypto.randomBytes)throw ge=!1,Error(c+"crypto unavailable");for(C=crypto.randomBytes(_*=7);I<_;)9e15<=(D=281474976710656*(31&C[I])+1099511627776*C[I+1]+4294967296*C[I+2]+16777216*C[I+3]+(C[I+4]<<16)+(C[I+5]<<8)+C[I+6])?crypto.randomBytes(7).copy(C,I):(x.push(D%1e14),I+=7);I=_/7}if(!ge)for(;I<_;)(D=He())<9e15&&(x[I++]=D%1e14);for(_=x[--I],v%=f,_&&v&&(D=p[f-v],x[I]=u(_/D)*D);x[I]===0;x.pop(),I--);if(I<0)x=[N=0];else{for(N=-1;x[0]===0;x.splice(0,1),N-=f);for(I=1,D=x[0];10<=D;D/=10,I++);I<f&&(N-=f-I)}return F.e=N,F.c=x,F}),S.sum=function(){for(var v=1,C=arguments,R=new S(C[0]);v<C.length;)R=R.plus(C[v++]);return R},ue=function(){var v="0123456789";function C(R,N,_,D){for(var I,x,F=[0],$=0,j=R.length;$<j;){for(x=F.length;x--;F[x]*=N);for(F[0]+=D.indexOf(R.charAt($++)),I=0;I<F.length;I++)F[I]>_-1&&(F[I+1]==null&&(F[I+1]=0),F[I+1]+=F[I]/_|0,F[I]%=_)}return F.reverse()}return function(R,N,_,D,I){var x,F,$,j,re,he,Ce,$e,Qe=R.indexOf("."),Ne=b,Oe=L;for(0<=Qe&&(j=se,se=0,R=R.replace(".",""),he=($e=new S(N)).pow(R.length-Qe),se=j,$e.c=C(Q(M(he.c),he.e,"0"),10,_,v),$e.e=$e.c.length),$=j=(Ce=C(R,N,_,I?(x=O,v):(x=v,O))).length;Ce[--j]==0;Ce.pop());if(!Ce[0])return x.charAt(0);if(Qe<0?--$:(he.c=Ce,he.e=$,he.s=D,Ce=(he=te(he,$e,Ne,Oe,_)).c,re=he.r,$=he.e),Qe=Ce[F=$+Ne+1],j=_/2,re=re||F<0||Ce[F+1]!=null,re=Oe<4?(Qe!=null||re)&&(Oe==0||Oe==(he.s<0?3:2)):j<Qe||Qe==j&&(Oe==4||re||Oe==6&&1&Ce[F-1]||Oe==(he.s<0?8:7)),F<1||!Ce[0])R=re?Q(x.charAt(1),-Ne,x.charAt(0)):x.charAt(0);else{if(Ce.length=F,re)for(--_;++Ce[--F]>_;)Ce[F]=0,F||(++$,Ce=[1].concat(Ce));for(j=Ce.length;!Ce[--j];);for(Qe=0,R="";Qe<=j;R+=x.charAt(Ce[Qe++]));R=Q(R,$,x.charAt(0))}return R}}(),te=function(){function v(N,_,D){var I,x,F,$,j=0,re=N.length,he=_%y,Ce=_/y|0;for(N=N.slice();re--;)j=((x=he*(F=N[re]%y)+(I=Ce*F+($=N[re]/y|0)*he)%y*y+j)/D|0)+(I/y|0)+Ce*$,N[re]=x%D;return j&&(N=[j].concat(N)),N}function C(N,_,D,I){var x,F;if(D!=I)F=I<D?1:-1;else for(x=F=0;x<D;x++)if(N[x]!=_[x]){F=N[x]>_[x]?1:-1;break}return F}function R(N,_,D,I){for(var x=0;D--;)N[D]-=x,x=N[D]<_[D]?1:0,N[D]=x*I+N[D]-_[D];for(;!N[0]&&1<N.length;N.splice(0,1));}return function(N,_,D,I,x){var F,$,j,re,he,Ce,$e,Qe,Ne,Oe,nt,Yt,gu,mr,Xc,ji,Vt,mn=N.s==_.s?1:-1,In=N.c,Dt=_.c;if(!(In&&In[0]&&Dt&&Dt[0]))return new S(N.s&&_.s&&(In?!Dt||In[0]!=Dt[0]:Dt)?In&&In[0]==0||!Dt?0*mn:mn/0:NaN);for(Ne=(Qe=new S(mn)).c=[],mn=D+($=N.e-_.e)+1,x||(x=d,$=T(N.e/f)-T(_.e/f),mn=mn/f|0),j=0;Dt[j]==(In[j]||0);j++);if(Dt[j]>(In[j]||0)&&$--,mn<0)Ne.push(1),re=!0;else{for(mr=In.length,ji=Dt.length,mn+=2,1<(he=u(x/(Dt[j=0]+1)))&&(Dt=v(Dt,he,x),In=v(In,he,x),ji=Dt.length,mr=In.length),gu=ji,nt=(Oe=In.slice(0,ji)).length;nt<ji;Oe[nt++]=0);Vt=Dt.slice(),Vt=[0].concat(Vt),Xc=Dt[0],Dt[1]>=x/2&&Xc++;do{if(he=0,(F=C(Dt,Oe,ji,nt))<0){if(Yt=Oe[0],ji!=nt&&(Yt=Yt*x+(Oe[1]||0)),1<(he=u(Yt/Xc)))for(x<=he&&(he=x-1),$e=(Ce=v(Dt,he,x)).length,nt=Oe.length;C(Ce,Oe,$e,nt)==1;)he--,R(Ce,ji<$e?Vt:Dt,$e,x),$e=Ce.length,F=1;else he==0&&(F=he=1),$e=(Ce=Dt.slice()).length;if($e<nt&&(Ce=[0].concat(Ce)),R(Oe,Ce,nt,x),nt=Oe.length,F==-1)for(;C(Dt,Oe,ji,nt)<1;)he++,R(Oe,ji<nt?Vt:Dt,nt,x),nt=Oe.length}else F===0&&(he++,Oe=[0]);Ne[j++]=he,Oe[0]?Oe[nt++]=In[gu]||0:(Oe=[In[gu]],nt=1)}while((gu++<mr||Oe[0]!=null)&&mn--);re=Oe[0]!=null,Ne[0]||Ne.splice(0,1)}if(x==d){for(j=1,mn=Ne[0];10<=mn;mn/=10,j++);z(Qe,D+(Qe.e=j+$*f-1)+1,I,re)}else Qe.e=$,Qe.r=+re;return Qe}}(),Le=/^(-?)0([xbo])(?=\w[\w.]*$)/i,be=/^([^.]+)\.$/,le=/^\.([^.]+)$/,ve=/^-?(Infinity|NaN)$/,st=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ce=function(v,C,R,N){var _,D=R?C:C.replace(st,"");if(ve.test(D))v.s=isNaN(D)?null:D<0?-1:1,v.c=v.e=null;else{if(!R&&(D=D.replace(Le,function(I,x,F){return _=(F=F.toLowerCase())=="x"?16:F=="b"?2:8,N&&N!=_?I:x}),N&&(_=N,D=D.replace(be,"$1").replace(le,"0.$1")),C!=D))return new S(D,_);if(S.DEBUG)throw Error(c+"Not a"+(N?" base "+N:"")+" number: "+C);v.c=v.e=v.s=null}},g.absoluteValue=g.abs=function(){var v=new S(this);return v.s<0&&(v.s=1),v},g.comparedTo=function(v,C){return P(this,new S(v,C))},g.decimalPlaces=g.dp=function(v,C){var R,N,_;if(v!=null)return H(v,0,E),C==null?C=L:H(C,0,8),z(new S(this),v+this.e+1,C);if(!(R=this.c))return null;if(N=((_=R.length-1)-T(this.e/f))*f,_=R[_])for(;_%10==0;_/=10,N--);return N<0&&(N=0),N},g.dividedBy=g.div=function(v,C){return te(this,new S(v,C),b,L)},g.dividedToIntegerBy=g.idiv=function(v,C){return te(this,new S(v,C),0,1)},g.exponentiatedBy=g.pow=function(v,C){var R,N,_,D,I,x,F,$,j=this;if((v=new S(v)).c&&!v.isInteger())throw Error(c+"Exponent not an integer: "+J(v));if(C!=null&&(C=new S(C)),I=14<v.e,!j.c||!j.c[0]||j.c[0]==1&&!j.e&&j.c.length==1||!v.c||!v.c[0])return $=new S(Math.pow(+J(j),I?2-U(v):+J(v))),C?$.mod(C):$;if(x=v.s<0,C){if(C.c?!C.c[0]:!C.s)return new S(NaN);(N=!x&&j.isInteger()&&C.isInteger())&&(j=j.mod(C))}else{if(9<v.e&&(0<j.e||j.e<-1||(j.e==0?1<j.c[0]||I&&24e7<=j.c[1]:j.c[0]<8e13||I&&j.c[0]<=9999975e7)))return D=j.s<0&&U(v)?-0:0,-1<j.e&&(D=1/D),new S(x?1/D:D);se&&(D=l(se/f+2))}for(F=I?(R=new S(.5),x&&(v.s=1),U(v)):(_=Math.abs(+J(v)))%2,$=new S(w);;){if(F){if(!($=$.times(j)).c)break;D?$.c.length>D&&($.c.length=D):N&&($=$.mod(C))}if(_){if((_=u(_/2))===0)break;F=_%2}else if(z(v=v.times(R),v.e+1,1),14<v.e)F=U(v);else{if((_=+J(v))==0)break;F=_%2}j=j.times(j),D?j.c&&j.c.length>D&&(j.c.length=D):N&&(j=j.mod(C))}return N?$:(x&&($=w.div($)),C?$.mod(C):D?z($,se,L,void 0):$)},g.integerValue=function(v){var C=new S(this);return v==null?v=L:H(v,0,8),z(C,C.e+1,v)},g.isEqualTo=g.eq=function(v,C){return P(this,new S(v,C))===0},g.isFinite=function(){return!!this.c},g.isGreaterThan=g.gt=function(v,C){return 0<P(this,new S(v,C))},g.isGreaterThanOrEqualTo=g.gte=function(v,C){return(C=P(this,new S(v,C)))===1||C===0},g.isInteger=function(){return!!this.c&&T(this.e/f)>this.c.length-2},g.isLessThan=g.lt=function(v,C){return P(this,new S(v,C))<0},g.isLessThanOrEqualTo=g.lte=function(v,C){return(C=P(this,new S(v,C)))===-1||C===0},g.isNaN=function(){return!this.s},g.isNegative=function(){return this.s<0},g.isPositive=function(){return 0<this.s},g.isZero=function(){return!!this.c&&this.c[0]==0},g.minus=function(v,C){var R,N,_,D,I=this,x=I.s;if(C=(v=new S(v,C)).s,!x||!C)return new S(NaN);if(x!=C)return v.s=-C,I.plus(v);var F=I.e/f,$=v.e/f,j=I.c,re=v.c;if(!F||!$){if(!j||!re)return j?(v.s=-C,v):new S(re?I:NaN);if(!j[0]||!re[0])return re[0]?(v.s=-C,v):new S(j[0]?I:L==3?-0:0)}if(F=T(F),$=T($),j=j.slice(),x=F-$){for((_=(D=x<0)?(x=-x,j):($=F,re)).reverse(),C=x;C--;_.push(0));_.reverse()}else for(N=(D=(x=j.length)<(C=re.length))?x:C,x=C=0;C<N;C++)if(j[C]!=re[C]){D=j[C]<re[C];break}if(D&&(_=j,j=re,re=_,v.s=-v.s),0<(C=(N=re.length)-(R=j.length)))for(;C--;j[R++]=0);for(C=d-1;x<N;){if(j[--N]<re[N]){for(R=N;R&&!j[--R];j[R]=C);--j[R],j[N]+=d}j[N]-=re[N]}for(;j[0]==0;j.splice(0,1),--$);return j[0]?G(v,j,$):(v.s=L==3?-1:1,v.c=[v.e=0],v)},g.modulo=g.mod=function(v,C){var R,N,_=this;return v=new S(v,C),!_.c||!v.s||v.c&&!v.c[0]?new S(NaN):!v.c||_.c&&!_.c[0]?new S(_):(me==9?(N=v.s,v.s=1,R=te(_,v,0,3),v.s=N,R.s*=N):R=te(_,v,0,me),(v=_.minus(R.times(v))).c[0]||me!=1||(v.s=_.s),v)},g.multipliedBy=g.times=function(v,C){var R,N,_,D,I,x,F,$,j,re,he,Ce,$e,Qe,Ne,Oe=this,nt=Oe.c,Yt=(v=new S(v,C)).c;if(!(nt&&Yt&&nt[0]&&Yt[0]))return!Oe.s||!v.s||nt&&!nt[0]&&!Yt||Yt&&!Yt[0]&&!nt?v.c=v.e=v.s=null:(v.s*=Oe.s,nt&&Yt?(v.c=[0],v.e=0):v.c=v.e=null),v;for(N=T(Oe.e/f)+T(v.e/f),v.s*=Oe.s,(F=nt.length)<(re=Yt.length)&&($e=nt,nt=Yt,Yt=$e,_=F,F=re,re=_),_=F+re,$e=[];_--;$e.push(0));for(Qe=d,Ne=y,_=re;0<=--_;){for(R=0,he=Yt[_]%Ne,Ce=Yt[_]/Ne|0,D=_+(I=F);_<D;)R=(($=he*($=nt[--I]%Ne)+(x=Ce*$+(j=nt[I]/Ne|0)*he)%Ne*Ne+$e[D]+R)/Qe|0)+(x/Ne|0)+Ce*j,$e[D--]=$%Qe;$e[D]=R}return R?++N:$e.splice(0,1),G(v,$e,N)},g.negated=function(){var v=new S(this);return v.s=-v.s||null,v},g.plus=function(v,C){var R,N=this,_=N.s;if(C=(v=new S(v,C)).s,!_||!C)return new S(NaN);if(_!=C)return v.s=-C,N.minus(v);var D=N.e/f,I=v.e/f,x=N.c,F=v.c;if(!D||!I){if(!x||!F)return new S(_/0);if(!x[0]||!F[0])return F[0]?v:new S(x[0]?N:0*_)}if(D=T(D),I=T(I),x=x.slice(),_=D-I){for((R=0<_?(I=D,F):(_=-_,x)).reverse();_--;R.push(0));R.reverse()}for((_=x.length)-(C=F.length)<0&&(R=F,F=x,x=R,C=_),_=0;C;)_=(x[--C]=x[C]+F[C]+_)/d|0,x[C]=d===x[C]?0:x[C]%d;return _&&(x=[_].concat(x),++I),G(v,x,I)},g.precision=g.sd=function(v,C){var R,N,_;if(v!=null&&v!==!!v)return H(v,1,E),C==null?C=L:H(C,0,8),z(new S(this),v,C);if(!(R=this.c))return null;if(N=(_=R.length-1)*f+1,_=R[_]){for(;_%10==0;_/=10,N--);for(_=R[0];10<=_;_/=10,N++);}return v&&this.e+1>N&&(N=this.e+1),N},g.shiftedBy=function(v){return H(v,-m,m),this.times("1e"+v)},g.squareRoot=g.sqrt=function(){var v,C,R,N,_,D=this,I=D.c,x=D.s,F=D.e,$=b+4,j=new S("0.5");if(x!==1||!I||!I[0])return new S(!x||x<0&&(!I||I[0])?NaN:I?D:1/0);if((R=(x=Math.sqrt(+J(D)))==0||x==1/0?(((C=M(I)).length+F)%2==0&&(C+="0"),x=Math.sqrt(+C),F=T((F+1)/2)-(F<0||F%2),new S(C=x==1/0?"1e"+F:(C=x.toExponential()).slice(0,C.indexOf("e")+1)+F)):new S(x+"")).c[0]){for((x=(F=R.e)+$)<3&&(x=0);;)if(_=R,R=j.times(_.plus(te(D,_,$,1))),M(_.c).slice(0,x)===(C=M(R.c)).slice(0,x)){if(R.e<F&&--x,(C=C.slice(x-3,x+1))!="9999"&&(N||C!="4999")){+C&&(+C.slice(1)||C.charAt(0)!="5")||(z(R,R.e+b+2,1),v=!R.times(R).eq(D));break}if(!N&&(z(_,_.e+b+2,0),_.times(_).eq(D))){R=_;break}$+=4,x+=4,N=1}}return z(R,R.e+b+1,L,v)},g.toExponential=function(v,C){return v!=null&&(H(v,0,E),v++),W(this,v,C,1)},g.toFixed=function(v,C){return v!=null&&(H(v,0,E),v=v+this.e+1),W(this,v,C)},g.toFormat=function(v,C,R){var N;if(R==null)v!=null&&C&&typeof C=="object"?(R=C,C=null):v&&typeof v=="object"?(R=v,v=C=null):R=ke;else if(typeof R!="object")throw Error(c+"Argument not an object: "+R);if(N=this.toFixed(v,C),this.c){var _,D=N.split("."),I=+R.groupSize,x=+R.secondaryGroupSize,F=R.groupSeparator||"",$=D[0],j=D[1],re=this.s<0,he=re?$.slice(1):$,Ce=he.length;if(x&&(_=I,I=x,Ce-=x=_),0<I&&0<Ce){for(_=Ce%I||I,$=he.substr(0,_);_<Ce;_+=I)$+=F+he.substr(_,I);0<x&&($+=F+he.slice(_)),re&&($="-"+$)}N=j?$+(R.decimalSeparator||"")+((x=+R.fractionGroupSize)?j.replace(new RegExp("\\d{"+x+"}\\B","g"),"$&"+(R.fractionGroupSeparator||"")):j):$}return(R.prefix||"")+N+(R.suffix||"")},g.toFraction=function(v){var C,R,N,_,D,I,x,F,$,j,re,he,Ce=this,$e=Ce.c;if(v!=null&&(!(x=new S(v)).isInteger()&&(x.c||x.s!==1)||x.lt(w)))throw Error(c+"Argument "+(x.isInteger()?"out of range: ":"not an integer: ")+J(x));if(!$e)return new S(Ce);for(C=new S(w),$=R=new S(w),N=F=new S(w),he=M($e),D=C.e=he.length-Ce.e-1,C.c[0]=p[(I=D%f)<0?f+I:I],v=!v||0<x.comparedTo(C)?0<D?C:$:x,I=ee,ee=1/0,x=new S(he),F.c[0]=0;j=te(x,C,0,1),(_=R.plus(j.times(N))).comparedTo(v)!=1;)R=N,N=_,$=F.plus(j.times(_=$)),F=_,C=x.minus(j.times(_=C)),x=_;return _=te(v.minus(R),N,0,1),F=F.plus(_.times($)),R=R.plus(_.times(N)),F.s=$.s=Ce.s,re=te($,N,D*=2,L).minus(Ce).abs().comparedTo(te(F,R,D,L).minus(Ce).abs())<1?[$,N]:[F,R],ee=I,re},g.toNumber=function(){return+J(this)},g.toPrecision=function(v,C){return v!=null&&H(v,1,E),W(this,v,C,2)},g.toString=function(v){var C,R=this,N=R.s,_=R.e;return _===null?N?(C="Infinity",N<0&&(C="-"+C)):C="NaN":(C=v==null?_<=k||B<=_?Y(M(R.c),_):Q(M(R.c),_,"0"):v===10?Q(M((R=z(new S(R),b+_+1,L)).c),R.e,"0"):(H(v,2,O.length,"Base"),ue(Q(M(R.c),_,"0"),10,v,N,!0)),N<0&&R.c[0]&&(C="-"+C)),C},g.valueOf=g.toJSON=function(){return J(this)},g._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(g[Symbol.toStringTag]="BigNumber",g[Symbol.for("nodejs.util.inspect.custom")]=g.valueOf),Z!=null&&S.set(Z),S}()).default=o.BigNumber=o,i!==void 0&&i.exports?i.exports=o:(s||(s=typeof self<"u"&&self?self:window),s.BigNumber=o)})(this)},{}],2:[function(n,i,r){i.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(s){var o=s%10;return~~(s%100/10)==1?"th":o===1?"st":o===2?"nd":o===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,i,r){function s(T,M){return function(P){if(Array.isArray(P))return P}(T)||function(P,H){var U=[],Y=!0,Q=!1,q=void 0;try{for(var Z,te=P[Symbol.iterator]();!(Y=(Z=te.next()).done)&&(U.push(Z.value),!H||U.length!==H);Y=!0);}catch(ue){Q=!0,q=ue}finally{try{Y||te.return==null||te.return()}finally{if(Q)throw q}}return U}(T,M)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(T){var M=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},P=2<arguments.length?arguments[2]:void 0;if(typeof M=="string"&&(M=l.parseFormat(M)),!a.validateFormat(M))return"ERROR: invalid format";var H=M.prefix||"",U=M.postfix||"",Y=function(Q,q,Z){switch(q.output){case"currency":return q=E(q,o.currentCurrencyDefaultFormat()),function(O,S,W){var K=W.currentCurrency(),G=Object.assign({},h,S),z=void 0,J="",v=!!G.totalLength||!!G.forceAverage||G.average,C=S.currencyPosition||K.position,R=S.currencySymbol||K.symbol;G.spaceSeparated&&(J=" "),C==="infix"&&(z=J+R+J);var N=y({instance:O,providedFormat:S,state:W,decimalSeparator:z});return C==="prefix"&&(N=O._value<0&&G.negative==="sign"?"-".concat(J).concat(R).concat(N.slice(1)):R+J+N),C&&C!=="postfix"||(N=N+(J=v?"":J)+R),N}(Q,q,o);case"percent":return q=E(q,o.currentPercentageDefaultFormat()),function(O,S,W,K){var G=S.prefixSymbol,z=y({instance:K(100*O._value),providedFormat:S,state:W}),J=Object.assign({},h,S);return G?"%".concat(J.spaceSeparated?" ":"").concat(z):"".concat(z).concat(J.spaceSeparated?" ":"","%")}(Q,q,o,Z);case"byte":return q=E(q,o.currentByteDefaultFormat()),w=Q,L=o,k=Z,B=(b=q).base||"binary",X=c[B],ee=f(w._value,X.suffixes,X.scale),ge=ee.value,me=ee.suffix,se=y({instance:k(ge),providedFormat:b,state:L,defaults:L.currentByteDefaultFormat()}),ke=L.currentAbbreviations(),"".concat(se).concat(ke.spaced?" ":"").concat(me);case"time":return q=E(q,o.currentTimeDefaultFormat()),le=Q,ve=Math.floor(le._value/60/60),st=Math.floor((le._value-60*ve*60)/60),g=Math.round(le._value-60*ve*60-60*st),"".concat(ve,":").concat(st<10?"0":"").concat(st,":").concat(g<10?"0":"").concat(g);case"ordinal":return q=E(q,o.currentOrdinalDefaultFormat()),te=Q,ue=q,Ee=(ce=o).currentOrdinal(),He=Object.assign({},h,ue),Le=y({instance:te,providedFormat:ue,state:ce}),be=Ee(te._value),"".concat(Le).concat(He.spaceSeparated?" ":"").concat(be);case"number":default:return y({instance:Q,providedFormat:q,numbro:Z})}var te,ue,ce,Ee,He,Le,be,le,ve,st,g,w,b,L,k,B,X,ee,ge,me,se,ke}(T,M,P);return Y=(Y=H+Y)+U}function f(T,M,P){var H=M[0],U=Math.abs(T);if(P<=U){for(var Y=1;Y<M.length;++Y){var Q=Math.pow(P,Y),q=Math.pow(P,Y+1);if(Q<=U&&U<q){H=M[Y],T/=Q;break}}H===M[0]&&(T/=Math.pow(P,M.length-1),H=M[M.length-1])}return{value:T,suffix:H}}function m(T){for(var M="",P=0;P<T;P++)M+="0";return M}function p(T,M){return T.toString().indexOf("e")!==-1?function(P,H){var U=P.toString(),Y=s(U.split("e"),2),Q=Y[0],q=Y[1],Z=s(Q.split("."),2),te=Z[0],ue=Z[1],ce=ue===void 0?"":ue;if(0<+q)U=te+ce+m(q-ce.length);else{var Ee=".";Ee=+te<0?"-0".concat(Ee):"0".concat(Ee);var He=(m(-q-1)+Math.abs(te)+ce).substr(0,H);He.length<H&&(He+=m(H-He.length)),U=Ee+He}return 0<+q&&0<H&&(U+=".".concat(m(H))),U}(T,M):(Math.round(+"".concat(T,"e+").concat(M))/Math.pow(10,M)).toFixed(M)}function y(T){var M=T.instance,P=T.providedFormat,H=T.state,U=H===void 0?o:H,Y=T.decimalSeparator,Q=T.defaults,q=Q===void 0?U.currentDefaults():Q,Z=M._value;if(Z===0&&U.hasZeroFormat())return U.getZeroFormat();if(!isFinite(Z))return Z.toString();var te,ue,ce,Ee,He,Le,be,le,ve=Object.assign({},h,q,P),st=ve.totalLength,g=st?0:ve.characteristic,w=ve.optionalCharacteristic,b=ve.forceAverage,L=!!st||!!b||ve.average,k=st?-1:L&&P.mantissa===void 0?0:ve.mantissa,B=!st&&(P.optionalMantissa===void 0?k===-1:ve.optionalMantissa),X=ve.trimMantissa,ee=ve.thousandSeparated,ge=ve.spaceSeparated,me=ve.negative,se=ve.forceSign,ke=ve.exponential,O="";if(L){var S=function(v){var C=v.value,R=v.forceAverage,N=v.abbreviations,_=v.spaceSeparated,D=_!==void 0&&_,I=v.totalLength,x=I===void 0?0:I,F="",$=Math.abs(C),j=-1;if($>=Math.pow(10,12)&&!R||R==="trillion"?(F=N.trillion,C/=Math.pow(10,12)):$<Math.pow(10,12)&&$>=Math.pow(10,9)&&!R||R==="billion"?(F=N.billion,C/=Math.pow(10,9)):$<Math.pow(10,9)&&$>=Math.pow(10,6)&&!R||R==="million"?(F=N.million,C/=Math.pow(10,6)):($<Math.pow(10,6)&&$>=Math.pow(10,3)&&!R||R==="thousand")&&(F=N.thousand,C/=Math.pow(10,3)),F&&(F=(D?" ":"")+F),x){var re=C.toString().split(".")[0];j=Math.max(x-re.length,0)}return{value:C,abbreviation:F,mantissaPrecision:j}}({value:Z,forceAverage:b,abbreviations:U.currentAbbreviations(),spaceSeparated:ge,totalLength:st});Z=S.value,O+=S.abbreviation,st&&(k=S.mantissaPrecision)}if(ke){var W=(ue=(te={value:Z,characteristicPrecision:g}).value,ce=te.characteristicPrecision,Ee=ce===void 0?0:ce,He=s(ue.toExponential().split("e"),2),Le=He[0],be=He[1],le=+Le,Ee&&1<Ee&&(le*=Math.pow(10,Ee-1),be=0<=(be=+be-(Ee-1))?"+".concat(be):be),{value:le,abbreviation:"e".concat(be)});Z=W.value,O=W.abbreviation+O}var K,G,z,J=function(v,C,R,N,_){if(N===-1)return v;var D=p(C,N),I=s(D.toString().split("."),2),x=I[0],F=I[1],$=F===void 0?"":F;if($.match(/^0+$/)&&(R||_))return x;var j=$.match(/0+$/);return _&&j?"".concat(x,".").concat($.toString().slice(0,j.index)):D.toString()}(Z.toString(),Z,B,k,X);return J=function(v,C,R,N,_){var D=N.currentDelimiters(),I=D.thousands;_=_||D.decimal;var x=D.thousandsSize||3,F=v.toString(),$=F.split(".")[0],j=F.split(".")[1];return R&&(C<0&&($=$.slice(1)),function(re,he){for(var Ce=[],$e=0,Qe=re;0<Qe;Qe--)$e===he&&(Ce.unshift(Qe),$e=0),$e++;return Ce}($.length,x).forEach(function(re,he){$=$.slice(0,re+he)+I+$.slice(re+he)}),C<0&&($="-".concat($))),F=j?$+_+j:$}(J=function(v,C,R,N){var _=v,D=s(_.toString().split("."),2),I=D[0],x=D[1];if(I.match(/^-?0$/)&&R)return x?"".concat(I.replace("0",""),".").concat(x):I.replace("0","");if(I.length<N)for(var F=N-I.length,$=0;$<F;$++)_="0".concat(_);return _.toString()}(J,0,w,g),Z,ee,U,Y),(L||ke)&&(J=J+O),(se||Z<0)&&(K=J,z=me,J=(G=Z)===0?K:+K==0?K.replace("-",""):0<G?"+".concat(K):z==="sign"?K:"(".concat(K.replace("-",""),")")),J}function E(T,M){if(!T)return M;var P=Object.keys(T);return P.length===1&&P[0]==="output"?M:T}i.exports=function(T){return{format:function(){for(var M=arguments.length,P=new Array(M),H=0;H<M;H++)P[H]=arguments[H];return d.apply(void 0,P.concat([T]))},getByteUnit:function(){for(var M=arguments.length,P=new Array(M),H=0;H<M;H++)P[H]=arguments[H];return(function(U){var Y=c.general;return f(U._value,Y.suffixes,Y.scale).suffix}).apply(void 0,P.concat([T]))},getBinaryByteUnit:function(){for(var M=arguments.length,P=new Array(M),H=0;H<M;H++)P[H]=arguments[H];return(function(U){var Y=c.binary;return f(U._value,Y.suffixes,Y.scale).suffix}).apply(void 0,P.concat([T]))},getDecimalByteUnit:function(){for(var M=arguments.length,P=new Array(M),H=0;H<M;H++)P[H]=arguments[H];return(function(U){var Y=c.decimal;return f(U._value,Y.suffixes,Y.scale).suffix}).apply(void 0,P.concat([T]))},formatOrDefault:E}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,i,r){var s=n("./en-US"),o=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},h=null,d={};function f(p){u=p}function m(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return m().currency},l.currentAbbreviations=function(){return m().abbreviations},l.currentDelimiters=function(){return m().delimiters},l.currentOrdinal=function(){return m().ordinal},l.currentDefaults=function(){return Object.assign({},m().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().timeFormat)},l.setDefaults=function(p){p=a.parseFormat(p),o.validateFormat(p)&&(d=p)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(p){return h=typeof p=="string"?p:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(p){if(p){if(c[p])return c[p];throw new Error('Unknown tag "'.concat(p,'"'))}return m()},l.registerLanguage=function(p){var y=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!o.validateLanguage(p))throw new Error("Invalid language data");c[p.languageTag]=p,y&&f(p.languageTag)},l.setLanguage=function(p){var y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:s.languageTag;if(!c[p]){var E=p.split("-")[0],T=Object.keys(c).find(function(M){return M.split("-")[0]===E});return c[T]?void f(T):void f(y)}f(p)},l.registerLanguage(s),u=s.languageTag,i.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,i,r){i.exports=function(s){return{loadLanguagesInNode:function(o){return a=s,void o.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,i,r){var s=n("bignumber.js");function o(a,l,u){var c=new s(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new s(h),a._value=c.minus(h).toNumber(),a}i.exports=function(a){return{add:function(l,u){return h=u,d=a,f=new s((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new s(m),c._value=f.plus(m).toNumber(),c;var c,h,d,f,m},subtract:function(l,u){return o(l,u,a)},multiply:function(l,u){return h=u,d=a,f=new s((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new s(m),c._value=f.times(m).toNumber(),c;var c,h,d,f,m},divide:function(l,u){return h=u,d=a,f=new s((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new s(m),c._value=f.dividedBy(m).toNumber(),c;var c,h,d,f,m},set:function(l,u){return c=l,d=h=u,a.isNumbro(h)&&(d=h._value),c._value=d,c;var c,h,d},difference:function(l,u){return c=u,o(d=(h=a)(l._value),c,h),Math.abs(d._value);var c,h,d}}}},{"bignumber.js":1}],7:[function(n,i,r){function s(y,E){for(var T=0;T<E.length;T++){var M=E[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(y,M.key,M)}}var o=n("./globalState"),a=n("./validating"),l=n("./loading")(p),u=n("./unformatting"),c=n("./formatting")(p),h=n("./manipulating")(p),d=n("./parsing"),f=function(){function y(M){(function(P,H){if(!(P instanceof H))throw new TypeError("Cannot call a class as a function")})(this,y),this._value=M}var E,T;return E=y,(T=[{key:"clone",value:function(){return p(this._value)}},{key:"format",value:function(){var M=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,M)}},{key:"formatCurrency",value:function(M){return typeof M=="string"&&(M=d.parseFormat(M)),(M=c.formatOrDefault(M,o.currentCurrencyDefaultFormat())).output="currency",c.format(this,M)}},{key:"formatTime",value:function(){var M=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return M.output="time",c.format(this,M)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(M){return h.difference(this,M)}},{key:"add",value:function(M){return h.add(this,M)}},{key:"subtract",value:function(M){return h.subtract(this,M)}},{key:"multiply",value:function(M){return h.multiply(this,M)}},{key:"divide",value:function(M){return h.divide(this,M)}},{key:"set",value:function(M){return h.set(this,m(M))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&s(E.prototype,T),y}();function m(y){var E=y;return p.isNumbro(y)?E=y._value:typeof y=="string"?E=p.unformat(y):isNaN(y)&&(E=NaN),E}function p(y){return new f(m(y))}p.version="2.1.2",p.isNumbro=function(y){return y instanceof f},p.language=o.currentLanguage,p.registerLanguage=o.registerLanguage,p.setLanguage=o.setLanguage,p.languages=o.languages,p.languageData=o.languageData,p.zeroFormat=o.setZeroFormat,p.defaultFormat=o.currentDefaults,p.setDefaults=o.setDefaults,p.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,p.validate=a.validate,p.loadLanguagesInNode=l.loadLanguagesInNode,p.unformat=u.unformat,i.exports=p},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,i,r){i.exports={parseFormat:function(s){var o,a,l,u,c,h,d,f,m,p,y,E,T,M,P,H,U,Y,Q,q,Z=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof s!="string"?s:(a=Z,s=(l=(o=s).match(/^{([^}]*)}/))?(a.prefix=l[1],o.slice(l[0].length)):o,c=Z,function(te,ue){if(te.indexOf("$")===-1){if(te.indexOf("%")===-1)return te.indexOf("bd")!==-1?(ue.output="byte",ue.base="general"):te.indexOf("b")!==-1?(ue.output="byte",ue.base="binary"):te.indexOf("d")!==-1?(ue.output="byte",ue.base="decimal"):te.indexOf(":")===-1?te.indexOf("o")!==-1&&(ue.output="ordinal"):ue.output="time";ue.output="percent"}else ue.output="currency"}(s=(h=(u=s).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,Z),d=Z,(f=s.match(/[1-9]+[0-9]*/))&&(d.totalLength=+f[0]),m=Z,(p=s.split(".")[0].match(/0+/))&&(m.characteristic=p[0].length),function(te,ue){if(te.indexOf(".")!==-1){var ce=te.split(".")[0];ue.optionalCharacteristic=ce.indexOf("0")===-1}}(s,Z),y=Z,s.indexOf("a")!==-1&&(y.average=!0),T=Z,(E=s).indexOf("K")!==-1?T.forceAverage="thousand":E.indexOf("M")!==-1?T.forceAverage="million":E.indexOf("B")!==-1?T.forceAverage="billion":E.indexOf("T")!==-1&&(T.forceAverage="trillion"),function(te,ue){var ce=te.split(".")[1];if(ce){var Ee=ce.match(/0+/);Ee&&(ue.mantissa=Ee[0].length)}}(s,Z),P=Z,(M=s).match(/\[\.]/)?P.optionalMantissa=!0:M.match(/\./)&&(P.optionalMantissa=!1),H=Z,s.indexOf(",")!==-1&&(H.thousandSeparated=!0),U=Z,s.indexOf(" ")!==-1&&(U.spaceSeparated=!0),Q=Z,(Y=s).match(/^\+?\([^)]*\)$/)&&(Q.negative="parenthesis"),Y.match(/^\+?-/)&&(Q.negative="sign"),q=Z,s.match(/^\+/)&&(q.forceSign=!0),Z)}}},{}],9:[function(n,i,r){var s=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,f=5<arguments.length?arguments[5]:void 0,m=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:function p(y,E){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",M=3<arguments.length?arguments[3]:void 0,P=4<arguments.length?arguments[4]:void 0,H=5<arguments.length?arguments[5]:void 0,U=6<arguments.length?arguments[6]:void 0;if(!isNaN(+y))return+y;var Y="",Q=y.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(Q!==y)return-1*p(Q,E,T,M,P,H,U);for(var q=0;q<s.length;q++){var Z=s[q];if((Y=y.replace(Z.key,""))!==y)return p(Y,E,T,M,P,H,U)*Z.factor}if((Y=y.replace("%",""))!==y)return p(Y,E,T,M,P,H,U)/100;var te=parseFloat(y);if(!isNaN(te)){var ue=M(te);if(ue&&ue!=="."&&(Y=y.replace(new RegExp("".concat(o(ue),"$")),""))!==y)return p(Y,E,T,M,P,H,U);var ce={};Object.keys(H).forEach(function(st){ce[H[st]]=st});for(var Ee=Object.keys(ce).sort().reverse(),He=Ee.length,Le=0;Le<He;Le++){var be=Ee[Le],le=ce[be];if((Y=y.replace(be,""))!==y){var ve=void 0;switch(le){case"thousand":ve=Math.pow(10,3);break;case"million":ve=Math.pow(10,6);break;case"billion":ve=Math.pow(10,9);break;case"trillion":ve=Math.pow(10,12)}return p(Y,E,T,M,P,H,U)*ve}}}}(function(p,y){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",T=p.replace(E,"");return T=(T=T.replace(new RegExp("([0-9])".concat(o(y.thousands),"([0-9])"),"g"),"$1$2")).replace(y.decimal,".")}(l,u,c),u,c,h,d,f,m)}i.exports={unformat:function(l,u){var c,h,d,f=n("./globalState"),m=f.currentDelimiters(),p=f.currentCurrency().symbol,y=f.currentOrdinal(),E=f.getZeroFormat(),T=f.currentAbbreviations(),M=void 0;if(typeof l=="string")M=function(P,H){if(!P.indexOf(":")||H.thousands===":")return!1;var U=P.split(":");if(U.length!==3)return!1;var Y=+U[0],Q=+U[1],q=+U[2];return!isNaN(Y)&&!isNaN(Q)&&!isNaN(q)}(l,m)?(c=l.split(":"),h=+c[0],d=+c[1],+c[2]+60*d+3600*h):a(l,m,p,y,E,T,u);else{if(typeof l!="number")return;M=l}if(M!==void 0)return M}}},{"./globalState":4}],10:[function(n,i,r){function s(m){return function(p){if(Array.isArray(p)){for(var y=0,E=new Array(p.length);y<p.length;y++)E[y]=p[y];return E}}(m)||function(p){if(Symbol.iterator in Object(p)||Object.prototype.toString.call(p)==="[object Arguments]")return Array.from(p)}(m)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(m)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(m,p){return p.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(m){return m.output==="byte"}},characteristic:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(m){return 0<=m},message:"value must be positive"},{restriction:function(m,p){return!p.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(m,p){return p.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(m){return m.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(m){return!!a.unformat(m)}function d(m,p,y){var E=3<arguments.length&&arguments[3]!==void 0&&arguments[3],T=Object.keys(m).map(function(M){if(!p[M])return console.error("".concat(y," Invalid key: ").concat(M)),!1;var P=m[M],H=p[M];if(typeof H=="string"&&(H={type:H}),H.type==="format"){if(!d(P,u,"[Validate ".concat(M,"]"),!0))return!1}else if(o(P)!==H.type)return console.error("".concat(y," ").concat(M,' type mismatched: "').concat(H.type,'" expected, "').concat(o(P),'" provided')),!1;if(H.restrictions&&H.restrictions.length)for(var U=H.restrictions.length,Y=0;Y<U;Y++){var Q=H.restrictions[Y],q=Q.restriction,Z=Q.message;if(!q(P,m))return console.error("".concat(y," ").concat(M," invalid value: ").concat(Z)),!1}return H.restriction&&!H.restriction(P,m)?(console.error("".concat(y," ").concat(M," invalid value: ").concat(H.message)),!1):H.validValues&&H.validValues.indexOf(P)===-1?(console.error("".concat(y," ").concat(M," invalid value: must be among ").concat(JSON.stringify(H.validValues),', "').concat(P,'" provided')),!1):!(H.children&&!d(P,H.children,"[Validate ".concat(M,"]")))});return E||T.push.apply(T,s(Object.keys(p).map(function(M){var P=p[M];if(typeof P=="string"&&(P={type:P}),P.mandatory){var H=P.mandatory;if(typeof H=="function"&&(H=H(m)),H&&m[M]===void 0)return console.error("".concat(y,' Missing mandatory key "').concat(M,'"')),!1}return!0}))),T.reduce(function(M,P){return M&&P},!0)}function f(m){return d(m,u,"[Validate format]")}i.exports={validate:function(m,p){var y=h(m),E=f(p);return y&&E},validateFormat:f,validateInput:h,validateLanguage:function(m){return d(m,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})($L);var iie=$L.exports;const ol=hj(iie),rie="numeric";function FL(t,e){if(zn(t)){const n=e.numericFormat,i=n&&n.culture||"-",r=n&&n.pattern;if(typeof i<"u"&&!ol.languages()[i]){const s=i.replace("-",""),o=ol.allLanguages?ol.allLanguages[i]:ol[s];o&&ol.registerLanguage(o)}ol.setLanguage(i),t=ol(t).format(r||"0")}return t}function sM(t,e,n,i,r,s,o){let a=s;if(zn(a)){const l=o.className||"",u=l.length?l.split(" "):[];a=FL(a,o),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),o.className=u.join(" "),e.dir="ltr"}jo(t,e,n,i,r,a,o)}sM.RENDERER_TYPE=rie;const sie="password";function oM(t,e,n,i,r,s,o){jo.apply(this,[t,e,n,i,r,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let u="";_e(a-1,()=>{u+=l}),hu(e,u)}oM.RENDERER_TYPE=sie;const oie="select";function aM(t,e,n,i,r,s,o){jo.apply(this,[t,e,n,i,r,s,o])}aM.RENDERER_TYPE=oie;const aie="time";function lM(t,e,n,i,r,s,o){jo.apply(this,[t,e,n,i,r,s,o]),e.dir="ltr"}lM.RENDERER_TYPE=aie;function lie(){xi(zc),xi(Uf),xi(nM),xi(tM),xi(rM),xi(eM),xi(sM),xi(oM),xi(aM),xi(jo),xi(lM)}const uie="autocomplete";function Iv(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,LP(n,e)):LP(n,e)(this.source):e(!0)}Iv.VALIDATOR_TYPE=uie;function LP(t,e){const n=t;return function(i){let r=!1;for(let s=0,o=i.length;s<o;s++)if(n===i[s]){r=!0;break}e(r)}}function VL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const cie=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:VL},Symbol.toStringTag,{value:"Module"})),hie="date";function uM(t,e){const n=ED(xL,this.instance);let i=t,r=!0;i==null&&(i="");let s=ne(i,this.dateFormat||n.defaultDateFormat,!0).isValid(),o=ne(new Date(i)).isValid()||s;if(this.allowEmpty&&i===""&&(o=!0,s=!0),o||(r=!1),!o&&s&&(r=!0),o&&!s)if(this.correctFormat===!0){const a=die(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),r=!0}else r=!1;e(r)}uM.VALIDATOR_TYPE=hie;function die(t,e){const n=ne(VL(t)),i=ne(t,e),r=t.search(/[A-z]/g)>-1;let s;return n.isValid()&&n.format("x")===i.format("x")||!i.isValid()||r?s=n:s=i,s.format(e)}const fie="dropdown";function cM(t,e){Iv.apply(this,[t,e])}cM.VALIDATOR_TYPE=fie;const gie="numeric";function hM(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:zn(t))}hM.VALIDATOR_TYPE=gie;const mie=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],pie="time";function dM(t,e){const n=this.timeFormat||"h:mm:ss a";let i=!0,r=t;r===null&&(r=""),r=/^\d{3,}$/.test(r)?parseInt(r,10):r;const s=/^\d{1,2}$/.test(r);s&&(r+=":00");const o=ne(r,mie,!0).isValid()?ne(r):ne(r,n);let a=o.isValid(),l=ne(r,n,!0).isValid()&&!s;if(this.allowEmpty&&r===""&&(a=!0,l=!0),a||(i=!1),!a&&l&&(i=!0),a&&!l)if(this.correctFormat===!0){const u=o.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),i=!0}else i=!1;e(i)}dM.VALIDATOR_TYPE=pie;function wie(){Hl(Iv),Hl(cM),Hl(uM),Hl(hM),Hl(dM)}const vie="autocomplete",Cie={CELL_TYPE:vie,editor:ZT,renderer:zc,validator:Iv},yie="checkbox",bie={CELL_TYPE:yie,editor:IL,renderer:nM},Sie="date";function WL(t,e,n,i,r,s,o){zc.apply(this,[t,e,n,i,r,s,o])}WL.RENDERER_TYPE=Sie;const Rie="date",Eie={CELL_TYPE:Rie,editor:AL,renderer:WL,validator:uM},Tie="dropdown",Mie={CELL_TYPE:Tie,editor:QT,renderer:tM,validator:cM},_ie="handsontable",Oie={CELL_TYPE:_ie,editor:qT,renderer:rM},Pie="numeric",Iie={CELL_TYPE:Pie,editor:HL,renderer:sM,validator:hM,dataType:"number"},xie="password",Aie={CELL_TYPE:xie,editor:NL,renderer:oM,copyable:!1},Hie="select",Nie={CELL_TYPE:Hie,editor:DL,renderer:aM},Die="time",Lie={CELL_TYPE:Die,editor:LL,renderer:lM,validator:dM};function kie(){Zi(Cie),Zi(bie),Zi(Eie),Zi(Mie),Zi(Oie),Zi(Iie),Zi(Aie),Zi(Nie),Zi(PL),Zi(Lie)}function $ie(t,e){BL(t,e),e.add(t)}function Fie(t,e,n){BL(t,e),e.set(t,n)}function BL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xu(t,e,n){return(e=Vie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vie(t){var e=Wie(t,"string");return typeof e=="symbol"?e:e+""}function Wie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Au(t,e){return t.get(jL(t,e))}function jL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kP=new Map([["plugin",Yq],["cell-type",yL],["editor",RD],["renderer",xD],["validator",AD]]),Bie="base",Ry=[];let is=null;var al=new WeakMap,$P=new WeakSet;class ut{static get PLUGIN_KEY(){return Bie}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){$ie(this,$P),xu(this,"eventManager",new hr(this)),xu(this,"pluginName",null),xu(this,"pluginsInitializedCallbacks",[]),xu(this,"isPluginsReady",!1),xu(this,"enabled",!1),xu(this,"initialized",!1),Fie(this,al,{}),js(this,"hot",e,{writable:!1}),is=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const r=[];if(n.forEach(s=>{const[o,a]=s.split(":");if(!kP.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);kP.get(o)(a)||r.push(` - ${a} (${o})`)}),r.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${r.join(`
`)}
`].join("");Ry.push(s)}}if(is||(is=J0()),is.indexOf("UndoRedo")>=0&&is.splice(is.indexOf("UndoRedo"),1),is.indexOf(this.pluginName)>=0&&is.splice(is.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),is.length===0){if(Ry.length>0){const r=[`${Ry.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(r)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n,i){Au(al,this)[e]=Au(al,this)[e]||[];const r=Au(al,this)[e];this.hot.addHook(e,n,i),r.push(n),Au(al,this)[e]=r}removeHooks(e){A(Au(al,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Au(al,this);ze(e,(n,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){A(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=jL($P,this,jie).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),ze(this,(n,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function jie(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function ll(t,e,n){return(e=Uie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uie(t){var e=Yie(t,"string");return typeof e=="symbol"?e:e+""}function Yie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let fM=class{constructor(e){ll(this,"hot",null),ll(this,"container",null),ll(this,"injected",!1),ll(this,"rows",[]),ll(this,"columns",[]),ll(this,"samples",null),ll(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),A(this.rows,n=>{e(n.row,sn(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),A(this.columns,n=>{const{width:i}=n.table.getBoundingClientRect();e(n.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{A(i.strings,r=>{n.appendChild(this.createColElement(r.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),i.appendChild(r)),this.samples.forEach(s=>{A(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),o.value,l),i.appendChild(c)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");i.push([-1,r]),n.appendChild(r)}this.samples.forEach(r=>{A(r.strings,s=>{const o=s.col,a=e.createElement("th");i.push([o,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),A(i,r=>{const[s,o]=r;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment();return this.samples.forEach(r=>{A(r.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,o,e,this.hot.colToProp(e),s.value,a),c.appendChild(u),i.appendChild(c)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const i=this.hot.rootDocument.createElement("col");let r=0;n>=0&&e>=0&&(r=this.hot.getCellMeta(n,e).colspan);let s=this.hot.getColWidth(e);if(r>1)for(let o=e+1;o<e+r;o++)s+=this.hot.getColWidth(o);return i.style.width=`${s}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("table"),s=n.createElement("thead"),o=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(l.appendChild(u),s.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(s),this.isVertical()&&o.appendChild(l),r.appendChild(o),ie(r,e),i.appendChild(r),{fragment:i,table:r,tHead:s,tBody:o,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return ie(r,s),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function sm(t,e,n){return(e=zie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zie(t){var e=Gie(t,"string");return typeof e=="symbol"?e:e+""}function Gie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xv{static get SAMPLE_COUNT(){return 3}constructor(e){sm(this,"samples",null),sm(this,"dataFactory",null),sm(this,"customSampleCount",null),sm(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:xv.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,i){const r=new Map,{from:s,to:o}=typeof i=="number"?{from:i,to:i}:i;return _e(s,o,a=>{const l=this.generateSample(e,n,a);r.set(a,l)}),r}generateSample(e,n,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const r=new Map,s=e==="row"?"col":"row",o=[];return _e(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(i,a):this.dataFactory(a,i);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Ye(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Jt(u).length}`,r.has(d)||r.set(d,{needed:this.getSampleCount(),strings:[]});const f=r.get(d);f.needed&&(!(o.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[s]:a}),o.push(u),f.needed-=1)}),r}}function Kie(t,e){UL(t,e),e.add(t)}function FP(t,e,n){UL(t,e),e.set(t,n)}function UL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mh(t,e,n){return(e=Xie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xie(t){var e=qie(t,"string");return typeof e=="symbol"?e:e+""}function qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ll(t,e){return t.get(bs(t,e))}function gM(t,e,n){return t.set(bs(t,e),n),n}function bs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ye.getSingleton().register("modifyAutoColumnSizeSeed");const _h="autoColumnSize",Zie=10,Jie="autoColumnSize";var rc=new WeakMap,Nc=new WeakMap,oo=new WeakSet;class Md extends ut{static get PLUGIN_KEY(){return _h}static get PLUGIN_PRIORITY(){return Zie}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Kie(this,oo),Mh(this,"ghostTable",new fM(this.hot)),Mh(this,"samplesGenerator",new xv((n,i)=>{const r=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(n,i);let a="";o.spanned||(a=this.hot.getDataAtCell(n,i));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),Mh(this,"inProgress",!1),Mh(this,"measuredColumns",0),Mh(this,"columnWidthsMap",new Wa),FP(this,rc,[]),FP(this,Nc,[]),this.hot.columnIndexMapper.registerMap(Jie,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,i,r)=>bs(oo,this,VP).call(this,n,i,r))}isEnabled(){return this.hot.getSettings()[_h]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[_h];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return bs(oo,e,tre).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return bs(oo,e,nre).call(e,...r)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return bs(oo,e,rre).call(e,...r)}),this.addHook("beforeRender",()=>bs(oo,this,ere).call(this)),this.addHook("modifyColWidth",(i,r)=>this.getColumnWidth(r,i)),this.addHook("init",()=>bs(oo,this,ire).call(this)),super.enablePlugin()}updatePlugin(){gM(Nc,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,i)=>bs(oo,this,VP).call(this,e,n,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const i=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:n},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,s=typeof n=="number"?{from:n,to:n}:n;_e(r.from,r.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(i||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&this.samplesGenerator.generateColumnSamples(o,s).forEach((u,c)=>this.ghostTable.addColumn(c,u))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((o,a)=>{const l=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){sf(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+Md.CALCULATION_STEP,r)},e,n),i=i+Md.CALCULATION_STEP+1,i<r?s=pv(o):(sf(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),i=a+1),i<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[_h],n=e&&Ut(e,"samplingRatio")?e.samplingRatio:void 0,i=e&&Ut(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[_h];let n=Md.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return Ye(e)&&(n=e.syncLimit,T0(n)?n=q0(i,n):n>>=0),Math.min(n,i)}getColumnWidth(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=n;return r===void 0&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof r=="number"&&(r=Math.max(r,Cv))),r}getFirstVisibleColumn(){var e;return(e=this.hot.view.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.view.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,r,s)=>{const o=Ll(rc,this).length;return(o-1<s||Ll(rc,this)[s]!==r)&&i.push(this.hot.toVisualColumn(s)),o-1<s?Ll(rc,this).push(r):Ll(rc,this)[s]=r,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Qie(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const i=this.hot.toPhysicalColumn(n);i!==null&&(this.hot._getColWidthFromSettings(i)||this.samplesGenerator.generateColumnSamples(n,e).forEach((s,o)=>this.ghostTable.addColumn(o,s)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((n,i)=>{const r=this.hot.toPhysicalColumn(n);this.columnWidthsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function ere(){this.calculateVisibleColumnsWidth(),this.inProgress||(bs(oo,this,Qie).call(this,Ll(Nc,this)),gM(Nc,this,[]))}function tre(t,e){e||this.recalculateAllColumnsWidth()}function nre(t){const e=t.reduce((n,i)=>{let[,r]=i;const s=this.hot.propToCol(r);return Number.isInteger(s)&&n.indexOf(s)===-1&&n.push(s),n},[]);Ll(Nc,this).push(...e)}function VP(t,e,n){let i=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function ire(){gM(rc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function rre(t){const e=t.reduce((n,i)=>{var r;const s=(r=i.address)===null||r===void 0?void 0:r.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);n.indexOf(o)===-1&&n.push(o)}return n},[]);Ll(Nc,this).push(...e)}const kl={horizontal:"horizontal",vertical:"vertical"};function sre(t,e,n){let i,r,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",i=n(e[0],e[1]),r=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",i=n(e[0],t[3]+1),r=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",i=n(e[0],e[1]),r=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",i=n(t[2]+1,e[1]),r=n(e[2],e[3])),i&&i.normalize(),r&&r.normalize(),{directionOfDrag:s,startOfDragCoords:i,endOfDragCoords:r}}function ore(t){const e={};return t===!0?(e.directions=Object.keys(kl),e.autoInsertRow=!0):Ye(t)?(Se(t.autoInsertRow)?t.direction===kl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Se(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(kl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function are(t,e){lre(t,e),e.add(t)}function lre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hu(t,e,n){return(e=ure(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ure(t){var e=cre(t,"string");return typeof e=="symbol"?e:e+""}function cre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ye.getSingleton().register("modifyAutofillRange");ye.getSingleton().register("beforeAutofill");ye.getSingleton().register("afterAutofill");const WP="autofill",hre=20,dre=["fillHandle"],fre="insert_row_below",gre=200;var Nu=new WeakSet;class mre extends ut{constructor(){super(...arguments),are(this,Nu),Hu(this,"addingStarted",!1),Hu(this,"mouseDownOnCellCorner",!1),Hu(this,"mouseDragOutside",!1),Hu(this,"handleDraggedCells",0),Hu(this,"directions",[]),Hu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return WP}static get PLUGIN_PRIORITY(){return hre}static get SETTING_KEYS(){return[WP,...dre]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Oh(Nu,this,wre).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Oh(Nu,this,pre).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Oh(Nu,this,vre).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:i}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:i,endRow:r,endCol:s}]),a=[],l=[],u=[];return A(o,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),A(a,c=>{const h=[];A(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,i,r]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,n),Math.max(a.row,i),Math.max(a.col,r)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=sre(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=s.clone(),p=this.hot._createCellRange(h,h,d),y=this.hot.runHooks("beforeAutofill",f,m,p,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=y;const T=y;if(["up","left"].indexOf(c)>-1&&!(T.length===1&&T[0].length===0))if(E=[],c==="up"){const M=d.row-h.row+1,P=M%T.length;for(let H=0;H<M;H++)E.push(T[(H+(T.length-P))%T.length])}else{const M=d.col-h.col+1,P=M%T[0].length;for(let H=0;H<T.length;H++){E.push([]);for(let U=0;U<M;U++)E[H].push(T[H][(U+(T[H].length-P))%T[H].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,m,p,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),i=n.getBottomEndCorner();let r=e;if(this.directions.includes(kl.vertical)&&this.directions.includes(kl.horizontal)){const s=n.getTopStartCorner();(i.col<=e.col||s.col>=e.col)&&(r=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||s.row>e.row)&&(r=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(kl.vertical))r=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(kl.horizontal))r=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(fre,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},gre)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&n[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),i=this.hot.countRows();let r;for(let s=e[2]+1;s<i;s++){for(let l=e[1];l<=e[3];l++){const u=n[s][l];if(!Qt(u))return-1}const o=n[s][e[1]-1],a=n[s][e[3]+1];(!Qt(o)||!Qt(a))&&(r=s)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...tt(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,i=bn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+sn(this.hot.table),r=bn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+At(this.hot.table);return e.clientY>i&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Oh(Nu,this,Cre).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Oh(Nu,this,yre).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=ore(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function pre(){this.selectAdjacent()&&this.fillIn()}function wre(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function vre(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Cre(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function yre(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function bre(t,e){YL(t,e),e.add(t)}function Sre(t,e,n){YL(t,e),e.set(t,n)}function YL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Du(t,e,n){return(e=Rre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rre(t){var e=Ere(t,"string");return typeof e=="symbol"?e:e+""}function Ere(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tre(t,e,n){return t.set(Ss(t,e),n),n}function mM(t,e){return t.get(Ss(t,e))}function Ss(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const om="autoRowSize",Mre=40,_re="autoRowSize";var cf=new WeakMap,ao=new WeakSet;class _d extends ut{static get PLUGIN_KEY(){return om}static get PLUGIN_PRIORITY(){return Mre}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),bre(this,ao),Du(this,"headerHeight",null),Du(this,"ghostTable",new fM(this.hot)),Du(this,"samplesGenerator",new xv((n,i)=>{const r=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(s)||n>=0&&i>=0&&this.hot.getCellMeta(n,i).hidden)return!1;let o;return n>=0?o=this.hot.getDataAtCell(n,i):n===-1&&(o=this.hot.getColHeader(i)),{value:o}})),Du(this,"inProgress",!1),Du(this,"measuredRows",0),Du(this,"rowHeightsMap",new Wa),Sre(this,cf,[]),this.hot.rowIndexMapper.registerMap(_re,this.rowHeightsMap),this.addHook("beforeRowResize",(n,i,r)=>Ss(ao,this,BP).call(this,n,i,r))}isEnabled(){const e=this.hot.getSettings()[om];return e===!0||Ye(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ss(ao,e,Ire).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ss(ao,e,xre).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ss(ao,e,Hre).call(e,...i)}),this.addHook("beforeRender",()=>Ss(ao,this,Pre).call(this)),this.addHook("modifyRowHeight",(n,i)=>this.getRowHeight(i,n)),this.addHook("init",()=>Ss(ao,this,Are).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,i)=>Ss(ao,this,BP).call(this,e,n,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const i=this.hot.renderCall;this.calculateRowsHeight({from:e,to:n},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,s=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}_e(r.from,r.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(i||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){sf(s),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+_d.CALCULATION_STEP,r)},e,n),i=i+_d.CALCULATION_STEP+1,i<r?s=pv(o):(sf(s),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),i=a+1),i<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const e=this.hot.getSettings()[om],n=e&&Ut(e,"samplingRatio")?e.samplingRatio:void 0,i=e&&Ut(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[om];let n=_d.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return Ye(e)&&(n=e.syncLimit,T0(n)?n=q0(i,n):n>>=0),Math.min(n,i)}getRowHeight(e,n){const i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let r=n;return i!==null&&i>(n||0)&&(r=i),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.view.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.view.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{_e(Math.min(n,i),Math.max(n,i),r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Ore(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((r,s)=>this.ghostTable.addRow(s,r))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,i)=>{const r=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function Pre(){this.calculateVisibleRowsHeight(),this.inProgress||(Ss(ao,this,Ore).call(this,mM(cf,this)),Tre(cf,this,[]))}function BP(t,e,n){let i=t;return n&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function Ire(t,e){e||this.recalculateAllRowsHeight()}function xre(t){const e=t.reduce((n,i)=>{let[r]=i;return n.indexOf(r)===-1&&n.push(r),n},[]);mM(cf,this).push(...e)}function Are(){this.recalculateAllRowsHeight()}function Hre(t){const e=t.reduce((n,i)=>{var r;const s=(r=i.address)===null||r===void 0?void 0:r.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);n.indexOf(o)===-1&&n.push(o)}return n},[]);mM(cf,this).push(...e)}const{getListWithInsertedItems:Nre,getListWithRemovedItems:Dre}=nL("physicallyIndexed");class Lre extends du{constructor(){super(e=>e)}insert(e,n){const i=RE(this.indexedValues,n);this.indexedValues=Nre(i,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=Dre(this.indexedValues,e);this.indexedValues=SE(n,e),super.remove(e)}}const{getListWithInsertedItems:kre,getListWithRemovedItems:$re}=nL("physicallyIndexed");class Fre extends du{constructor(){super(e=>e)}insert(e,n){this.indexedValues=kre(this.indexedValues,e,n,(i,r)=>this.getNextValue(r)),super.insert(e,n)}remove(e){this.indexedValues=$re(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function Vre(t,e){Wre(t,e),e.add(t)}function Wre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bre(t,e,n){return(e=jre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jre(t){var e=Ure(t,"string");return typeof e=="symbol"?e:e+""}function Ure(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yre(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ey="bindRowsWithHeaders",zre=210,Gre="loose",Kre=new Map([["loose",Lre],["strict",Fre]]);var jP=new WeakSet;class Xre extends ut{constructor(){super(...arguments),Vre(this,jP),Bre(this,"headerIndexes",null)}static get PLUGIN_KEY(){return Ey}static get PLUGIN_PRIORITY(){return zre}isEnabled(){return!!this.hot.getSettings()[Ey]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[Ey];typeof e!="string"&&(e=Gre);const n=Kre.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",i=>Yre(jP,this,qre).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function qre(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Zre(t,e){zL(t,e),e.add(t)}function Jre(t,e,n){zL(t,e),e.set(t,n)}function zL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UP(t,e,n){return(e=Qre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qre(t){var e=ese(t,"string");return typeof e=="symbol"?e:e+""}function ese(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YP(t,e){return t.get(hc(t,e))}function Ty(t,e,n){return t.set(hc(t,e),n),n}function hc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gp="collapsibleColumns",tse=290,nse=["nestedHeaders"],Rc="collapsibleIndicator",zP=gp,GP=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Lu=new WeakMap,Ph=new WeakSet;class ise extends ut{constructor(){super(...arguments),Zre(this,Ph),UP(this,"nestedHeadersPlugin",null),UP(this,"headerStateManager",null),Jre(this,Lu,null)}static get PLUGIN_KEY(){return gp}static get PLUGIN_PRIORITY(){return tse}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[gp,...nse]}isEnabled(){return!!this.hot.getSettings()[gp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||vt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Ty(Lu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>hc(Ph,this,ose).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return hc(Ph,e,ase).call(e,...r)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return hc(Ph,e,rse).call(e,...r)}),this.addHook("beforeOnCellMouseDown",(i,r,s)=>hc(Ph,this,sse).call(this,i,r,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ty(Lu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(n,i))!==null&&e!==void 0?e:{};if(r)return s?this.expandSection({row:n,col:o}):this.collapseSection({row:n,col:o}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:zP,relativeToGroup:Ba,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zP)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};_e(0,e-1,o=>{const a=n.childNodes[o],l=i.childNodes[o],u=r?r.childNodes[o]:null;_e(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Rc}`);s(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Rc}`),s(h)),r&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Rc}`),s(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(i=>{const{collapsible:r,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=i;if(r===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!GP.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const i=Ao(e,f=>{let{row:m}=f;return m<0});let r=i.length>0;A(i,f=>{var m;let{row:p,col:y}=f;const{collapsible:E,isCollapsed:T}=(m=this.headerStateManager.getHeaderSettings(p,y))!==null&&m!==void 0?m:{};if(!E||T&&n==="collapse"||!T&&n==="expand")return r=!1,!1});const s=[],o=[];r&&A(i,f=>{let{row:m,col:p}=f;const{colspanCompensation:y,affectedColumns:E,rollbackModification:T}=this.headerStateManager.triggerNodeModification(n,m,p);y>0&&(o.push(...E),s.push(T))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=R0([...a,...o]):n==="expand"&&(l=Ao(a,f=>!o.includes(f)));const u=GP.get(n);if(this.hot.runHooks(u.beforeHook,a,l,r)===!1){A(s,f=>{f()});return}this.hot.batchExecution(()=>{A(o,f=>{YP(Lu,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&o.includes(m)){const y=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;y!==null&&E!==null&&this.hot.selectCell(y,E)}}this.hot.runHooks(u.afterHook,a,l,r,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return YP(Lu,this).getHiddenIndexes()}destroy(){Ty(Lu,this,null),super.destroy()}}function rse(t,e,n){var i;const{collapsible:r,origColspan:s,isCollapsed:o}=(i=this.headerStateManager.getHeaderSettings(n,t))!==null&&i!==void 0?i:{},a=r&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Rc}`);if(cu(e,[lr("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),ie(u,Rc),e.querySelector("div:first-child").appendChild(u)),We(u,["collapsed","expanded"]),o?(ie(u,"collapsed"),Ha(u,"+"),l&&xe(e,...lr(!1))):(ie(u,"expanded"),Ha(u,"-"),l&&xe(e,...lr(!0))),l&&xe(u,...Vo());else{var c;(c=u)===null||c===void 0||c.remove()}}function sse(t,e){De(t.target,Rc)&&(De(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):De(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),gr(t))}function ose(){this.updatePlugin()}function ase(t,e){e||this.updatePlugin()}function ul(t,e,n){return(e=lse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lse(t){var e=use(t,"string");return typeof e=="symbol"?e:e+""}function use(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const cse=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],hse=!1,dse=!0,fse=!0;class gse{constructor(e,n){ul(this,"hot",void 0),ul(this,"sortingStates",new Ev),ul(this,"sortEmptyCells",hse),ul(this,"indicator",dse),ul(this,"headerAction",fse),ul(this,"compareFunctionFactory",void 0),ul(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Ye(e)&&ze(e,(n,i)=>{cse.includes(i)&&(this[i]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[i]=n;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Ye(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[i,r]=n;return{column:this.hot.toVisualColumn(i),...r}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(Se(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function GL(t,e,n){const i=e.locale;return function(r,s){const{sortEmptyCells:o}=n;return typeof r=="string"&&(r=r.toLocaleLowerCase(i)),typeof s=="string"&&(s=s.toLocaleLowerCase(i)),r===s?Ns:Qt(r)?Qt(s)?Ns:o&&t==="asc"?qt:Zt:Qt(s)?o&&t==="asc"?Zt:qt:isNaN(r)&&!isNaN(s)?t==="asc"?Zt:qt:!isNaN(r)&&isNaN(s)||(isNaN(r)||isNaN(s)||(r=parseFloat(r),s=parseFloat(s)),r<s)?t==="asc"?qt:Zt:r>s?t==="asc"?Zt:qt:Ns}}const KL="default";function mse(t,e,n){return function(i,r){const s=parseFloat(i),o=parseFloat(r),{sortEmptyCells:a}=n;if(s===o||isNaN(s)&&isNaN(o))return Ns;if(a){if(Qt(i))return t==="asc"?qt:Zt;if(Qt(r))return t==="asc"?Zt:qt}return isNaN(s)?Zt:isNaN(o)?qt:s<o?t==="asc"?qt:Zt:s>o?t==="asc"?Zt:qt:Ns}}const pse="numeric";function wse(t,e,n){const i=e.checkedTemplate,r=e.uncheckedTemplate,{sortEmptyCells:s}=n;return function(o,a){const l=Qt(o),u=Qt(a),c=l?r:o,h=u?r:a,d=c===r||c===i,f=h===r||h===i;if(s===!1){if(l&&u===!1)return Zt;if(l===!1&&u)return qt}return d===!1&&f?t==="asc"?qt:Zt:d&&f===!1?t==="asc"?Zt:qt:d===!1&&f===!1?GL(t,e,n)(o,a):c===r&&h===i?t==="asc"?qt:Zt:c===i&&h===r?t==="asc"?Zt:qt:Ns}}const vse="checkbox";function Cse(t,e,n){return ek(t,e.dateFormat,n)}const yse="date";function bse(t,e,n){return ek(t,e.timeFormat,n)}const Sse="time",{register:Yf,getItem:KP,hasItem:Rse}=Kr("sorting.compareFunctionFactory"),{register:XL,getItem:Ese}=Kr("sorting.mainSortComparator");function qL(t){return Rse(t)?KP(t):KP(KL)}Yf(vse,wse);Yf(yse,Cse);Yf(KL,GL);Yf(pse,mse);Yf(Sse,bse);const Ns=0,qt=-1,Zt=1;function Tse(t,e){const n=Ese(e);for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];t.sort(n(...r))}const ew="asc",tw="desc",ZL="colHeader";function Mse(t){if(Ye(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[ew,tw].includes(n)}function _se(t){if(t.some(n=>Mse(n)===!1))return!1;const e=t.map(n=>{let{column:i}=n;return i});return new Set(e).size===e.length}function XP(t){if(t!==tw)return t===ew?tw:ew}function JL(t){return t.querySelector(`.${ZL}`)}function QL(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function pM(t,e,n){return t===-1&&e>=0&&Na(n)===!1}function ek(t,e,n){return function(i,r){const{sortEmptyCells:s}=n;if(i===r)return Ns;if(Qt(i))return Qt(r)?Ns:s&&t==="asc"?qt:Zt;if(Qt(r))return s&&t==="asc"?Zt:qt;const o=ne(i,e),a=ne(r,e);return o.isValid()?a.isValid()?a.isAfter(o)?t==="asc"?qt:Zt:a.isBefore(o)?t==="asc"?Zt:qt:Ns:qt:Zt}}const Ose="ascending",Pse="descending",tk="indicatorDisabled",nk="columnSorting",ik="sortAction",rk=new Map([[ew,Ose],[tw,Pse]]);function Ise(t,e,n,i){const r=[nk];if(i&&r.push(ik),n===!1)return r.push(tk),r;const s=t.getSortOrderOfColumn(e);return Se(s)&&r.push(rk.get(s)),r}function xse(){return Array.from(rk.values()).concat(ik,tk,nk)}function Ase(t,e){return function(n,i){const[,...r]=n,[,...s]=i;return function(a){const l=t[a],u=e[a],c=r[a],h=s[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:qL(u.type))(l,u,d)(c,h)}(0)}}function Hse(t,e){Nse(t,e),e.add(t)}function Nse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function am(t,e,n){return(e=Dse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dse(t){var e=Lse(t,"string");return typeof e=="symbol"?e:e+""}function Lse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nw="columnSorting",kse=50,iw="append",$se="replace",qP=nw;XL(nw,Ase);ye.getSingleton().register("beforeColumnSort");ye.getSingleton().register("afterColumnSort");var xl=new WeakSet;class sk extends ut{constructor(){super(...arguments),Hse(this,xl),am(this,"columnStatesManager",null),am(this,"columnMetaCache",null),am(this,"pluginKey",nw),am(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return nw}static get PLUGIN_PRIORITY(){return kse}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new gse(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Wa(n=>{let i=this.hot.toVisualColumn(n);return i===null&&(i=n),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,i)=>sc(xl,this,Fse).call(this,n,i)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return sc(xl,e,Wse).call(e,...i)}),this.addHook("afterOnCellMouseDown",(n,i)=>this.onAfterOnCellMouseDown(n,i)),this.addHook("afterInit",()=>sc(xl,this,BS).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return sc(xl,e,Vse).call(e,...i)}),this.hot.view&&sc(xl,this,BS).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,i)=>{const r=JL(i);QL(n,i)===!1||r===null||this.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:Ba,position:"before",group:qP})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(qP)}sort(e){const n=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",n,i,r)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new iL),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",n,r?i:n,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Se(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return _se(e)&&e.every(i=>{let{column:r}=i;return r<=n&&r>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),i=r=>{let{column:s,...o}=r;return{column:this.hot.toPhysicalColumn(s),...o}};n.initialConfig=tt(e,i),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,i=r=>{let{column:s,...o}=r;return{column:this.hot.toVisualColumn(s),...o}};return Se(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=tt(n.initialConfig,i)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(Se(n)){const r=XP(n);return Se(r)?{column:e,sortOrder:r}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:XP()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iw;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=i!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(r){if(xt(o))return[...s.slice(0,i),...s.slice(i+1)];if(n===iw)return[...s.slice(0,i),...s.slice(i+1),o];if(n===$se)return[...s.slice(0,i),o,...s.slice(i+1)]}return Se(o)?s.concat(o):s}getPluginColumnConfig(e){if(Ye(e)){const n=e[this.pluginKey];if(Ye(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(r);return Array.isArray(s.columns)?Object.assign(i,n,this.getPluginColumnConfig(s.columns[e])):Pt(s.columns)?Object.assign(i,n,this.getPluginColumnConfig(s.columns(e))):Object.assign(i,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),i=Object.create(n);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],i=this.hot.countRows(),r=u=>tt(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(i);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(r(u)));const s=tt(n,u=>u[0]);Tse(n,this.pluginKey,tt(e,u=>u.sortOrder),tt(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<i;u+=1)n.push([u].concat(r(u)));const o=tt(n,u=>u[0]),a=new Map(tt(s,(u,c)=>[u,o[c]])),l=tt(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Ye(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Ye(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(We(e,xse()),this.enabled!==!1){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];ie(e,Ise(...i))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Se(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&De(e.target,ZL)}onAfterOnCellMouseDown(e,n){pM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function BS(){const t=this.getAllSavedSortSettings();if(Ye(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Fse(t,e){const n=JL(e);if(QL(t,e)===!1||n===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],r=i.indicator,s=i.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,r,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);xe(e,...C9(o?`${o}ending`:"none"))}}function Vse(t){t===!0&&this.hot.view&&sc(xl,this,BS).call(this)}function Wse(t,e,n,i){pM(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function cl(t,e,n){return(e=Bse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bse(t){var e=jse(t,"string");return typeof e=="symbol"?e:e+""}function jse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Use{constructor(e,n){cl(this,"plugin",void 0),cl(this,"hot",void 0),cl(this,"endpoints",[]),cl(this,"settings",void 0),cl(this,"settingsType","array"),cl(this,"currentEndpoint",null),cl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),A(i,r=>{const s={};this.assignSetting(r,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(r,s,"reversedRowCoords",!1),this.assignSetting(r,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,s,"sourceColumn",r.destinationColumn),this.assignSetting(r,s,"type","sum"),this.assignSetting(r,s,"forceNumeric",!1),this.assignSetting(r,s,"suppressDataTypeErrors",!0),this.assignSetting(r,s,"customFunction",null),this.assignSetting(r,s,"readOnly",!0),this.assignSetting(r,s,"roundFloat",!1),n.push(s)}),n}assignSetting(e,n,i,r){if(i==="ranges"&&e[i]===void 0){n[i]=r;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(r instanceof Error)throw r;n[i]=r}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-e[i]-1:n[i]=e[i]}resetSetupBeforeStructureAlteration(e,n,i){if(this.settingsType!=="function")return;const r=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();A(s,o=>{r==="row"&&o.destinationRow>=n&&(e==="insert_row"?o.alterRowOffset=i:e==="remove_row"&&(o.alterRowOffset=-1*i)),r==="col"&&o.destinationColumn>=n&&(e==="insert_col"?o.alterColumnOffset=i:e==="remove_col"&&(o.alterColumnOffset=-1*i))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,n,i,r,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;A(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*i),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*i)}),this.resetAllEndpoints(u,!c),c?A(u,d=>{this.extendEndpointRanges(d,h,r[0],r.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):A(u,d=>{this.shiftEndpointCoordinates(d,h)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,i,r){A(e.ranges,s=>{s[1]&&(n>=s[0]&&n<=s[1]?i>s[1]?s[1]+=r:i<s[0]&&(s[0]-=r):i>=s[0]&&i<=s[1]&&(s[1]-=r,n<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,i=[],r=[];A(n,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));r.push(o)}),A(r,s=>{let o=[];A(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),i.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),i.push(o))})}),e.ranges=i}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,A(e.ranges,i=>{A(i,(r,s)=>{r>=n&&(i[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(r=>{const s=r.alterRowOffset||0,o=r.alterColumnOffset||0;return r.destinationRow+s>=this.hot.countRows()||r.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],A(e,r=>{this.resetEndpointValue(r,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],A(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],A(e,(i,r,s)=>{`${i[2]||""}`!=`${i[3]}`&&A(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[r][1])===o.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),A(n,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const i=this.hot.getCellMeta(n,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?i:0)),this.hot.toVisualColumn(e.destinationColumn+(n?r:0)),""])}setEndpointValue(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(n==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let a=0;Number.isInteger(o)&&(a=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(a)}i?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){vt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function My(t){return t==null||isNaN(t)}function Yse(t,e){zse(t,e),e.add(t)}function zse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gse(t,e,n){return(e=Kse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kse(t){var e=Xse(t,"string");return typeof e=="symbol"?e:e+""}function Xse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _y="columnSummary",qse=220;var Ih=new WeakSet;class Zse extends ut{constructor(){super(...arguments),Yse(this,Ih),Gse(this,"endpoints",null)}static get PLUGIN_KEY(){return _y}static get PLUGIN_PRIORITY(){return qse}isEnabled(){return!!this.hot.getSettings()[_y]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[_y],this.endpoints=new Use(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lm(Ih,e,Jse).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lm(Ih,e,eoe).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lm(Ih,e,Qse).call(e,...i)}),this.addHook("beforeCreateRow",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,i,null,r)),this.addHook("beforeCreateCol",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,i,null,r)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,i,null,r)),this.addHook("afterCreateCol",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,i,null,r)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lm(Ih,e,toe).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return ze(e.ranges,i=>{n+=this.getPartialSum(i,e.sourceColumn)}),n}getPartialSum(e,n){let i=0,r=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(r,n),s=My(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}i+=s||0,r-=1}while(r>=e[0]);return Math.round(i*10**o)/10**o}calculateMinMax(e,n){let i=null;return ze(e.ranges,r=>{const s=this.getPartialMinMax(r,e.sourceColumn,n);if(i===null&&s!==null&&(i=s),s!==null)switch(n){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}}),i===null?"Not enough data":i}getPartialMinMax(e,n,i){let r=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,n),o=My(o)?null:o,r===null)r=o;else if(o!==null)switch(i){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}s-=1}while(s>=e[0]);return r}countEmpty(e,n){let i,r=0,s=e[1]||e[0];do i=this.getCellValue(s,n),i=My(i)?null:i,i===null&&(r+=1),s-=1;while(s>=e[0]);return r}countEntries(e){let n=0;const i=e.ranges;return ze(i,r=>{const s=r[1]===void 0?1:r[1]-r[0]+1,o=this.countEmpty(r,e.sourceColumn);n+=s,n-=o}),n}calculateAverage(e){const n=this.calculateSum(e),i=this.countEntries(e);return n/i}getCellValue(e,n){const i=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(n);let s=this.hot.getSourceDataAtCell(e,n),o="";if(i!==null&&r!==null&&(o=this.hot.getCellMeta(i,r).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Ct`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function Jse(){this.endpoints.initEndpoints()}function Qse(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function eoe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function toe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function noe(t,e){ok(t,e),e.add(t)}function Oy(t,e,n){ok(t,e),e.set(t,n)}function ok(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oc(t,e){return t.get(wM(t,e))}function jS(t,e,n){return t.set(wM(t,e),n),n}function wM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rw=new WeakMap,um=new WeakMap,cm=new WeakMap,ZP=new WeakSet;class ak{constructor(){noe(this,ZP),Oy(this,rw,!0),Oy(this,um,null),Oy(this,cm,new ResizeObserver(e=>wM(ZP,this,ioe).call(this,e)))}setObservedElement(e){jS(um,this,e)}unobserve(){oc(cm,this).unobserve(oc(um,this))}observe(){jS(rw,this,!0),oc(cm,this).observe(oc(um,this))}destroy(){oc(cm,this).disconnect()}}function ioe(t){if(oc(rw,this)||!Array.isArray(t)||!t.length){jS(rw,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:i,blockSize:r}=n[0];this.runLocalHooks("resize",i,r)})}yt(ak,Fn);function hl(t,e,n){roe(t,e),e.set(t,n)}function roe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Et(t,e){return t.get(lk(t,e))}function eo(t,e,n){return t.set(lk(t,e),n),n}function lk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dl=new WeakMap,Py=new WeakMap,to=new WeakMap,fl=new WeakMap,Go=new WeakMap,hm=new WeakMap,ku=new WeakMap;class $l{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var i=this;hl(this,dl,void 0),hl(this,Py,!1),hl(this,to,null),hl(this,fl,void 0),hl(this,Go,void 0),hl(this,hm,!0),hl(this,ku,new ak),eo(dl,this,e),eo(Py,this,n),eo(fl,this,this.createEditor()),eo(Go,this,Et(fl,this).style),Et(ku,this).setObservedElement(this.getInputElement()),Et(ku,this).addLocalHook("resize",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){Et(Go,this).left=`${e}px`,Et(Go,this).top=`${n}px`}setSize(e,n){if(e&&n){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${n}px`}}getSize(){return{width:At(this.getInputElement()),height:sn(this.getInputElement())}}observeSize(){Et(ku,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){Et(Go,this).display="block",eo(hm,this,!1)}hide(){Et(ku,this).unobserve(),Et(hm,this)||(Et(Go,this).display="none"),eo(hm,this,!0)}isVisible(){return Et(Go,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return Et(dl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=Et(dl,this).createElement("div"),n=Et(dl,this).createElement("textarea");return e.style.display="none",eo(to,this,Et(dl,this).createElement("div")),Et(to,this).setAttribute("dir",Et(Py,this)?"rtl":"ltr"),ie(Et(to,this),$l.CLASS_EDITOR_CONTAINER),Et(dl,this).body.appendChild(Et(to,this)),ie(e,$l.CLASS_EDITOR),ie(n,$l.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),Et(to,this).appendChild(e),e}getInputElement(){return Et(fl,this).querySelector(`.${$l.CLASS_INPUT}`)}destroy(){const e=Et(to,this)?Et(to,this).parentNode:null;Et(fl,this).parentNode.removeChild(Et(fl,this)),eo(fl,this,null),eo(Go,this,null),Et(ku,this).destroy(),e&&e.removeChild(Et(to,this))}}yt($l,Fn);function Iy(t,e,n){return(e=soe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function soe(t){var e=ooe(t,"string");return typeof e=="symbol"?e:e+""}function ooe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const aoe=250,loe=250;class uk{constructor(e){Iy(this,"wasLastActionShow",!0),Iy(this,"showDebounced",null),Iy(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},loe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:aoe;this.showDebounced=fv(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}yt(uk,Fn);function uoe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function coe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function gl(t,e){const n={};return A(t,i=>{i.forAll((r,s)=>{r>=0&&s>=0&&(n[r]||(n[r]=[]),n[r][s]=e(r,s))})}),n}function sa(t,e,n,i,r){A(t,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&hoe(o,a,e,n,i,r)})})}function hoe(t,e,n,i,r,s){const o=r(t,e);let a=i;o.className&&(n==="vertical"?a=uoe(o.className,i):a=coe(o.className,i)),s(t,e,"className",a)}function ho(t){return`<span class="selected">✓</span>${t}`}function Rs(t,e){let n=!1;return Array.isArray(t)&&A(t,i=>(i.forAll((r,s)=>{if(r>=0&&s>=0&&e(r,s))return n=!0,!1}),n)),n}function Av(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:r,left:s}=i.getBoundingClientRect();n.top=r,n.left=s}return n}const Ke="---------";function doe(){return{name:Ke}}const er="alignment";function foe(){return{key:er,name(){return this.getTranslatedPhrase(XE)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${er}:left`,name(){let t=this.getTranslatedPhrase(qE);return Rs(this.getSelectedRange(),(n,i)=>{const r=this.getCellMeta(n,i).className;if(r&&r.indexOf("htLeft")!==-1)return!0})&&(t=ho(t)),t},callback(){const t=this.getSelectedRange(),e=gl(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,n,i),sa(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${er}:center`,name(){let t=this.getTranslatedPhrase(ZE);return Rs(this.getSelectedRange(),(n,i)=>{const r=this.getCellMeta(n,i).className;if(r&&r.indexOf("htCenter")!==-1)return!0})&&(t=ho(t)),t},callback(){const t=this.getSelectedRange(),e=gl(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,n,i),sa(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${er}:right`,name(){let t=this.getTranslatedPhrase(JE);return Rs(this.getSelectedRange(),(n,i)=>{const r=this.getCellMeta(n,i).className;if(r&&r.indexOf("htRight")!==-1)return!0})&&(t=ho(t)),t},callback(){const t=this.getSelectedRange(),e=gl(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,n,i),sa(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${er}:justify`,name(){let t=this.getTranslatedPhrase(QE);return Rs(this.getSelectedRange(),(n,i)=>{const r=this.getCellMeta(n,i).className;if(r&&r.indexOf("htJustify")!==-1)return!0})&&(t=ho(t)),t},callback(){const t=this.getSelectedRange(),e=gl(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,n,i),sa(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{name:Ke},{key:`${er}:top`,name(){let t=this.getTranslatedPhrase(eT);return Rs(this.getSelectedRange(),(n,i)=>{const r=this.getCellMeta(n,i).className;if(r&&r.indexOf("htTop")!==-1)return!0})&&(t=ho(t)),t},callback(){const t=this.getSelectedRange(),e=gl(t,(r,s)=>this.getCellMeta(r,s).className),n="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,n,i),sa(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${er}:middle`,name(){let t=this.getTranslatedPhrase(tT);return Rs(this.getSelectedRange(),(n,i)=>{const r=this.getCellMeta(n,i).className;if(r&&r.indexOf("htMiddle")!==-1)return!0})&&(t=ho(t)),t},callback(){const t=this.getSelectedRange(),e=gl(t,(r,s)=>this.getCellMeta(r,s).className),n="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,i),sa(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${er}:bottom`,name(){let t=this.getTranslatedPhrase(nT);return Rs(this.getSelectedRange(),(n,i)=>{const r=this.getCellMeta(n,i).className;if(r&&r.indexOf("htBottom")!==-1)return!0})&&(t=ho(t)),t},callback(){const t=this.getSelectedRange(),e=gl(t,(r,s)=>this.getCellMeta(r,s).className),n="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,n,i),sa(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1}]}}}const Hv="clear_column";function goe(){return{key:Hv,name(){return this.getTranslatedPhrase(DE)},callback(t,e){const n=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const zf="col_left";function moe(){return{key:zf,name(){return this.getTranslatedPhrase(OE)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Gf="col_right";function poe(){return{key:Gf,name(){return this.getTranslatedPhrase(PE)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Kf="make_read_only";function woe(){return{key:Kf,name(){let t=this.getTranslatedPhrase(NE);return Rs(this.getSelectedRange(),(n,i)=>this.getCellMeta(n,i).readOnly)&&(t=ho(t)),t},callback(){const t=this.getSelectedRange(),e=Rs(t,(n,i)=>this.getCellMeta(n,i).readOnly);A(t,n=>{n.forAll((i,r)=>{i>=0&&r>=0&&this.setCellMeta(i,r,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Nv="redo";function voe(){return{key:Nv,name(){return this.getTranslatedPhrase(HE)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Xf="remove_col";function Coe(){return{key:Xf,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(xE,e)},callback(){this.alter("remove_col",lee(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Dv="remove_row";function yoe(){return{key:Dv,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(IE,e)},callback(){this.alter("remove_row",uee(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Lv="row_above";function boe(){return{key:Lv,name(){return this.getTranslatedPhrase(ME)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const kv="row_below";function Soe(){return{key:kv,name(){return this.getTranslatedPhrase(_E)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const hf="no_items";function Roe(){return{key:hf,name(){return this.getTranslatedPhrase(TE)},disabled:!0,isCommand:!1}}const $v="undo";function Eoe(){return{key:$v,name(){return this.getTranslatedPhrase(AE)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Toe=[Lv,kv,zf,Gf,Hv,Dv,Xf,$v,Nv,Kf,er,Ke,hf],Moe={[Ke]:doe,[hf]:Roe,[Lv]:boe,[kv]:Soe,[zf]:moe,[Gf]:poe,[Hv]:goe,[Dv]:yoe,[Xf]:Coe,[$v]:Eoe,[Nv]:voe,[Kf]:woe,[er]:foe};function ck(){const t={};return ze(Moe,(e,n)=>{t[n]=e()}),t}function _oe(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(zE):this.getTranslatedPhrase(YE)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Ooe(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(GE)},callback(){this.getSelectedRangeLast().forAll((n,i)=>{n>=0&&i>=0&&t.removeCommentAtCell(n,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Poe(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(KE);return Rs(this.getSelectedRange(),(i,r)=>t.getCommentMeta(i,r,mp))?ho(e):e},callback(){this.getSelectedRangeLast().forAll((n,i)=>{if(n>=0&&i>=0){const r=!!t.getCommentMeta(n,i,mp);t.updateCommentMeta(n,i,{[mp]:!r})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Ioe(t,e){hk(t,e),e.add(t)}function $u(t,e,n){hk(t,e),e.set(t,n)}function hk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xoe(t,e,n){return(e=Aoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aoe(t){var e=Hoe(t,"string");return typeof e=="symbol"?e:e+""}function Hoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sa(t,e,n){return t.set(Or(t,e),n),n}function et(t,e){return t.get(Or(t,e))}function Or(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Od="comments",Noe=60,fo="comment",ad="value",dk="style",mp="readOnly",dm=Od,US=`plugin:${Od}`;var Mt=new WeakMap,vs=new WeakMap,Fv=new WeakMap,pp=new WeakMap,YS=new WeakMap,sw=new WeakMap,rs=new WeakSet;class Doe extends ut{constructor(){super(...arguments),Ioe(this,rs),xoe(this,"range",{}),$u(this,Mt,null),$u(this,vs,null),$u(this,Fv,!1),$u(this,pp,!1),$u(this,YS,null),$u(this,sw,"")}static get PLUGIN_KEY(){return Od}static get PLUGIN_PRIORITY(){return Noe}isEnabled(){return!!this.hot.getSettings()[Od]}enablePlugin(){var e=this;this.enabled||(et(Mt,this)||(Sa(Mt,this,new $l(this.hot.rootDocument,this.hot.isRtl())),et(Mt,this).addLocalHook("resize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Or(rs,e,Boe).call(e,...i)})),et(vs,this)||Sa(vs,this,new uk(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,i,r,s,o,a)=>Or(rs,this,Foe).call(this,n,a)),this.addHook("afterScroll",()=>Or(rs,this,Uoe).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Or(rs,this,joe).call(this,n)),et(vs,this).addLocalHook("hide",()=>this.hide()),et(vs,this).addLocalHook("show",(n,i)=>this.showAtCell(n,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){et(vs,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),i=e.addContext(US);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const r=this.hot.getSelectedRangeLast();Sa(pp,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(r),this.show(),this.focusEditor(),e.setActiveContextName(US),this.hot._registerTimeout(()=>{Sa(pp,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var r;return((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isCell())&&!et(Mt,this).isVisible()},group:dm}),i.addShortcut({keys:[["Escape"]],callback:()=>{et(Mt,this).setValue(et(sw,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>et(Mt,this).isVisible()&&et(Mt,this).isFocused(),group:dm}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>et(Mt,this).isVisible()&&et(Mt,this).isFocused(),group:dm})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dm)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>Or(rs,this,koe).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Or(rs,this,Loe).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Or(rs,this,$oe).call(this)),this.eventManager.addEventListener(n,"focus",()=>Or(rs,this,Woe).call(this)),this.eventManager.addEventListener(n,"blur",()=>Or(rs,this,Voe).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Aa(e.target,"TD","TBODY");return!!(n&&De(n,"htCommentCell")&&Aa(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=et(Mt,this).getValue();let i="";e!=null?i=e:n!=null&&(i=n);const r=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(r,s,{[ad]:i}),this.hot.render()}setCommentAtCell(e,n,i){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,fo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(i)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,ad)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,ad)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:i}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return et(vs,this).cancelHiding(),et(Mt,this).setValue((e=r[fo]?r[fo][ad]:null)!==null&&e!==void 0?e:""),et(Mt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){et(Mt,this).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!et(Mt,this).isVisible()))return;const{rowIndexMapper:r,columnIndexMapper:s}=this.hot,{row:o,col:a}=this.range.from;let l=r.getRenderableFromVisualIndex(o),u=s.getRenderableFromVisualIndex(a);const c=l===null;et(Mt,this).setPosition(0,0),l===null&&(l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1))),u===null&&(u=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1)));const h=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:f,view:{_wt:m}}=this.hot,{wtTable:p}=m,y=m.getCell({row:l,col:u},!0),E=this.getCommentMeta(o,a,dk);E?et(Mt,this).setSize(E.width,E.height):et(Mt,this).resetSize();const T=d?0:p.getStretchedColumnWidth(u),M=c&&!h?sn(y):0,{left:P,top:H,width:U,height:Y}=y.getBoundingClientRect(),{width:Q,height:q}=et(Mt,this).getSize(),{innerWidth:Z,innerHeight:te}=this.hot.rootWindow,ue=this.hot.rootDocument.documentElement;let ce=P+f.scrollX+T,Ee=H+f.scrollY+M;this.hot.isRtl()&&(ce-=Q+T),this.hot.isLtr()&&P+U+Q>Z?ce=P+f.scrollX-Q-1:this.hot.isRtl()&&ce<-(ue.scrollWidth-ue.clientWidth)&&(ce=P+f.scrollX+T+1),H+q>te&&(Ee-=q-Y+1),et(Mt,this).setPosition(ce,Ee),et(Mt,this).setReadOnlyState(this.getCommentMeta(o,a,mp)),et(Mt,this).observeSize()}focusEditor(){et(Mt,this).focus()}updateCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n)[fo];let s;r?(s=Jn(r),$f(s,i)):s=i,this.hot.setCellMeta(e,n,fo,s)}getCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n);if(r[fo])return r[fo][i]}addToContextMenu(e){e.items.push({name:Ke},_oe(this),Ooe(this),Poe(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Od];if(Ye(e))return e.displayDelay}getEditorInputElement(){return et(Mt,this).getInputElement()}destroy(){var e,n;(e=et(Mt,this))===null||e===void 0||e.destroy(),(n=et(vs,this))===null||n===void 0||n.destroy(),super.destroy()}}function Loe(t){if(!(!this.hot.view||!this.hot.view._wt)&&!et(Fv,this)&&!this.targetIsCommentTextArea(t)){const e=Aa(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function koe(t){const{rootDocument:e}=this.hot;if(!(et(Fv,this)||et(Mt,this).isFocused()||De(t.target,"wtBorder")||et(YS,this)===t.target||!et(Mt,this)))if(Sa(YS,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));et(vs,this).show(n)}else Ma(t.target,e)&&!this.targetIsCommentTextArea(t)&&et(vs,this).hide()}function $oe(){Sa(Fv,this,!1)}function Foe(t,e){e[fo]&&e[fo][ad]&&ie(t,e.commentedCellClassName)}function Voe(){Sa(sw,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Woe(){Sa(sw,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(US)}function Boe(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[dk]:{width:t,height:e}})}function joe(t){et(Mt,this).isVisible()&&gr(t)}function Uoe(){et(pp,this)||this.hide()}var JP=zw,Yoe=TypeError,zoe=function(t,e){if(!delete t[e])throw new Yoe("Cannot delete property "+JP(e)+" of "+JP(t))},Goe=$n,Koe=Ef,Xoe=_f,qoe=yH,Zoe=zoe,Joe=bH,Qoe=[].unshift(0)!==1,eae=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},tae=Qoe||!eae();Goe({target:"Array",proto:!0,arity:1,forced:tae},{unshift:function(e){var n=Koe(this),i=Xoe(n),r=arguments.length;if(r){Joe(i+r);for(var s=i;s--;){var o=s+r;s in n?n[o]=n[s]:Zoe(n,o)}for(var a=0;a<r;a++)n[a]=arguments[a]}return qoe(n,i+r)}});function xy(t,e,n){return(e=nae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nae(t){var e=iae(t,"string");return typeof e=="symbol"?e:e+""}function iae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fk{constructor(e){xy(this,"hot",void 0),xy(this,"commands",{}),xy(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=rae(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Ut(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),i.unshift(s.join(":")),A(u,c=>c.apply(this.hot,i))}}function rae(t,e){let n;return A(e,i=>{const r=i.key?i.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=i,!1}),n}function Ay(t,e,n){return(e=sae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sae(t){var e=oae(t,"string");return typeof e=="symbol"?e:e+""}function oae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gk{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Ay(this,"hot",void 0),Ay(this,"predefinedItems",ck()),Ay(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,ze(e,(i,r)=>{let s="";i.name===Ke?(n[Ke]=i,s=Ke):isNaN(parseInt(r,10))?(i.key=i.key===void 0?r:i.key,n[r]=i,s=i.key):(n[i.key]=i,s=i.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return aae(e,this.defaultOrderPattern,this.predefinedItems)}}function aae(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let r=t;return r&&r.items?r=r.items:Array.isArray(r)||(r=e),Ye(r)?ze(r,(s,o)=>{let a=n[typeof s=="string"?s:o];a||(a=s),Ye(s)?un(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),i.push(a)}):A(r,(s,o)=>{let a=n[s];!a&&Toe.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),Ye(s)&&un(a,s),a.key===void 0&&(a.key=o),i.push(a))}),i}function Ko(t,e,n){return(e=lae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lae(t){var e=uae(t,"string");return typeof e=="symbol"?e:e+""}function uae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cae{constructor(e,n){Ko(this,"top",void 0),Ko(this,"topRelative",void 0),Ko(this,"left",void 0),Ko(this,"leftRelative",void 0),Ko(this,"scrollTop",void 0),Ko(this,"scrollLeft",void 0),Ko(this,"cellHeight",void 0),Ko(this,"cellWidth",void 0);const i=n.scrollY,r=n.scrollX;let s,o,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,o=s,l=a,s+=i,a+=r):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,o=s-i,l=a-r),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=i,this.scrollLeft=r,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function xh(t,e,n){hae(t,e),e.set(t,n)}function hae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qe(t,e){return t.get(mk(t,e))}function fm(t,e,n){return t.set(mk(t,e),n),n}function mk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ei=new WeakMap,Xo=new WeakMap,Hn=new WeakMap,Hy=new WeakMap,Fu=new WeakMap;class dae{constructor(e){xh(this,ei,void 0),xh(this,Xo,void 0),xh(this,Hn,void 0),xh(this,Hy,!1),xh(this,Fu,{above:0,below:0,left:0,right:0}),fm(Hy,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return qe(Fu,this)[e]=n,this}setElement(e){return fm(ei,this,e),this}setParentElement(e){return fm(Xo,this,e),this}updatePosition(e){fm(Hn,this,new cae(e,qe(ei,this).ownerDocument.defaultView)),qe(Hy,this)?(qe(Hn,this).fitsBelow(qe(ei,this))?this.setPositionBelowCursor():qe(Hn,this).fitsAbove(qe(ei,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){qe(ei,this).dir==="rtl"?qe(Hn,this).fitsOnLeft(qe(ei,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():qe(Hn,this).fitsOnRight(qe(ei,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=qe(Fu,this).above+qe(Hn,this).top-qe(ei,this).offsetHeight;qe(Xo,this)&&(e=qe(Hn,this).top+qe(Hn,this).cellHeight-qe(ei,this).offsetHeight+3),qe(ei,this).style.top=`${e}px`}setPositionBelowCursor(){let e=qe(Fu,this).below+qe(Hn,this).top+1;qe(Xo,this)&&(e=qe(Hn,this).top-1),qe(ei,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=qe(Hn,this).left;if(qe(Xo,this)){const{right:n}=qe(Xo,this).getBoundingClientRect();e+=qe(Hn,this).cellWidth+n-(qe(Hn,this).left+qe(Hn,this).cellWidth)}else e+=qe(Fu,this).right;qe(ei,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=qe(Fu,this).left+qe(Hn,this).left-qe(ei,this).offsetWidth;if(qe(Xo,this)){const{left:n}=qe(Xo,this).getBoundingClientRect();e-=qe(Hn,this).left-n}qe(ei,this).style.left=`${e}px`}}function pk(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:i=()=>{},onClear:r=()=>{}}=t;const s=new Set;let o=pt(e,-1,m()-1);function a(y,E){const T=m()-1;return y<0&&(y=T),y>T&&(y=0),s.has(y)?-1:(s.add(y),i(y,!1)===!1&&(y=a(E===1?++y:--y,E)),y)}function l(y){y>-1&&y<m()&&i(y,!0)!==!1&&(o=y)}function u(){return o}function c(){m()>0&&(s.clear(),o=a(0,1))}function h(){m()>0&&(s.clear(),o=a(m()-1,-1))}function d(){m()>0&&(s.clear(),o=a(++o,1))}function f(){m()>0&&(s.clear(),o=a(--o,-1))}function m(){return Math.max(n(),0)}function p(){s.clear(),o=e,r()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:m,clear:p}}function fae(t){return tt(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function zS(t){return Ut(t,"submenu")}function GS(t){return new RegExp(Ke,"i").test(t.name)}function wp(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function QP(t){return Ut(t,"disableSelection")}function gae(t){return De(t,"htSeparator")}function mae(t){return De(t,"htSubmenu")}function pae(t){return De(t,"htDisabled")}function wae(t){return De(t,"htSelectionDisabled")}function vae(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function wk(t,e){const n=t.slice(0);for(let i=0;i<n.length&&n[i].name===e;)n.shift();return n}function Cae(t,e){let n=t.slice(0);return n.reverse(),n=wk(n,e),n.reverse(),n}function yae(t){const e=[];return A(t,(n,i)=>{i>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function bae(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ke,n=t.slice(0);return n=wk(n,e),n=Cae(n,e),n=yae(n),n}function Sae(t){return pk({size:()=>t.countRows(),onItemSelect(e,n){const i=t.getCell(e,0);if(!i||gae(i)||pae(i)||wae(i))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Rae(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(i):s.tabMoves;r.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const i=n.getSelectedLast();if(i){const r=t.openSubMenu(i[0]);r&&r.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const r=n.getSelectedLast();r&&(n.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const vk="menu",eI=vk;function Eae(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];i(Rae(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;r(c,h)});function i(u,c){a(c).addShortcuts(u,{group:vk})}function r(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>h.removeShortcutsByKeys(m))}),n.push({shortcuts:u,contextName:c}),i(u,c)}function s(){return[...n]}function o(u){return u?`${eI}:${u}`:eI}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=o(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(o(u))}return{addCustomShortcuts:r,getCustomShortcuts:s,getContext:a,listen:l}}function Tae(t){return(e,n,i,r,s,o)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(i),l=t.rootDocument.createElement("div"),u=typeof o=="function"?o.call(t):o;if(Br(n),ie(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!wp(a,t)&&!QP(a)&&!GS(a);xe(n,[c9(),_0(u),...c?[Wc(-1)]:[],...wp(a,t)?[w9()]:[],...zS(a)?[lr(!1)]:[]])}n.className="",n.appendChild(l),GS(a)?ie(n,"htSeparator"):typeof a.renderer=="function"?(ie(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,i,r,s,u))):hu(l,u),wp(a,t)?ie(n,"htDisabled"):QP(a)?ie(n,"htSelectionDisabled"):zS(a)&&ie(n,"htSubmenu")}}function tI(t,e,n){Mae(t,e),e.set(t,n)}function Mae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ss(t,e,n){return(e=_ae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ae(t){var e=Oae(t,"string");return typeof e=="symbol"?e:e+""}function Oae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nI(t,e,n){return t.set(Ck(t,e),n),n}function Ah(t,e){return t.get(Ck(t,e))}function Ck(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const iI=215;var Hh=new WeakMap,gm=new WeakMap;class Gc{constructor(e,n){var i=this;ss(this,"hot",void 0),ss(this,"options",void 0),ss(this,"eventManager",new hr(this)),ss(this,"container",void 0),ss(this,"positioner",void 0),ss(this,"hotMenu",null),ss(this,"hotSubMenus",{}),ss(this,"parentMenu",void 0),ss(this,"menuItems",null),ss(this,"origOutsideClickDeselects",null),tI(this,Hh,void 0),tI(this,gm,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:iI,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new dae(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.parentMenu.runLocalHooks("afterSelectionChange",...s)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Gl(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Ah(Hh,this)}getKeyboardShortcutsCtrl(){return Ah(gm,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=fv(a=>this.openSubMenu(a),300),n=this.options.minWidth||iI;let i=!1,r=Ao(this.menuItems,a=>(a.key===hf&&(i=!0),vae(a,this.hot)));if(r.length<1&&!i)r.push(ck()[hf]);else if(r.length===0)return;r=bae(r,Ke);let s=!1;const o={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return Se(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Tae(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Ah(Hh,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>r[a].name===Ke?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),SS()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!SS()||!Na(a))&&s&&this.hasSelectedItem()&&(bo()||j0()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),nI(Hh,this,Sae(this.hotMenu)),nI(gm,this,Eae(this)),Ah(gm,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Ah(Hh,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const i=this.parentMenu.hotMenu.getCell(n[0],0);xe(i,[lr(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!mae(n))return!1;const i=this.hotMenu.getSourceDataAtRow(e),r=new Gc(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&xe(n,[lr(!0)]),r}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[n.key];if(i){i.destroy(),delete this.hotSubMenus[n.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&xe(r,[lr(!1)])}}closeAllSubMenus(){A(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const i=this.hot.getSelectedRange(),r=i?fae(i):[];this.runLocalHooks("executeCommand",n.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,r,e)}isCommandPassive(e){return e.isCommand===!1||GS(e)||wp(e,this.hot)||zS(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let i=e,r;return i&&(Pt(i)&&(i=i.call(this.hot),i===null||xt(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,r=n.querySelector(`.${this.options.className}.${i}`)),r||(r=n.createElement("div"),ie(r,`htMenu ${this.options.className}`),i&&ie(r,i),this.options.container.appendChild(r)),r}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,i=e.hider.style,r=e.holder.style,s=parseInt(i.width,10),o=cn(n,(a,l)=>a+(l.name===Ke?1:26),0);r.width=`${s+3}px`,r.height=`${o+3}px`,i.height=r.height,this.hot.getSettings().ariaTags&&xe(this.hotMenu.rootElement,[u9(),Wc(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Ma(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Ma(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&De(e.target,"htCore")&&Ma(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}yt(Gc,Fn);function Pae(t,e){Iae(t,e),e.add(t)}function Iae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ny(t,e,n){return(e=xae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xae(t){var e=Aae(t,"string");return typeof e=="symbol"?e:e+""}function Aae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ld="contextMenu",Hae=70,rI=ld;ye.getSingleton().register("afterContextMenuDefaultOptions");ye.getSingleton().register("beforeContextMenuShow");ye.getSingleton().register("afterContextMenuShow");ye.getSingleton().register("afterContextMenuHide");ye.getSingleton().register("afterContextMenuExecute");var Nh=new WeakSet;class Vv extends ut{constructor(){super(...arguments),Pae(this,Nh),Ny(this,"commandExecutor",new fk(this.hot)),Ny(this,"itemsFactory",null),Ny(this,"menu",null)}static get PLUGIN_KEY(){return ld}static get PLUGIN_PRIORITY(){return Hae}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Lv,kv,Ke,zf,Gf,Ke,Dv,Xf,Ke,$v,Nv,Ke,Kf,Ke,er]}isEnabled(){return!!this.hot.getSettings()[ld]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[ld];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Gc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>mm(Nh,this,Dae).call(this)),this.menu.addLocalHook("afterOpen",()=>mm(Nh,this,Lae).call(this)),this.menu.addLocalHook("afterClose",()=>mm(Nh,this,kae).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return e.executeCommand.call(e,...r)}),this.addHook("afterOnCellContextMenu",i=>mm(Nh,this,Nae).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=Av(this.menu.container,this.hot.rootDocument);this.open({left:n.left+i.left,top:n.top+i.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:rI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rI)}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),ze(i,(r,s)=>{this.menu.setOffset(s,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new gk(this.hot,Vv.DEFAULT_ITEMS);const e=this.hot.getSettings()[ld],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),A(i,r=>this.commandExecutor.registerCommand(r.key,r))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Nae(t){const e=this.hot.getSettings(),n=e.rowHeaders,i=e.colHeaders;function r(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),De(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||i)&&!r(s)&&!(De(s,"current")&&De(s,"wtBorder"))))return;const o=Av(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function Dae(){this.hot.runHooks("beforeContextMenuShow",this)}function Lae(){this.hot.runHooks("afterContextMenuShow",this)}function kae(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Vv.SEPARATOR={name:Ke};function $ae(t){return{key:"copy",name(){return this.getTranslatedPhrase(LE)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Fae(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?pt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(FE,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Vae(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?pt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase($E,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Wae(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?pt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(kE,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Bae(t){return{key:"cut",name(){return this.getTranslatedPhrase(VE)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class jae{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class Uae{constructor(){this.clipboardData=new jae}preventDefault(){}}function Yae(t,e){yk(t,e),e.add(t)}function Vu(t,e,n){yk(t,e),e.set(t,n)}function yk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ri(t,e){return t.get(dc(t,e))}function Wu(t,e,n){return t.set(dc(t,e),n),n}function dc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qo=new WeakMap,Dy=new WeakMap,Dh=new WeakMap,KS=new WeakMap,XS=new WeakMap,Lh=new WeakMap,kh=new WeakSet;class zae{constructor(e){let{countRows:n,countColumns:i,rowsLimit:r,columnsLimit:s,countColumnHeaders:o}=e;Yae(this,kh),Vu(this,qo,void 0),Vu(this,Dy,void 0),Vu(this,Dh,void 0),Vu(this,KS,void 0),Vu(this,XS,void 0),Vu(this,Lh,void 0),Wu(Dy,this,n),Wu(Dh,this,i),Wu(KS,this,r),Wu(XS,this,s),Wu(Lh,this,o)}setSelectedRange(e){Wu(qo,this,e)}getCellsRange(){if(ri(Dy,this).call(this)===0||ri(Dh,this).call(this)===0)return null;const{row:e,col:n}=ri(qo,this).getTopStartCorner(),{row:i,col:r}=ri(qo,this).getBottomEndCorner(),s=dc(kh,this,Gae).call(this,e,i),o=dc(kh,this,Ly).call(this,n,r);return{isRangeTrimmed:i!==s||r!==o,startRow:e,startCol:n,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(ri(Dh,this).call(this)===0||ri(Lh,this).call(this)===0)return null;const{col:e}=ri(qo,this).getTopStartCorner(),{col:n}=ri(qo,this).getBottomEndCorner(),i=dc(kh,this,Ly).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(ri(Dh,this).call(this)===0||ri(Lh,this).call(this)===0)return null;const{col:e}=ri(qo,this).getTopStartCorner(),{col:n}=ri(qo,this).getBottomEndCorner(),i=dc(kh,this,Ly).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-ri(Lh,this).call(this),startCol:e,endRow:-1,endCol:i}}}function Ly(t,e){return Math.min(e,Math.max(t+ri(XS,this).call(this)-1,t))}function Gae(t,e){return Math.min(e,Math.max(t+ri(KS,this).call(this)-1,t))}function bk(t){const e=[],n=[];return A(t,i=>{const r=Math.min(i.startRow,i.endRow),s=Math.max(i.startRow,i.endRow);_e(r,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(i.startCol,i.endCol),a=Math.max(i.startCol,i.endCol);_e(o,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Kae(t,e){Sk(t,e),e.add(t)}function Zo(t,e,n){Sk(t,e),e.set(t,n)}function Sk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $h(t,e,n){return(e=Xae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xae(t){var e=qae(t,"string");return typeof e=="symbol"?e:e+""}function qae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Si(t,e){return t.get(Ri(t,e))}function _r(t,e,n){return t.set(Ri(t,e),n),n}function Ri(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ye.getSingleton().register("afterCopyLimit");ye.getSingleton().register("modifyCopyableRange");ye.getSingleton().register("beforeCut");ye.getSingleton().register("afterCut");ye.getSingleton().register("beforePaste");ye.getSingleton().register("afterPaste");ye.getSingleton().register("beforeCopy");ye.getSingleton().register("afterCopy");const pm="copyPaste",Zae=80,Jae=["fragmentSelection"],sI=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var qS=new WeakMap,ZS=new WeakMap,JS=new WeakMap,Bu=new WeakMap,wm=new WeakMap,vm=new WeakMap,ju=new WeakMap,ow=new WeakMap,Hi=new WeakSet;class Qae extends ut{constructor(){super(...arguments),Kae(this,Hi),$h(this,"columnsLimit",1/0),$h(this,"rowsLimit",1/0),$h(this,"pasteMode","overwrite"),$h(this,"uiContainer",this.hot.rootDocument.body),Zo(this,qS,!1),Zo(this,ZS,!1),Zo(this,JS,!1),Zo(this,Bu,"cells-only"),Zo(this,wm,!1),Zo(this,vm,!1),Zo(this,ju,new zae({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Zo(this,ow,!1),$h(this,"copyableRanges",[])}static get PLUGIN_KEY(){return pm}static get SETTING_KEYS(){return[pm,...Jae]}static get PLUGIN_PRIORITY(){return Zae}isEnabled(){return!!this.hot.getSettings()[pm]}enablePlugin(){var e=this;if(this.enabled)return;const{[pm]:n}=this.hot.getSettings();if(typeof n=="object"){var i,r;this.pasteMode=(i=n.pasteMode)!==null&&i!==void 0?i:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,_r(qS,this,!!n.copyColumnHeaders),_r(ZS,this,!!n.copyColumnGroupHeaders),_r(JS,this,!!n.copyColumnHeadersOnly),this.uiContainer=(r=n.uiContainer)!==null&&r!==void 0?r:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",s=>Ri(Hi,this,nle).call(this,s)),this.addHook("afterSelection",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return Ri(Hi,e,ile).call(e,...o)}),this.addHook("afterSelectionEnd",()=>Ri(Hi,this,rle).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),W0()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return Ri(Hi,e,sle).call(e,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return Ri(Hi,e,ole).call(e,...o)}),this.addHook("afterSelection",()=>Ri(Hi,this,ale).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";_r(Bu,this,e),_r(wm,this,!0),Ri(Hi,this,oI).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){_r(vm,this,!0),Ri(Hi,this,oI).call(this,"cut")}getRangedCopyableData(e){return Td(this.getRangedData(e))}getRangedData(e){const n=[],{rows:i,columns:r}=bk(e);return A(i,s=>{const o=[];A(r,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),n.push(o)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const i=new Uae;e&&i.clipboardData.setData("text/plain",e),n&&i.clipboardData.setData("text/html",n),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Si(ju,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Si(Bu,this)==="column-headers-only"?n.set("headers",Si(ju,this).getMostBottomColumnHeadersRange()):(Si(Bu,this)==="with-column-headers"?n.set("headers",Si(ju,this).getMostBottomColumnHeadersRange()):Si(Bu,this)==="with-column-group-headers"&&n.set("headers",Si(ju,this).getAllColumnHeadersRange()),n.set("cells",Si(ju,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(r=>r!==null).map(r=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=r;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=n.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:r,startCol:s,endRow:o,endCol:a}=i;this.hot.runHooks("afterCopyLimit",o-r+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,r=e[0].length,s=[],{row:o,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=o,h=a,d=o,f=a;for(;s.length<i||c<=l;){const{skipRowOnPaste:m,visualRow:p}=this.hot.getCellMeta(c,a);if(c=p+1,m===!0)continue;d=p,h=a;const y=[],E=s.length%i;for(;y.length<r||h<=u;){const{skipColumnOnPaste:T,visualCol:M}=this.hot.getCellMeta(o,h);if(h=M+1,T===!0)continue;f=M;const P=y.length%r;y.push(e[E][P])}s.push(y)}return _r(ow,this,!0),this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,d,f]}onCopy(e){if(!this.hot.isListening()&&!Si(wm,this)||this.isEditorOpened()||!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body)return;this.setCopyableText(),_r(wm,this,!1);const n=this.getRangedData(this.copyableRanges),i=Ri(Hi,this,ele).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,i)){const s=Td(n);if(e&&e.clipboardData){const o=IS(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",s),e.clipboardData.setData("text/html",[sI,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",n,this.copyableRanges,i)}_r(Bu,this,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!Si(vm,this)||this.isEditorOpened()||!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body)return;this.setCopyableText(),_r(vm,this,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const r=Td(n);if(e&&e.clipboardData){const s=IS(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[sI,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body)return;e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=av(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=_D(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=gee(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[i,r,s,o]=this.populateValues(n);this.hot.selectCell(i,r,Math.min(this.hot.countRows()-1,s),Math.min(this.hot.countCols()-1,o)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function oI(t){if(W0()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:i}=e.highlight,r=this.hot.getCell(n,i,!0);r&&eD(r,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function ele(t){const{rows:e}=bk(t);let n=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function tle(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i&&L0(i)}}}function Rk(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i!=null&&i.hasAttribute("contenteditable")&&k0(i)}}}function nle(t){t.items.push({name:"---------"},$ae(this)),Si(qS,this)&&t.items.push(Wae(this)),Si(ZS,this)&&t.items.push(Vae(this)),Si(JS,this)&&t.items.push(Fae(this)),t.items.push(Bae(this))}function ile(t,e,n,i,r){Si(ow,this)&&(r.value=!0),_r(ow,this,!1)}function rle(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function sle(){Ri(Hi,this,Rk).call(this)}function ole(){Ri(Hi,this,tle).call(this)}function ale(){Ri(Hi,this,Rk).call(this)}function Ek(t,e){return`border_row${t}col${e}`}function ud(){return{width:1,color:"#000"}}function So(){return{hide:!0}}function lle(){return{width:1,color:"#000",cornerVisible:!1}}function ky(t){if(Se(t.start)||Se(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(Se(t.end)||Se(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Fh(t){return Se(t.start)&&(t.left=t.start),Se(t.end)&&(t.right=t.end),t}function $y(t,e){return{id:Ek(t,e),border:lle(),row:t,col:e,top:So(),bottom:So(),start:So(),end:So()}}function ule(t,e){return Ut(e,"border")&&e.border&&(t.border=e.border),Ut(e,"top")&&Se(e.top)&&(e.top?(Ye(e.top)||(e.top=ud()),t.top=e.top):(e.top=So(),t.top=e.top)),Ut(e,"bottom")&&Se(e.bottom)&&(e.bottom?(Ye(e.bottom)||(e.bottom=ud()),t.bottom=e.bottom):(e.bottom=So(),t.bottom=e.bottom)),Ut(e,"start")&&Se(e.start)&&(e.start?(Ye(e.start)||(e.start=ud()),t.start=e.start):(e.start=So(),t.start=e.start)),Ut(e,"end")&&Se(e.end)&&(e.end?(Ye(e.end)||(e.end=ud()),t.end=e.end):(e.end=So(),t.end=e.end)),t}function No(t,e){let n=!1;return A(t.getSelectedRange(),i=>{i.forAll((r,s)=>{if(r<0||s<0)return;const o=t.getCellMeta(r,s).borders;if(o)if(e){if(!Ut(o[e],"hide")||o[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Wv(t){return`<span class="selected">✓</span>${t}`}function cle(t){return t.some(e=>Se(e.left)||Se(e.right))}function hle(t){return t.some(e=>Se(e.start)||Se(e.end))}const dle=new Map([["left","start"],["right","end"]]);function fle(t){var e;return(e=dle.get(t))!==null&&e!==void 0?e:t}function gle(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(oT);return No(this,"bottom")&&(e=Wv(e)),e},callback(e,n){const i=No(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function mle(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(aT);return No(this,e)&&(n=Wv(n)),n},callback(n,i){const r=No(this,e);t.prepareBorder(i,e,r)}}}function ple(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(lT)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!No(this)}}}function wle(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(sT);return No(this,e)&&(n=Wv(n)),n},callback(n,i){const r=No(this,e);t.prepareBorder(i,e,r)}}}function vle(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(rT);return No(this,"top")&&(e=Wv(e)),e},callback(e,n){const i=No(this,"top");t.prepareBorder(n,"top",i)}}}function Cle(t,e){yle(t,e),e.add(t)}function yle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ble(t,e,n){return(e=Sle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sle(t){var e=Rle(t,"string");return typeof e=="symbol"?e:e+""}function Rle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aI(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vp="customBorders",Ele=90;var Fy=new WeakSet;class Tle extends ut{constructor(){super(...arguments),Cle(this,Fy),ble(this,"savedBorders",[])}static get PLUGIN_KEY(){return vp}static get PLUGIN_PRIORITY(){return Ele}isEnabled(){return!!this.hot.getSettings()[vp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>aI(Fy,this,Mle).call(this,e)),this.addHook("init",()=>aI(Fy,this,_le).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let i=["top","bottom","start","end"],r=null;n&&(this.checkSettingsCohesion([n]),i=Object.keys(n),r=ky(n));const s=xc(e),o=uf(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});A(e,a=>{o(a).forAll((l,u)=>{A(i,c=>{this.prepareBorderFromCustomAdded(l,u,r,fle(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=xc(e),i=uf(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return A(e,s=>{i(s).forAll((o,a)=>{A(this.savedBorders,l=>{l.row===o&&l.col===a&&r.push(Fh(l))})})}),r}clearBorders(e){e?this.setBorders(e):(A(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,n,i,r){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||n>=o)return;let a=$y(e,n);i&&(a=ule(a,i),A(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,i),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Fh(a)),this.insertBorderIntoSettings(a,r)}prepareBorderFromCustomAddedRange(e,n){const i=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);_e(e.from.row,i,s=>{_e(e.from.col,r,o=>{const a=$y(s,o);let l=0;s===e.from.row&&Ut(n,"top")&&(l+=1,a.top=n.top),s===e.to.row&&Ut(n,"bottom")&&(l+=1,a.bottom=n.bottom),o===e.from.col&&Ut(n,"start")&&(l+=1,a.start=n.start),o===e.to.col&&Ut(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(s,o,"borders",Fh(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const i=Ek(e,n);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,i,r){let s=this.hot.getCellMeta(e,n).borders;!s||s.border===void 0?s=$y(e,n):s=ky(s),r?(s[i]=So(),this.countHide(s)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(s,i,r)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,n,"borders",Fh(s)))):(s[i]=ud(),this.checkCustomSelectionsFromContextMenu(s,i,r)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,n,"borders",Fh(s)))}prepareBorder(e,n,i){A(e,r=>{let{start:s,end:o}=r;if(s.row===o.row&&s.col===o.col)n==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,n,i);else switch(n){case"noBorders":_e(s.col,o.col,a=>{_e(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":_e(s.col,o.col,a=>{this.setBorder(s.row,a,n,i)});break;case"bottom":_e(s.col,o.col,a=>{this.setBorder(o.row,a,n,i)});break;case"start":_e(s.row,o.row,a=>{this.setBorder(a,s.col,n,i)});break;case"end":_e(s.row,o.row,a=>{this.setBorder(a,o.col,n,i)});break}})}createCustomBorders(e){A(e,n=>{const i=ky(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,i):this.prepareBorderFromCustomAdded(n.row,n.col,i)})}countHide(e){const{top:n,bottom:i,start:r,end:s}=e;return cn([n,i,r,s],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=tt(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){A(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){A(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=tt(this.savedBorders,i=>i.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):A(this.savedBorders,(r,s)=>{if(e.id===r.id)return this.savedBorders[s]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,i){let r=!1;return A(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return A(o,a=>{a.toggleHiddenClass(n,i)}),r=!0,!1}}),r}checkCustomSelections(e,n,i){const r=this.countHide(e);let s=!1;return r===4?(this.removeAllBorders(e.row,e.col),s=!0):A(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=n,o.commit(),i){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);A(a,l=>{l.changeBorderStyle(i,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[vp];if(Array.isArray(e)){const n=Jn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=cle(e),i=hle(e);if(n&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Mle(t){this.hot.getSettings()[vp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(iT)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[vle(this),wle(this),gle(this),mle(this),ple(this)]}})}function _le(){this.changeBorderSettings()}function Ole(t,e){Ple(t,e),e.add(t)}function Ple(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vy(t,e,n){return(e=Ile(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ile(t){var e=xle(t,"string");return typeof e=="symbol"?e:e+""}function xle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lI(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const uI="dragToScroll",Ale=100;var Wy=new WeakSet;class Hle extends ut{constructor(){super(...arguments),Ole(this,Wy),Vy(this,"boundaries",null),Vy(this,"callback",null),Vy(this,"listening",!1)}static get PLUGIN_KEY(){return uI}static get PLUGIN_PRIORITY(){return Ale}isEnabled(){return!!this.hot.getSettings()[uI]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>lI(Wy,this,cI).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>lI(Wy,this,cI).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let i=0,r=0;n<this.boundaries.top?r=n-this.boundaries.top:n>this.boundaries.bottom&&(r=n-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",i=>this.onMouseMove(i)),n=Gl(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function cI(t){if(Na(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,i)=>{var r,s;const o=(r=e.scrollLeft)!==null&&r!==void 0?r:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(n)*50,a+Math.sign(i)*20)}),this.listen()}function Nle(t,e){Tk(t,e),e.add(t)}function Dle(t,e,n){Tk(t,e),e.set(t,n)}function Tk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function By(t,e,n){return(e=Lle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lle(t){var e=kle(t,"string");return typeof e=="symbol"?e:e+""}function kle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $le(t,e){return t.get(tr(t,e))}function Mk(t,e,n){return t.set(tr(t,e),n),n}function tr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ye.getSingleton().register("afterDropdownMenuDefaultOptions");ye.getSingleton().register("beforeDropdownMenuShow");ye.getSingleton().register("afterDropdownMenuShow");ye.getSingleton().register("afterDropdownMenuHide");ye.getSingleton().register("afterDropdownMenuExecute");const Cp="dropdownMenu",Fle=230,aw="changeType",jy=Cp;var Bv=new WeakMap,Pr=new WeakSet;class jv extends ut{static get PLUGIN_KEY(){return Cp}static get PLUGIN_PRIORITY(){return Fle}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[zf,Gf,Ke,Xf,Ke,Hv,Ke,Kf,Ke,er]}constructor(e){super(e),Nle(this,Pr),By(this,"commandExecutor",new fk(this.hot)),By(this,"itemsFactory",null),By(this,"menu",null),Dle(this,Bv,!1),this.hot.addHook("afterGetColHeader",(n,i)=>tr(Pr,this,Wle).call(this,n,i))}isEnabled(){return this.hot.getSettings()[Cp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new gk(this.hot,jv.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return tr(Pr,e,Gle).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return tr(Pr,e,zle).call(e,...s)});const n=this.hot.getSettings()[Cp],i={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const r=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Gc(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>tr(Pr,this,Ble).call(this)),this.menu.addLocalHook("afterOpen",()=>tr(Pr,this,jle).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>tr(Pr,this,Ule).call(this,s)),this.menu.addLocalHook("afterClose",()=>tr(Pr,this,Yle).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),A(r,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:r}=this.hot.getSelectedRangeLast(),s=Av(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,r.col,!0),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:jy},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isCell()&&!this.menu.isOpened()},group:jy}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jy)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>tr(Pr,this,Vle).call(this,e))}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),ze(i,(r,s)=>{this.menu.setOffset(s,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _k(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Vle(t){if(De(t.target,aw)){const e=Av(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),Mk(Bv,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function Wle(t,e){const n=e.parentNode;if(!n)return;const i=n.parentNode.childNodes,r=Array.prototype.indexOf.call(i,n);if(t<0||r!==i.length-1)return;const s=e.querySelector(`.${aw}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=aw,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(xe(o,[Vo(),_0(" ")]),xe(e,[$N("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function Ble(){this.hot.runHooks("beforeDropdownMenuShow",this)}function jle(){this.hot.runHooks("afterDropdownMenuShow",this),tr(Pr,this,_k).call(this,this.menu)}function Ule(t){tr(Pr,this,_k).call(this,t)}function Yle(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function zle(t){return $le(Bv,this)?null:t}function Gle(t){De(t.target,aw)&&Mk(Bv,this,!0)}jv.SEPARATOR={name:Ke};function hI(t,e,n){return(e=Kle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kle(t){var e=Xle(t,"string");return typeof e=="symbol"?e:e+""}function Xle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qle{constructor(e){hI(this,"hot",void 0),hI(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:i,endCol:r}=this._getDataRange(),s=this.options,o=[];return _e(e,i,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(_e(n,r,u=>{!s.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();_e(n,i,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(r[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();_e(n,i,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(r[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[i=0,r=0,s=n,o=e]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),s=Math.min(s,n),o=Math.min(o,e),{startRow:i,startCol:r,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function dI(t,e,n){return(e=Zle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zle(t){var e=Jle(t,"string");return typeof e=="symbol"?e:e+""}function Jle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vM{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){dI(this,"dataProvider",void 0),dI(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=jr(this.constructor.DEFAULT_OPTIONS);const i=new Date;return n=un(jr(vM.DEFAULT_OPTIONS),n),n=un(n,e),n.filename=M0(n.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),n}}const Qle="\r",eue='"',tue=`
`;class nue extends vM{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const r=i.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return r&&(i=tt(i,l=>this._escapeCell(l,!0)),o&&(a+=e.columnDelimiter),a+=i.join(e.columnDelimiter),a+=e.rowDelimiter),A(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=Jt(e);return i!==""&&(n||i.indexOf(Qle)>=0||i.indexOf(eue)>=0||i.indexOf(tue)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`),i}}const iue="csv",QS={[iue]:nue};function rue(t,e,n){return typeof QS[t]=="function"?new QS[t](e,n):null}const sue="exportFile",oue=240;class aue extends ut{static get PLUGIN_KEY(){return sue}static get PLUGIN_PRIORITY(){return oue}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:r}=this.hot,s=this._createTypeFormatter(e,n),o=this._createBlob(s),a=r.URL||r.webkitURL,l=i.createElement("a"),u=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!QS[e])throw new Error(`Export format type "${e}" is not supported.`);return rue(e,new qle(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Uu(t,e,n){return(e=lue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lue(t){var e=uue(t,"string");return typeof e=="symbol"?e:e+""}function uue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qf{constructor(e,n){let{id:i,stateless:r=!0}=n;Uu(this,"hot",void 0),Uu(this,"id",void 0),Uu(this,"elements",[]),Uu(this,"hidden",!1),Uu(this,"stateId",""),Uu(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Ev)}getElements(){return this.elements}reset(){A(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),A(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}yt(qf,Fn);const df={};function Da(t,e){if(!df[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:i}=df[t];let r=e;return i.inputValuesDecorator&&(r=i.inputValuesDecorator(r)),function(s){return n.apply(s.meta.instance,[].concat([s],[r]))}}function Fl(t){if(!df[t])throw Error(`Filter condition "${t}" does not exist.`);return df[t].descriptor}function hn(t,e,n){n.key=t,df[t]={condition:e,descriptor:n}}const On="none";function cue(){return!0}hn(On,cue,{name:Tv,inputsCount:0,showOperators:!1});const Pd="empty";function hue(t){return Qt(t.value)}hn(Pd,hue,{name:mT,inputsCount:0,showOperators:!0});const yp="not_empty";function due(t,e){return!Da(Pd,e)(t)}hn(yp,due,{name:pT,inputsCount:0,showOperators:!0});const Id="eq";function fue(t,e){let[n]=e;return Jt(t.value).toLocaleLowerCase(t.meta.locale)===Jt(n)}hn(Id,fue,{name:wT,inputsCount:1,showOperators:!0});const bp="neq";function gue(t,e){return!Da(Id,e)(t)}hn(bp,gue,{name:vT,inputsCount:1,showOperators:!0});const Ok="gt";function mue(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}hn(Ok,mue,{name:RT,inputsCount:1,showOperators:!0});const Pk="gte";function pue(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}hn(Pk,pue,{name:ET,inputsCount:1,showOperators:!0});const Ik="lt";function wue(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}hn(Ik,wue,{name:TT,inputsCount:1,showOperators:!0});const xk="lte";function vue(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}hn(xk,vue,{name:MT,inputsCount:1,showOperators:!0});const CM="date_after";function Cue(t,e){let[n]=e;const i=ne(t.value,t.meta.dateFormat),r=ne(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)>=0}hn(CM,Cue,{name:PT,inputsCount:1,showOperators:!0});const yM="date_before";function yue(t,e){let[n]=e;const i=ne(t.value,t.meta.dateFormat),r=ne(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)<=0}hn(yM,yue,{name:IT,inputsCount:1,showOperators:!0});const lw="between";function bue(t,e){let[n,i]=e,r=n,s=i;if(t.meta.type==="numeric"){const o=parseFloat(r,10),a=parseFloat(s,10);r=Math.min(o,a),s=Math.max(o,a)}else if(t.meta.type==="date"){const o=Da(yM,[s]),a=Da(CM,[r]);return o(t)&&a(t)}return t.value>=r&&t.value<=s}hn(lw,bue,{name:_T,inputsCount:2,showOperators:!0});const Ak="not_between";function Sue(t,e){return!Da(lw,e)(t)}hn(Ak,Sue,{name:OT,inputsCount:2,showOperators:!0});const Hk="begins_with";function Rue(t,e){let[n]=e;return Jt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Jt(n))}hn(Hk,Rue,{name:CT,inputsCount:1,showOperators:!0});const Nk="ends_with";function Eue(t,e){let[n]=e;return Jt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Jt(n))}hn(Nk,Eue,{name:yT,inputsCount:1,showOperators:!0});const bM="contains";function Tue(t,e){let[n]=e;return Jt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Jt(n))>=0}hn(bM,Tue,{name:bT,inputsCount:1,showOperators:!0});const Dk="not_contains";function Mue(t,e){return!Da(bM,e)(t)}hn(Dk,Mue,{name:ST,inputsCount:1,showOperators:!0});const Lk="date_tomorrow";function _ue(t){const e=ne(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ne().subtract(-1,"days").startOf("day"),"d"):!1}hn(Lk,_ue,{name:AT,inputsCount:0});const kk="date_today";function Oue(t){const e=ne(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ne().startOf("day"),"d"):!1}hn(kk,Oue,{name:xT,inputsCount:0});const $k="date_yesterday";function Pue(t){const e=ne(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ne().subtract(1,"days").startOf("day"),"d"):!1}hn($k,Pue,{name:HT,inputsCount:0});uD();function Iue(t,e){let n=t;return n===""&&(n=`(${e})`),n}const eR=new Set([1]).has(1),xue=eR&&typeof Array.from=="function";function Zf(t){let e=t;return eR&&(e=new Set(e)),function(n){let i;return eR?i=e.has(n):i=!!~e.indexOf(n),i}}function Fk(t){return t??""}function tR(t){let e=t;return xue?e=Array.from(new Set(e)):e=R0(e),e=e.sort((n,i)=>typeof n=="number"&&typeof i=="number"?n-i:n===i?0:n>i?1:-1),e}function fI(t,e,n,i){const r=[],s=t===e;let o;return s||(o=Zf(e)),A(t,a=>{let l=!1;(s||o(a))&&(l=!0);const u={checked:l,value:a,visualValue:Iue(a,n)};i&&i(u),r.push(u)}),r}const Vl="by_value";function Aue(t,e){let[n]=e;return n(t.value)}hn(Vl,Aue,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Zf(e)]},showOperators:!1});const ff={};function Hue(t){if(!ff[t])throw Error(`Operation with id "${t}" does not exist.`);const e=ff[t].func;return function(n,i){return e(n,i)}}function Nue(t){return ff[t].name}function SM(t,e,n){ff[t]={name:e,func:n}}const Pa="conjunction",Due=LT;function Lue(t,e){return t.every(n=>n.func(e))}SM(Pa,Due,Lue);const uw="disjunction",kue=Mv;function $ue(t,e){return t.some(n=>n.func(e))}SM(uw,kue,$ue);const RM="disjunctionWithExtraCondition",Fue=Mv;function Vue(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}SM(RM,Fue,Vue);const Wue="numeric",Vk="text",Bue="date",gI={[Wue]:[On,Ke,Pd,yp,Ke,Id,bp,Ke,Ok,Pk,Ik,xk,lw,Ak],[Vk]:[On,Ke,Pd,yp,Ke,Id,bp,Ke,Hk,Nk,Ke,bM,Dk],[Bue]:[On,Ke,Pd,yp,Ke,Id,bp,Ke,yM,CM,lw,Ke,Lk,kk,$k]};function jue(t){const e=[];let n=t;return gI[n]||(n=Vk),A(gI[n],i=>{let r;i===Ke?r={name:Ke}:r=jr(Fl(i)),e.push(r)}),e}function Vh(t,e,n){return(e=Uue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uue(t){var e=Yue(t,"string");return typeof e=="symbol"?e:e+""}function Yue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Uy="built",Yy="building",mI=["click","input","keydown","keypress","keyup","focus","blur","change"];let Fr=class Wk{static get DEFAULTS(){return jr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Vh(this,"hot",void 0),Vh(this,"eventManager",new hr(this)),Vh(this,"options",void 0),Vh(this,"_element",void 0),Vh(this,"buildState",void 0),this.hot=e,this.options=un(Wk.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Yy?this._element:this.buildState===Uy?(this.update(),this._element):(this.buildState=Yy,this.build(),this.buildState=Uy,this._element)}isBuilt(){return this.buildState===Uy}translateIfPossible(e){return typeof e=="string"&&e.startsWith(di)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,i)=>{this.eventManager.addEventListener(n,i,r=>this.runLocalHooks(i,r,this))};if(this.buildState||(this.buildState=Yy),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&ie(this._element,this.options.className),this.options.children.length)A(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),ze(this.options,(i,r)=>{n[r]!==void 0&&r!=="className"&&r!=="tagName"&&r!=="children"&&(n[r]=this.translateIfPossible(i))}),this._element.appendChild(n),A(mI,i=>e(n,i))}else A(mI,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};yt(Fr,Fn);function zue(t,e){Bk(t,e),e.add(t)}function Gue(t,e,n){Bk(t,e),e.set(t,n)}function Bk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cm(t,e){return t.get(EM(t,e))}function Kue(t,e,n){return t.set(EM(t,e),n),n}function EM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yu=new WeakMap,pI=new WeakSet;class Ia extends Fr{static get DEFAULTS(){return jr({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,un(Ia.DEFAULTS,n)),zue(this,pI),Gue(this,Yu,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>EM(pI,this,Xue).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Kue(Yu,this,this._element.firstChild),ie(this._element,"htUIInput"),ie(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Cm(Yu,this).type=this.options.type,Cm(Yu,this).placeholder=this.translateIfPossible(this.options.placeholder),Cm(Yu,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Cm(Yu,this).focus()}}function Xue(t){this.options.value=t.target.value}function que(t,e){jk(t,e),e.add(t)}function Wh(t,e,n){jk(t,e),e.set(t,n)}function jk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zu(t,e,n){return t.set(xd(t,e),n),n}function zt(t,e){return t.get(xd(t,e))}function xd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vn=new WeakMap,ym=new WeakMap,bm=new WeakMap,zy=new WeakMap,Sm=new WeakMap,Rm=new WeakSet;class gf extends Fr{static get DEFAULTS(){return jr({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,un(gf.DEFAULTS,n)),que(this,Rm),Wh(this,vn,null),Wh(this,ym,[]),Wh(this,bm,void 0),Wh(this,zy,void 0),Wh(this,Sm,void 0),this.registerHooks()}getMenu(){return zt(vn,this)}registerHooks(){this.addLocalHook("click",()=>xd(Rm,this,Que).call(this))}setItems(e){zu(ym,this,this.translateNames(e)),zt(vn,this)&&zt(vn,this).setMenuItems(zt(ym,this))}translateNames(e){return A(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),zu(vn,this,new Gc(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),zt(vn,this).setMenuItems(zt(ym,this));const e=new Fr(this.hot,{className:"htUISelectCaption"}),n=new Fr(this.hot,{className:"htUISelectDropdown"});zu(bm,this,e),zu(zy,this,e.element),zu(Sm,this,n),this.hot.getSettings().ariaTags&&(xe(n.element,[Vo()]),xe(this._element,[kN()])),A([e,n],i=>this._element.appendChild(i.element)),zt(vn,this).addLocalHook("select",i=>xd(Rm,this,Zue).call(this,i)),zt(vn,this).addLocalHook("afterClose",()=>xd(Rm,this,Jue).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=zt(vn,this).hot.getTranslatedPhrase(Tv),zt(zy,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();zt(vn,this)&&(zt(vn,this).open(),zt(vn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),zt(vn,this).getNavigator().toFirstItem(),zt(vn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){zt(vn,this)&&zt(vn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){zt(vn,this)&&(zt(vn,this).destroy(),zu(vn,this,null)),zt(bm,this)&&zt(bm,this).destroy(),zt(Sm,this)&&zt(Sm,this).destroy(),super.destroy()}}function Zue(t){t.name!==Ke&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Jue(){this.runLocalHooks("afterClose")}function Que(){this.openOptions()}function ece(t,e){tce(t,e),e.add(t)}function tce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wI(t,e,n){return(e=nce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nce(t){var e=ice(t,"string");return typeof e=="symbol"?e:e+""}function ice(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vI(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gy=new WeakSet;class nR extends qf{constructor(e,n){super(e,{id:n.id,stateless:!1}),ece(this,Gy),wI(this,"name",""),wI(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new gf(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Ia(this.hot,{placeholder:BT})),this.elements.push(new Ia(this.hot,{placeholder:jT})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>vI(Gy,this,rce).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),A(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>vI(Gy,this,sce).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=jr(e.command);n.name.startsWith(en)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),A(e.args,(i,r)=>{if(r>n.inputsCount-1)return!1;const s=this.getInputElement(r);s.setValue(i),s[n.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Fl(On),n=[];return A(this.getInputElements(),(i,r)=>{e.inputsCount>r&&n.push(i.getValue())}),{command:e,args:n}}updateState(e,n){const i=Fl(e?e.name:On);this.state.setValueAtIndex(n,{command:i,args:e?e.args:[]}),e||A(this.getInputElements(),r=>r.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof gf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Ia)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,s,o)=>{ie(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ie(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return ie(a,"htFiltersMenuLabel"),a.textContent=o,n.appendChild(a),A(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Fl(On)];if(e!==null){const{visualIndex:i}=e;n=jue(this.hot.getDataType(0,i,this.hot.countRows(),i))}A(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function rce(t){A(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function sce(t){jc(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),gr(t))}function CI(t,e,n){oce(t,e),e.set(t,n)}function oce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bh(t,e){return t.get(Uk(t,e))}function yI(t,e,n){return t.set(Uk(t,e),n),n}function Uk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gu=new WeakMap,Ky=new WeakMap;class cw extends Fr{static get DEFAULTS(){return jr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,un(cw.DEFAULTS,n)),CI(this,Gu,void 0),CI(this,Ky,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),yI(Ky,this,e),yI(Gu,this,this._element.firstChild),Bh(Gu,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Bh(Ky,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Bh(Gu,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Bh(Gu,this).checked=e)}focus(){this.isBuilt()&&Bh(Gu,this).focus()}}function ace(t,e){lce(t,e),e.add(t)}function lce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uce(t,e,n){return(e=cce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cce(t){var e=hce(t,"string");return typeof e=="symbol"?e:e+""}function hce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bI=0;var SI=new WeakSet;class fce extends qf{constructor(e,n){super(e,{id:n.id,stateless:!1}),ace(this,SI),uce(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(ie(n.parentNode,"htFiltersMenuOperators"),A(this.elements,i=>n.appendChild(i.element)),n)}}buildOperatorsElement(){const e=[Pa,uw];A(e,n=>{const i=new cw(this.hot,{name:"operator",label:{htmlFor:n,textContent:Nue(n)},value:n,checked:n===e[bI],id:n});i.addLocalHook("change",r=>dce(SI,this,gce).call(this,r)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(Ct`Radio button with index ${e} doesn't exist.`);A(this.elements,(n,i)=>{n.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof cw&&n.isChecked());return e?e.getValue():Pa}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&A(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pa,n=arguments.length>1?arguments[1]:void 0,i=e;i===RM&&(i=uw),this.state.setValueAtIndex(n,i)}reset(){this.setChecked(bI)}}function gce(t){this.setState(t.target.value)}function mce(t,e,n){pce(t,e),e.set(t,n)}function pce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xy(t,e){return t.get(Yk(t,e))}function wce(t,e,n){return t.set(Yk(t,e),n),n}function Yk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jh=new WeakMap;class mf extends Fr{static get DEFAULTS(){return jr({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,un(mf.DEFAULTS,n)),mce(this,jh,void 0)}build(){super.build(),wce(jh,this,this._element.firstChild)}update(){this.isBuilt()&&(Xy(jh,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Xy(jh,this).focus()}activate(){Xy(jh,this).click()}}function vce(t,e){zk(t,e),e.add(t)}function Ku(t,e,n){zk(t,e),e.set(t,n)}function zk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ve(t,e){return t.get(fc(t,e))}function Rr(t,e,n){return t.set(fc(t,e),n),n}function fc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const RI="multipleSelect.itemBox";var Ir=new WeakMap,Bt=new WeakMap,qy=new WeakMap,no=new WeakMap,Jo=new WeakMap,Qo=new WeakMap,Uh=new WeakSet;class pf extends Fr{static get DEFAULTS(){return jr({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,un(pf.DEFAULTS,n)),vce(this,Uh),Ku(this,Ir,[]),Ku(this,Bt,void 0),Ku(this,qy,void 0),Ku(this,no,void 0),Ku(this,Jo,void 0),Ku(this,Qo,void 0),Rr(no,this,new Ia(this.hot,{placeholder:WT,className:"htUIMultipleSelectSearch"})),Rr(Jo,this,new mf(this.hot,{textContent:kT,className:"htUISelectAll"})),Rr(Qo,this,new mf(this.hot,{textContent:$T,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Ve(Bt,this)}registerHooks(){Ve(no,this).addLocalHook("keydown",e=>fc(Uh,this,yce).call(this,e)),Ve(no,this).addLocalHook("input",e=>fc(Uh,this,Cce).call(this,e)),Ve(Jo,this).addLocalHook("click",e=>fc(Uh,this,bce).call(this,e)),Ve(Qo,this).addLocalHook("click",e=>fc(Uh,this,Sce).call(this,e))}setItems(e){Rr(Ir,this,e),Ve(Bt,this)&&Ve(Bt,this).loadData(Ve(Ir,this))}setLocale(e){Rr(qy,this,e)}getLocale(){return Ve(qy,this)}getItems(){return[...Ve(Ir,this)]}getValue(){return Ece(Ve(Ir,this))}getSearchInputElement(){return Ve(no,this)}getSelectAllElement(){return Ve(Jo,this)}getClearAllElement(){return Ve(Qo,this)}isSelectedAllValues(){return Ve(Ir,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),i=new Fr(this.hot,{className:"htUISelectionControls",children:[Ve(Jo,this),Ve(Qo,this)]});this._element.appendChild(Ve(no,this).element),this._element.appendChild(i.element),this._element.appendChild(n);const r=s=>{if(!this._element)return;Ve(Bt,this)&&Ve(Bt,this).destroy(),ie(s,"htUIMultipleSelectHot"),Rr(Bt,this,new this.hot.constructor(s,{data:Ve(Ir,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,h,d,f)=>{l.title=f.instance.getDataAtRowProp(u,f.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Ve(Bt,this).listen()},colWidths:()=>Ve(Bt,this).container.scrollWidth-Rn(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Ve(Bt,this).init();const a=Ve(Bt,this).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:RI}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{Ve(Bt,this).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:RI})};r(n),this.hot._registerTimeout(()=>r(n),100)}focus(){this.isBuilt()&&Ve(Bt,this).listen()}reset(){Ve(no,this).reset(),Ve(Jo,this).reset(),Ve(Qo,this).reset()}update(){this.isBuilt()&&(Ve(Bt,this).loadData(Rce(Ve(Ir,this),this.options.value)),super.update())}destroy(){Ve(Bt,this)&&Ve(Bt,this).destroy(),Ve(no,this).destroy(),Ve(Qo,this).destroy(),Ve(Jo,this).destroy(),Rr(no,this,null),Rr(Qo,this,null),Rr(Jo,this,null),Rr(Bt,this,null),Rr(Ir,this,null),super.destroy()}}function Cce(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Ve(Ir,this)]:n=Ve(Ir,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Ve(Bt,this).loadData(n)}function yce(t){this.runLocalHooks("keydown",t,this),$0(jc,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),gr(t),Ve(Bt,this).listen(),Ve(Bt,this).selectCell(0,0))}function bce(t){const e=[];t.preventDefault(),Ve(Bt,this).getSourceData().forEach((n,i)=>{n.checked=!0,e.push(wE(n,i)[0])}),Ve(Bt,this).setSourceDataAtCell(e)}function Sce(t){const e=[];t.preventDefault(),Ve(Bt,this).getSourceData().forEach((n,i)=>{n.checked=!1,e.push(wE(n,i)[0])}),Ve(Bt,this).setSourceDataAtCell(e)}function Rce(t,e){const n=Zf(e);return t.map(i=>(i.checked=n(i.value),i))}function Ece(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function Tce(t,e){Mce(t,e),e.add(t)}function Mce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _ce(t,e,n){return(e=Oce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oce(t){var e=Pce(t,"string");return typeof e=="symbol"?e:e+""}function Pce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Em(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yh=new WeakSet;class Ice extends qf{constructor(e,n){super(e,{id:n.id,stateless:!1}),Tce(this,Yh),_ce(this,"name",""),this.name=n.name,this.elements.push(new pf(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Em(Yh,this,xce).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Em(Yh,this,Ace).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Vl){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?On:Vl},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(i,r,s,o,a)=>{const[l]=Ao(r,h=>h.name===Vl),u={},c=this.hot.getTranslatedPhrase(Zp);if(l){const h=o(i,a),d=tt(h,T=>T.value),f=new Map(h.map(T=>[T.value,this.hot.getCellMeta(T.meta.visualRow,T.meta.visualCol)])),m=tR(d);s&&(l.args[0]=s);const p=[],y=fI(m,l.args[0],c,T=>{T.checked&&p.push(T.value),Em(Yh,this,EI).call(this,T,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[p],u.command=Fl(Vl),u.itemsSnapshot=y}else u.args=[],u.command=Fl(On);this.state.setValueAtIndex(i,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof pf)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,s,o)=>{ie(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return ie(a,"htFiltersMenuLabel"),a.textContent=o,n.appendChild(a),A(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Zp),n=this._getColumnVisibleValues(),i=n.map(l=>l.value),r=new Map(n.map(l=>[l.value,l.meta])),s=tR(i),o=fI(s,s,e,l=>{Em(Yh,this,EI).call(this,l,r)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:tt(this.hot.getDataAtCol(e.visualIndex),(n,i)=>({value:Fk(n),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function xce(t){jc(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),gr(t))}function EI(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Ace(t,e){switch(e.type){case"numeric":return FL(t,e);default:return t}}var Gk;function Hce(t,e){Nce(t,e),e.add(t)}function Nce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dce(t,e,n){return(e=Lce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lce(t){var e=kce(t,"string");return typeof e=="symbol"?e:e+""}function kce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $ce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var TI=new WeakSet;class wf extends qf{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Hce(this,TI),Dce(this,"name",""),this.name=n.name,this.elements.push(new Ia(this.hot,{type:"button",value:FT,className:"htUIButton htUIButtonOK",identifier:wf.BUTTON_OK})),this.elements.push(new Ia(this.hot,{type:"button",value:VT,className:"htUIButton htUIButtonCancel",identifier:wf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){A(this.elements,e=>{e.addLocalHook("click",(n,i)=>$ce(TI,this,Fce).call(this,n,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(ie(n.parentNode,"htFiltersMenuActionBar"),A(this.elements,i=>n.appendChild(i.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}Gk=wf;function Fce(t,e){e.options.identifier===Gk.BUTTON_OK?this.accept():this.cancel()}function Zy(t,e,n){return(e=Vce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vce(t){var e=Wce(t,"string");return typeof e=="symbol"?e:e+""}function Wce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const MI="ConditionCollection.filteringStates";class TM{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Zy(this,"hot",void 0),Zy(this,"isMapRegistrable",void 0),Zy(this,"filteringStates",new Ev),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(MI,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var i;const r=this.filteringStates.getValueAtIndex(n),s=(i=r==null?void 0:r.conditions)!==null&&i!==void 0?i:[],o=r==null?void 0:r.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pa;return e.length?Hue(i)(e,n):!0}addCondition(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pa,r=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=tt(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(s):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==i)throw Error(Ct`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(xt(ff[i]))throw new Error(Ct`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:a,args:o,func:Da(a,o)}]},r):u.push({name:a,args:o,func:Da(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return cn(this.filteringStates.getEntries(),(e,n)=>{let[i,{operation:r,conditions:s}]=n;return e.push({column:i,operation:r,conditions:tt(s,o=>{let{name:a,args:l}=o;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),A(e,n=>{A(n.conditions,i=>this.addCondition(n.column,i))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const i=this.getConditions(e);return n?i.some(r=>r.name===n):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(MI),this.filteringStates=null,this.clearLocalHooks()}}yt(TM,Fn);function _I(t,e,n){return(e=Bce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bce(t){var e=jce(t,"string");return typeof e=="symbol"?e:e+""}function jce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kk{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];_I(this,"conditionCollection",void 0),_I(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return A(this.conditionCollection.getFilteredColumns(),(n,i)=>{let r=this.columnDataFactory(n);i&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(n,r)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return A(n,r=>{r!==void 0&&this.conditionCollection.isMatch(r,e)&&i.push(r)}),i}_getIntersectData(e,n){const i=[];return A(n,r=>{const s=r.meta.visualRow;e[s]!==void 0&&(i[s]=e[s])}),i}}function Uce(t,e){Yce(t,e),e.add(t)}function Yce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ml(t,e,n){return(e=zce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zce(t){var e=Gce(t,"string");return typeof e=="symbol"?e:e+""}function Gce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jy(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tm=new WeakSet;class Xk{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Uce(this,Tm),ml(this,"hot",void 0),ml(this,"conditionCollection",void 0),ml(this,"columnDataFactory",void 0),ml(this,"changes",[]),ml(this,"grouping",!1),ml(this,"latestEditedColumnPosition",-1),ml(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",r=>Jy(Tm,this,Kce).call(this,r)),this.conditionCollection.addLocalHook("afterRemove",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("afterAdd",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("beforeClean",()=>Jy(Tm,this,Xce).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Jy(Tm,this,qce).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,A(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const r=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=r.slice(0,s),a=r.slice(s);a.length&&a[0].column===e&&a.shift();const l=nD(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new TM(i.hot,!1),m=[].concat(c,d);f.importAllConditions(m);const p=i.columnDataFactory(h);let y;f.isEmpty()?y=p:y=new Kk(f,T=>i.columnDataFactory(T)).filter(),y=tt(y,T=>T.meta.visualRow);const E=Zf(y);return f.destroy(),Ao(p,T=>E(T.meta.visualRow))})(o),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),ze(this,(e,n)=>{this[n]=null})}}function Kce(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Xce(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function qce(){A(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}yt(Xk,Fn);function Zce(t){return pk({initialPage:0,size:()=>t.length,onItemSelect:(n,i)=>{const r=t[n];if(r instanceof pf)return i;if(r.element&&!Kl(r.element))return!1;r.focus()}})}const zh="filters";function Jce(t,e){let n=-1;const i=Zce(e),r=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(zh),i.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof Fr&&(l.addLocalHook("click",r(l)),l.addLocalHook("focus",r(l)),l.addLocalHook("afterClose",r(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||i.clear()});function s(l){const u=t.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();i.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(zh),callback:()=>{l.isSubMenu()&&l.close(),u.listen(zh)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:h=>{const d=t.getNavigator();d.getCurrentPage()>-1&&(n=d.getCurrentPage()),d.clear(),h.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:h=>{const d=e[i.getCurrentPage()];d instanceof gf&&(d.openOptions(),h.preventDefault()),d instanceof mf&&(d.activate(),h.preventDefault()),d instanceof Fr||h.preventDefault()}}],zh)}t.addLocalHook("afterSubmenuOpen",s),t.addLocalHook("afterOpen",s);function o(){t.focus(),t.getKeyboardShortcutsCtrl().listen(zh)}function a(){return n}return{...i,listen:o,getLastMenuPage:a}}function Qce(t,e){qk(t,e),e.add(t)}function ehe(t,e,n){qk(t,e),e.set(t,n)}function qk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gh(t,e,n){return(e=the(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function the(t){var e=nhe(t,"string");return typeof e=="symbol"?e:e+""}function nhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ihe(t,e,n){return t.set(Ai(t,e),n),n}function Kh(t,e){return t.get(Ai(t,e))}function Ai(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const iR="filters",rhe=250,OI=iR;var pl=new WeakMap,qi=new WeakSet;class she extends ut{static get PLUGIN_KEY(){return iR}static get PLUGIN_PRIORITY(){return rhe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),Qce(this,qi),Gh(this,"dropdownMenuPlugin",null),Gh(this,"conditionCollection",null),Gh(this,"conditionUpdateObserver",null),Gh(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Gh(this,"filtersRowsMap",null),ehe(this,pl,void 0),this.hot.addHook("afterGetColHeader",(n,i)=>Ai(qi,this,hhe).call(this,n,i))}isEnabled(){return!!this.hot.getSettings()[iR]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new jf),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,i=o=>(o.addLocalHook("accept",()=>Ai(qi,this,PI).call(this,"accept")),o.addLocalHook("cancel",()=>Ai(qi,this,PI).call(this,"cancel")),o.addLocalHook("change",a=>Ai(qi,this,che).call(this,o,a)),o),r=()=>`${this.hot.getTranslatedPhrase(NT)}:`,s=()=>`${this.hot.getTranslatedPhrase(DT)}:`;if(!this.components.get("filter_by_condition")){const o=new nR(this.hot,{id:"filter_by_condition",name:r,addSeparator:!1,menuContainer:n});o.addLocalHook("afterClose",()=>Ai(qi,this,II).call(this)),this.components.set("filter_by_condition",i(o))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new fce(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const o=new nR(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});o.addLocalHook("afterClose",()=>Ai(qi,this,II).call(this)),this.components.set("filter_by_condition2",i(o))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new Ice(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new wf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new TM(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Xk(this.hot,this.conditionCollection,o=>this.getDataMapAtColumn(o)),this.conditionUpdateObserver.addLocalHook("update",o=>Ai(qi,this,dhe).call(this,o))),this.components.forEach(o=>o.show()),this.addHook("afterDropdownMenuDefaultOptions",o=>Ai(qi,this,uhe).call(this,o)),this.addHook("afterDropdownMenuShow",()=>Ai(qi,this,ahe).call(this)),this.addHook("afterDropdownMenuHide",()=>Ai(qi,this,lhe).call(this)),this.addHook("afterChange",o=>Ai(qi,this,ohe).call(this,o)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Kh(pl,this)&&this.dropdownMenuPlugin.enabled){const o=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=o.getNavigator(),c=Kh(pl,this).getLastMenuPage();o.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];ihe(pl,this,Jce(o,a));const l=u=>{Kh(pl,this).listen(),u.preventDefault(),jc(u.keyCode,"TAB")&&(u.shiftKey?Kh(pl,this).toPreviousItem():Kh(pl,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,i)=>{n.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:OI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(OI)}addCondition(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Pa;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:n},args:i},r)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let r=[];const s=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",s)!==!1)if(i){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=tt(n.filter(),u=>u.meta.visualRow);const l=Zf(r);_e(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),A(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!r.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),i=[];return A(this.hot.getSourceDataAtCol(n),(r,s)=>{var o;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(s,n),p=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),n))!==null&&o!==void 0?o:r;i.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m},value:Fk(p)})}),i}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),i=tR(n);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var n;const i=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(r=>{r.isHidden()||r.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,i,r){let s=e;return s===uw&&n.command.key!==On&&i.command.key!==On&&r.command.key!==On?s=RM:r.command.key!==On&&(n.command.key===On||i.command.key===On)&&(s=Pa),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new Kk(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return A(r,o=>{A(n.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,r=i.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?r.showRows(l):r.hideRows(l),i.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function ohe(t){t&&A(t,e=>{const[,n]=e,i=this.hot.propToCol(n);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function ahe(){this.restoreComponents(Array.from(this.components.values()))}function lhe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function uhe(t){t.items.push({name:Ke}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function PI(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:r}=i,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(r);u===-1&&(u=void 0),this.conditionCollection.removeConditions(r),s.command.key!==On&&(this.conditionCollection.addCondition(r,s,l,u),o.command.key!==On&&this.conditionCollection.addCondition(r,o,l,u)),a.command.key!==On&&this.conditionCollection.addCondition(r,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(r)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function che(t,e){this.updateDependentComponentsVisibility(),t.constructor===nR&&!e.inputsCount&&this.setListeningDropdownMenu()}function II(){this.setListeningDropdownMenu()}function hhe(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?ie(e,"htFiltersActive"):We(e,"htFiltersActive")}function dhe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:i}}=t,r=n.filter(o=>o.name===Vl),s=n.filter(o=>o.name!==Vl);if(r.length>=2||s.length>=3)vt(Ct`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const o=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(s[0],i),this.components.get("filter_by_condition2").updateState(s[1],i),this.components.get("filter_operators").updateState(o,i),this.components.get("filter_by_value").updateState(t)}}const Zk="internal-use-in-handsontable",rR={licenseKey:Zk,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Jk(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Gn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function Qk(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function fhe(t){var e;const n=t[Gn],i=Qk(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=Jk(t);return{...rR,...i,...r}}function ghe(t){var e;const n=t[Gn],i=Qk(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=Jk(t);return{...i,...r}}function mhe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function Uv(){const t="engine_relationship",e=Kr(Gn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function MM(){const t="shared_engine_usage",e=Kr(Gn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function phe(t){const e=t.getSettings(),n=e[Gn],i=n==null?void 0:n.engine;if(n===!0||xt(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var r;return whe((r=i.hyperformula)!==null&&r!==void 0?r:i,e,t)}else if(typeof i=="object"&&xt(i.hyperformula)){const s=Uv(),o=MM().get(i);return s.has(i)||s.set(i,[]),s.get(i).push(t),o&&o.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:Zk}),(i.getConfig().leapYear1900!==rR.leapYear1900||gv(i.getConfig().nullDate,rR.nullDate)===!1)&&vt(Ct`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function whe(t,e,n){const i=e[Gn],r=fhe(e),s=Uv(),o=MM();vhe(t,i.functions),Che(t,i.language);const a=t.buildEmpty(r);return s.set(a,[n]),o.set(a,[n.guid]),yhe(a,i.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function xI(t){var e;const n=Uv(),i=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(r=>[r.getPlugin("formulas").sheetId,r]))}function AI(t,e){if(t){const n=Uv(),i=n.get(t),r=MM(),s=r.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&n.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(r.delete(t),t.destroy()))}}function vhe(t,e){e&&e.forEach(n=>{const{name:i,plugin:r,translations:s}=n;try{t.registerFunction(i,r,s)}catch(o){vt(o.message)}})}function Che(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(i){vt(i.message)}}}function yhe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:i,expression:r,scope:s,options:o}=n;try{t.addNamedExpression(i,r,s,o)}catch(a){vt(a.message)}}),t.resumeEvaluation())}function bhe(t,e){return(xt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const e$="DD/MM/YYYY";function t$(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function She(t){return t$(t)?t.substr(1):t}function Rhe(t){return typeof t=="string"&&t.startsWith("=")}function _M(t,e){return typeof t=="string"&&e==="date"}function n$(t,e){return ne(t,e,!0).isValid()}function i$(t,e){return ne(t,e,!0).format(e$)}function Ehe(t,e){return ne(t,e$,!0).format(e)}function r$(t,e){const i=new Date(Date.UTC(0,0,t+-1));return ne(i).format(e)}function The(t,e,n){const i=Array.from(Array(n).keys()).filter(s=>t.includes(s)===!1);if(e===0){var r;return(r=i[e])!==null&&r!==void 0?r:0}return i[e-1]+1}function Mhe(t,e){const n=[];return t.forEach(i=>{const r={from:i,to:e};n.forEach(s=>{const o=s.from>s.to,a=s.to<=r.from;s.from>r.from&&a&&o&&(r.from+=1)}),r.from>=e&&(e+=1),n.push(r)}),n}function _he(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(r=>{const s=r.from<r.to;r.from>e.from&&s&&(r.from-=1)})}),t}function OM(t,e,n){const i=Mhe(t,The(t,e,n));return _he(i)}function wl(t,e,n){Ohe(t,e),e.set(t,n)}function Ohe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kt(t,e){return t.get(s$(t,e))}function ea(t,e,n){return t.set(s$(t,e),n),n}function s$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xh=new WeakMap,ta=new WeakMap,_i=new WeakMap,Mm=new WeakMap,Qy=new WeakMap,eb=new WeakMap,_m=new WeakMap;class HI{constructor(e,n,i){wl(this,Xh,void 0),wl(this,ta,void 0),wl(this,_i,void 0),wl(this,Mm,[]),wl(this,Qy,[]),wl(this,eb,void 0),wl(this,_m,[]),ea(Xh,this,e),ea(ta,this,n),ea(_i,this,i)}setRemovedHfIndexes(e){return ea(_m,this,e.map(n=>{const i=kt(ta,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(i)})),kt(_m,this)}getRemovedHfIndexes(){return kt(_m,this)}getHfIndexFromVisualIndex(e){const n=kt(ta,this).getIndexesSequence(),i=kt(ta,this).getNotTrimmedIndexes();return n.indexOf(i[e])}syncMoves(e){const i=`move${Zn(kt(Xh,this))}s`;kt(_i,this).getEngine().batch(()=>{e.forEach(r=>{const s=r.from!==r.to,o=r.from+1!==r.to;s&&o&&kt(_i,this).getEngine()[i](kt(_i,this).getSheetId(),r.from,1,r.to)})})}storeMovesInformation(e,n,i){i!==!1&&(ea(Qy,this,e.map(r=>this.getHfIndexFromVisualIndex(r))),ea(eb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(kt(_i,this).isPerformingUndoRedo()||e===!1||n===!1)return;const i=OM(kt(Qy,this),kt(eb,this),kt(ta,this).getNumberOfIndexes());kt(_i,this).getSheetId()===null?kt(_i,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${Zn(kt(Xh,this))}Order`;return n=>{if(kt(_i,this).isPerformingUndoRedo())return;const i=kt(ta,this).getIndexesSequence();if(n==="update"&&i.length>0){const r=kt(Mm,this).map(l=>i.indexOf(l)),s=kt(_i,this).getEngine().getSheetDimensions(kt(_i,this).getSheetId());let o;kt(Xh,this)==="row"?o=s.height:o=s.width;const a=r.length;for(let l=a;l<o;l+=1)r.push(l);kt(_i,this).getEngine()[e](kt(_i,this).getSheetId(),r)}ea(Mm,this,i)}}init(){ea(Mm,this,kt(ta,this).getIndexesSequence())}}function vl(t,e,n){Phe(t,e),e.set(t,n)}function Phe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function io(t,e){return t.get(o$(t,e))}function Cl(t,e,n){return t.set(o$(t,e),n),n}function o$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Om=new WeakMap,Pm=new WeakMap,tb=new WeakMap,nb=new WeakMap,ib=new WeakMap,rb=new WeakMap,sb=new WeakMap;class Ihe{constructor(e,n,i){vl(this,Om,void 0),vl(this,Pm,void 0),vl(this,tb,void 0),vl(this,nb,!1),vl(this,ib,!1),vl(this,rb,null),vl(this,sb,null),Cl(Om,this,new HI("row",e,this)),Cl(Pm,this,new HI("column",n,this)),Cl(tb,this,i)}getForAxis(e){return e==="row"?io(Om,this):io(Pm,this)}setPerformUndo(e){Cl(nb,this,e)}setPerformRedo(e){Cl(ib,this,e)}isPerformingUndoRedo(){return io(nb,this)||io(ib,this)}getSheetId(){return io(sb,this)}getEngine(){return io(rb,this)}getPostponeAction(){return io(tb,this)}setupSyncEndpoint(e,n){Cl(rb,this,e),Cl(sb,this,n),io(Om,this).init(),io(Pm,this).init()}}function xhe(t,e){a$(t,e),e.add(t)}function Xu(t,e,n){return(e=Ahe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ahe(t){var e=Hhe(t,"string");return typeof e=="symbol"?e:e+""}function Hhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ob(t,e,n){a$(t,e),e.set(t,n)}function a$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function La(t,e,n){return t.set(St(t,e),n),n}function Ec(t,e){return t.get(St(t,e))}function St(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Gn="formulas",Nhe=["maxRows","maxColumns","language"],Dhe=260;ye.getSingleton().register("afterNamedExpressionAdded");ye.getSingleton().register("afterNamedExpressionRemoved");ye.getSingleton().register("afterSheetAdded");ye.getSingleton().register("afterSheetRemoved");ye.getSingleton().register("afterSheetRenamed");ye.getSingleton().register("afterFormulasValuesUpdate");const Kc=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Do=new WeakMap,PM=new WeakMap,qh=new WeakMap,Tt=new WeakSet;class Lhe extends ut{constructor(){var e;super(...arguments),e=this,xhe(this,Tt),ob(this,Do,!1),ob(this,PM,!1),ob(this,qh,[["valuesUpdated",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return St(Tt,e,Jhe).call(e,...i)}],["namedExpressionAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return St(Tt,e,Qhe).call(e,...i)}],["namedExpressionRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return St(Tt,e,ede).call(e,...i)}],["sheetAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return St(Tt,e,tde).call(e,...i)}],["sheetRenamed",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return St(Tt,e,nde).call(e,...i)}],["sheetRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return St(Tt,e,ide).call(e,...i)}]]),Xu(this,"staticRegister",Kr("formulas")),Xu(this,"engine",null),Xu(this,"sheetName",null),Xu(this,"indexSyncer",null),Xu(this,"rowAxisSyncer",null),Xu(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Gn}static get PLUGIN_PRIORITY(){return Dhe}static get SETTING_KEYS(){return[Gn,...Nhe]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Gn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=phe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){vt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&(this.sheetName=i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,NI).call(n,...r)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,DI).call(n,...r)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,NI).call(n,...r)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,DI).call(n,...r)}),this.addHook("modifyData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,Vhe).call(n,...r)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,Whe).call(n,...r)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,khe).call(n,...r)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,Bhe).call(n,...r)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,LI).call(n,...r)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,LI).call(n,...r)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,jhe).call(n,...r)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,Uhe).call(n,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,Ghe).call(n,...r)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,Khe).call(n,...r)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,Yhe).call(n,...r)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,zhe).call(n,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,Xhe).call(n,...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,qhe).call(n,...r)}),this.indexSyncer=new Ihe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,r,s,o)=>{this.rowAxisSyncer.storeMovesInformation(i,r,o)}),this.hot.addHook("beforeColumnMove",(i,r,s,o)=>{this.columnAxisSyncer.storeMovesInformation(i,r,o)}),this.hot.addHook("afterRowMove",(i,r,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(i,r,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,r)}),this.hot.addHook("afterColumnFreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.hot.addHook("beforeColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,r)}),this.hot.addHook("afterColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,Fhe).call(n,...r)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,Zhe).call(n,...r)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return St(Tt,n,$he).call(n,...r)}),Ec(qh,this).forEach(i=>{let[r,s]=i;return this.engine.on(r,s)}),super.enablePlugin()}}disablePlugin(){Ec(qh,this).forEach(e=>{let[n,i]=e;return this.engine.off(n,i)}),AI(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=ghe(this.hot.getSettings());mhe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const i=this.hot.getSettings()[Gn];if(Se(i)&&Se(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const r=this.hot.getSettings()[Gn].sheetName;r&&this.engine.doesSheetExist(r)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(r??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Ec(qh,this).forEach(e=>{var n;let[i,r]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(i,r)}),La(qh,this,null),AI(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(Se(n)&&!eL(n))return vt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return vt("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(i),n),i}catch(i){return vt(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){z0(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Zn(Gn)}.switchSheet`)}getCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(n);return r!==null&&s!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(r=>{var s;const o=r==null||(s=r.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(i.has(o)||i.add(o))}),xI(this.engine).forEach((r,s)=>{if((n||s!==this.sheetId)&&i.has(s)){var o;r.render(),(o=r.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=s=>{var o;const{row:a,col:l,sheet:u}=(o=s==null?void 0:s.address)!==null&&o!==void 0?o:{};return Se(u)?`${u}:${a}x${l}`:""},r=new Set(n.map(s=>i(s)));e.forEach(s=>{var o,a;const{row:l,col:u}=(o=s.address)!==null&&o!==void 0?o:{};if(Se(l)===!1||Se(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,h=i(s);if(c!==void 0&&!r.has(h)){const d=xI(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,i){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){vt(`Not possible to set cell data at ${JSON.stringify(r)}`);return}const s=this.hot.getCellMeta(e,n);return _M(i,s.type)&&(n$(i,s.dateFormat)?i=i$(i,s.dateFormat):Rhe(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(r,i)}}function khe(t,e,n){const i=this.hot.propToCol(n);if(this.isFormulaCellType(e,i)){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},s=this.hot.getCellMeta(e,i);let o=this.engine.getCellValue(r);return s.type==="date"&&zn(o)&&(o=r$(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return t}function $he(t,e,n){const{row:i,col:r}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:m,col:p}=h.start,{row:y,col:E}=h.end,T=y-m+1,M=E-p+1;for(let P=0;P<f.length;P+=1)for(let H=0;H<f[P].length;H+=1){const U=f[P][H],Y=m+P%T,Q=p+H%M,q=this.hot.getCellMeta(Y,Q);_M(U,q.type)&&(U.startsWith("'")?f[P][H]=U.slice(1):this.isFormulaCellType(Y,Q,this.sheetId)===!1&&(f[P][H]=Ehe(U,q.dateFormat)))}return f}function NI(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Zn(Gn))||La(PM,this,xt(this.hot.getSettings().data))}function Fhe(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,i)=>{n.forEach((r,s)=>{const o=this.hot.getCellMeta(i,s),a=o.dateFormat;_M(r,o.type)&&(e=!0,n$(r,a)?t[i][s]=i$(r,a):this.isFormulaCellType(i,s)===!1&&(t[i][s]=`'${r}`))})}),e===!0&&(La(Do,this,!0),this.engine.setSheetContent(this.sheetId,t),La(Do,this,!1))}function DI(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Zn(Gn)))if(this.sheetName=bhe(this.engine,this.hot.getSettings()[Gn].sheetName),Ec(PM,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){La(Do,this,!0);const r=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(r),La(Do,this,!1)}}}function Vhe(t,e,n,i){if(i!=="get"||Ec(Do,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t);if(r===null||e===null)return;if(!this.isFormulaCellType(r,e)&&this.getCellType(r,e)!=="ARRAY"){t$(n.value)&&(n.value=She(n.value));return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(o),l=this.hot.getCellsMeta().find(c=>c.visualRow===r&&c.visualCol===e);l===void 0&&(l={}),l.type==="date"&&zn(a)&&(a=r$(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function Whe(t,e,n,i){if(i!=="get"||Ec(Do,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(r===null||s===null||!this.isFormulaCellType(r,s)&&this.getCellType(r,s)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function LI(t,e){if(Kc(e))return;const n=[],i=[],r=this.engine.batch(()=>{t.forEach(s=>{let[o,a,,l]=s;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(o),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(o,u,l):n.push([o,u,l]),i.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{n.forEach(o=>{let[a,l,u]=o;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function Bhe(t,e){if(Kc(e))return;const n=[],i=[];t.forEach(r=>{let[s,o,,a]=r;const l=this.hot.propToCol(o);if(!zn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){vt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}i.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}function jhe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Uhe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Yhe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function zhe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function Ghe(t,e,n){if(Kc(n))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function Khe(t,e,n){if(Kc(n))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function Xhe(t,e,n,i){if(Kc(i))return;const r=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{r.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function qhe(t,e,n,i){if(Kc(i))return;const r=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{r.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function Zhe(t,e,n){var i;La(Do,this,!0);const r=this.hot.getSourceDataArray(n,0,n+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());La(Do,this,!1),r.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+o,sheet:this.sheetId},[[a]])})})}function Jhe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Qhe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function ede(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function tde(t){this.hot.runHooks("afterSheetAdded",t)}function nde(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function ide(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function rde(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(hT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,n.col),0),r=Math.max(e.col,n.col),s=[];for(let l=i;l<=r;l+=1)s.push(l);t.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function sde(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(dT,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],s=e[e.length-1];r=(n=this.columnIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,s=(i=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),s-r+1===this.countCols()||this.selectColumns(r,s)},disabled:!1,hidden(){const n=tt(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().col,s=i.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(r),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(r!==s){const h=s-r+1,d=l-a+1;if(h>d){const f=u.slice(r,s+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return A(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function ode(t,e){l$(t,e),e.add(t)}function kI(t,e,n){l$(t,e),e.set(t,n)}function l$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $i(t,e){return t.get(ua(t,e))}function Zh(t,e,n){return t.set(ua(t,e),n),n}function ua(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ye.getSingleton().register("beforeHideColumns");ye.getSingleton().register("afterHideColumns");ye.getSingleton().register("beforeUnhideColumns");ye.getSingleton().register("afterUnhideColumns");const ab="hiddenColumns",ade=310;var As=new WeakMap,os=new WeakMap,yl=new WeakSet;class lde extends ut{constructor(){super(...arguments),ode(this,yl),kI(this,As,{}),kI(this,os,null)}static get PLUGIN_KEY(){return ab}static get PLUGIN_PRIORITY(){return ade}isEnabled(){return!!this.hot.getSettings()[ab]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[ab];Ye(n)&&(Zh(As,this,n),xt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Zh(os,this,new Rv),$i(os,this).addLocalHook("init",()=>ua(yl,this,gde).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,$i(os,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return ua(yl,e,fde).call(e,...r)}),this.addHook("afterGetCellMeta",(i,r,s)=>ua(yl,this,cde).call(this,i,r,s)),this.addHook("modifyColWidth",(i,r)=>ua(yl,this,ude).call(this,i,r),2),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return ua(yl,e,dde).call(e,...r)}),this.addHook("modifyCopyableRange",i=>ua(yl,this,hde).call(this,i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Zh(As,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;const s=$i(os,this).getValues().slice(),o=e.length>0;if(i&&o){const l=e.map(u=>this.hot.toPhysicalColumn(u));A(l,u=>{s[u]=!1}),r=cn(s,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,r,i&&o)!==!1&&(i&&o&&$i(os,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,r,i&&o,i&&r.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{A(e,o=>{$i(os,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",n,r,i,i&&r.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideColumns(n)}getHiddenColumns(){return tt($i(os,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return $i(os,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){A(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Zh(As,this,null),Zh(os,this,null),super.destroy()}}function ude(t,e){if(this.isHidden(e))return 0;if($i(As,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function cde(t,e,n){if($i(As,this).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenColumn");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function hde(t){if($i(As,this).copyPasteEnabled)return t;const e=[],n=(i,r,s,o)=>{e.push({startRow:i,endRow:r,startCol:s,endCol:o})};return A(t,i=>{let r=!0,s=0;_e(i.startCol,i.endCol,o=>{this.isHidden(o)?(r||n(i.startRow,i.endRow,s,o-1),r=!0):(r&&(s=o),o===i.endCol&&n(i.startRow,i.endRow,s,o),r=!1)})}),e}function dde(t,e){if(!$i(As,this).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),ie(e,n)}function fde(t){t.items.push({name:Ke},rde(this),sde(this))}function gde(){Array.isArray($i(As,this).columns)&&this.hideColumns($i(As,this).columns)}function mde(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(fT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,n.row),0),r=Math.max(e.row,n.row),s=[];for(let l=i;l<=r;l+=1)s.push(l);t.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function pde(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(gT,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],s=e[e.length-1];r=(n=this.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,s=(i=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),s-r+1===this.countRows()||this.selectRows(r,s)},disabled:!1,hidden(){const n=tt(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().row,s=i.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(r),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(r!==s){const h=s-r+1,d=l-a+1;if(h>d){const f=u.slice(r,s+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return A(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function wde(t,e){u$(t,e),e.add(t)}function $I(t,e,n){u$(t,e),e.set(t,n)}function u$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ir(t,e){return t.get(ca(t,e))}function Jh(t,e,n){return t.set(ca(t,e),n),n}function ca(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ye.getSingleton().register("beforeHideRows");ye.getSingleton().register("afterHideRows");ye.getSingleton().register("beforeUnhideRows");ye.getSingleton().register("afterUnhideRows");const lb="hiddenRows",vde=320;var Ro=new WeakMap,as=new WeakMap,bl=new WeakSet;class Cde extends ut{constructor(){super(...arguments),wde(this,bl),$I(this,Ro,{}),$I(this,as,null)}static get PLUGIN_KEY(){return lb}static get PLUGIN_PRIORITY(){return vde}isEnabled(){return!!this.hot.getSettings()[lb]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[lb];Ye(n)&&(Jh(Ro,this,n),xt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Jh(as,this,new Rv),ir(as,this).addLocalHook("init",()=>ca(bl,this,Tde).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ir(as,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return ca(bl,e,Ede).call(e,...r)}),this.addHook("afterGetCellMeta",(i,r,s)=>ca(bl,this,bde).call(this,i,r,s)),this.addHook("modifyRowHeight",(i,r)=>ca(bl,this,yde).call(this,i,r)),this.addHook("afterGetRowHeader",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return ca(bl,e,Rde).call(e,...r)}),this.addHook("modifyCopyableRange",i=>ca(bl,this,Sde).call(this,i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Jh(Ro,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;const s=ir(as,this).getValues().slice(),o=e.length>0;if(i&&o){const l=e.map(u=>this.hot.toPhysicalRow(u));A(l,u=>{s[u]=!1}),r=cn(s,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,r,i&&o)!==!1&&(i&&o&&ir(as,this).setValues(s),this.hot.runHooks("afterUnhideRows",n,r,i&&o,i&&r.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{A(e,o=>{ir(as,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",n,r,i,i&&r.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideRows(n)}getHiddenRows(){return tt(ir(as,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return ir(as,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){A(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Jh(Ro,this,null),Jh(as,this,null),super.destroy()}}function yde(t,e){return this.isHidden(e)?0:t}function bde(t,e,n){if(ir(Ro,this).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenRow");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function Sde(t){if(ir(Ro,this).copyPasteEnabled)return t;const e=[],n=(i,r,s,o)=>{e.push({startRow:i,endRow:r,startCol:s,endCol:o})};return A(t,i=>{let r=!0,s=0;_e(i.startRow,i.endRow,o=>{this.isHidden(o)?(r||n(s,o-1,i.startCol,i.endCol),r=!0):(r&&(s=o),o===i.endRow&&n(s,o,i.startCol,i.endCol),r=!1)})}),e}function Rde(t,e){if(!ir(Ro,this).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),ie(e,n)}function Ede(t){t.items.push({name:Ke},mde(this),pde(this))}function Tde(){Array.isArray(ir(Ro,this).rows)&&this.hideRows(ir(Ro,this).rows)}function Mde(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(WE)},callback(e,n){const[{start:{col:i}}]=n;t.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function _de(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(BE)},callback(e,n){const[{start:{col:i}}]=n;t.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Ode(t,e){c$(t,e),e.add(t)}function Pde(t,e,n){c$(t,e),e.set(t,n)}function c$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sR(t,e){return t.get(hw(t,e))}function ub(t,e,n){return t.set(hw(t,e),n),n}function hw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ye.getSingleton().register("beforeColumnFreeze");ye.getSingleton().register("afterColumnFreeze");ye.getSingleton().register("beforeColumnUnfreeze");ye.getSingleton().register("afterColumnUnfreeze");const FI="manualColumnFreeze",Ide=110;var Al=new WeakMap,cb=new WeakSet;class xde extends ut{constructor(){super(...arguments),Ode(this,cb),Pde(this,Al,!1)}static get PLUGIN_KEY(){return FI}static get PLUGIN_PRIORITY(){return Ide}isEnabled(){return!!this.hot.getSettings()[FI]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>hw(cb,this,Ade).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>hw(cb,this,Hde).call(this,e,n)),super.enablePlugin())}disablePlugin(){ub(Al,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;sR(Al,this)||ub(Al,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;sR(Al,this)||ub(Al,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function Ade(t){t.items.push({name:"---------"},Mde(this),_de(this))}function Hde(t,e){if(sR(Al,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(i=>i<n))return!1}}function Im(t,e,n){return(e=Nde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nde(t){var e=Dde(t,"string");return typeof e=="symbol"?e:e+""}function Dde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const hb=0,VI=1,WI=2,qu="px";let h$=class{constructor(e){Im(this,"hot",void 0),Im(this,"_element",null),Im(this,"state",hb),Im(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=WI}build(){this.state===hb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=VI)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=hb}isAppended(){return this.state===WI}isBuilt(){return this.state>=VI}setPosition(e,n){zn(e)&&(this._element.style.top=e+qu),zn(n)&&(this._element.style[this.inlineProperty]=n+qu)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){zn(e)&&(this._element.style.width=e+qu),zn(n)&&(this._element.style.height=n+qu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){zn(e)&&(this._element.style.marginTop=e+qu),zn(n)&&(this._element.style[`margin${Zn(this.inlineProperty)}`]=n+qu)}getOffset(){const e=this._element.style,n=`margin${Zn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Lde="ht__manualColumnMove--backlight";let kde=class extends h${build(){super.build(),ie(this._element,Lde)}};const $de="ht__manualColumnMove--guideline";let Fde=class extends h${build(){super.build(),ie(this._element,$de)}};function Vde(t,e){d$(t,e),e.add(t)}function Er(t,e,n){d$(t,e),e.set(t,n)}function d$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ei(t,e,n){return t.set(ha(t,e),n),n}function Te(t,e){return t.get(ha(t,e))}function ha(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ye.getSingleton().register("beforeColumnMove");ye.getSingleton().register("afterColumnMove");const db="manualColumnMove",Wde=120,BI="ht__manualColumnMove",dw="show-ui",oR="on-moving--columns",aR="after-selection--columns";var ai=new WeakMap,pa=new WeakMap,Eo=new WeakMap,Sp=new WeakMap,Ra=new WeakMap,oi=new WeakMap,xm=new WeakMap,Ji=new WeakMap,ac=new WeakMap,fw=new WeakMap,Ad=new WeakMap,Sl=new WeakSet;class Bde extends ut{constructor(){super(...arguments),Vde(this,Sl),Er(this,ai,new kde(this.hot)),Er(this,pa,new Fde(this.hot)),Er(this,Eo,[]),Er(this,Sp,0),Er(this,Ra,!1),Er(this,oi,{}),Er(this,xm,void 0),Er(this,Ji,void 0),Er(this,ac,void 0),Er(this,fw,void 0),Er(this,Ad,void 0)}static get PLUGIN_KEY(){return db}static get PLUGIN_PRIORITY(){return Wde}isEnabled(){return!!this.hot.getSettings()[db]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ha(Sl,e,jde).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ha(Sl,e,Yde).call(e,...i)}),this.addHook("afterScrollVertically",()=>ha(Sl,this,Gde).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ha(Sl,e,Kde).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),ie(this.hot.rootElement,BI),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){We(this.hot.rootElement,BI),this.unregisterEvents(),Te(ai,this).destroy(),Te(pa,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const i=Te(xm,this),r=this.isMovePossible(e,n),s=this.hot.runHooks("beforeColumnMove",e,n,i,r);if(Ei(xm,this,void 0),s===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,n);const o=r&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,i,r,o),o}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const i=this.countFinalIndex(e,n);return Ei(xm,this,n),this.moveColumns(e,i)}isMovePossible(e,n){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,s=n<0,o=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||s||o||a)}isColumnOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=cn(e,(r,s)=>(s<n&&(r+=1),r),0);return n-i}getColumnsWidth(e,n){const i=this.hot.columnIndexMapper;let r=0;for(let s=e;s<=n;s+=1){const o=i.getRenderableFromVisualIndex(s);s<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(r+=this.hot.view._wt.wtTable.getStretchedColumnWidth(o)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[db];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const i=[];return _e(e,n,r=>{i.push(r)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Te(Ji,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Te(Ji,this)-1);const o=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=Te(ai,this).getOffset().start,u=Te(ai,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,p=At(this.hot.rootElement),y=m.innerWidth-Te(ac,this)-p;h=m.innerWidth-Te(oi,this).eventPageX-y-(i.scrollX===void 0?r:0)}else h=Te(oi,this).eventPageX-(Te(ac,this)-(i.scrollX===void 0?r:0));if(Te(fw,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Te(Ji,this))&&(s+=r),s+=c,Te(Ji,this)<0)Te(Ad,this)>0?Te(oi,this).col=0:Te(oi,this).col=e>0?e-1:e;else if(Te(oi,this).TD.offsetWidth/2+s<=h){const m=Te(Ji,this)>=Te(Sp,this)?Te(Sp,this)-1:Te(Ji,this);Te(oi,this).col=m+1,s+=Te(oi,this).TD.offsetWidth}else Te(oi,this).col=Te(Ji,this);let d=h,f=s;h+u+l>=o?d=o-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),s>=o-1?f=o-1:f===0?f=1:i.scrollX!==void 0&&Te(Ji,this)<Te(Ad,this)&&(f-=Te(ac,this)<=i.scrollX?Te(ac,this):0),Te(ai,this).setPosition(null,d),Te(pa,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ha(Sl,this,Ude).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ha(Sl,this,zde).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Te(ai,this).build(),Te(pa,this).build()}destroy(){Te(ai,this).destroy(),Te(pa,this).destroy(),super.destroy()}}function jde(t,e,n,i){const r=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),a=De(t.target,"sortAction");if(!o||!s||Te(Ra,this)||t.button!==0||a){Ei(Ra,this,!1),Te(Eo,this).length=0,We(this.hot.rootElement,[oR,dw]);return}const l=Te(pa,this).isBuilt()&&!Te(pa,this).isAppended(),u=Te(ai,this).isBuilt()&&!Te(ai,this).isAppended();l&&u&&(Te(pa,this).appendTo(r.hider),Te(ai,this).appendTo(r.hider));const{from:c,to:h}=o,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){i.column=!0,Ei(Ra,this,!0);const m=n.firstChild?vD(t,n.firstChild).x:t.offsetX;Te(oi,this).eventPageX=t.pageX,Ei(Ji,this,e.col),Te(oi,this).TD=n,Te(oi,this).col=e.col,Ei(Eo,this,this.prepareColumnsToMoving(d,f)),Ei(fw,this,!!this.hot.getSettings().rowHeaders),Ei(Sp,this,this.hot.countCols()),Ei(Ad,this,this.hot.getSettings().fixedColumnsStart),Ei(ac,this,bn(this.hot.rootElement).left);const p=Te(fw,this)?-1:0,y=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,E=e.col<Te(Ad,this),T=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),M=Math.abs(m-(this.hot.isRtl()?n.offsetWidth:0)),P=this.getColumnsWidth(d,e.col-1)+M,H=this.getColumnsWidth(p,d-1)+(E?T:0)+P;Te(ai,this).setPosition(y,H),Te(ai,this).setSize(this.getColumnsWidth(d,f),r.hider.offsetHeight-y),Te(ai,this).setOffset(null,-P),ie(this.hot.rootElement,oR)}else We(this.hot.rootElement,aR),Ei(Ra,this,!1),Te(Eo,this).length=0}function Ude(t){Te(Ra,this)&&(Te(oi,this).eventPageX=t.pageX,this.refreshPositions())}function Yde(t,e,n,i){!this.hot.getSelectedRangeLast()||!Te(Ra,this)||(Te(Eo,this).indexOf(e.col)>-1?We(this.hot.rootElement,dw):ie(this.hot.rootElement,dw),i.row=!0,i.column=!0,i.cell=!0,Ei(Ji,this,e.col),Te(oi,this).TD=n)}function zde(){const t=Te(oi,this).col,e=Te(Eo,this).length;if(Ei(Ji,this,void 0),Ei(Ra,this,!1),We(this.hot.rootElement,[oR,dw,aR]),this.hot.selection.isSelectedByColumnHeader()&&ie(this.hot.rootElement,aR),e<1||t===void 0)return;const n=Te(Eo,this)[0],i=this.hot.toPhysicalColumn(n),r=this.dragColumns(Te(Eo,this),t);if(Te(Eo,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(i),o=s+e-1;this.hot.selectColumns(s,o)}}function Gde(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,i=e+n;Te(ai,this).setPosition(i),Te(ai,this).setSize(null,t.hider.offsetHeight-i)}function Kde(){this.moveBySettingsOrLoad()}function Xde(t,e){f$(t,e),e.add(t)}function jn(t,e,n){f$(t,e),e.set(t,n)}function f$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rn(t,e,n){return t.set(xr(t,e),n),n}function pe(t,e){return t.get(xr(t,e))}function xr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gw="manualColumnResize",qde=130,jI="manualColumnWidths";var go=new WeakMap,Am=new WeakMap,Di=new WeakMap,mw=new WeakMap,Os=new WeakMap,Zde=new WeakMap,Tc=new WeakMap,Hm=new WeakMap,vi=new WeakMap,lo=new WeakMap,eu=new WeakMap,pw=new WeakMap,Hd=new WeakMap,Nd=new WeakMap,ki=new WeakMap,Dd=new WeakMap,ls=new WeakSet;class Jde extends ut{static get PLUGIN_KEY(){return gw}static get PLUGIN_PRIORITY(){return qde}constructor(e){super(e),Xde(this,ls),jn(this,go,null),jn(this,Am,null),jn(this,Di,[]),jn(this,mw,null),jn(this,Os,null),jn(this,Zde,null),jn(this,Tc,null),jn(this,Hm,null),jn(this,vi,this.hot.rootDocument.createElement("DIV")),jn(this,lo,this.hot.rootDocument.createElement("DIV")),jn(this,eu,null),jn(this,pw,!1),jn(this,Hd,0),jn(this,Nd,null),jn(this,ki,void 0),jn(this,Dd,void 0),ie(pe(vi,this),"manualColumnResizer"),ie(pe(lo,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[gw]}enablePlugin(){this.enabled||(rn(ki,this,new Wa),pe(ki,this).addLocalHook("init",()=>xr(ls,this,Qde).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,pe(ki,this)),this.addHook("modifyColWidth",(e,n)=>xr(ls,this,sfe).call(this,e,n),1),this.addHook("beforeStretchingColumnWidth",(e,n)=>xr(ls,this,ofe).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,i)=>xr(ls,this,afe).call(this,e,n,i)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){rn(Dd,this,pe(ki,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",jI,pe(ki,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",jI,e),e.value}setManualSize(e,n){const i=Math.max(n,20),r=this.hot.toPhysicalColumn(e);return pe(ki,this).setValueAtIndex(r,i),i}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);pe(ki,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;rn(go,this,e);const{_wt:n}=this.hot.view,i=n.wtTable.getCoords(pe(go,this)),r=i.col;if(r<0)return;const s=sn(pe(go,this)),o=pe(go,this).getBoundingClientRect(),a=r<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(pe(go,this),i.row,i.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(pe(go,this),i.row,i.col)),rn(Am,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),rn(Di,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();A(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;_e(d,f,m=>{pe(Di,this).includes(m)||pe(Di,this).push(m)})})}pe(Di,this).includes(pe(Am,this))||rn(Di,this,[pe(Am,this)]),rn(Hm,this,l.start-6),rn(Tc,this,parseInt(o.width,10)),pe(vi,this).style.top=`${l.top}px`,pe(vi,this).style[this.inlineDir]=`${pe(Hm,this)+pe(Tc,this)}px`,pe(vi,this).style.height=`${s}px`,this.hot.rootElement.appendChild(pe(vi,this))}refreshHandlePosition(){pe(vi,this).style[this.inlineDir]=`${pe(Hm,this)+pe(mw,this)}px`}setupGuidePosition(){const e=parseInt(sn(pe(vi,this)),10),n=parseInt(pe(vi,this).style.top,10)+e,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ie(pe(vi,this),"active"),ie(pe(lo,this),"active"),pe(lo,this).style.top=`${n}px`,this.refreshGuidePosition(),pe(lo,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(pe(lo,this))}refreshGuidePosition(){pe(lo,this).style[this.inlineDir]=pe(vi,this).style[this.inlineDir]}hideHandleAndGuide(){We(pe(vi,this),"active"),We(pe(lo,this),"active")}checkIfColumnHeader(e){const n=Aa(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const s=this.hot.runHooks("beforeColumnResize",pe(Os,this),i,!0);s!==void 0&&rn(Os,this,s),this.hot.getSettings().stretchH==="all"?this.clearManualSize(i):this.setManualSize(i,pe(Os,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",pe(Os,this),i,!0),r&&e()};pe(Hd,this)>=2&&(pe(Di,this).length>1?(A(pe(Di,this),r=>{n(r)}),e()):A(pe(Di,this),r=>{n(r,!0)})),rn(Hd,this,0),rn(Nd,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",i=>xr(ls,this,efe).call(this,i)),this.eventManager.addEventListener(n,"mousedown",i=>xr(ls,this,tfe).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>xr(ls,this,nfe).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>xr(ls,this,ife).call(this)),this.eventManager.addEventListener(pe(vi,this),"contextmenu",()=>xr(ls,this,rfe).call(this))}destroy(){super.destroy()}}function Qde(){const t=this.hot.getSettings()[gw],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,i)=>{pe(ki,this).setValueAtIndex(i,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,i)=>{pe(ki,this).setValueAtIndex(i,n)})},!0),rn(Dd,this,t)):t===!0&&Array.isArray(pe(Dd,this))&&this.hot.batchExecution(()=>{pe(Dd,this).forEach((n,i)=>{pe(ki,this).setValueAtIndex(i,n)})},!0)}function efe(t){if(!D0(t.target)&&pe(pw,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(pe(eu,this)||this.setupHandlePosition(e))}}function tfe(t){t.target.parentNode===this.hot.rootElement&&De(t.target,"manualColumnResizer")&&(this.setupHandlePosition(pe(go,this)),this.setupGuidePosition(),rn(eu,this,!0),pe(Nd,this)===null&&(rn(Nd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(pe(Nd,this))),rn(Hd,this,pe(Hd,this)+1),this.startX=t.pageX,rn(Os,this,pe(Tc,this)))}function nfe(t){if(pe(eu,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();rn(mw,this,pe(Tc,this)+e),A(pe(Di,this),n=>{rn(Os,this,this.setManualSize(n,pe(mw,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function ife(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeColumnResize",pe(Os,this),n,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",pe(Os,this),n,!1)};pe(eu,this)&&(this.hideHandleAndGuide(),rn(eu,this,!1),pe(Os,this)!==pe(Tc,this)&&(pe(Di,this).length>1?(A(pe(Di,this),i=>{e(i)}),t()):A(pe(Di,this),i=>{e(i,!0)})),this.setupHandlePosition(pe(go,this)))}function rfe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(pe(vi,this)),this.hot.rootElement.removeChild(pe(lo,this)),rn(eu,this,!1),rn(pw,this,!0),this.hot._registerImmediate(()=>{rn(pw,this,!1)})}function sfe(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),r=pe(ki,this).getValueAtIndex(i);this.hot.getSettings()[gw]&&r&&(n=r)}return n}function ofe(t,e){let n=pe(ki,this).getValueAtIndex(e);return n===null&&(n=t),n}function afe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function fb(t,e,n){return(e=lfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lfe(t){var e=ufe(t,"string");return typeof e=="symbol"?e:e+""}function ufe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const gb=0,UI=1,YI=2,Zu="px";let g$=class{constructor(e){fb(this,"hot",void 0),fb(this,"_element",null),fb(this,"state",gb),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=YI}build(){this.state===gb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=UI)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=gb}isAppended(){return this.state===YI}isBuilt(){return this.state>=UI}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Zu),n!==void 0&&(this._element.style.left=n+Zu)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Zu),n&&(this._element.style.height=n+Zu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Zu),n&&(this._element.style.marginLeft=n+Zu)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const cfe="ht__manualRowMove--backlight";class hfe extends g${build(){super.build(),ie(this._element,cfe)}}const dfe="ht__manualRowMove--guideline";class ffe extends g${build(){super.build(),ie(this._element,dfe)}}function gfe(t,e){m$(t,e),e.add(t)}function Ju(t,e,n){m$(t,e),e.set(t,n)}function m$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wl(t,e,n){return t.set(da(t,e),n),n}function Be(t,e){return t.get(da(t,e))}function da(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ye.getSingleton().register("beforeRowMove");ye.getSingleton().register("afterRowMove");const mb="manualRowMove",mfe=140,zI="ht__manualRowMove",ww="show-ui",lR="on-moving--rows",uR="after-selection--rows";var li=new WeakMap,wa=new WeakMap,To=new WeakMap,Ea=new WeakMap,Ti=new WeakMap,Nm=new WeakMap,Rl=new WeakSet;class pfe extends ut{constructor(){super(...arguments),gfe(this,Rl),Ju(this,li,new hfe(this.hot)),Ju(this,wa,new ffe(this.hot)),Ju(this,To,[]),Ju(this,Ea,void 0),Ju(this,Ti,{}),Ju(this,Nm,void 0)}static get PLUGIN_KEY(){return mb}static get PLUGIN_PRIORITY(){return mfe}isEnabled(){return!!this.hot.getSettings()[mb]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return da(Rl,e,wfe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return da(Rl,e,Cfe).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>da(Rl,this,bfe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return da(Rl,e,Sfe).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),ie(this.hot.rootElement,zI),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){We(this.hot.rootElement,zI),this.unregisterEvents(),Be(li,this).destroy(),Be(wa,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const i=Be(Nm,this),r=this.isMovePossible(e,n),s=this.hot.runHooks("beforeRowMove",e,n,i,r);if(Wl(Nm,this,void 0),s===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,n);const o=r&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,i,r,o),o}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const i=this.countFinalIndex(e,n);return Wl(Nm,this,n),this.moveRows(e,i)}isMovePossible(e,n){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,s=n<0,o=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||s||o||a)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=cn(e,(r,s)=>(s<n&&(r+=1),r),0);return n-i}getRowsHeight(e,n){const i=this.hot.rowIndexMapper;let r=0;for(let s=e;s<=n;s++){const o=i.getRenderableFromVisualIndex(s);o!==null&&(r+=this.hot.view._wt.wtTable.getRowHeight(o)||23)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[mb];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:i,to:r}=e,s=Math.min(i.row,r.row),o=Math.max(i.row,r.row);return _e(s,o,a=>{n.push(a)}),n}refreshPositions(){const e=Be(Ti,this).coords,n=this.hot.view.getFirstFullyVisibleRow(),i=this.hot.view.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=Be(Ti,this).TD,a=this.hot.rootElement,l=bn(a),u=Xl(a),c=s.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Be(Ti,this).eventPageY-d+c,m=s.hider.offsetHeight,p=s.TBODY.offsetTop,y=Be(li,this).getOffset().top,E=Be(li,this).getSize().height,T=o.offsetHeight/2,M=o.offsetHeight;let P=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const H=f>=P+T;this.isFixedRowTop(e.row)&&(P+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Be(Ti,this).row=n>0?n-1:n:H?(Be(Ti,this).row=e.row+1,P+=e.row===0?M-1:M):Be(Ti,this).row=e.row;let U=f,Y=P;f+E+y>=m?U=m-E-y:f+y<p&&(U=p+Math.abs(y)),P>=m-1&&(Y=m-1),Be(li,this).setPosition(U),Be(wa,this).setPosition(Y)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>da(Rl,this,vfe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>da(Rl,this,yfe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Be(li,this).build(),Be(wa,this).build()}destroy(){Be(li,this).destroy(),Be(wa,this).destroy(),super.destroy()}}function wfe(t,e,n,i){const{wtTable:r,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!o||Be(Ea,this)||t.button!==0){Wl(Ea,this,!1),Be(To,this).length=0,We(this.hot.rootElement,[lR,ww]);return}const l=Be(wa,this).isBuilt()&&!Be(wa,this).isAppended(),u=Be(li,this).isBuilt()&&!Be(li,this).isAppended();l&&u&&(Be(wa,this).appendTo(r.hider),Be(li,this).appendTo(r.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){i.row=!0,Wl(Ea,this,!0),Be(Ti,this).eventPageY=t.pageY,Be(Ti,this).coords=e,Be(Ti,this).TD=n,Wl(To,this,this.prepareRowsToMoving());const m=r.holder.scrollLeft+s.getRowHeaderWidth(),p=this.getRowsHeight(d,e.row-1)+t.offsetY;Be(li,this).setPosition(null,m),Be(li,this).setSize(r.hider.offsetWidth-m,this.getRowsHeight(d,f)),Be(li,this).setOffset(-p,null),ie(this.hot.rootElement,lR),this.refreshPositions()}else We(this.hot.rootElement,uR),Wl(Ea,this,!1),Be(To,this).length=0}function vfe(t){Be(Ea,this)&&(Be(Ti,this).eventPageY=t.pageY,this.refreshPositions())}function Cfe(t,e,n,i){!this.hot.getSelectedRangeLast()||!Be(Ea,this)||(Be(To,this).indexOf(e.row)>-1?We(this.hot.rootElement,ww):ie(this.hot.rootElement,ww),i.row=!0,i.column=!0,i.cell=!0,Be(Ti,this).coords=e,Be(Ti,this).TD=n)}function yfe(){const t=Be(Ti,this).row,e=Be(To,this).length;if(Wl(Ea,this,!1),We(this.hot.rootElement,[lR,ww,uR]),this.hot.selection.isSelectedByRowHeader()&&ie(this.hot.rootElement,uR),e<1||t===void 0)return;const n=Be(To,this)[0],i=this.hot.toPhysicalRow(n),r=this.dragRows(Be(To,this),t);if(Be(To,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(i),o=s+e-1;this.hot.selectRows(s,o)}}function bfe(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,i=e+n;Be(li,this).setPosition(null,i),Be(li,this).setSize(t.hider.offsetWidth-i)}function Sfe(){this.moveBySettingsOrLoad()}function Rfe(t,e){p$(t,e),e.add(t)}function Un(t,e,n){p$(t,e),e.set(t,n)}function p$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xt(t,e,n){return t.set(mo(t,e),n),n}function fe(t,e){return t.get(mo(t,e))}function mo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vw="manualRowResize",Efe=30,GI="manualRowHeights";var Cs=new WeakMap,Dm=new WeakMap,Li=new WeakMap,Ld=new WeakMap,va=new WeakMap,IM=new WeakMap,Mc=new WeakMap,Lm=new WeakMap,ii=new WeakMap,ps=new WeakMap,tu=new WeakMap,Cw=new WeakMap,kd=new WeakMap,$d=new WeakMap,Ar=new WeakMap,Fd=new WeakMap,na=new WeakSet;class Tfe extends ut{static get PLUGIN_KEY(){return vw}static get PLUGIN_PRIORITY(){return Efe}constructor(e){super(e),Rfe(this,na),Un(this,Cs,null),Un(this,Dm,null),Un(this,Li,[]),Un(this,Ld,null),Un(this,va,null),Un(this,IM,null),Un(this,Mc,null),Un(this,Lm,null),Un(this,ii,this.hot.rootDocument.createElement("DIV")),Un(this,ps,this.hot.rootDocument.createElement("DIV")),Un(this,tu,!1),Un(this,Cw,!1),Un(this,kd,0),Un(this,$d,null),Un(this,Ar,void 0),Un(this,Fd,void 0),ie(fe(ii,this),"manualRowResizer"),ie(fe(ps,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[vw]}enablePlugin(){this.enabled||(Xt(Ar,this,new Wa),fe(Ar,this).addLocalHook("init",()=>mo(na,this,Afe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,fe(Ar,this)),this.addHook("modifyRowHeight",(e,n)=>mo(na,this,xfe).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Xt(Fd,this,fe(Ar,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",GI,fe(Ar,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",GI,e),e.value}setManualSize(e,n){const i=this.hot.toPhysicalRow(e),r=Math.max(n,LD);return fe(Ar,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return fe(Ld,this)}setupHandlePosition(e){Xt(Cs,this,e);const{view:n}=this.hot,{_wt:i}=n,r=i.wtTable.getCoords(fe(Cs,this)),s=r.row;if(s<0)return;const o=At(fe(Cs,this)),a=fe(Cs,this).getBoundingClientRect(),l=s<i.getSetting("fixedRowsTop"),u=s>=n.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let c;l?c=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(fe(Cs,this),r.row,r.col):u&&(c=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(fe(Cs,this),r.row,r.col)),c||(c=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(fe(Cs,this),r.row,r.col)),Xt(Dm,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),Xt(Li,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();A(d,f=>{const m=f.getTopStartCorner().row,p=f.getBottomStartCorner().row;_e(m,p,y=>{fe(Li,this).includes(y)||fe(Li,this).push(y)})})}fe(Li,this).includes(fe(Dm,this))||Xt(Li,this,[fe(Dm,this)]),Xt(Lm,this,c.top-6),Xt(Mc,this,parseInt(a.height,10)),fe(ii,this).style.top=`${fe(Lm,this)+fe(Mc,this)}px`,fe(ii,this).style[this.inlineDir]=`${c.start}px`,fe(ii,this).style.width=`${o}px`,this.hot.rootElement.appendChild(fe(ii,this))}refreshHandlePosition(){fe(ii,this).style.top=`${fe(Lm,this)+fe(Ld,this)}px`}setupGuidePosition(){const e=parseInt(At(fe(ii,this)),10),n=parseInt(fe(ii,this).style[this.inlineDir],10)+e,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ie(fe(ii,this),"active"),ie(fe(ps,this),"active"),fe(ps,this).style.top=fe(ii,this).style.top,fe(ps,this).style[this.inlineDir]=`${n}px`,fe(ps,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(fe(ps,this))}refreshGuidePosition(){fe(ps,this).style.top=fe(ii,this).style.top}hideHandleAndGuide(){We(fe(ii,this),"active"),We(fe(ps,this),"active")}checkIfRowHeader(e){const n=Aa(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&fe(va,this)<n?n:fe(va,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);s!==void 0&&Xt(va,this,s),this.setManualSize(i,fe(va,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),r&&e()};fe(kd,this)>=2&&(fe(Li,this).length>1?(A(fe(Li,this),r=>{n(r)}),e()):A(fe(Li,this),r=>{n(r,!0)})),Xt(kd,this,0),Xt($d,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>mo(na,this,Mfe).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>mo(na,this,_fe).call(this,i)),this.eventManager.addEventListener(n,"mousemove",i=>mo(na,this,Ofe).call(this,i)),this.eventManager.addEventListener(n,"mouseup",()=>mo(na,this,Pfe).call(this)),this.eventManager.addEventListener(fe(ii,this),"contextmenu",()=>mo(na,this,Ife).call(this))}destroy(){super.destroy()}}function Mfe(t){if(!D0(t.target)&&fe(Cw,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(fe(tu,this)||this.setupHandlePosition(e))}}function _fe(t){De(t.target,"manualRowResizer")&&(this.setupHandlePosition(fe(Cs,this)),this.setupGuidePosition(),Xt(tu,this,!0),fe($d,this)===null&&(Xt($d,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(fe($d,this))),Xt(kd,this,fe(kd,this)+1),Xt(IM,this,t.pageY),Xt(va,this,fe(Mc,this)))}function Ofe(t){fe(tu,this)&&(Xt(Ld,this,fe(Mc,this)+(t.pageY-fe(IM,this))),A(fe(Li,this),e=>{Xt(va,this,this.setManualSize(e,fe(Ld,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Pfe(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};fe(tu,this)&&(this.hideHandleAndGuide(),Xt(tu,this,!1),fe(va,this)!==fe(Mc,this)&&(fe(Li,this).length>1?(A(fe(Li,this),i=>{e(i)}),t()):A(fe(Li,this),i=>{e(i,!0)})),this.setupHandlePosition(fe(Cs,this)))}function Ife(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(fe(ii,this)),this.hot.rootElement.removeChild(fe(ps,this)),Xt(tu,this,!1),Xt(Cw,this,!0),this.hot._registerImmediate(()=>{Xt(Cw,this,!1)})}function xfe(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalRow(e),r=fe(Ar,this).getValueAtIndex(i);this.hot.getSettings()[vw]&&r&&(n=r)}return n}function Afe(){const t=this.hot.getSettings()[vw],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,i)=>{fe(Ar,this).setValueAtIndex(i,n)}):Array.isArray(t)?(t.forEach((n,i)=>{fe(Ar,this).setValueAtIndex(i,n)}),Xt(Fd,this,t)):t===!0&&Array.isArray(fe(Fd,this))&&fe(Fd,this).forEach((n,i)=>{fe(Ar,this).setValueAtIndex(i,n)})},!0)}function Hfe(t,e,n){Nfe(t,e),e.set(t,n)}function Nfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function El(t,e,n){return(e=Dfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dfe(t){var e=Lfe(t,"string");return typeof e=="symbol"?e:e+""}function Lfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KI(t,e){return t.get(w$(t,e))}function km(t,e,n){return t.set(w$(t,e),n),n}function w$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tl=new WeakMap;class ys{constructor(e,n,i,r,s,o){El(this,"row",void 0),El(this,"col",void 0),El(this,"rowspan",void 0),El(this,"colspan",void 0),El(this,"removed",!1),El(this,"cellCoordsFactory",void 0),El(this,"cellRangeFactory",void 0),Hfe(this,Tl,null),this.row=e,this.col=n,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:i,rowspan:r,colspan:s}=e;return Ct`The merged cell declared with {row: ${n}, col: ${i},\x20
      rowspan: ${r}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:i}=e;return Ct`The merged cell declared at [${n}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:i}=e;return Ct`The merged cell declared at [${n}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:i}=e;return Ct`The merged cell declared at [${n}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:i,rowspan:r,colspan:s}=e;return n<0||i<0||r<0||s<0}static isSingleCell(e){let{rowspan:n,colspan:i}=e;return i===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:i}=e;return i===0||n===0}static isOutOfBounds(e,n,i){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const n=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),km(Tl,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const i=e[0]||e[1],r=n+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(n,r),l=Math.max(n,r),u=this[o],c=this[o]+this[s]-1;if(u>=n&&(this[o]+=i),i>0)n<=c&&n>u&&(this[s]+=i);else if(i<0){if(a<=u&&l>=c)return this.removed=!0,km(Tl,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(i)-h;this[o]-=d+i,this[s]-=h}else if(u<=a&&c>=l)this[s]+=i;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[s]-=h}}return km(Tl,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return KI(Tl,this)||km(Tl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),KI(Tl,this)}}function kfe(t,e){$fe(t,e),e.add(t)}function $fe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $m(t,e,n){return(e=Ffe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ffe(t){var e=Vfe(t,"string");return typeof e=="symbol"?e:e+""}function Vfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ro(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var us=new WeakSet;class yw{constructor(e){kfe(this,us),$m(this,"plugin",void 0),$m(this,"mergedCells",[]),$m(this,"mergedCellsMatrix",new Map),$m(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:i}=e;return Ct`The merged cell declared at [${n}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(n))!==null&&i!==void 0?i:!1}getByRange(e){let n=!1;return A(this.mergedCells,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(n=i,n):!0),n}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(r=>{const{row:s,col:o,colspan:a,rowspan:l}=r;for(let u=s;u<s+l;u++)for(let c=o;c<o+a;c++)n.add(`r${u},c${c}`)}),e.filter(r=>{const{row:s,col:o,colspan:a,rowspan:l}=r,u=new Set;let c=!1;for(let h=s;h<s+l;h++){for(let d=o;d<o+a;d++){const f=`r${h},c${d}`;if(n.has(f)){vt(yw.IS_OVERLAPPING_WARNING(r)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:r}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=i;l<=s;l++)for(let u=r;u<=o;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,r=e.col,s=e.rowspan,o=e.colspan,a=new ys(i,r,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(i,r),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),ro(us,this,XI).call(this,a),a):(vt(yw.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const i=this.get(e,n),r=i?this.mergedCells.indexOf(i):-1;return i&&r!==-1?(this.mergedCells.splice(r,1),ro(us,this,pb).call(this,i),i):!1}clear(){A(this.mergedCells,e=>{let{row:n,col:i,rowspan:r,colspan:s}=e;_e(n,n+r,o=>{_e(i,i+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const i=this.get(e,n);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===n}getFirstRenderableCoords(e,n){const i=this.get(e,n);if(!i||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,s)}getStartMostColumnIndex(e,n){const i=ro(us,this,Fm).call(this,e,"col",-1);let r=n;for(let s=0;s<i.length;s++)if(i[s]<=n){r=i[s];break}return r}getEndMostColumnIndex(e,n){const i=ro(us,this,Fm).call(this,e,"col",1);let r=n;for(let s=0;s<i.length;s++)if(i[s]>=n){r=i[s];break}return r}getTopMostRowIndex(e,n){const i=ro(us,this,Fm).call(this,e,"row",-1);let r=n;for(let s=0;s<i.length;s++)if(i[s]<=n){r=i[s];break}return r}getBottomMostRowIndex(e,n){const i=ro(us,this,Fm).call(this,e,"row",1);let r=n;for(let s=0;s<i.length;s++)if(i[s]>=n){r=i[s];break}return r}shiftCollections(e,n,i){const r=[0,0];switch(e){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i;break}A(this.mergedCells,s=>{ro(us,this,pb).call(this,s),s.shift(r,n),ro(us,this,XI).call(this,s)}),Gp(this.mergedCells.length-1,0,s=>{const o=this.mergedCells[s];o&&o.removed&&(this.mergedCells.splice(this.mergedCells.indexOf(o),1),ro(us,this,pb).call(this,o))})}}function Fm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,r=n===1?t.getTopStartCorner():t.getBottomEndCorner(),s=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let o=r.row;n===1?o<=s.row:o>=s.row;o+=n)for(let a=r.col;n===1?a<=s.col:a>=s.col;a+=n){const l=e==="row"?o:a,u=this.get(o,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),i.has(l)||i.set(l,new Set),i.get(l).add(c)}return Array.from(new Set(Array.from(i.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function XI(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function pb(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function wb(t,e,n){return(e=Wfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wfe(t){var e=Bfe(t,"string");return typeof e=="symbol"?e:e+""}function Bfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jfe{constructor(e){wb(this,"plugin",void 0),wb(this,"mergedCellsCollection",void 0),wb(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let i=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?i="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?i="up":n[1]===e[1]&&n[2]===e[2]?i="right":i="left",i}snapDragArea(e,n,i,r){const s=n.slice(0),o=this.getAutofillSize(e,n,i),[a,l,u,c]=e,d=["up","down"].indexOf(i)>-1?u-a+1:c-l+1,f=Math.floor(o/d)*d,m=o-f,p=this.getFarthestCollection(e,n,i,r);if(p){if(i==="down"){const y=p.row+p.rowspan-a-m;s[2]+y>=this.plugin.hot.countRows()?s[2]-=m:s[2]+=m?y:0}else if(i==="right"){const y=p.col+p.colspan-l-m;s[3]+y>=this.plugin.hot.countCols()?s[3]-=m:s[3]+=m?y:0}else if(i==="up"){const y=u-m-p.row+1;s[0]+y<0?s[0]+=m:s[0]-=m?y:0}else if(i==="left"){const y=c-m-p.col+1;s[1]+y<0?s[1]+=m:s[1]-=m?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:r,fillSize:o,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),un(this.currentFillData,e)}getAutofillSize(e,n,i){const[r,s,o,a]=e,[l,u,c,h]=n;switch(i){case"up":return r-l;case"down":return c-o;case"left":return s-u;case"right":return h-a;default:return null}}getDragArea(e,n,i){const[r,s,o,a]=e,[l,u,c,h]=n;switch(i){case"up":return[l,u,r-1,a];case"down":return[o+1,s,c,a];case"left":return[l,u,o,s-1];case"right":return[r,a+1,c,h];default:return null}}getFarthestCollection(e,n,i,r){const[s,o,a,l]=e,u=["up","down"].indexOf(i)>-1,c=u?a:l,h=u?s:o,d=this.getAutofillSize(e,n,i),f=u?a-s+1:l-o+1,m=Math.floor(d/f)*f,p=d-m;let y=null,E=null,T=null;switch(i){case"up":y="includesVertically",T=c-p+1;break;case"left":y="includesHorizontally",T=c-p+1;break;case"down":y="includesVertically",T=h+p-1;break;case"right":y="includesHorizontally",T=h+p-1;break}return A(r,M=>{M[y](T)&&M.isFarther(E,i)&&(E=M)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,s=(u,c)=>{switch(r){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let o=0,a=null,l=1;do for(let u=0;u<i.length;u+=1){if(a=i[u],o=l*this.currentFillData.cycleLength,s(a,o))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan});break}u===i.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},i={min:null,max:null};return A(e,r=>{const s=r[0],o=this.plugin.hot.propToCol(r[1]);(n.min===null||s<n.min)&&(n.min=s),(n.max===null||s>n.max)&&(n.max=s),(i.min===null||o<i.min)&&(i.min=o),(i.max===null||o>i.max)&&(i.max=o)}),{from:{row:n.min,column:i.min},to:{row:n.max,column:i.max}}}dragAreaOverlapsCollections(e,n,i){const r=this.getDragArea(e,n,i),[s,o,a,l]=r,u=this.plugin.hot._createCellCoords(s,o),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return this.mergedCellsCollection.getWithinRange(h,!0).length>0}}function vb(t,e,n){return(e=Ufe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ufe(t){var e=Yfe(t,"string");return typeof e=="symbol"?e:e+""}function Yfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zfe{constructor(e){vb(this,"plugin",void 0),vb(this,"hot",void 0),vb(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,i,r){const s=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(r===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(s<=c.row&&o<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${r}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const i=[];if(!n||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let s=0;s<e.colspan;s+=1)i.push(this.hot._createCellCoords(e.row+r,e.col+s));for(let r=0;r<i.length;r+=1){const s=[];for(let o=0;o<n.length;o+=1)s[o]=n[o].includes(i[r]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function Gfe(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(UE)}return this.getTranslatedPhrase(jE)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedLast();return e?ys.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Vd(t,e,n){return(e=Kfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kfe(t){var e=Xfe(t,"string");return typeof e=="symbol"?e:e+""}function Xfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qI{constructor(e){Vd(this,"data",void 0),Vd(this,"next",null),Vd(this,"prev",null),this.data=e}}class Vm{constructor(){Vd(this,"first",null),Vd(this,"last",null)}push(e){const n=new qI(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.last;this.last=n,n.prev=i,i.next=n}return n}unshift(e){const n=new qI(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.first;this.first=n,n.next=i,i.prev=n}}inorder(e){let n=this.first;for(;n;){const i=e(n);if(n===this.last||i===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,i,r;for(;n;){if(n.data===e)return i=n.next,r=n.prev,i&&(i.prev=r),r&&(r.next=i),n===this.first&&(this.first=i),n===this.last&&(this.last=r),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,r){r&&(e(r,r.next),r.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,i;for(;e;)i=e.next,e.next=n,n.prev=e,n=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=n,this.last=i}}function qfe(t,e){v$(t,e),e.add(t)}function Ml(t,e,n){v$(t,e),e.set(t,n)}function v$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gt(t,e){return t.get(bw(t,e))}function Oi(t,e,n){return t.set(bw(t,e),n),n}function bw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cs=new WeakMap,hs=new WeakMap,ds=new WeakMap,fs=new WeakMap,cR=new WeakMap,Wm=new WeakMap,Bm=new WeakMap,Cb=new WeakSet;class Zfe{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:i,columnIndexMapper:r}=e;qfe(this,Cb),Ml(this,cs,new Vm),Ml(this,hs,new Vm),Ml(this,ds,null),Ml(this,fs,null),Ml(this,cR,null),Ml(this,Wm,null),Ml(this,Bm,null),Oi(cR,this,n),Oi(Wm,this,i),Oi(Bm,this,r)}getCurrentVerticalNode(){return gt(fs,this).data}getFirstVerticalNode(){return gt(hs,this).first.data}getNextVerticalNode(){return gt(fs,this).next.data}getPrevVerticalNode(){return gt(fs,this).prev.data}getCurrentHorizontalNode(){return gt(ds,this).data}getFirstHorizontalNode(){return gt(cs,this).first.data}getNextHorizontalNode(){return gt(ds,this).next.data}getPrevHorizontalNode(){return gt(ds,this).prev.data}setPrevNodeAsActive(){Oi(fs,this,gt(fs,this).prev),Oi(ds,this,gt(ds,this).prev)}setNextNodeAsActive(){Oi(fs,this,gt(fs,this).next),Oi(ds,this,gt(ds,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),i=e.getBottomEndCorner(),r=new WeakSet;Oi(cs,this,new Vm);for(let o=n.row;o<=i.row;o++)if(!gt(Wm,this).isHidden(o))for(let a=n.col;a<=i.col;a++){if(gt(Bm,this).isHidden(a))continue;const l=bw(Cb,this,ZI).call(this,e,gt(cs,this),r,o,a);l&&Oi(ds,this,l)}gt(cs,this).first&&(gt(cs,this).first.prev=gt(cs,this).last,gt(cs,this).last.next=gt(cs,this).first);const s=new WeakSet;Oi(hs,this,new Vm);for(let o=n.col;o<=i.col;o++)if(!gt(Bm,this).isHidden(o))for(let a=n.row;a<=i.row;a++){if(gt(Wm,this).isHidden(a))continue;const l=bw(Cb,this,ZI).call(this,e,gt(hs,this),s,a,o);l&&Oi(fs,this,l)}gt(hs,this).first&&(gt(hs,this).first.prev=gt(hs,this).last,gt(hs,this).last.next=gt(hs,this).first)}setActiveNode(e,n){return gt(cs,this).inorder(i=>{const{rowStart:r,rowEnd:s,colStart:o,colEnd:a}=i.data;if(e>=r&&e<=s&&n>=o&&n<=a)return Oi(ds,this,i),!1}),gt(hs,this).inorder(i=>{const{rowStart:r,rowEnd:s,colStart:o,colEnd:a}=i.data;if(e>=r&&e<=s&&n>=o&&n<=a)return Oi(fs,this,i),!1}),this}}function ZI(t,e,n,i,r){const s=t.getTopStartCorner(),o=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=gt(cR,this).call(this,i,r);if(l&&n.has(l))return null;const u={colStart:r,colEnd:r,rowStart:i,rowEnd:i};if(l){if(n.add(l),l.row<s.row||l.row+l.rowspan-1>o.row||l.col<s.col||l.col+l.colspan-1>o.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return i===a.row&&r===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function Jfe(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:i}=e;function r(){}function s(o,a,l){const u=t.mergedCellsCollection.get(a,l);if(!Ye(u)){o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="";return}const{row:c,col:h,colspan:d,rowspan:f}=u,[m,p]=t.translateMergedCellToRenderable(c,f,h,d),y=n.getRenderableFromVisualIndex(a),E=i.getRenderableFromVisualIndex(l),T=m-y+1,M=p-E+1,P=n.getNearestNotHiddenIndex(c,1),H=i.getNearestNotHiddenIndex(h,1),U=Math.min(f,T),Y=Math.min(d,M);P===a&&H===l?(o.setAttribute("rowspan",U),o.setAttribute("colspan",Y)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}return{before:r,after:s}}function Qfe(t,e){C$(t,e),e.add(t)}function jm(t,e,n){C$(t,e),e.set(t,n)}function C$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yb(t,e,n){return(e=ege(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ege(t){var e=tge(t,"string");return typeof e=="symbol"?e:e+""}function tge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vf(t,e,n){return t.set(mt(t,e),n),n}function It(t,e){return t.get(mt(t,e))}function mt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ye.getSingleton().register("beforeMergeCells");ye.getSingleton().register("afterMergeCells");ye.getSingleton().register("beforeUnmergeCells");ye.getSingleton().register("afterUnmergeCells");const Wd="mergeCells",nge=150,JI=Wd;var sr=new WeakMap,or=new WeakMap,Ps=new WeakMap,QI=new WeakMap,bt=new WeakSet;class ige extends ut{constructor(){super(...arguments),Qfe(this,bt),yb(this,"mergedCellsCollection",null),yb(this,"autofillCalculations",null),yb(this,"selectionCalculations",null),jm(this,sr,null),jm(this,or,{row:0,col:0}),jm(this,Ps,new Zfe({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),jm(this,QI,Jfe(this))}static get PLUGIN_KEY(){return Wd}static get PLUGIN_PRIORITY(){return nge}isEnabled(){return!!this.hot.getSettings()[Wd]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new yw(this),this.autofillCalculations=new jfe(this),this.selectionCalculations=new zfe(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,rge).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,oge).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,age).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,lge).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,uge).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,ex).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,ex).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,dge).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,fge).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,gge).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,cge).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,sge).call(e,...i)}),this.addHook("afterRenderer",function(){return It(QI,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,hge).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,mge).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,pge).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,wge).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,vge).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,Cge).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,yge).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,bge).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,Sge).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,Rge).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,Ege).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,Tge).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,Mge).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,_ge).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mt(bt,e,Oge).call(e,...i)}),this.addHook("beforeUndoStackChange",(n,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Wd];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!V0())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:r,rowspan:s}=i;for(let o=r+1;o<r+s;o++)n.push(o)}),n=[...new Set(n)],n.forEach(i=>{const r=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(r);o&&(o.style.background=Pc(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{i.style.background=Pc(i,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?ys.containsNegativeValues(e)?(vt(ys.NEGATIVE_VALUES_WARNING(e)),!1):ys.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(vt(ys.IS_OUT_OF_BOUNDS_WARNING(e)),!1):ys.isSingleCell(e)?(vt(ys.IS_SINGLE_CELL(e)),!1):ys.containsZeroSpan(e)?(vt(ys.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(e){if(!Array.isArray(e))return;const n=e.filter(s=>this.validateSetting(s)),i=this.mergedCellsCollection.filterOverlappingMergeCells(n),r=[];i.forEach(s=>{const{row:o,col:a,rowspan:l,colspan:u}=s,c=this.hot._createCellCoords(o,a),h=this.hot._createCellCoords(o+l-1,a+u-1),d=this.hot._createCellRange(c,c,h);this.mergeRange(d,!0,!0);for(let f=o;f<o+l;f++)for(let m=a;m<a+u;m++)(f!==o||m!==a)&&r.push([f,m,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:r.row,col:r.col,rowspan:s.row-r.row+1,colspan:s.col-r.col+1},a=[];let l=null;return this.canMergeRange(o,n)?(this.hot.runHooks("beforeMergeCells",e,n),_e(0,o.rowspan-1,c=>{_e(0,o.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+c,o.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,n)?(i?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),A(i,r=>{this.mergedCellsCollection.remove(r.row,r.col),_e(0,r.rowspan-1,s=>{_e(0,r.colspan-1,o=>{this.hot.removeCellMeta(r.row+s,r.col+o,"hidden"),this.hot.removeCellMeta(r.row+s,r.col+o,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,i,r){const s=this.hot._createCellCoords(e,n),o=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,n,i,r){const s=this.hot._createCellCoords(e,n),o=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:JI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(JI)}modifyViewportRowStart(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(r,s);if(Ye(o)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(r,s);if(Ye(o)){const a=o.row+o.rowspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(s,r);if(Ye(o)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(s,r);if(Ye(o)){const a=o.col+o.colspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,i,r){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;n===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+n-1,-1),r===0?l=o.getNearestNotHiddenIndex(i,1):l=o.getNearestNotHiddenIndex(i+r-1,-1);const u=e>=0?s.getRenderableFromVisualIndex(a):e,c=i>=0?o.getRenderableFromVisualIndex(l):i;return[u,c]}}function rge(){this.generateFromSettings(this.hot.getSettings()[Wd]),this.hot.render()}function sge(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),i=n.getTopStartCorner(),r=n.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(i.row===e[s].row&&i.col===e[s].col&&r.row===e[s].row+e[s].rowspan-1&&r.col===e[s].col+e[s].colspan-1)return!1}return t}function oge(t){It(or,this).row=t.row,It(or,this).col=t.col}function age(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot;It(sr,this)&&(r.getRenderableFromVisualIndex(It(sr,this).row)!==null&&(n.row=It(sr,this).row),i.getRenderableFromVisualIndex(It(sr,this).col)!==null&&(n.col=It(sr,this).col),vf(sr,this,null));const s=this.mergedCellsCollection.get(n.row,n.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(t.col<0){const c=n.col>=o&&n.col<=a?o-1:a,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=o&&n.col<=a?a+1:o,h=i.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=s.row,u=s.row+s.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=r.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function lge(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:i}=e,{columnIndexMapper:r,rowIndexMapper:s}=this.hot,o=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;o(i.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=r.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,i.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;o(i.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=r.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;o(a,i.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,i.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;o(a,i.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,l)-1,1))}}function uge(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){vf(sr,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);vf(sr,this,e.clone()),n&&e.assign(n)}function cge(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:i,col:r,colspan:s,rowspan:o}=n;return[i,r,i+o-1,r+s-1]}function hge(t){t.items.push({name:"---------"},Gfe(this))}function ex(){vf(sr,this,null)}function dge(){if(It(sr,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),i=It(sr,this).clone().normalize();It(Ps,this).setActiveNode(i.row,i.col),It(or,this).row>0||It(or,this).col>0?It(Ps,this).setPrevNodeAsActive():(n==="E-W"&&It(or,this).col<0||e==="S-N"&&It(or,this).row<0)&&It(Ps,this).setNextNodeAsActive()}function fge(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:r}=this.hot;let s=null,o=null;if(It(or,this).col<0){const{rowEnd:a,colEnd:l}=It(Ps,this).getPrevHorizontalNode();o=i.getNearestNotHiddenIndex(l,-1),s=r.getNearestNotHiddenIndex(a,-1)}else if(It(or,this).col>0){const{rowStart:a,colStart:l}=It(Ps,this).getNextHorizontalNode();o=i.getNearestNotHiddenIndex(l,1),s=r.getNearestNotHiddenIndex(a,1)}else if(It(or,this).row<0){const{rowEnd:a,colEnd:l}=It(Ps,this).getPrevVerticalNode();o=i.getNearestNotHiddenIndex(l,-1),s=r.getNearestNotHiddenIndex(a,-1)}else if(It(or,this).row>0){const{rowStart:a,colStart:l}=It(Ps,this).getNextVerticalNode();o=i.getNearestNotHiddenIndex(l,1),s=r.getNearestNotHiddenIndex(a,1)}if(s!==null||o!==null){const a=this.hot._createCellCoords(s,o),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}It(Ps,this).setActiveNode(t,e),vf(or,this,{row:0,col:0})}function gge(){this.hot.getSelectedRangeLast().isHeader()||It(Ps,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function mge(t,e,n){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?n.copyable=!1:(n.rowspan=i.rowspan,n.colspan=i.colspan))}function pge(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function wge(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function vge(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let i=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,i,n))return i=e,i;const r=this.hot._createCellCoords(e[0],e[1]),s=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,s),a=this.mergedCellsCollection.getWithinRange(o);return a.length===0||(i=this.autofillCalculations.snapDragArea(e,i,n,a)),i}function Cge(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function yge(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function bge(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Sge(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Rge(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Ege(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(n);A(i,r=>{n.getBottomEndCorner().row===r.getLastRow()&&n.getBottomEndCorner().col===r.getLastColumn()&&(t[2]=r.row,t[3]=r.col)})}}function Tge(t,e,n,i){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,i)}function Mge(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function _ge(t,e,n,i){if(!(i instanceof MouseEvent))return;const r=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(r);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&r.isEqual(this.hot._createCellRange(o,o,a))}function Oge(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let i,r;if(n==="master")i=this.hot.view.getFirstRenderedVisibleColumn(),r=this.hot.view.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const o=this.hot._createCellCoords(e,i),a=this.hot._createCellCoords(e,r),l=this.hot._createCellRange(o,o,a),u=this.mergedCellsCollection.getWithinRange(l),c=u.reduce((d,f)=>{let{rowspan:m}=f;return Math.max(d,m)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{var f;let{rowspan:m}=d,p=0;n==="top"||n==="top_inline_start_corner"?p=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):p=m-h,t=Math.max((f=t)!==null&&f!==void 0?f:0,mt(bt,this,Pge).call(this,e,p))}),t}function Pge(t,e){const n=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),i=this.hot.getPlugin("autoRowSize");let r=0;for(let o=t;o<t+e;o++)if(!this.hot.rowIndexMapper.isHidden(o)){var s;r+=(s=i==null?void 0:i.getRowHeight(o))!==null&&s!==void 0?s:n}return r}function Ige(t,e){return function(n,i){const[,...r]=n,[,...s]=i;return function o(a){const l=t[a],u=e[a],c=r[a],h=s[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:qL(u.type))(l,u,d)(c,h);if(m===Ns){const p=a+1;if(typeof e[p]<"u")return o(p)}return m}(0)}}function tx(){vt(Ct`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const y$="sort";function xge(t,e,n){const i=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${y$}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function Age(t){const e=t.className.split(" "),n=new RegExp(`^${y$}-[0-9]{1,2}$`);return e.filter(i=>n.test(i))}function Hge(t,e,n){return(e=Nge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nge(t){var e=Dge(t,"string");return typeof e=="symbol"?e:e+""}function Dge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Sw="multiColumnSorting",Lge=170,bb="columnSorting",nx=Sw;XL(Sw,Ige);class kge extends sk{constructor(){super(...arguments),Hge(this,"pluginKey",Sw)}static get PLUGIN_KEY(){return Sw}static get PLUGIN_PRIORITY(){return Lge}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[bb]&&(tx(),this.hot.getPlugin(bb).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,iw)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:Ba,position:"before",group:nx})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(nx)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];super.updateHeaderClasses(e,...i),We(e,Age(e)),this.enabled!==!1&&ie(e,xge(...i))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[bb]&&tx(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){pM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,iw))):this.sort(this.getColumnNextConfig(n.col)))}}function ix(t,e,n){return(e=$ge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ge(t){var e=Fge(t,"string");return typeof e=="symbol"?e:e+""}function Fge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Vge="multipleSelectionHandles",Wge=160;class Bge extends ut{constructor(){super(...arguments),ix(this,"dragged",[]),ix(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Vge}static get PLUGIN_PRIORITY(){return Wge}isEnabled(){return bo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function i(r){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(r);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",r=>{let s;if(De(r.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},r.preventDefault(),!1;if(De(r.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",r=>{if(De(r.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,r.preventDefault(),!1;if(De(r.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",r=>{const{rootDocument:s}=this.hot;let o,a,l,u,c,h;if(e.dragged.length===0)return;const d=s.elementFromPoint(r.touches[0].clientX,r.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(o=e.hot.getCoords(d),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(o),h=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),r.preventDefault())})}getCurrentRangeCoords(e,n,i,r,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":s==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,o.col)};break;case"SE-NW":s==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,o.col)});break}break;case"NW-SE":switch(r){case"NE-SW":s==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":s==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":s==="top"?c={start:n,end:o}:c.end=n;break;case"SW-NE":s==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(r){case"NW-SE":s==="bottom"?c={start:this.hot._createCellCoords(n.row,o.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(o.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":s==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,o.col),end:this.hot._createCellCoords(o.row,n.col)};break;case"SE-NW":s==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(o.row,n.col)}:s==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(c.end=n);break;case"SE-NW":s==="top"?c.end=n:c={start:n,end:o};break}break}return c}isDragged(){return this.dragged.length>0}}function hR(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:i=!1,crossHiddenColumns:r=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:i,isCollapsed:s,crossHiddenColumns:r,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:u}}function b$(){return{label:"",isPlaceholder:!0}}function jge(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;A(t,r=>{const s=[];let o=0;n.push(s),A(r,a=>{const l=hR();if(Ye(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Jt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Jt(a);o+=l.origColspan;let u=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,u=!0),s.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)s.push(b$());return!u})});const i=Math.max(...tt(n,r=>r.length));return A(n,r=>{if(r.length<i){const s=tt(new Array(i-r.length),()=>hR());r.splice(r.length,0,...s)}}),n}function Sb(t,e,n){Uge(t,e),e.set(t,n)}function Uge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tr(t,e){return t.get(S$(t,e))}function Qh(t,e,n){return t.set(S$(t,e),n),n}function S$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rx=["label","collapsible"];var so=new WeakMap,_l=new WeakMap,Rb=new WeakMap;class Yge{constructor(){Sb(this,so,[]),Sb(this,_l,0),Sb(this,Rb,1/0)}setColumnsLimit(e){Qh(Rb,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Qh(so,this,jge(e,Tr(Rb,this))),Qh(_l,this,Tr(so,this).length)}getData(){return Tr(so,this)}mergeWith(e){A(e,n=>{let{row:i,col:r,...s}=n;const o=this.getHeaderSettings(i,r);o!==null&&un(o,s,rx)})}map(e){A(Tr(so,this),n=>{A(n,i=>{const r=e({...i});Ye(r)&&un(i,r,rx)})})}getHeaderSettings(e,n){var i;if(e>=Tr(_l,this)||e<0)return null;const r=Tr(so,this)[e];return Array.isArray(r)===!1||n>=r.length?null:(i=r[n])!==null&&i!==void 0?i:null}getHeadersSettings(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=[];if(e>=Tr(_l,this)||e<0)return r;const s=Tr(so,this)[e];let o=0;for(let a=n;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,r.push(l),l.colspan>1&&(a+=l.colspan-1),o===i)break;if(o>i)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return Tr(_l,this)}getColumnsCount(){return Tr(_l,this)>0?Tr(so,this)[0].length:0}clear(){Qh(so,this,[]),Qh(_l,this,0)}}function Eb(t,e,n){return(e=zge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zge(t){var e=Gge(t,"string");return typeof e=="symbol"?e:e+""}function Gge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const R$="DF-pre-order";function E$(t,e){let n=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(n===!1)return!1;n=E$.call(this.childs[i],t,e)}return n}const Kge="DF-post-order";function T$(t,e){for(let n=0;n<this.childs.length;n++)if(T$.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const M$="BF";function Xge(t,e){const n=[this];function i(){if(n.length===0)return;const r=n.shift();n.push(...r.childs),t.call(e,r)!==!1&&i()}i()}const qge=M$,sx=new Map([[R$,E$],[Kge,T$],[M$,Xge]]);class Rw{constructor(e){Eb(this,"data",{}),Eb(this,"parent",null),Eb(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new Rw({...e.data});for(let i=0;i<e.childs.length;i++)n.addChild(this.cloneTree(e.childs[i]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qge;if(!sx.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);sx.get(n).call(this,e,this)}walkUp(e){const n=this,i=r=>{e.call(n,r)!==!1&&r.parent!==null&&i(r.parent)};i(this)}}function Tb(t,e,n){Zge(t,e),e.set(t,n)}function Zge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ti(t,e){return t.get(_$(t,e))}function Jge(t,e,n){return t.set(_$(t,e),n),n}function _$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qu=new WeakMap,Ol=new WeakMap,ec=new WeakMap;class Qge{constructor(e){Tb(this,Qu,new Map),Tb(this,Ol,new Map),Tb(this,ec,null),Jge(ec,this,e)}getRoots(){return Array.from(ti(Qu,this).values())}getRootByColumn(e){let n;return ti(Ol,this).has(e)&&(n=ti(Qu,this).get(ti(Ol,this).get(e))),n}getNode(e,n){const i=this.getRootByColumn(n);if(!i)return;const r=n-ti(Ol,this).get(n);let s=0,o;return i.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(r>=s&&r<=s+l-1)return o=a,o.data.isRoot=n===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;ti(Ol,this).clear(),A(ti(Qu,this),n=>{let[,{data:{colspan:i}}]=n;for(let r=e;r<e+i;r++)ti(Ol,this).set(r,e);e+=i})}buildTree(){this.clear();const e=ti(ec,this).getColumnsCount();let n=0;for(;n<e;){const i=ti(ec,this).getHeaderSettings(0,n),r=new Rw;ti(Qu,this).set(n,r),this.buildLeaves(r,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=ti(ec,this).getHeadersSettings(i,n,r);i+=1,A(s,o=>{const a={...o,headerLevel:i-1,columnIndex:n};let l;i===1?(e.data=a,l=e):(l=new Rw(a),e.addChild(l)),i<ti(ec,this).getLayersCount()&&this.buildLeaves(l,n,i,o.origColspan),n+=o.origColspan})}clear(){ti(Qu,this).clear(),ti(Ol,this).clear()}}function O$(t,e){t.walkDown(n=>{let{data:i,childs:r}=n;if(!i.isHidden&&(e(i.columnIndex),r.length===0))for(let s=1;s<i.colspan;s++)e(i.columnIndex+s)})}function Ew(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Tw(t){return Ew(t,"origColspan")===t.data.origColspan}function xM(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Tw(t))return xM(n[0]);e.isCollapsed=!1;const r=n.slice(1),s=new Set;let o=0;if(r.length>0)A(r,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,O$(a,u=>{s.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;o=l-a;for(let c=1;c<l;c++)s.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Tw(a)&&(l.isCollapsed=Ew(a,"isCollapsed"))}),{rollbackModification:()=>AM(t),affectedColumns:Array.from(s),colspanCompensation:o}}function AM(t){var e;const{data:n,childs:i}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Tw(t))return AM(i[0]);n.isCollapsed=!0;const s=i.slice(1),o=new Set;if(s.length>0)A(s,l=>{O$(l,u=>{o.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;o.add(h)}}const a=n.colspan-((e=Ew(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Tw(l)&&(u.isCollapsed=Ew(l,"isCollapsed"))}),{rollbackModification:()=>xM(t),affectedColumns:Array.from(o),colspanCompensation:a}}function eme(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ct`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:s}}=r;if(s)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:s}=r;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function tme(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ct`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:s}}=r;if(s)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:s}=r;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const ox=new Map([["collapse",AM],["expand",xM],["hide-column",eme],["show-column",tme]]);function nme(t,e,n){if(!ox.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return ox.get(t)(e,n)}function Um(t){const e=[];return A(t,n=>{n.walkDown(i=>{const r=i.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=r,u=rme(e,a);let c=!1;for(let h=o;h<o+s;h++)if(l.includes(h)||c)u.push(b$());else{const f=ime(r);f.isRoot=!0,u.push(f),c=!0}})}),e}function ime(t){const{crossHiddenColumns:e,...n}=hR(t);return n}function rme(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function Mb(t,e,n){sme(t,e),e.set(t,n)}function sme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ed(t,e,n){return t.set(P$(t,e),n),n}function Gt(t,e){return t.get(P$(t,e))}function P$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gs=new WeakMap,pi=new WeakMap,Pl=new WeakMap;class ome{constructor(){Mb(this,gs,new Yge),Mb(this,pi,new Qge(Gt(gs,this))),Mb(this,Pl,[[]])}setState(e){Gt(gs,this).setData(e);let n=!1;try{Gt(pi,this).buildTree()}catch{Gt(pi,this).clear(),Gt(gs,this).clear(),n=!0}return ed(Pl,this,Um(Gt(pi,this).getRoots())),n}setColumnsLimit(e){Gt(gs,this).setColumnsLimit(e)}mergeStateWith(e){const n=tt(e,i=>{let{row:r,...s}=i;return{row:r<0?this.rowCoordsToLevel(r):r,...s}});Gt(gs,this).mergeWith(n),Gt(pi,this).buildTree(),ed(Pl,this,Um(Gt(pi,this).getRoots()))}mapState(e){Gt(gs,this).map(e),Gt(pi,this).buildTree(),ed(Pl,this,Um(Gt(pi,this).getRoots()))}mapNodes(e){return cn(Gt(pi,this).getRoots(),(n,i)=>(i.walkDown(r=>{const s=e(r.data);s!==void 0&&n.push(s)}),n),[])}triggerNodeModification(e,n,i){n<0&&(n=this.rowCoordsToLevel(n));const r=Gt(pi,this).getNode(n,i);let s;return r&&(s=nme(e,r,i),ed(Pl,this,Um(Gt(pi,this).getRoots()))),s}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var i,r;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(r=Gt(Pl,this)[e])===null||r===void 0?void 0:r[n])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,n){const i=this.getHeaderTreeNode(e,n);return i?{...i.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=Gt(pi,this).getNode(e,n);return i||null}findTopMostEntireHeaderLevel(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=i-e+1;let s=!1,o=null;for(let a=e;a<=i;a++){const l=Gt(pi,this).getRootByColumn(a);if(!l)break;s=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:d,isHidden:f}=u.data;f||d<=r&&c>=e&&c+d-1<=i&&(o===null||h<o)&&(o=h)},R$)}return s&&o===null?-1:this.levelToRowCoords((n=o)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var i;const{isRoot:r}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0};if(r)return n;let s=n-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,n){var i;const{isRoot:r,origColspan:s}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(r)return n+s-1;let o=n+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return Gt(gs,this).getLayersCount()}getColumnsCount(){return Gt(gs,this).getColumnsCount()}clear(){ed(Pl,this,[]),Gt(gs,this).clear(),Gt(pi,this).clear()}}function td(t,e,n){return(e=ame(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ame(t){var e=lme(t,"string");return typeof e=="symbol"?e:e+""}function lme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ume{constructor(e,n){td(this,"hot",void 0),td(this,"nestedHeaderSettingsGetter",void 0),td(this,"layersCount",0),td(this,"container",void 0),td(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let i=0;i<n;i++){const r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(r);this.widthsMap.setValueAtIndex(s,e[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:i}=this.hot,r=n.createDocumentFragment(),s=n.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=i.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;o&&(m+='<button class="changeType"></button>'),hu(d,m),d.colSpan=f.colspan,u.appendChild(d)}}s.appendChild(u)}r.appendChild(s),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}}function cme(t,e){I$(t,e),e.add(t)}function ax(t,e,n){return(e=hme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hme(t){var e=dme(t,"string");return typeof e=="symbol"?e:e+""}function dme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ym(t,e,n){I$(t,e),e.set(t,n)}function I$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bl(t,e,n){return t.set(Kt(t,e),n),n}function rt(t,e){return t.get(Kt(t,e))}function Kt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lx="nestedHeaders",fme=280;var Rt=new WeakMap,ia=new WeakMap,Bd=new WeakMap,Yv=new WeakMap,tn=new WeakSet;class gme extends ut{constructor(){super(...arguments),cme(this,tn),Ym(this,Rt,new ome),Ym(this,ia,null),Ym(this,Bd,null),Ym(this,Yv,!1),ax(this,"ghostTable",new ume(this.hot,(e,n)=>this.getHeaderSettings(e,n))),ax(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return lx}static get PLUGIN_PRIORITY(){return fme}isEnabled(){return!!this.hot.getSettings()[lx]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&vt(Ct`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Kt(tn,this,Ime).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,xme).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,vme).call(e,...r)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,Cme).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,yme).call(e,...r)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,bme).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,Sme).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,Rme).call(e,...r)}),this.addHook("afterSelection",()=>Kt(tn,this,zm).call(this)),this.addHook("afterSelectionFocusSet",()=>Kt(tn,this,zm).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,mme).call(e,...r)}),this.addHook("afterGetColumnHeaderRenderers",i=>Kt(tn,this,Tme).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,_me).call(e,...r)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,Ome).call(e,...r)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,pme).call(e,...r)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,wme).call(e,...r)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,Eme).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,Mme).call(e,...r)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Kt(tn,e,Pme).call(e,...r)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Kt(tn,this,zm).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Kt(tn,this,zm).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();rt(Rt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=rt(Rt,this).setState(e)),this.detectedOverlappedHeaders&&vt(Ct`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,i)=>{const r=n===!0?"hide-column":"show-column";rt(Rt,this).triggerColumnModification(r,i)}),!rt(ia,this)&&this.enabled&&Bl(ia,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(i=>{let{op:r,index:s,newValue:o}=i;if(r==="replace"){const a=o===!0?"hide-column":"show-column";rt(Rt,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),rt(Rt,this).clear(),rt(ia,this).unsubscribe(),Bl(ia,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return rt(Rt,this)}getLayersCount(){return rt(Rt,this).getLayersCount()}getHeaderSettings(e,n){return rt(Rt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<n;o++){const a=i.childNodes[o];if(!a)break;const l=r.childNodes[o],u=s?s.childNodes[o]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),We(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),We(l.childNodes[c],"hiddenHeader")),s&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),We(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(r);u===null&&(u=r),s.removeAttribute("colspan"),We(s,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(o=rt(Rt,this).getHeaderSettings(e,u))!==null&&o!==void 0?o:{label:""};if(d||h)ie(s,"hiddenHeader");else if(c>1){var m,p;const{wtOverlays:y}=l._wt,E=(m=y.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s),T=(p=y.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(s),M=E||T?Math.min(c,i-r):c;M>1&&s.setAttribute("colspan",M)}if(this.hot.view.appendColHeader(u,s,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const y=s.querySelector("div.relative");y&&f&&f.length>0&&(We(y,this.hot.getColumnMeta(u).headerClassName),ie(y,f))}}}getColumnHeaderValue(e,n){var i;const{isHidden:r,isPlaceholder:s}=(i=rt(Rt,this).getHeaderSettings(n,e))!==null&&i!==void 0?i:{};return s||r?"":this.hot.getColHeader(e,n)}destroy(){Bl(Rt,this,null),rt(ia,this)!==null&&(rt(ia,this).unsubscribe(),Bl(ia,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return rt(Rt,this).getHeaderTreeNodeData(e.row,e.col)}}function zm(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const r=rt(Rt,this).findLeftMostColumnIndex(n.row,n.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=r,s.visualCellRange.from.col=r,s.visualCellRange.to.col=r,s.commit()}}function mme(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const r=this.hot.view.getFirstFullyVisibleColumn(),s=this.hot.view.getLastFullyVisibleColumn(),o=rt(Rt,this).findLeftMostColumnIndex(n.row,n.col),a=rt(Rt,this).findRightMostColumnIndex(n.row,n.col);return o<r&&a>s?t:o<r?o:a}function pme(t,e,n){const i=rt(Rt,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:r,selectionType:s,selectionWidth:o}=n,{isRoot:a,colspan:l}=rt(Rt,this).getHeaderSettings(e,t);if(s===oE){if(!a)return i.columnIndex}else if(s===zD&&(l>o-r||!a))return null;return t}function wme(t,e,n){let{columnHeadersCount:i}=n;if(i!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:u}=e[s],c=l-o+1,h=a-u+1;if(o>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=o;f<=l;f++){var r;const m=c+f,p=d-a;if(p===0)continue;((r=rt(Rt,this).getHeaderTreeNodeData(f,d))===null||r===void 0?void 0:r.isRoot)===!1&&(t[m][p]="")}}}function vme(t,e,n,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function Cme(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Bl(Bd,this,e.clone()),Bl(Yv,this,!0);const{selection:i}=this.hot,r=i.isSelected()?i.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=n,l=!i.inInSelection(e);t.shiftKey&&r?e.col<r.from.col?s.push(r.getTopEndCorner().col,o,e.row):e.col>r.from.col?s.push(r.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(wv(t)||Na(t)&&l||wD(t))&&s.push(o,o+a-1,e.row),i.selectColumns(...s)}function yme(t,e,n,i){if(!this.hot.view.isMouseDown())return;const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;const{columnIndex:s,origColspan:o}=r,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;i.column=!0,i.cell=!0;const h=[],d=pt(e.row,-1/0,-1);e.col<c.col?h.push(u.col,s,d):e.col>c.col?h.push(l.col,s+o-1,d):h.push(s,s+o-1,d),this.hot.selection.selectColumns(...h)}function bme(){Bl(Yv,this,!1)}function Sme(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!rt(Yv,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:r,origColspan:s}=rt(Rt,this).getHeaderTreeNodeData(rt(Bd,this).row,rt(Bd,this).col);if(e.setHighlight(rt(Bd,this)),s>e.getWidth()||r<n||r+s-1>i){const o=rt(Rt,this).findTopMostEntireHeaderLevel(pt(n,r,r+s-1),pt(i,r,r+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function Rme(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const r=rt(Rt,this).findLeftMostColumnIndex(n.row,n.col),s=rt(Rt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const o=e.col>=r&&e.col<=s?r-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const o=e.col>=r&&e.col<=s?s+1:r,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Eme(t,e){const n=t.row,i=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),r=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),r&&(e.col=r.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),r&&(e.col=r.columnIndex+r.origColspan-1))}function Tme(t){t.length=0;for(let e=0;e<rt(Rt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Mme(t){const e=rt(Rt,this).getLayersCount();let n=t.startColumn,i=!!e;for(let r=0;r<e;r++){const s=rt(Rt,this).findLeftMostColumnIndex(r,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(i=!1),zn(o)&&o<t.startColumn){n=o;break}}t.startColumn=i?rt(Rt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function _me(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Ome(t,e,n){var i;const{label:r}=(i=rt(Rt,this).getHeaderTreeNodeData(n,e))!==null&&i!==void 0?i:{label:""};return r}function Pme(t,e){if(t<0)return this.hot.getCell(t,rt(Rt,this).findLeftMostColumnIndex(t,e),!0)}function Ime(){this.updatePlugin()}function xme(t,e){e||this.updatePlugin()}function nd(t,e,n){return(e=Ame(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ame(t){var e=Hme(t,"string");return typeof e=="symbol"?e:e+""}function Hme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nme{constructor(e,n){nd(this,"hot",void 0),nd(this,"data",null),nd(this,"plugin",void 0),nd(this,"parentReference",new WeakMap),nd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},_e(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,i){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&A(e.__children,r=>{this.cacheNode(r,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,i,r){let s=!1,o=n;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),i!=null&&o===i?{result:a,end:!0}:r!=null&&a===r?{result:o,end:!0}:(o+=1,a.__children&&A(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,i,r),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return ze(this.data[0],(n,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(A(i.__children,r=>{n+=1,r.__children&&(n+=this.countChildren(r))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var i;return((i=e.__children)===null||i===void 0?void 0:i[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let i=n;this.hot.runHooks("beforeAddChild",e,i);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),i||(i=this.mockNode()),s.__children.push(i),this.rewriteCache();const o=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,n,i){let r=i,s;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",e,r,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[n]);r=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,r,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),r=this.getRowParent(i),s=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(r,s+1,null);break;case"above":this.addChildAtIndex(r,s,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const r=[];Array.isArray(e)?(_e(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);r.push(this.getDataObject(f))}),_e(0,r.length-2,d=>{this.detachFromParent(r[d],!1)}),i=r[r.length-1]):i=e;const s=this.getRowIndex(i),o=this.countChildren(i),a=this.getRowIndexWithinParent(i),l=this.getRowParent(i),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,i),a!=null){const d=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,o+1,this.plugin.pluginName),u.__children.push(i)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,o+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),n&&this.hot.render()}filterData(e,n,i){const r=[];A(i,s=>{r.push(this.getDataObject(s))}),A(r,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,n,i){const r=this.getDataObject(e-1);let s=null,o=e;r&&r.__children&&r.__children.length===0?(s=r,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?i?s.__children.splice(o,n,...i):s.__children.splice(o,n):i?this.data.splice(o,n,...i):this.data.splice(o,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,i,r){const s=n===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),u=e>n;let c=s?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=s||i||r?c.__children.length:this.getRowIndexWithinParent(n),d=o===c;c.__children.splice(h,0,l[0]),o.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function ux(t,e,n){return(e=Dme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dme(t){var e=Lme(t,"string");return typeof e=="symbol"?e:e+""}function Lme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HM{constructor(e,n){ux(this,"hot",void 0),ux(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Es extends HM{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const i=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(i),s=this.dataManager.getDataObject(i),o=n.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(A(l,c=>{c&&o.removeChild(c)}),ie(n,Es.CSS_CLASSES.indicatorContainer),r){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);o.innerHTML="",_e(0,r-1,()=>{const d=c.createElement("SPAN");ie(d,Es.CSS_CLASSES.emptyIndicator),o.appendChild(d)}),o.appendChild(h)}if(this.dataManager.hasChildren(s)){const c=this.hot.rootDocument.createElement("DIV");u&&xe(c,[Vo()]),ie(n,Es.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(ie(c,`${Es.CSS_CLASSES.button} ${Es.CSS_CLASSES.expandButton}`),u&&xe(n,[lr(!1)])):(ie(c,`${Es.CSS_CLASSES.button} ${Es.CSS_CLASSES.collapseButton}`),u&&xe(n,[lr(!0)])),o.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}class kme extends HM{constructor(e,n){var i;super(e,n),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,r)},shiftStash:function(r,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),A(i.lastCollapsedRows,(a,l)=>{a>=r&&a<s&&(i.lastCollapsedRows[l]=a+o)})},applyStash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,r),i.lastCollapsedRows=void 0},trimStash:(r,s)=>{_e(r,r+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&A(s.__children,l=>{r.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(r,!0,!1),i&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];A(e,s=>{r.push(...this.collapseChildren(s,!1,!1))}),i&&this.trimRows(r),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return A(e,s=>{r.push(s),n&&this.collapseChildRows(s,r)}),i&&this.trimRows(r),r}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);A(r.__children,s=>{const o=this.dataManager.getRowIndex(s);n.push(o),this.collapseChildRows(o,n)})}i&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return A(e,s=>{r.push(s),n&&this.expandChildRows(s,r)}),i&&this.untrimRows(r),r}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);A(r.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);n.push(o),this.expandChildRows(o,n)}})}i&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&A(s.__children,l=>{const u=this.dataManager.getRowIndex(l);r.push(u)}),a=this.expandRows(r,!0,!1),i&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];A(e,s=>{r.push(...this.expandChildren(s,!1,!1))}),i&&this.untrimRows(r),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];A(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];A(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{A(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{A(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&A(n.__children,r=>{const s=this.dataManager.getRowIndex(r);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return i=!1,!1}),i}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const i=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const i=this.translateTrimmedRow(n.row);De(e.target,Es.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),gr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function $me(t,e,n){Fme(t,e),e.set(t,n)}function Fme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vme(t,e,n){return(e=Wme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wme(t){var e=Bme(t,"string");return typeof e=="symbol"?e:e+""}function Bme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jme(t,e){return t.get(Ume(t,e))}function Ume(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cx=new WeakMap;class Yme extends HM{constructor(){super(...arguments),Vme(this,"dataManager",this.plugin.dataManager),$me(this,cx,{row_above:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(uT)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),r=this.dataManager.getDataObject(i);this.dataManager.addChild(r)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(cT)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),r=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(r)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return _e(0,e.items.length-1,i=>{if(i===0)return A(n,(r,s)=>{e.items.splice(i+s,0,r)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return _e(0,e.items.length-1,n=>{const i=jme(cx,this)[e.items[n].key];i!=null&&(e.items[n].callback=i)}),e}}function Gm(t,e,n){return(e=zme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zme(t){var e=Gme(t,"string");return typeof e=="symbol"?e:e+""}function Gme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kme{constructor(e){Gm(this,"plugin",void 0),Gm(this,"hot",void 0),Gm(this,"dataManager",void 0),Gm(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,i,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;const o=i===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let l=!0;const u=e.map(m=>{if(!l)return!1;const p=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(p,a),p}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(o,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,i,r,r&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:i,dropIndex:r,movePossible:s}=e;let o=!1;return xt(r)&&(vt(Ct`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,i,r,s,!1),o=!0),o}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let i=this.dataManager.getRowParent(e?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}shiftCollapsibleParentsLocations(e,n,i){i||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,i){const r=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,n,this.movedToCollapsed,r)})})}moveCellsMeta(e,n){const i=[],r=Math.max(...e)<n;e.forEach(s=>{i.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(r?i.length:0),0,...i)}selectCells(e,n){const i=e.length;let r=0,s=0,o=null,a=null;if(this.movedToCollapsed){let l=null;e[i-1]<n?l=this.dataManager.translateTrimmedRow(n-i):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);r=this.dataManager.untranslateTrimmedRow(c),s=r}else e[i-1]<n?(s=n-1,r=s-i+1):(r=n,s=r+i-1);o=this.hot.selection,a=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(r,0)),o.setRangeEnd(this.hot._createCellCoords(s,a),!0)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}}function Xme(t,e){x$(t,e),e.add(t)}function hx(t,e,n){x$(t,e),e.set(t,n)}function x$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _b(t,e,n){return(e=qme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qme(t){var e=Zme(t,"string");return typeof e=="symbol"?e:e+""}function Zme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rp(t,e){return t.get(yn(t,e))}function Mw(t,e,n){return t.set(yn(t,e),n),n}function yn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _w="nestedRows",Jme=300,dx=_w,Qme="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var zv=new WeakMap,tc=new WeakMap,Mn=new WeakSet;class epe extends ut{constructor(){super(...arguments),Xme(this,Mn),_b(this,"dataManager",null),_b(this,"headersUI",null),_b(this,"collapsedRowsMap",null),hx(this,zv,!1),hx(this,tc,!1)}static get PLUGIN_KEY(){return _w}static get PLUGIN_PRIORITY(){return Jme}isEnabled(){return!!this.hot.getSettings()[_w]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new jf),this.dataManager=new Nme(this,this.hot),this.collapsingUI=new kme(this,this.hot),this.headersUI=new Es(this,this.hot),this.contextMenuUI=new Yme(this,this.hot),this.rowMoveController=new Kme(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,gpe).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,mpe).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,ipe).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,rpe).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,spe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,npe).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,lpe).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,ape).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,upe).call(e,...i)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,cpe).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,hpe).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,dpe).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,ope).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,fpe).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yn(Mn,e,tpe).call(e,...i)}),this.addHook("beforeLoadData",n=>yn(Mn,this,fx).call(this,n)),this.addHook("beforeUpdateData",n=>yn(Mn,this,fx).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:dx,relativeToGroup:Ba,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dx)}disableCoreAPIModifiers(){Mw(tc,this,!0)}enableCoreAPIModifiers(){Mw(tc,this,!1)}onModifyRowData(e){if(!Rp(tc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Rp(tc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,i){return Rp(tc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,i),!1)}destroy(){super.destroy()}}function tpe(t,e,n,i){return this.rowMoveController.onBeforeRowMove(t,e,n,i)}function npe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function ipe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),Mw(zv,this,!0),this.dataManager.getData().slice()}function rpe(t){return this.contextMenuUI.appendOptions(t)}function spe(t,e){this.headersUI.appendLevelIndicators(t,e)}function ope(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function ape(t,e,n,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{Mw(zv,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function lpe(t,e,n){const i=Array.from(n.reduce((r,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return r.add(s),Array.isArray(o)&&o.forEach(a=>r.add(this.dataManager.getRowIndex(a))),r}return r.add(s)},new Set));n.length=0,n.push(...i)}function upe(){this.collapsingUI.collapsedRowsStash.stash()}function cpe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function hpe(){this.collapsingUI.collapsedRowsStash.stash()}function dpe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function fpe(){this.dataManager.rewriteCache()}function gpe(){this.headersUI.updateRowHeaderWidth()}function mpe(t,e){Rp(zv,this)&&(e.skipRender=!0)}function fx(t){if(!tL(t)){z0(Qme),this.hot.getSettings()[_w]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function Ob(t,e,n){return(e=ppe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ppe(t){var e=wpe(t,"string");return typeof e=="symbol"?e:e+""}function wpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vpe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;Ob(this,"rootWindow",void 0),Ob(this,"prefix",void 0),Ob(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const i=typeof e>"u"?n:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return r===null?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){A(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function Cpe(t,e,n){return(e=ype(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ype(t){var e=bpe(t,"string");return typeof e=="symbol"?e:e+""}function bpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ye.getSingleton().register("persistentStateSave");ye.getSingleton().register("persistentStateLoad");ye.getSingleton().register("persistentStateReset");const gx="persistentState",Spe=0;class Rpe extends ut{constructor(){super(...arguments),Cpe(this,"storage",void 0)}static get PLUGIN_KEY(){return gx}static get PLUGIN_PRIORITY(){return Spe}isEnabled(){return!!this.hot.getSettings()[gx]}enablePlugin(){this.enabled||(this.storage||(this.storage=new vpe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Epe(t,e){Tpe(t,e),e.add(t)}function Tpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pb(t,e,n){return(e=Mpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mpe(t){var e=_pe(t,"string");return typeof e=="symbol"?e:e+""}function _pe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ib="search",Ope=190,Ppe="htSearchResult",Ipe=function(t,e,n,i,r){t.getCellMeta(e,n).isSearchResult=r},xpe=function(t,e,n){return xt(t)||t===null||!t.toLocaleLowerCase||t.length===0||xt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var xb=new WeakSet;class Ape extends ut{constructor(){super(...arguments),Epe(this,xb),Pb(this,"callback",Ipe),Pb(this,"queryMethod",xpe),Pb(this,"searchResultClass",Ppe)}static get PLUGIN_KEY(){return Ib}static get PLUGIN_PRIORITY(){return Ope}isEnabled(){return this.hot.getSettings()[Ib]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Ib];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return mx(xb,e,px).call(e,...r)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return mx(xb,e,px).call(e,...r)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return _e(0,r-1,l=>{_e(0,s-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,m=(h.search.queryMethod||i)(e,c,h);if(m){const p={row:l,col:u,data:c};o.push(p)}d&&d(a,l,u,c,m)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Ye(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function px(t,e,n,i,r,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function Hpe(t,e){Npe(t,e),e.add(t)}function Npe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Km(t,e,n){return(e=Dpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dpe(t){var e=Lpe(t,"string");return typeof e=="symbol"?e:e+""}function Lpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ab(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kpe="touchScroll",$pe=200;var Xm=new WeakSet;class Fpe extends ut{constructor(){super(...arguments),Hpe(this,Xm),Km(this,"scrollbars",[]),Km(this,"clones",[]),Km(this,"lockedCollection",!1),Km(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return kpe}static get PLUGIN_PRIORITY(){return $pe}static get SETTING_KEYS(){return!0}isEnabled(){return F0()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Ab(Xm,this,Vpe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Ab(Xm,this,Wpe).call(this)),this.addHook("afterMomentumScroll",()=>Ab(Xm,this,Bpe).call(this))}}function Vpe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),i&&this.scrollbars.push(i),r&&r.clone&&this.scrollbars.push(r),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}function Wpe(){this.freezeOverlays=!0,A(this.clones,t=>{ie(t,"hide-tween")})}function Bpe(){this.freezeOverlays=!1,A(this.clones,t=>{We(t,"hide-tween"),ie(t,"show-tween")}),this.hot._registerTimeout(()=>{A(this.clones,t=>{We(t,"show-tween")})},400),A(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function jpe(t,e){Upe(t,e),e.add(t)}function Upe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ype(t,e,n){return(e=zpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zpe(t){var e=Gpe(t,"string");return typeof e=="symbol"?e:e+""}function Gpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kpe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ep="trimRows",Xpe=330;var wx=new WeakSet;class qpe extends ut{constructor(){super(...arguments),jpe(this,wx),Ype(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Ep}static get PLUGIN_PRIORITY(){return Xpe}isEnabled(){return!!this.hot.getSettings()[Ep]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new jf),this.trimmedRowsMap.addLocalHook("init",()=>Kpe(wx,this,Zpe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Ep];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),A(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{A(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",n,r,i,i&&r.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;i&&o&&(A(e,l=>{s[l]=!1}),r=cn(s,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,r,i&&o)!==!1&&(i&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",n,r,i&&o,i&&r.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<n)}destroy(){super.destroy()}}function Zpe(){const t=this.hot.getSettings()[Ep];Array.isArray(t)&&this.hot.batchExecution(()=>{A(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var A$={},Jpe=Fa,Qpe=A$,ewe=Jpe("iterator"),twe=Array.prototype,nwe=function(t){return t!==void 0&&(Qpe.Array===t||twe[ewe]===t)},iwe=gH,vx=Gw,rwe=Bw,swe=A$,owe=Fa,awe=owe("iterator"),H$=function(t){if(!rwe(t))return vx(t,awe)||vx(t,"@@iterator")||swe[iwe(t)]},lwe=Yr,uwe=Rf,cwe=ko,hwe=zw,dwe=H$,fwe=TypeError,gwe=function(t,e){var n=arguments.length<2?dwe(t):e;if(uwe(n))return cwe(lwe(n,t));throw new fwe(hwe(t)+" is not iterable")},mwe=IH,pwe=Yr,wwe=ko,vwe=zw,Cwe=nwe,ywe=_f,Cx=Uw,bwe=gwe,Swe=H$,yx=ZR,Rwe=TypeError,Tp=function(t,e){this.stopped=t,this.result=e},bx=Tp.prototype,Ewe=function(t,e,n){var i=n&&n.that,r=!!(n&&n.AS_ENTRIES),s=!!(n&&n.IS_RECORD),o=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=mwe(e,i),u,c,h,d,f,m,p,y=function(T){return u&&yx(u,"normal",T),new Tp(!0,T)},E=function(T){return r?(wwe(T),a?l(T[0],T[1],y):l(T[0],T[1])):a?l(T,y):l(T)};if(s)u=t.iterator;else if(o)u=t;else{if(c=Swe(t),!c)throw new Rwe(vwe(t)+" is not iterable");if(Cwe(c)){for(h=0,d=ywe(t);d>h;h++)if(f=E(t[h]),f&&Cx(bx,f))return f;return new Tp(!1)}u=bwe(t,c)}for(m=s?t.next:u.next;!(p=pwe(m,u)).done;){try{f=E(p.value)}catch(T){yx(u,"throw",T)}if(typeof f=="object"&&f&&Cx(bx,f))return f}return new Tp(!1)},Twe=Ur,Mwe=Va,_we=Ww,Owe=function(t,e,n){Twe?Mwe.f(t,e,_we(0,n)):t[e]=n},Pwe=$n,Iwe=Ewe,xwe=Owe;Pwe({target:"Object",stat:!0},{fromEntries:function(e){var n={};return Iwe(e,function(i,r){xwe(n,i,r)},{AS_ENTRIES:!0}),n}});const N$="undoRedo",Awe="undoRedo";function de(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(i,r){const s=i&&i.length;if(!s||!i.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=i.reduce((c,h)=>(c.push([...h]),c),[]);A(l,c=>{c[1]=t.propToCol(c[1])});const u=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new de.ChangeAction(l,u)};e.done(a,r)}),t.addHook("afterCreateRow",(i,r,s)=>{e.done(()=>new de.CreateRowAction(i,r),s)});const n=(i,r,s,o)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return _e(s,o,c=>{_e(i,r,h=>{const d=t.getCellMeta(h,c);if(Object.keys(d).length!==l){const f=Object.fromEntries(Object.entries(d).filter(m=>{let[p]=m;return a.includes(p)===!1}));u.push([d.visualRow,d.visualCol,f])}})}),u};t.addHook("beforeRemoveRow",(i,r,s,o)=>{const a=()=>{const l=t.toPhysicalRow(i),u=l+r-1,c=Jn(e.instance.getSourceData(l,0,l+r-1,e.instance.countSourceCols()-1));return new de.RemoveRowAction(l,c,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),n(l,u,0,t.countCols()-1))};e.done(a,o)}),t.addHook("afterCreateCol",(i,r,s)=>{e.done(()=>new de.CreateColumnAction(i,r),s)}),t.addHook("beforeRemoveCol",(i,r,s,o)=>{const a=()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+i)%e.instance.countCols(),c=u+r-1,h=[],d=[],f=[];_e(l.length-1,y=>{const E=[],T=l[y];_e(u,c,M=>{E.push(T[t.toPhysicalColumn(M)])}),h.push(E)}),_e(r-1,y=>{f.push(t.toPhysicalColumn(u+y))}),Array.isArray(t.getSettings().colHeaders)&&_e(r-1,y=>{d.push(t.getSettings().colHeaders[t.toPhysicalColumn(u+y)]||null)});const m=t.columnIndexMapper.getIndexesSequence(),p=t.rowIndexMapper.getIndexesSequence();return new de.RemoveColumnAction(u,f,h,d,m,p,t.getSettings().fixedColumnsStart,n(0,t.countRows(),u,c))};e.done(a,o)}),t.addHook("beforeCellAlignment",(i,r,s,o)=>{e.done(()=>new de.CellAlignmentAction(i,r,s,o))}),t.addHook("beforeFilter",i=>{e.done(()=>new de.FiltersAction(i))}),t.addHook("beforeRowMove",(i,r)=>{i!==!1&&e.done(()=>new de.RowMoveAction(i,r))}),t.addHook("beforeColumnMove",(i,r)=>{i!==!1&&e.done(()=>new de.ColumnMoveAction(i,r))}),t.addHook("beforeMergeCells",(i,r)=>{r||e.done(()=>new de.MergeCellsAction(t,i))}),t.addHook("afterUnmergeCells",(i,r)=>{r||e.done(()=>new de.UnmergeCellsAction(t,i))}),t.addHook("beforeColumnSort",(i,r,s)=>{s&&e.done(()=>new de.ColumnSortAction(i,r))}),t.addHook("afterInit",()=>{e.init()})}de.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const i=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",i,e)===!1)return;const s=t(),o=this.undoneActions.slice();this.doneActions.push(s),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())};de.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=Jn(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const r=this,s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s),e.undo(this.instance,()=>{r.ignoreNewActions=!1,r.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};de.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=Jn(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const r=this,s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s),e.redo(this.instance,()=>{r.ignoreNewActions=!1,r.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};de.prototype.isUndoAvailable=function(){return this.doneActions.length>0};de.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};de.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};de.prototype.isEnabled=function(){return this.enabled};de.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,Dwe(t),this.registerShortcuts(),t.addHook("afterChange",D$)};de.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,Lwe(t),this.unregisterShortcuts(),t.removeHook("afterChange",D$)};de.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};de.Action=function(){};de.Action.prototype.undo=function(){};de.Action.prototype.redo=function(){};de.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Gr(de.ChangeAction,de.Action);de.ChangeAction.prototype.undo=function(t,e){const n=Jn(this.changes),i=t.countEmptyRows(!0),r=t.countEmptyCols(!0);for(let o=0,a=n.length;o<a;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,a=n.length;o<a;o++){const[l,u]=n[o];t.getSettings().minSpareRows&&l+1+t.getSettings().minSpareRows===t.countRows()&&i===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(l+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&u+1+t.getSettings().minSpareCols===t.countCols()&&r===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(u+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const s=t.getSelectedLast();if(s!==void 0){const[o,a]=n[0],[l,u]=s,c=t.view.getFirstFullyVisibleRow(),h=t.view.getFirstFullyVisibleColumn(),d=o>=c,f=a>=h;if((d&&f)===!1&&(l!==o||u!==a)===!0){const y={row:o,col:a};d===!1&&(y.verticalSnap="top"),f===!1&&(y.horizontalSnap="start"),t.scrollViewportTo(y)}}t.selectCells(this.selected,!1,!1)};de.ChangeAction.prototype.redo=function(t,e){const n=Jn(this.changes);for(let i=0,r=n.length;i<r;i++)n[i].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};de.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Gr(de.CreateRowAction,de.Action);de.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),i=t.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};de.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};de.RemoveRowAction=function(t,e,n,i,r,s){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=i,this.rowIndexesSequence=r,this.removedCellMetas=s};Gr(de.RemoveRowAction,de.Action);de.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((r,s)=>{Object.keys(r).forEach(o=>{const a=parseInt(o,10);i.push([this.index+s,isNaN(a)?o:a,r[o]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(r=>{let[s,o,a]=r;t.setCellMetaObject(s,o,a)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};de.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};de.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Gr(de.CreateColumnAction,de.Action);de.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};de.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};de.RemoveColumnAction=function(t,e,n,i,r,s,o,a){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=i,this.columnPositions=r.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o,this.removedCellMetas=a};Gr(de.RemoveColumnAction,de.Action);de.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),r=(u,c,h)=>h[this.indexes.indexOf(i[c])],s=this.data.length,o=[];for(let u=0;u<s;u++)o.push(tt(this.data[u],r));const a=tt(this.headers,r),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),A(t.getSourceDataArray(),(u,c)=>{A(i,(h,d)=>{u[h]=o[c][d],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&A(a,(u,c)=>{t.getSettings().colHeaders[i[c]]=u}),this.removedCellMetas.forEach(u=>{let[c,h,d]=u;t.setCellMetaObject(c,h,d)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};de.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};de.CellAlignmentAction=function(t,e,n,i){this.stateBefore=t,this.range=e,this.type=n,this.alignment=i};de.CellAlignmentAction.prototype.undo=function(t,e){A(this.range,n=>{n.forAll((i,r)=>{i>=0&&r>=0&&t.setCellMeta(i,r,"className",this.stateBefore[i][r]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};de.CellAlignmentAction.prototype.redo=function(t,e){sa(this.range,this.type,this.alignment,(n,i)=>t.getCellMeta(n,i),(n,i,r,s)=>t.setCellMeta(n,i,r,s)),t.addHookOnce("afterViewRender",e),t.render()};de.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};Gr(de.FiltersAction,de.Action);de.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};de.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class Hwe extends de.Action{constructor(e,n){super(),this.cellRange=n;const i=this.cellRange.getTopStartCorner(),r=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(i.row,i.col,r.row,r.col)}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange)}}de.MergeCellsAction=Hwe;class Nwe extends de.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange,!0)}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0),e.render()}}de.UnmergeCellsAction=Nwe;de.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"};Gr(de.RowMoveAction,de.Action);de.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),OM(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(r=>{let{from:s,to:o}=r;s<o&&(o-=1),n.moveRow(o,s)}),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};de.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};de.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"};Gr(de.ColumnMoveAction,de.Action);de.ColumnMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),OM(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(r=>{let{from:s,to:o}=r;s<o&&(o-=1),n.moveColumn(o,s)}),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};de.ColumnMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),n.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};de.ColumnSortAction=function(t,e){this.previousSortState=t,this.nextSortState=e};Gr(de.ColumnSortAction,de.Action);de.ColumnSortAction.prototype.undo=function(t,e){const n=t.getPlugin("columnSorting"),i=t.getPlugin("multiColumnSorting"),r=i.isEnabled()?i:n;this.previousSortState.length?r.sort(this.previousSortState):r.clearSort(),e()};de.ColumnSortAction.prototype.redo=function(t,e){const n=t.getPlugin("columnSorting"),i=t.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),e()};de.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};de.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),i={runOnlyIf:r=>!r.altKey,group:N$};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)};de.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(N$)};function D$(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function Dwe(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function Lwe(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const Jf=ye.getSingleton();Jf.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});Jf.register("beforeUndo");Jf.register("afterUndo");Jf.register("beforeRedo");Jf.register("afterRedo");de.PLUGIN_KEY=Awe;de.SETTING_KEYS=!0;function kwe(){ot(Md),ot(mre),ot(_d),ot(Xre),ot(ise),ot(sk),ot(Zse),ot(Doe),ot(Vv),ot(Qae),ot(Tle),ot(Hle),ot(jv),ot(aue),ot(she),ot(Lhe),ot(lde),ot(Cde),ot(xde),ot(Bde),ot(Jde),ot(pfe),ot(Tfe),ot(ige),ot(kge),ot(Bge),ot(gme),ot(epe),ot(Rpe),ot(Ape),ot(Fpe),ot(qpe),ot(de)}function $we(){Une(),lie(),wie(),kie(),kwe()}function Fwe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const i=this.first();let r=i.data("handsontable");if(typeof n!="string"){const u=n||{};return r?r.updateSettings(u):(r=new t.Core(i[0],u),i.data("handsontable",r),r.init()),i}let s;if(r)if(typeof r[n]<"u"){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];s=r[n].call(r,...a),n==="destroy"&&i.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return s})}var Hb,Nb,Db,Lb,kb;$we();Fwe(Fe);Fe.__GhostTable=fM;Fe._getListenersCounter=Y8;Fe._getRegisteredMapsCounter=gQ;Fe.EventManager=hr;const Vwe=[JX,o8,tQ,cie,i8,V9,n9,Dq,n8,r9,u8,Nq],Wwe=[L9,c8];Fe.helper={};Fe.dom={};A(Vwe,t=>{A(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Fe.helper[e]=t[e])})});A(Wwe,t=>{A(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Fe.dom[e]=t[e])})});Fe.cellTypes=(Hb=Fe.cellTypes)!==null&&Hb!==void 0?Hb:{};A(Cee(),t=>{Fe.cellTypes[t]=XT(t)});Fe.cellTypes.registerCellType=Zi;Fe.cellTypes.getCellType=XT;Fe.editors=(Nb=Fe.editors)!==null&&Nb!==void 0?Nb:{};A(F8(),t=>{Fe.editors[`${Zn(t)}Editor`]=zp(t)});Fe.editors.registerEditor=yi;Fe.editors.getEditor=zp;Fe.renderers=(Db=Fe.renderers)!==null&&Db!==void 0?Db:{};A(qq(),t=>{const e=Kp(t);t==="base"&&(Fe.renderers.cellDecorator=e),Fe.renderers[`${Zn(t)}Renderer`]=e});Fe.renderers.registerRenderer=xi;Fe.renderers.getRenderer=Kp;Fe.validators=(Lb=Fe.validators)!==null&&Lb!==void 0?Lb:{};A(Qq(),t=>{Fe.validators[`${Zn(t)}Validator`]=Q0(t)});Fe.validators.registerValidator=Hl;Fe.validators.getValidator=Q0;Fe.plugins=(kb=Fe.plugins)!==null&&kb!==void 0?kb:{};A(J0(),t=>{Fe.plugins[t]=Ff(t)});Fe.plugins[`${Zn(ut.PLUGIN_KEY)}Plugin`]=ut;Fe.plugins.registerPlugin=ot;Fe.plugins.getPlugin=Ff;const Bwe=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n},jwe={data(){return{booksData:[]}},mounted(){fetch("/book-viewer/assets/books.json").then(t=>t.json()).then(t=>{this.booksData=t;const e=this.booksData.map(r=>[`/${r.id}.png`,r.dueDate,r.isRenewable?"✅":"❌",r.accountName,r.name,r.renewed,r.by,r.type]),n=function(r,s,o,a,l,u,c){Fe.renderers.TextRenderer.apply(this,arguments),u?s.innerHTML=`<img src="/book-viewer/assets${u}" width="150">`:s.innerText="No Image"},i=document.getElementById("books-table");new Fe(i,{data:e,colHeaders:["Cover Image","Due Date","Renewable","Account Name","Book Name","Renewed","Author","Type"],columns:[{renderer:n},{},{},{},{},{},{},{}],rowHeaders:!0,colWidths:[150,120,200,100,100,200,200,100],filters:!0,dropdownMenu:!0,columnSorting:!0})})}},Uwe={id:"books-table"};function Ywe(t,e,n,i,r,s){return HV(),LV("div",Uwe)}const zwe=Bwe(jwe,[["render",Ywe]]),L$=yW(zwe);cj(L$);L$.mount("#app")});export default Gwe();
